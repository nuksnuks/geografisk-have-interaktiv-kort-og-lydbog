const __vite__fileDeps=["assets/AboutGarden-BL6GR5sE.js","assets/TopNav-D4Fz84cq.js","assets/AboutGarden-Bc1Lx8TL.css","assets/MapView-qkKO5SCB.js","assets/MapView-DAHpCabt.css","assets/CalenderView-GuxHBmbT.js","assets/CalenderView-BFbSI-GV.css","assets/404View-CMNVDfyR.js","assets/404View-CnqEGJVp.css","assets/PlantPage-MlLtCwq-.js","assets/PlantPage-lvU3t2DN.css","assets/SingleEventPage-DmEq6x_M.js","assets/SingleEventPage-DaQfUv29.css","assets/CountryView-DnN8cFEr.js","assets/CountryView-CYPQl3De.css","assets/PlantOverview-Cmnb5Dk-.js","assets/PlantOverview-uiVe4LBw.css","assets/AdminDashboard-CYyEXQCk.js","assets/LoginView-Dhvqv6r5.js","assets/LoginView-DDZCIAGd.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Yp(n,e){const t=new Set(n.split(","));return r=>t.has(r)}const Lt={},ia=[],vr=()=>{},WT=()=>!1,Ah=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),Xp=n=>n.startsWith("onUpdate:"),rn=Object.assign,Qp=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},GT=Object.prototype.hasOwnProperty,Et=(n,e)=>GT.call(n,e),et=Array.isArray,oa=n=>gc(n)==="[object Map]",Ih=n=>gc(n)==="[object Set]",m1=n=>gc(n)==="[object Date]",lt=n=>typeof n=="function",Ut=n=>typeof n=="string",Ss=n=>typeof n=="symbol",Pt=n=>n!==null&&typeof n=="object",A2=n=>(Pt(n)||lt(n))&&lt(n.then)&&lt(n.catch),I2=Object.prototype.toString,gc=n=>I2.call(n),YT=n=>gc(n).slice(8,-1),R2=n=>gc(n)==="[object Object]",Jp=n=>Ut(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Sl=Yp(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Rh=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},XT=/-(\w)/g,ts=Rh(n=>n.replace(XT,(e,t)=>t?t.toUpperCase():"")),QT=/\B([A-Z])/g,ko=Rh(n=>n.replace(QT,"-$1").toLowerCase()),kh=Rh(n=>n.charAt(0).toUpperCase()+n.slice(1)),yu=Rh(n=>n?`on${kh(n)}`:""),Ai=(n,e)=>!Object.is(n,e),bu=(n,...e)=>{for(let t=0;t<n.length;t++)n[t](...e)},k2=(n,e,t,r=!1)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,writable:r,value:t})},Lu=n=>{const e=parseFloat(n);return isNaN(e)?n:e},JT=n=>{const e=Ut(n)?Number(n):NaN;return isNaN(e)?n:e};let g1;const C2=()=>g1||(g1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function _c(n){if(et(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=Ut(r)?nS(r):_c(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(Ut(n)||Pt(n))return n}const ZT=/;(?![^(]*\))/g,eS=/:([^]+)/,tS=/\/\*[^]*?\*\//g;function nS(n){const e={};return n.replace(tS,"").split(ZT).forEach(t=>{if(t){const r=t.split(eS);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function mi(n){let e="";if(Ut(n))e=n;else if(et(n))for(let t=0;t<n.length;t++){const r=mi(n[t]);r&&(e+=r+" ")}else if(Pt(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}function VB(n){if(!n)return null;let{class:e,style:t}=n;return e&&!Ut(e)&&(n.class=mi(e)),t&&(n.style=_c(t)),n}const rS="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",sS=Yp(rS);function x2(n){return!!n||n===""}function iS(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=Ch(n[r],e[r]);return t}function Ch(n,e){if(n===e)return!0;let t=m1(n),r=m1(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=Ss(n),r=Ss(e),t||r)return n===e;if(t=et(n),r=et(e),t||r)return t&&r?iS(n,e):!1;if(t=Pt(n),r=Pt(e),t||r){if(!t||!r)return!1;const s=Object.keys(n).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Ch(n[o],e[o]))return!1}}return String(n)===String(e)}function oS(n,e){return n.findIndex(t=>Ch(t,e))}const Ys=n=>Ut(n)?n:n==null?"":et(n)||Pt(n)&&(n.toString===I2||!lt(n.toString))?JSON.stringify(n,M2,2):String(n),M2=(n,e)=>e&&e.__v_isRef?M2(n,e.value):oa(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[Df(r,i)+" =>"]=s,t),{})}:Ih(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>Df(t))}:Ss(e)?Df(e):Pt(e)&&!et(e)&&!R2(e)?String(e):e,Df=(n,e="")=>{var t;return Ss(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let cr;class P2{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=cr,!e&&cr&&(this.index=(cr.scopes||(cr.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=cr;try{return cr=this,e()}finally{cr=t}}}on(){cr=this}off(){cr=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function O2(n){return new P2(n)}function aS(n,e=cr){e&&e.active&&e.effects.push(n)}function N2(){return cr}function lS(n){cr&&cr.cleanups.push(n)}let oo;class Zp{constructor(e,t,r,s){this.fn=e,this.trigger=t,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=5,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,aS(this,s)}get dirty(){if(this._dirtyLevel===2)return!1;if(this._dirtyLevel===3||this._dirtyLevel===4){this._dirtyLevel=1,Pi();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed){if(t.computed.effect._dirtyLevel===2)return!0;if(cS(t.computed),this._dirtyLevel>=5)break}}this._dirtyLevel===1&&(this._dirtyLevel=0),Oi()}return this._dirtyLevel>=5}set dirty(e){this._dirtyLevel=e?5:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=gi,t=oo;try{return gi=!0,oo=this,this._runnings++,_1(this),this.fn()}finally{y1(this),this._runnings--,oo=t,gi=e}}stop(){this.active&&(_1(this),y1(this),this.onStop&&this.onStop(),this.active=!1)}}function cS(n){return n.value}function _1(n){n._trackId++,n._depsLength=0}function y1(n){if(n.deps.length>n._depsLength){for(let e=n._depsLength;e<n.deps.length;e++)D2(n.deps[e],n);n.deps.length=n._depsLength}}function D2(n,e){const t=n.get(e);t!==void 0&&e._trackId!==t&&(n.delete(e),n.size===0&&n.cleanup())}let gi=!0,Hd=0;const L2=[];function Pi(){L2.push(gi),gi=!1}function Oi(){const n=L2.pop();gi=n===void 0?!0:n}function em(){Hd++}function tm(){for(Hd--;!Hd&&jd.length;)jd.shift()()}function V2(n,e,t){if(e.get(n)!==n._trackId){e.set(n,n._trackId);const r=n.deps[n._depsLength];r!==e?(r&&D2(r,n),n.deps[n._depsLength++]=e):n._depsLength++}}const jd=[];function B2(n,e,t){em();for(const r of n.keys()){if(!n.computed&&r.computed&&n.get(r)===r._trackId&&r._runnings>0){r._dirtyLevel=2;continue}let s;r._dirtyLevel<e&&(s??(s=n.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r.computed&&r._dirtyLevel===2&&(r._shouldSchedule=!0),r._dirtyLevel=e),r._shouldSchedule&&(s??(s=n.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==3&&(r._shouldSchedule=!1,r.scheduler&&jd.push(r.scheduler)))}tm()}const F2=(n,e)=>{const t=new Map;return t.cleanup=n,t.computed=e,t},Vu=new WeakMap,ao=Symbol(""),zd=Symbol("");function ir(n,e,t){if(gi&&oo){let r=Vu.get(n);r||Vu.set(n,r=new Map);let s=r.get(t);s||r.set(t,s=F2(()=>r.delete(t))),V2(oo,s)}}function vs(n,e,t,r,s,i){const o=Vu.get(n);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&et(n)){const l=Number(r);o.forEach((c,u)=>{(u==="length"||!Ss(u)&&u>=l)&&a.push(c)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":et(n)?Jp(t)&&a.push(o.get("length")):(a.push(o.get(ao)),oa(n)&&a.push(o.get(zd)));break;case"delete":et(n)||(a.push(o.get(ao)),oa(n)&&a.push(o.get(zd)));break;case"set":oa(n)&&a.push(o.get(ao));break}em();for(const l of a)l&&B2(l,5);tm()}function uS(n,e){const t=Vu.get(n);return t&&t.get(e)}const hS=Yp("__proto__,__v_isRef,__isVue"),U2=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(Ss)),b1=fS();function fS(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const r=wt(this);for(let i=0,o=this.length;i<o;i++)ir(r,"get",i+"");const s=r[e](...t);return s===-1||s===!1?r[e](...t.map(wt)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){Pi(),em();const r=wt(this)[e].apply(this,t);return tm(),Oi(),r}}),n}function dS(n){Ss(n)||(n=String(n));const e=wt(this);return ir(e,"has",n),e.hasOwnProperty(n)}class H2{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?IS:q2:i?$2:z2).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=et(e);if(!s){if(o&&Et(b1,t))return Reflect.get(b1,t,r);if(t==="hasOwnProperty")return dS}const a=Reflect.get(e,t,r);return(Ss(t)?U2.has(t):hS(t))||(s||ir(e,"get",t),i)?a:sn(a)?o&&Jp(t)?a:a.value:Pt(a)?s?W2(a):yc(a):a}}class j2 extends H2{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=$l(i);if(!Bu(r)&&!$l(r)&&(i=wt(i),r=wt(r)),!et(e)&&sn(i)&&!sn(r))return l?!1:(i.value=r,!0)}const o=et(e)&&Jp(t)?Number(t)<e.length:Et(e,t),a=Reflect.set(e,t,r,s);return e===wt(s)&&(o?Ai(r,i)&&vs(e,"set",t,r):vs(e,"add",t,r)),a}deleteProperty(e,t){const r=Et(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&vs(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!Ss(t)||!U2.has(t))&&ir(e,"has",t),r}ownKeys(e){return ir(e,"iterate",et(e)?"length":ao),Reflect.ownKeys(e)}}class pS extends H2{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const mS=new j2,gS=new pS,_S=new j2(!0);const nm=n=>n,xh=n=>Reflect.getPrototypeOf(n);function Wc(n,e,t=!1,r=!1){n=n.__v_raw;const s=wt(n),i=wt(e);t||(Ai(e,i)&&ir(s,"get",e),ir(s,"get",i));const{has:o}=xh(s),a=r?nm:t?om:ql;if(o.call(s,e))return a(n.get(e));if(o.call(s,i))return a(n.get(i));n!==s&&n.get(e)}function Gc(n,e=!1){const t=this.__v_raw,r=wt(t),s=wt(n);return e||(Ai(n,s)&&ir(r,"has",n),ir(r,"has",s)),n===s?t.has(n):t.has(n)||t.has(s)}function Yc(n,e=!1){return n=n.__v_raw,!e&&ir(wt(n),"iterate",ao),Reflect.get(n,"size",n)}function v1(n){n=wt(n);const e=wt(this);return xh(e).has.call(e,n)||(e.add(n),vs(e,"add",n,n)),this}function E1(n,e){e=wt(e);const t=wt(this),{has:r,get:s}=xh(t);let i=r.call(t,n);i||(n=wt(n),i=r.call(t,n));const o=s.call(t,n);return t.set(n,e),i?Ai(e,o)&&vs(t,"set",n,e):vs(t,"add",n,e),this}function w1(n){const e=wt(this),{has:t,get:r}=xh(e);let s=t.call(e,n);s||(n=wt(n),s=t.call(e,n)),r&&r.call(e,n);const i=e.delete(n);return s&&vs(e,"delete",n,void 0),i}function T1(){const n=wt(this),e=n.size!==0,t=n.clear();return e&&vs(n,"clear",void 0,void 0),t}function Xc(n,e){return function(r,s){const i=this,o=i.__v_raw,a=wt(o),l=e?nm:n?om:ql;return!n&&ir(a,"iterate",ao),o.forEach((c,u)=>r.call(s,l(c),l(u),i))}}function Qc(n,e,t){return function(...r){const s=this.__v_raw,i=wt(s),o=oa(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),u=t?nm:e?om:ql;return!e&&ir(i,"iterate",l?zd:ao),{next(){const{value:f,done:d}=c.next();return d?{value:f,done:d}:{value:a?[u(f[0]),u(f[1])]:u(f),done:d}},[Symbol.iterator](){return this}}}}function Us(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function yS(){const n={get(i){return Wc(this,i)},get size(){return Yc(this)},has:Gc,add:v1,set:E1,delete:w1,clear:T1,forEach:Xc(!1,!1)},e={get(i){return Wc(this,i,!1,!0)},get size(){return Yc(this)},has:Gc,add:v1,set:E1,delete:w1,clear:T1,forEach:Xc(!1,!0)},t={get(i){return Wc(this,i,!0)},get size(){return Yc(this,!0)},has(i){return Gc.call(this,i,!0)},add:Us("add"),set:Us("set"),delete:Us("delete"),clear:Us("clear"),forEach:Xc(!0,!1)},r={get(i){return Wc(this,i,!0,!0)},get size(){return Yc(this,!0)},has(i){return Gc.call(this,i,!0)},add:Us("add"),set:Us("set"),delete:Us("delete"),clear:Us("clear"),forEach:Xc(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=Qc(i,!1,!1),t[i]=Qc(i,!0,!1),e[i]=Qc(i,!1,!0),r[i]=Qc(i,!0,!0)}),[n,t,e,r]}const[bS,vS,ES,wS]=yS();function rm(n,e){const t=e?n?wS:ES:n?vS:bS;return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(Et(t,s)&&s in r?t:r,s,i)}const TS={get:rm(!1,!1)},SS={get:rm(!1,!0)},AS={get:rm(!0,!1)};const z2=new WeakMap,$2=new WeakMap,q2=new WeakMap,IS=new WeakMap;function RS(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function kS(n){return n.__v_skip||!Object.isExtensible(n)?0:RS(YT(n))}function yc(n){return $l(n)?n:sm(n,!1,mS,TS,z2)}function K2(n){return sm(n,!1,_S,SS,$2)}function W2(n){return sm(n,!0,gS,AS,q2)}function sm(n,e,t,r,s){if(!Pt(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=s.get(n);if(i)return i;const o=kS(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return s.set(n,a),a}function lo(n){return $l(n)?lo(n.__v_raw):!!(n&&n.__v_isReactive)}function $l(n){return!!(n&&n.__v_isReadonly)}function Bu(n){return!!(n&&n.__v_isShallow)}function G2(n){return n?!!n.__v_raw:!1}function wt(n){const e=n&&n.__v_raw;return e?wt(e):n}function im(n){return Object.isExtensible(n)&&k2(n,"__v_skip",!0),n}const ql=n=>Pt(n)?yc(n):n,om=n=>Pt(n)?W2(n):n;class Y2{constructor(e,t,r,s){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new Zp(()=>e(this._value),()=>Al(this,this.effect._dirtyLevel===3?3:4)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=wt(this);return(!e._cacheable||e.effect.dirty)&&Ai(e._value,e._value=e.effect.run())&&Al(e,5),am(e),e.effect._dirtyLevel>=2&&Al(e,3),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function CS(n,e,t=!1){let r,s;const i=lt(n);return i?(r=n,s=vr):(r=n.get,s=n.set),new Y2(r,s,i||!s,t)}function am(n){var e;gi&&oo&&(n=wt(n),V2(oo,(e=n.dep)!=null?e:n.dep=F2(()=>n.dep=void 0,n instanceof Y2?n:void 0)))}function Al(n,e=5,t,r){n=wt(n);const s=n.dep;s&&B2(s,e)}function sn(n){return!!(n&&n.__v_isRef===!0)}function Mh(n){return X2(n,!1)}function xS(n){return X2(n,!0)}function X2(n,e){return sn(n)?n:new MS(n,e)}class MS{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:wt(e),this._value=t?e:ql(e)}get value(){return am(this),this._value}set value(e){const t=this.__v_isShallow||Bu(e)||$l(e);e=t?e:wt(e),Ai(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=t?e:ql(e),Al(this,5))}}function aa(n){return sn(n)?n.value:n}const PS={get:(n,e,t)=>aa(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return sn(s)&&!sn(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function Q2(n){return lo(n)?n:new Proxy(n,PS)}class OS{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:t,set:r}=e(()=>am(this),()=>Al(this));this._get=t,this._set=r}get value(){return this._get()}set value(e){this._set(e)}}function BB(n){return new OS(n)}function NS(n){const e=et(n)?new Array(n.length):{};for(const t in n)e[t]=J2(n,t);return e}class DS{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return uS(wt(this._object),this._key)}}class LS{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function FB(n,e,t){return sn(n)?n:lt(n)?new LS(n):Pt(n)&&arguments.length>1?J2(n,e,t):Mh(n)}function J2(n,e,t){const r=n[e];return sn(r)?r:new DS(n,e,t)}/**
* @vue/runtime-core v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function _i(n,e,t,r){try{return r?n(...r):n()}catch(s){Ph(s,e,t)}}function wr(n,e,t,r){if(lt(n)){const s=_i(n,e,t,r);return s&&A2(s)&&s.catch(i=>{Ph(i,e,t)}),s}if(et(n)){const s=[];for(let i=0;i<n.length;i++)s.push(wr(n[i],e,t,r));return s}}function Ph(n,e,t,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=`https://vuejs.org/error-reference/#runtime-${t}`;for(;i;){const c=i.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](n,o,a)===!1)return}i=i.parent}const l=e.appContext.config.errorHandler;if(l){Pi(),_i(l,null,10,[n,o,a]),Oi();return}}VS(n,t,s,r)}function VS(n,e,t,r=!0){console.error(n)}let Kl=!1,$d=!1;const Vn=[];let qr=0;const la=[];let Xs=null,Qi=0;const Z2=Promise.resolve();let lm=null;function Oh(n){const e=lm||Z2;return n?e.then(this?n.bind(this):n):e}function BS(n){let e=qr+1,t=Vn.length;for(;e<t;){const r=e+t>>>1,s=Vn[r],i=Wl(s);i<n||i===n&&s.pre?e=r+1:t=r}return e}function cm(n){(!Vn.length||!Vn.includes(n,Kl&&n.allowRecurse?qr+1:qr))&&(n.id==null?Vn.push(n):Vn.splice(BS(n.id),0,n),eb())}function eb(){!Kl&&!$d&&($d=!0,lm=Z2.then(nb))}function FS(n){const e=Vn.indexOf(n);e>qr&&Vn.splice(e,1)}function US(n){et(n)?la.push(...n):(!Xs||!Xs.includes(n,n.allowRecurse?Qi+1:Qi))&&la.push(n),eb()}function S1(n,e,t=Kl?qr+1:0){for(;t<Vn.length;t++){const r=Vn[t];if(r&&r.pre){if(n&&r.id!==n.uid)continue;Vn.splice(t,1),t--,r()}}}function tb(n){if(la.length){const e=[...new Set(la)].sort((t,r)=>Wl(t)-Wl(r));if(la.length=0,Xs){Xs.push(...e);return}for(Xs=e,Qi=0;Qi<Xs.length;Qi++){const t=Xs[Qi];t.active!==!1&&t()}Xs=null,Qi=0}}const Wl=n=>n.id==null?1/0:n.id,HS=(n,e)=>{const t=Wl(n)-Wl(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function nb(n){$d=!1,Kl=!0,Vn.sort(HS);try{for(qr=0;qr<Vn.length;qr++){const e=Vn[qr];e&&e.active!==!1&&_i(e,null,14)}}finally{qr=0,Vn.length=0,tb(),Kl=!1,lm=null,(Vn.length||la.length)&&nb()}}function jS(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||Lt;let s=t;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in r){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:f,trim:d}=r[u]||Lt;d&&(s=t.map(m=>Ut(m)?m.trim():m)),f&&(s=t.map(Lu))}let a,l=r[a=yu(e)]||r[a=yu(ts(e))];!l&&i&&(l=r[a=yu(ko(e))]),l&&wr(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,wr(c,n,6,s)}}function rb(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!lt(n)){const l=c=>{const u=rb(c,e,!0);u&&(a=!0,rn(o,u))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(Pt(n)&&r.set(n,null),null):(et(i)?i.forEach(l=>o[l]=null):rn(o,i),Pt(n)&&r.set(n,o),o)}function Nh(n,e){return!n||!Ah(e)?!1:(e=e.slice(2).replace(/Once$/,""),Et(n,e[0].toLowerCase()+e.slice(1))||Et(n,ko(e))||Et(n,e))}let ln=null,Dh=null;function Fu(n){const e=ln;return ln=n,Dh=n&&n.type.__scopeId||null,e}function sb(n){Dh=n}function ib(){Dh=null}function ui(n,e=ln,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&F1(-1);const i=Fu(e);let o;try{o=n(...s)}finally{Fu(i),r._d&&F1(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function Lf(n){const{type:e,vnode:t,proxy:r,withProxy:s,propsOptions:[i],slots:o,attrs:a,emit:l,render:c,renderCache:u,props:f,data:d,setupState:m,ctx:_,inheritAttrs:D}=n,O=Fu(n);let x,w;try{if(t.shapeFlag&4){const V=s||r,p=V;x=$r(c.call(p,V,u,f,m,d,_)),w=a}else{const V=e;x=$r(V.length>1?V(f,{attrs:a,slots:o,emit:l}):V(f,null)),w=e.props?a:zS(a)}}catch(V){xl.length=0,Ph(V,n,1),x=vt(er)}let N=x;if(w&&D!==!1){const V=Object.keys(w),{shapeFlag:p}=N;V.length&&p&7&&(i&&V.some(Xp)&&(w=$S(w,i)),N=Ii(N,w,!1,!0))}return t.dirs&&(N=Ii(N,null,!1,!0),N.dirs=N.dirs?N.dirs.concat(t.dirs):t.dirs),t.transition&&(N.transition=t.transition),x=N,Fu(O),x}const zS=n=>{let e;for(const t in n)(t==="class"||t==="style"||Ah(t))&&((e||(e={}))[t]=n[t]);return e},$S=(n,e)=>{const t={};for(const r in n)(!Xp(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function qS(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?A1(r,o,c):!!o;if(l&8){const u=e.dynamicProps;for(let f=0;f<u.length;f++){const d=u[f];if(o[d]!==r[d]&&!Nh(c,d))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?A1(r,o,c):!0:!!o;return!1}function A1(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Nh(t,i))return!0}return!1}function KS({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const um="components",WS="directives";function nr(n,e){return hm(um,n,!0,e)||n}const ob=Symbol.for("v-ndc");function UB(n){return Ut(n)?hm(um,n,!1)||n:n||ob}function HB(n){return hm(WS,n)}function hm(n,e,t=!0,r=!1){const s=ln||dn;if(s){const i=s.type;if(n===um){const a=W4(i,!1);if(a&&(a===e||a===ts(e)||a===kh(ts(e))))return i}const o=I1(s[n]||i[n],e)||I1(s.appContext[n],e);return!o&&r?i:o}}function I1(n,e){return n&&(n[e]||n[ts(e)]||n[kh(ts(e))])}const GS=n=>n.__isSuspense;function YS(n,e){e&&e.pendingBranch?et(n)?e.effects.push(...n):e.effects.push(n):US(n)}function Lh(n,e,t=dn,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{Pi();const a=bc(t),l=wr(e,t,n,o);return a(),Oi(),l});return r?s.unshift(i):s.push(i),i}}const xs=n=>(e,t=dn)=>{(!Fh||n==="sp")&&Lh(n,(...r)=>e(...r),t)},XS=xs("bm"),ab=xs("m"),QS=xs("bu"),JS=xs("u"),lb=xs("bum"),cb=xs("um"),ZS=xs("sp"),e4=xs("rtg"),t4=xs("rtc");function n4(n,e=dn){Lh("ec",n,e)}function jB(n,e){if(ln===null)return n;const t=Uh(ln),r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=Lt]=e[s];i&&(lt(i)&&(i={mounted:i,updated:i}),i.deep&&ri(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function Hi(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(Pi(),wr(l,t,8,[n.el,a,n,e]),Oi())}}function r4(n,e,t,r){let s;const i=t;if(et(n)||Ut(n)){s=new Array(n.length);for(let o=0,a=n.length;o<a;o++)s[o]=e(n[o],o,void 0,i)}else if(typeof n=="number"){s=new Array(n);for(let o=0;o<n;o++)s[o]=e(o+1,o,void 0,i)}else if(Pt(n))if(n[Symbol.iterator])s=Array.from(n,(o,a)=>e(o,a,void 0,i));else{const o=Object.keys(n);s=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];s[a]=e(n[c],c,a,i)}}else s=[];return s}/*! #__NO_SIDE_EFFECTS__ */function ub(n,e){return lt(n)?rn({name:n.name},e,{setup:n}):n}const Il=n=>!!n.type.__asyncLoader;function zB(n,e,t={},r,s){if(ln.isCE||ln.parent&&Il(ln.parent)&&ln.parent.isCE)return vt("slot",t,r&&r());let i=n[e];i&&i._c&&(i._d=!1),$t();const o=i&&hb(i(t)),a=ba(ur,{key:t.key||o&&o.key||`_${e}`},o||(r?r():[]),o&&n._===1?64:-2);return a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function hb(n){return n.some(e=>ju(e)?!(e.type===er||e.type===ur&&!hb(e.children)):!0)?n:null}function $B(n,e){const t={};for(const r in n)t[/[A-Z]/.test(r)?`on:${r}`:yu(r)]=n[r];return t}const qd=n=>n?Pb(n)?Uh(n):qd(n.parent):null,Rl=rn(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>qd(n.parent),$root:n=>qd(n.root),$emit:n=>n.emit,$options:n=>fm(n),$forceUpdate:n=>n.f||(n.f=()=>{n.effect.dirty=!0,cm(n.update)}),$nextTick:n=>n.n||(n.n=Oh.bind(n.proxy)),$watch:n=>S4.bind(n)}),Vf=(n,e)=>n!==Lt&&!n.__isScriptSetup&&Et(n,e),s4={get({_:n},e){if(e==="__v_skip")return!0;const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(Vf(r,e))return o[e]=1,r[e];if(s!==Lt&&Et(s,e))return o[e]=2,s[e];if((c=n.propsOptions[0])&&Et(c,e))return o[e]=3,i[e];if(t!==Lt&&Et(t,e))return o[e]=4,t[e];Kd&&(o[e]=0)}}const u=Rl[e];let f,d;if(u)return e==="$attrs"&&ir(n.attrs,"get",""),u(n);if((f=a.__cssModules)&&(f=f[e]))return f;if(t!==Lt&&Et(t,e))return o[e]=4,t[e];if(d=l.config.globalProperties,Et(d,e))return d[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return Vf(s,e)?(s[e]=t,!0):r!==Lt&&Et(r,e)?(r[e]=t,!0):Et(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==Lt&&Et(n,o)||Vf(e,o)||(a=i[0])&&Et(a,o)||Et(r,o)||Et(Rl,o)||Et(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Et(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function R1(n){return et(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let Kd=!0;function i4(n){const e=fm(n),t=n.proxy,r=n.ctx;Kd=!1,e.beforeCreate&&k1(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:u,beforeMount:f,mounted:d,beforeUpdate:m,updated:_,activated:D,deactivated:O,beforeDestroy:x,beforeUnmount:w,destroyed:N,unmounted:V,render:p,renderTracked:k,renderTriggered:S,errorCaptured:b,serverPrefetch:E,expose:T,inheritAttrs:M,components:H,directives:y,filters:A}=e;if(c&&o4(c,r,null),o)for(const ne in o){const Q=o[ne];lt(Q)&&(r[ne]=Q.bind(t))}if(s){const ne=s.call(t,t);Pt(ne)&&(n.data=yc(ne))}if(Kd=!0,i)for(const ne in i){const Q=i[ne],ce=lt(Q)?Q.bind(t,t):lt(Q.get)?Q.get.bind(t,t):vr,J=!lt(Q)&&lt(Q.set)?Q.set.bind(t):vr,L=hr({get:ce,set:J});Object.defineProperty(r,ne,{enumerable:!0,configurable:!0,get:()=>L.value,set:C=>L.value=C})}if(a)for(const ne in a)fb(a[ne],r,t,ne);if(l){const ne=lt(l)?l.call(t):l;Reflect.ownKeys(ne).forEach(Q=>{vu(Q,ne[Q])})}u&&k1(u,n,"c");function X(ne,Q){et(Q)?Q.forEach(ce=>ne(ce.bind(t))):Q&&ne(Q.bind(t))}if(X(XS,f),X(ab,d),X(QS,m),X(JS,_),X(A4,D),X(I4,O),X(n4,b),X(t4,k),X(e4,S),X(lb,w),X(cb,V),X(ZS,E),et(T))if(T.length){const ne=n.exposed||(n.exposed={});T.forEach(Q=>{Object.defineProperty(ne,Q,{get:()=>t[Q],set:ce=>t[Q]=ce})})}else n.exposed||(n.exposed={});p&&n.render===vr&&(n.render=p),M!=null&&(n.inheritAttrs=M),H&&(n.components=H),y&&(n.directives=y)}function o4(n,e,t=vr){et(n)&&(n=Wd(n));for(const r in n){const s=n[r];let i;Pt(s)?"default"in s?i=Tr(s.from||r,s.default,!0):i=Tr(s.from||r):i=Tr(s),sn(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function k1(n,e,t){wr(et(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function fb(n,e,t,r){const s=r.includes(".")?Tb(t,r):()=>t[r];if(Ut(n)){const i=e[n];lt(i)&&kl(s,i)}else if(lt(n))kl(s,n.bind(t));else if(Pt(n))if(et(n))n.forEach(i=>fb(i,e,t,r));else{const i=lt(n.handler)?n.handler.bind(t):e[n.handler];lt(i)&&kl(s,i,n)}}function fm(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(c=>Uu(l,c,o,!0)),Uu(l,e,o)),Pt(e)&&i.set(e,l),l}function Uu(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&Uu(n,i,t,!0),s&&s.forEach(o=>Uu(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=a4[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const a4={data:C1,props:x1,emits:x1,methods:pl,computed:pl,beforeCreate:qn,created:qn,beforeMount:qn,mounted:qn,beforeUpdate:qn,updated:qn,beforeDestroy:qn,beforeUnmount:qn,destroyed:qn,unmounted:qn,activated:qn,deactivated:qn,errorCaptured:qn,serverPrefetch:qn,components:pl,directives:pl,watch:c4,provide:C1,inject:l4};function C1(n,e){return e?n?function(){return rn(lt(n)?n.call(this,this):n,lt(e)?e.call(this,this):e)}:e:n}function l4(n,e){return pl(Wd(n),Wd(e))}function Wd(n){if(et(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function qn(n,e){return n?[...new Set([].concat(n,e))]:e}function pl(n,e){return n?rn(Object.create(null),n,e):e}function x1(n,e){return n?et(n)&&et(e)?[...new Set([...n,...e])]:rn(Object.create(null),R1(n),R1(e??{})):e}function c4(n,e){if(!n)return e;if(!e)return n;const t=rn(Object.create(null),n);for(const r in e)t[r]=qn(n[r],e[r]);return t}function db(){return{app:null,config:{isNativeTag:WT,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let u4=0;function h4(n,e){return function(r,s=null){lt(r)||(r=rn({},r)),s!=null&&!Pt(s)&&(s=null);const i=db(),o=new WeakSet;let a=!1;const l=i.app={_uid:u4++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:Y4,get config(){return i.config},set config(c){},use(c,...u){return o.has(c)||(c&&lt(c.install)?(o.add(c),c.install(l,...u)):lt(c)&&(o.add(c),c(l,...u))),l},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),l},component(c,u){return u?(i.components[c]=u,l):i.components[c]},directive(c,u){return u?(i.directives[c]=u,l):i.directives[c]},mount(c,u,f){if(!a){const d=vt(r,s);return d.appContext=i,f===!0?f="svg":f===!1&&(f=void 0),u&&e?e(d,c):n(d,c,f),a=!0,l._container=c,c.__vue_app__=l,Uh(d.component)}},unmount(){a&&(n(null,l._container),delete l._container.__vue_app__)},provide(c,u){return i.provides[c]=u,l},runWithContext(c){const u=ca;ca=l;try{return c()}finally{ca=u}}};return l}}let ca=null;function vu(n,e){if(dn){let t=dn.provides;const r=dn.parent&&dn.parent.provides;r===t&&(t=dn.provides=Object.create(r)),t[n]=e}}function Tr(n,e,t=!1){const r=dn||ln;if(r||ca){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:ca._context.provides;if(s&&n in s)return s[n];if(arguments.length>1)return t&&lt(e)?e.call(r&&r.proxy):e}}function f4(){return!!(dn||ln||ca)}const pb={},mb=()=>Object.create(pb),gb=n=>Object.getPrototypeOf(n)===pb;function d4(n,e,t,r=!1){const s={},i=mb();n.propsDefaults=Object.create(null),_b(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:K2(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function p4(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=wt(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const u=n.vnode.dynamicProps;for(let f=0;f<u.length;f++){let d=u[f];if(Nh(n.emitsOptions,d))continue;const m=e[d];if(l)if(Et(i,d))m!==i[d]&&(i[d]=m,c=!0);else{const _=ts(d);s[_]=Gd(l,a,_,m,n,!1)}else m!==i[d]&&(i[d]=m,c=!0)}}}else{_b(n,e,s,i)&&(c=!0);let u;for(const f in a)(!e||!Et(e,f)&&((u=ko(f))===f||!Et(e,u)))&&(l?t&&(t[f]!==void 0||t[u]!==void 0)&&(s[f]=Gd(l,a,f,void 0,n,!0)):delete s[f]);if(i!==a)for(const f in i)(!e||!Et(e,f))&&(delete i[f],c=!0)}c&&vs(n.attrs,"set","")}function _b(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(Sl(l))continue;const c=e[l];let u;s&&Et(s,u=ts(l))?!i||!i.includes(u)?t[u]=c:(a||(a={}))[u]=c:Nh(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=wt(t),c=a||Lt;for(let u=0;u<i.length;u++){const f=i[u];t[f]=Gd(s,l,f,c[f],n,!Et(c,f))}}return o}function Gd(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=Et(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&lt(l)){const{propsDefaults:c}=s;if(t in c)r=c[t];else{const u=bc(s);r=c[t]=l.call(null,e),u()}}else r=l}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===ko(t))&&(r=!0))}return r}function yb(n,e,t=!1){const r=e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!lt(n)){const u=f=>{l=!0;const[d,m]=yb(f,e,!0);rn(o,d),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(u),n.extends&&u(n.extends),n.mixins&&n.mixins.forEach(u)}if(!i&&!l)return Pt(n)&&r.set(n,ia),ia;if(et(i))for(let u=0;u<i.length;u++){const f=ts(i[u]);M1(f)&&(o[f]=Lt)}else if(i)for(const u in i){const f=ts(u);if(M1(f)){const d=i[u],m=o[f]=et(d)||lt(d)?{type:d}:rn({},d);if(m){const _=N1(Boolean,m.type),D=N1(String,m.type);m[0]=_>-1,m[1]=D<0||_<D,(_>-1||Et(m,"default"))&&a.push(f)}}}const c=[o,a];return Pt(n)&&r.set(n,c),c}function M1(n){return n[0]!=="$"&&!Sl(n)}function P1(n){return n===null?"null":typeof n=="function"?n.name||"":typeof n=="object"&&n.constructor&&n.constructor.name||""}function O1(n,e){return P1(n)===P1(e)}function N1(n,e){return et(e)?e.findIndex(t=>O1(t,n)):lt(e)&&O1(e,n)?0:-1}const bb=n=>n[0]==="_"||n==="$stable",dm=n=>et(n)?n.map($r):[$r(n)],m4=(n,e,t)=>{if(e._n)return e;const r=ui((...s)=>dm(e(...s)),t);return r._c=!1,r},vb=(n,e,t)=>{const r=n._ctx;for(const s in n){if(bb(s))continue;const i=n[s];if(lt(i))e[s]=m4(s,i,r);else if(i!=null){const o=dm(i);e[s]=()=>o}}},Eb=(n,e)=>{const t=dm(e);n.slots.default=()=>t},g4=(n,e)=>{const t=n.slots=mb();if(n.vnode.shapeFlag&32){const r=e._;r?(rn(t,e),k2(t,"_",r,!0)):vb(e,t)}else e&&Eb(n,e)},_4=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=Lt;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:(rn(s,e),!t&&a===1&&delete s._):(i=!e.$stable,vb(e,s)),o=e}else e&&(Eb(n,e),o={default:1});if(i)for(const a in s)!bb(a)&&o[a]==null&&delete s[a]};function Yd(n,e,t,r,s=!1){if(et(n)){n.forEach((d,m)=>Yd(d,e&&(et(e)?e[m]:e),t,r,s));return}if(Il(r)&&!s)return;const i=r.shapeFlag&4?Uh(r.component):r.el,o=s?null:i,{i:a,r:l}=n,c=e&&e.r,u=a.refs===Lt?a.refs={}:a.refs,f=a.setupState;if(c!=null&&c!==l&&(Ut(c)?(u[c]=null,Et(f,c)&&(f[c]=null)):sn(c)&&(c.value=null)),lt(l))_i(l,a,12,[o,u]);else{const d=Ut(l),m=sn(l);if(d||m){const _=()=>{if(n.f){const D=d?Et(f,l)?f[l]:u[l]:l.value;s?et(D)&&Qp(D,i):et(D)?D.includes(i)||D.push(i):d?(u[l]=[i],Et(f,l)&&(f[l]=u[l])):(l.value=[i],n.k&&(u[n.k]=l.value))}else d?(u[l]=o,Et(f,l)&&(f[l]=o)):m&&(l.value=o,n.k&&(u[n.k]=o))};o?(_.id=-1,Zn(_,t)):_()}}}const Zn=YS;function y4(n){return b4(n)}function b4(n,e){const t=C2();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:u,parentNode:f,nextSibling:d,setScopeId:m=vr,insertStaticContent:_}=n,D=(j,K,re,he=null,_e=null,De=null,v=void 0,P=null,me=!!K.dynamicChildren)=>{if(j===K)return;j&&!Ji(j,K)&&(he=Z(j),C(j,_e,De,!0),j=null),K.patchFlag===-2&&(me=!1,K.dynamicChildren=null);const{type:fe,ref:Se,shapeFlag:Re}=K;switch(fe){case Bh:O(j,K,re,he);break;case er:x(j,K,re,he);break;case Eu:j==null&&w(K,re,he,v);break;case ur:H(j,K,re,he,_e,De,v,P,me);break;default:Re&1?p(j,K,re,he,_e,De,v,P,me):Re&6?y(j,K,re,he,_e,De,v,P,me):(Re&64||Re&128)&&fe.process(j,K,re,he,_e,De,v,P,me,le)}Se!=null&&_e&&Yd(Se,j&&j.ref,De,K||j,!K)},O=(j,K,re,he)=>{if(j==null)r(K.el=a(K.children),re,he);else{const _e=K.el=j.el;K.children!==j.children&&c(_e,K.children)}},x=(j,K,re,he)=>{j==null?r(K.el=l(K.children||""),re,he):K.el=j.el},w=(j,K,re,he)=>{[j.el,j.anchor]=_(j.children,K,re,he,j.el,j.anchor)},N=({el:j,anchor:K},re,he)=>{let _e;for(;j&&j!==K;)_e=d(j),r(j,re,he),j=_e;r(K,re,he)},V=({el:j,anchor:K})=>{let re;for(;j&&j!==K;)re=d(j),s(j),j=re;s(K)},p=(j,K,re,he,_e,De,v,P,me)=>{K.type==="svg"?v="svg":K.type==="math"&&(v="mathml"),j==null?k(K,re,he,_e,De,v,P,me):E(j,K,_e,De,v,P,me)},k=(j,K,re,he,_e,De,v,P)=>{let me,fe;const{props:Se,shapeFlag:Re,transition:Ae,dirs:Te}=j;if(me=j.el=o(j.type,De,Se&&Se.is,Se),Re&8?u(me,j.children):Re&16&&b(j.children,me,null,he,_e,Bf(j,De),v,P),Te&&Hi(j,null,he,"created"),S(me,j,j.scopeId,v,he),Se){for(const Ue in Se)Ue!=="value"&&!Sl(Ue)&&i(me,Ue,null,Se[Ue],De,j.children,he,_e,ie);"value"in Se&&i(me,"value",null,Se.value,De),(fe=Se.onVnodeBeforeMount)&&Ur(fe,he,j)}Te&&Hi(j,null,he,"beforeMount");const Ne=v4(_e,Ae);Ne&&Ae.beforeEnter(me),r(me,K,re),((fe=Se&&Se.onVnodeMounted)||Ne||Te)&&Zn(()=>{fe&&Ur(fe,he,j),Ne&&Ae.enter(me),Te&&Hi(j,null,he,"mounted")},_e)},S=(j,K,re,he,_e)=>{if(re&&m(j,re),he)for(let De=0;De<he.length;De++)m(j,he[De]);if(_e){let De=_e.subTree;if(K===De){const v=_e.vnode;S(j,v,v.scopeId,v.slotScopeIds,_e.parent)}}},b=(j,K,re,he,_e,De,v,P,me=0)=>{for(let fe=me;fe<j.length;fe++){const Se=j[fe]=P?Js(j[fe]):$r(j[fe]);D(null,Se,K,re,he,_e,De,v,P)}},E=(j,K,re,he,_e,De,v)=>{const P=K.el=j.el;let{patchFlag:me,dynamicChildren:fe,dirs:Se}=K;me|=j.patchFlag&16;const Re=j.props||Lt,Ae=K.props||Lt;let Te;if(re&&ji(re,!1),(Te=Ae.onVnodeBeforeUpdate)&&Ur(Te,re,K,j),Se&&Hi(K,j,re,"beforeUpdate"),re&&ji(re,!0),fe?T(j.dynamicChildren,fe,P,re,he,Bf(K,_e),De):v||Q(j,K,P,null,re,he,Bf(K,_e),De,!1),me>0){if(me&16)M(P,K,Re,Ae,re,he,_e);else if(me&2&&Re.class!==Ae.class&&i(P,"class",null,Ae.class,_e),me&4&&i(P,"style",Re.style,Ae.style,_e),me&8){const Ne=K.dynamicProps;for(let Ue=0;Ue<Ne.length;Ue++){const Ie=Ne[Ue],Je=Re[Ie],dt=Ae[Ie];(dt!==Je||Ie==="value")&&i(P,Ie,Je,dt,_e,j.children,re,he,ie)}}me&1&&j.children!==K.children&&u(P,K.children)}else!v&&fe==null&&M(P,K,Re,Ae,re,he,_e);((Te=Ae.onVnodeUpdated)||Se)&&Zn(()=>{Te&&Ur(Te,re,K,j),Se&&Hi(K,j,re,"updated")},he)},T=(j,K,re,he,_e,De,v)=>{for(let P=0;P<K.length;P++){const me=j[P],fe=K[P],Se=me.el&&(me.type===ur||!Ji(me,fe)||me.shapeFlag&70)?f(me.el):re;D(me,fe,Se,null,he,_e,De,v,!0)}},M=(j,K,re,he,_e,De,v)=>{if(re!==he){if(re!==Lt)for(const P in re)!Sl(P)&&!(P in he)&&i(j,P,re[P],null,v,K.children,_e,De,ie);for(const P in he){if(Sl(P))continue;const me=he[P],fe=re[P];me!==fe&&P!=="value"&&i(j,P,fe,me,v,K.children,_e,De,ie)}"value"in he&&i(j,"value",re.value,he.value,v)}},H=(j,K,re,he,_e,De,v,P,me)=>{const fe=K.el=j?j.el:a(""),Se=K.anchor=j?j.anchor:a("");let{patchFlag:Re,dynamicChildren:Ae,slotScopeIds:Te}=K;Te&&(P=P?P.concat(Te):Te),j==null?(r(fe,re,he),r(Se,re,he),b(K.children||[],re,Se,_e,De,v,P,me)):Re>0&&Re&64&&Ae&&j.dynamicChildren?(T(j.dynamicChildren,Ae,re,_e,De,v,P),(K.key!=null||_e&&K===_e.subTree)&&pm(j,K,!0)):Q(j,K,re,Se,_e,De,v,P,me)},y=(j,K,re,he,_e,De,v,P,me)=>{K.slotScopeIds=P,j==null?K.shapeFlag&512?_e.ctx.activate(K,re,he,v,me):A(K,re,he,_e,De,v,me):W(j,K,me)},A=(j,K,re,he,_e,De,v)=>{const P=j.component=H4(j,he,_e);if(Vh(j)&&(P.ctx.renderer=le),z4(P),P.asyncDep){if(_e&&_e.registerDep(P,X,v),!j.el){const me=P.subTree=vt(er);x(null,me,K,re)}}else X(P,j,K,re,_e,De,v)},W=(j,K,re)=>{const he=K.component=j.component;if(qS(j,K,re))if(he.asyncDep&&!he.asyncResolved){ne(he,K,re);return}else he.next=K,FS(he.update),he.effect.dirty=!0,he.update();else K.el=j.el,he.vnode=K},X=(j,K,re,he,_e,De,v)=>{const P=()=>{if(j.isMounted){let{next:Se,bu:Re,u:Ae,parent:Te,vnode:Ne}=j;{const F=wb(j);if(F){Se&&(Se.el=Ne.el,ne(j,Se,v)),F.asyncDep.then(()=>{j.isUnmounted||P()});return}}let Ue=Se,Ie;ji(j,!1),Se?(Se.el=Ne.el,ne(j,Se,v)):Se=Ne,Re&&bu(Re),(Ie=Se.props&&Se.props.onVnodeBeforeUpdate)&&Ur(Ie,Te,Se,Ne),ji(j,!0);const Je=Lf(j),dt=j.subTree;j.subTree=Je,D(dt,Je,f(dt.el),Z(dt),j,_e,De),Se.el=Je.el,Ue===null&&KS(j,Je.el),Ae&&Zn(Ae,_e),(Ie=Se.props&&Se.props.onVnodeUpdated)&&Zn(()=>Ur(Ie,Te,Se,Ne),_e)}else{let Se;const{el:Re,props:Ae}=K,{bm:Te,m:Ne,parent:Ue}=j,Ie=Il(K);if(ji(j,!1),Te&&bu(Te),!Ie&&(Se=Ae&&Ae.onVnodeBeforeMount)&&Ur(Se,Ue,K),ji(j,!0),Re&&Oe){const Je=()=>{j.subTree=Lf(j),Oe(Re,j.subTree,j,_e,null)};Ie?K.type.__asyncLoader().then(()=>!j.isUnmounted&&Je()):Je()}else{const Je=j.subTree=Lf(j);D(null,Je,re,he,j,_e,De),K.el=Je.el}if(Ne&&Zn(Ne,_e),!Ie&&(Se=Ae&&Ae.onVnodeMounted)){const Je=K;Zn(()=>Ur(Se,Ue,Je),_e)}(K.shapeFlag&256||Ue&&Il(Ue.vnode)&&Ue.vnode.shapeFlag&256)&&j.a&&Zn(j.a,_e),j.isMounted=!0,K=re=he=null}},me=j.effect=new Zp(P,vr,()=>cm(fe),j.scope),fe=j.update=()=>{me.dirty&&me.run()};fe.id=j.uid,ji(j,!0),fe()},ne=(j,K,re)=>{K.component=j;const he=j.vnode.props;j.vnode=K,j.next=null,p4(j,K.props,he,re),_4(j,K.children,re),Pi(),S1(j),Oi()},Q=(j,K,re,he,_e,De,v,P,me=!1)=>{const fe=j&&j.children,Se=j?j.shapeFlag:0,Re=K.children,{patchFlag:Ae,shapeFlag:Te}=K;if(Ae>0){if(Ae&128){J(fe,Re,re,he,_e,De,v,P,me);return}else if(Ae&256){ce(fe,Re,re,he,_e,De,v,P,me);return}}Te&8?(Se&16&&ie(fe,_e,De),Re!==fe&&u(re,Re)):Se&16?Te&16?J(fe,Re,re,he,_e,De,v,P,me):ie(fe,_e,De,!0):(Se&8&&u(re,""),Te&16&&b(Re,re,he,_e,De,v,P,me))},ce=(j,K,re,he,_e,De,v,P,me)=>{j=j||ia,K=K||ia;const fe=j.length,Se=K.length,Re=Math.min(fe,Se);let Ae;for(Ae=0;Ae<Re;Ae++){const Te=K[Ae]=me?Js(K[Ae]):$r(K[Ae]);D(j[Ae],Te,re,null,_e,De,v,P,me)}fe>Se?ie(j,_e,De,!0,!1,Re):b(K,re,he,_e,De,v,P,me,Re)},J=(j,K,re,he,_e,De,v,P,me)=>{let fe=0;const Se=K.length;let Re=j.length-1,Ae=Se-1;for(;fe<=Re&&fe<=Ae;){const Te=j[fe],Ne=K[fe]=me?Js(K[fe]):$r(K[fe]);if(Ji(Te,Ne))D(Te,Ne,re,null,_e,De,v,P,me);else break;fe++}for(;fe<=Re&&fe<=Ae;){const Te=j[Re],Ne=K[Ae]=me?Js(K[Ae]):$r(K[Ae]);if(Ji(Te,Ne))D(Te,Ne,re,null,_e,De,v,P,me);else break;Re--,Ae--}if(fe>Re){if(fe<=Ae){const Te=Ae+1,Ne=Te<Se?K[Te].el:he;for(;fe<=Ae;)D(null,K[fe]=me?Js(K[fe]):$r(K[fe]),re,Ne,_e,De,v,P,me),fe++}}else if(fe>Ae)for(;fe<=Re;)C(j[fe],_e,De,!0),fe++;else{const Te=fe,Ne=fe,Ue=new Map;for(fe=Ne;fe<=Ae;fe++){const se=K[fe]=me?Js(K[fe]):$r(K[fe]);se.key!=null&&Ue.set(se.key,fe)}let Ie,Je=0;const dt=Ae-Ne+1;let F=!1,U=0;const Y=new Array(dt);for(fe=0;fe<dt;fe++)Y[fe]=0;for(fe=Te;fe<=Re;fe++){const se=j[fe];if(Je>=dt){C(se,_e,De,!0);continue}let G;if(se.key!=null)G=Ue.get(se.key);else for(Ie=Ne;Ie<=Ae;Ie++)if(Y[Ie-Ne]===0&&Ji(se,K[Ie])){G=Ie;break}G===void 0?C(se,_e,De,!0):(Y[G-Ne]=fe+1,G>=U?U=G:F=!0,D(se,K[G],re,null,_e,De,v,P,me),Je++)}const te=F?E4(Y):ia;for(Ie=te.length-1,fe=dt-1;fe>=0;fe--){const se=Ne+fe,G=K[se],ae=se+1<Se?K[se+1].el:he;Y[fe]===0?D(null,G,re,ae,_e,De,v,P,me):F&&(Ie<0||fe!==te[Ie]?L(G,re,ae,2):Ie--)}}},L=(j,K,re,he,_e=null)=>{const{el:De,type:v,transition:P,children:me,shapeFlag:fe}=j;if(fe&6){L(j.component.subTree,K,re,he);return}if(fe&128){j.suspense.move(K,re,he);return}if(fe&64){v.move(j,K,re,le);return}if(v===ur){r(De,K,re);for(let Re=0;Re<me.length;Re++)L(me[Re],K,re,he);r(j.anchor,K,re);return}if(v===Eu){N(j,K,re);return}if(he!==2&&fe&1&&P)if(he===0)P.beforeEnter(De),r(De,K,re),Zn(()=>P.enter(De),_e);else{const{leave:Re,delayLeave:Ae,afterLeave:Te}=P,Ne=()=>r(De,K,re),Ue=()=>{Re(De,()=>{Ne(),Te&&Te()})};Ae?Ae(De,Ne,Ue):Ue()}else r(De,K,re)},C=(j,K,re,he=!1,_e=!1)=>{const{type:De,props:v,ref:P,children:me,dynamicChildren:fe,shapeFlag:Se,patchFlag:Re,dirs:Ae,memoIndex:Te}=j;if(P!=null&&Yd(P,null,re,j,!0),Te!=null&&(K.renderCache[Te]=void 0),Se&256){K.ctx.deactivate(j);return}const Ne=Se&1&&Ae,Ue=!Il(j);let Ie;if(Ue&&(Ie=v&&v.onVnodeBeforeUnmount)&&Ur(Ie,K,j),Se&6)z(j.component,re,he);else{if(Se&128){j.suspense.unmount(re,he);return}Ne&&Hi(j,null,K,"beforeUnmount"),Se&64?j.type.remove(j,K,re,_e,le,he):fe&&(De!==ur||Re>0&&Re&64)?ie(fe,K,re,!1,!0):(De===ur&&Re&384||!_e&&Se&16)&&ie(me,K,re),he&&I(j)}(Ue&&(Ie=v&&v.onVnodeUnmounted)||Ne)&&Zn(()=>{Ie&&Ur(Ie,K,j),Ne&&Hi(j,null,K,"unmounted")},re)},I=j=>{const{type:K,el:re,anchor:he,transition:_e}=j;if(K===ur){B(re,he);return}if(K===Eu){V(j);return}const De=()=>{s(re),_e&&!_e.persisted&&_e.afterLeave&&_e.afterLeave()};if(j.shapeFlag&1&&_e&&!_e.persisted){const{leave:v,delayLeave:P}=_e,me=()=>v(re,De);P?P(j.el,De,me):me()}else De()},B=(j,K)=>{let re;for(;j!==K;)re=d(j),s(j),j=re;s(K)},z=(j,K,re)=>{const{bum:he,scope:_e,update:De,subTree:v,um:P,m:me,a:fe}=j;D1(me),D1(fe),he&&bu(he),_e.stop(),De&&(De.active=!1,C(v,j,K,re)),P&&Zn(P,K),Zn(()=>{j.isUnmounted=!0},K),K&&K.pendingBranch&&!K.isUnmounted&&j.asyncDep&&!j.asyncResolved&&j.suspenseId===K.pendingId&&(K.deps--,K.deps===0&&K.resolve())},ie=(j,K,re,he=!1,_e=!1,De=0)=>{for(let v=De;v<j.length;v++)C(j[v],K,re,he,_e)},Z=j=>j.shapeFlag&6?Z(j.component.subTree):j.shapeFlag&128?j.suspense.next():d(j.anchor||j.el);let q=!1;const ee=(j,K,re)=>{j==null?K._vnode&&C(K._vnode,null,null,!0):D(K._vnode||null,j,K,null,null,null,re),q||(q=!0,S1(),tb(),q=!1),K._vnode=j},le={p:D,um:C,m:L,r:I,mt:A,mc:b,pc:Q,pbc:T,n:Z,o:n};let Ee,Oe;return{render:ee,hydrate:Ee,createApp:h4(ee,Ee)}}function Bf({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function ji({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function v4(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function pm(n,e,t=!1){const r=n.children,s=e.children;if(et(r)&&et(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=Js(s[i]),a.el=o.el),!t&&a.patchFlag!==-2&&pm(o,a)),a.type===Bh&&(a.el=o.el)}}function E4(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=t[t.length-1],n[s]<c){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function wb(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:wb(e)}function D1(n){if(n)for(let e=0;e<n.length;e++)n[e].active=!1}const w4=Symbol.for("v-scx"),T4=()=>Tr(w4);function qB(n,e){return mm(n,null,e)}const Jc={};function kl(n,e,t){return mm(n,e,t)}function mm(n,e,{immediate:t,deep:r,flush:s,once:i,onTrack:o,onTrigger:a}=Lt){if(e&&i){const k=e;e=(...S)=>{k(...S),p()}}const l=dn,c=k=>r===!0?k:ri(k,r===!1?1:void 0);let u,f=!1,d=!1;if(sn(n)?(u=()=>n.value,f=Bu(n)):lo(n)?(u=()=>c(n),f=!0):et(n)?(d=!0,f=n.some(k=>lo(k)||Bu(k)),u=()=>n.map(k=>{if(sn(k))return k.value;if(lo(k))return c(k);if(lt(k))return _i(k,l,2)})):lt(n)?e?u=()=>_i(n,l,2):u=()=>(m&&m(),wr(n,l,3,[_])):u=vr,e&&r){const k=u;u=()=>ri(k())}let m,_=k=>{m=N.onStop=()=>{_i(k,l,4),m=N.onStop=void 0}},D;if(Fh)if(_=vr,e?t&&wr(e,l,3,[u(),d?[]:void 0,_]):u(),s==="sync"){const k=T4();D=k.__watcherHandles||(k.__watcherHandles=[])}else return vr;let O=d?new Array(n.length).fill(Jc):Jc;const x=()=>{if(!(!N.active||!N.dirty))if(e){const k=N.run();(r||f||(d?k.some((S,b)=>Ai(S,O[b])):Ai(k,O)))&&(m&&m(),wr(e,l,3,[k,O===Jc?void 0:d&&O[0]===Jc?[]:O,_]),O=k)}else N.run()};x.allowRecurse=!!e;let w;s==="sync"?w=x:s==="post"?w=()=>Zn(x,l&&l.suspense):(x.pre=!0,l&&(x.id=l.uid),w=()=>cm(x));const N=new Zp(u,vr,w),V=N2(),p=()=>{N.stop(),V&&Qp(V.effects,N)};return e?t?x():O=N.run():s==="post"?Zn(N.run.bind(N),l&&l.suspense):N.run(),D&&D.push(p),p}function S4(n,e,t){const r=this.proxy,s=Ut(n)?n.includes(".")?Tb(r,n):()=>r[n]:n.bind(r,r);let i;lt(e)?i=e:(i=e.handler,t=e);const o=bc(this),a=mm(s,i.bind(r),t);return o(),a}function Tb(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}function ri(n,e=1/0,t){if(e<=0||!Pt(n)||n.__v_skip||(t=t||new Set,t.has(n)))return n;if(t.add(n),e--,sn(n))ri(n.value,e,t);else if(et(n))for(let r=0;r<n.length;r++)ri(n[r],e,t);else if(Ih(n)||oa(n))n.forEach(r=>{ri(r,e,t)});else if(R2(n)){for(const r in n)ri(n[r],e,t);for(const r of Object.getOwnPropertySymbols(n))Object.prototype.propertyIsEnumerable.call(n,r)&&ri(n[r],e,t)}return n}const Vh=n=>n.type.__isKeepAlive;function A4(n,e){Sb(n,"a",e)}function I4(n,e){Sb(n,"da",e)}function Sb(n,e,t=dn){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(Lh(e,r,t),t){let s=t.parent;for(;s&&s.parent;)Vh(s.parent.vnode)&&R4(r,e,t,s),s=s.parent}}function R4(n,e,t,r){const s=Lh(e,n,r,!0);cb(()=>{Qp(r[e],s)},t)}const Qs=Symbol("_leaveCb"),Zc=Symbol("_enterCb");function k4(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ab(()=>{n.isMounted=!0}),lb(()=>{n.isUnmounting=!0}),n}const gr=[Function,Array],Ab={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:gr,onEnter:gr,onAfterEnter:gr,onEnterCancelled:gr,onBeforeLeave:gr,onLeave:gr,onAfterLeave:gr,onLeaveCancelled:gr,onBeforeAppear:gr,onAppear:gr,onAfterAppear:gr,onAppearCancelled:gr},Ib=n=>{const e=n.subTree;return e.component?Ib(e.component):e},C4={name:"BaseTransition",props:Ab,setup(n,{slots:e}){const t=j4(),r=k4();return()=>{const s=e.default&&kb(e.default(),!0);if(!s||!s.length)return;let i=s[0];if(s.length>1){for(const d of s)if(d.type!==er){i=d;break}}const o=wt(n),{mode:a}=o;if(r.isLeaving)return Ff(i);const l=L1(i);if(!l)return Ff(i);let c=Xd(l,o,r,t,d=>c=d);Hu(l,c);const u=t.subTree,f=u&&L1(u);if(f&&f.type!==er&&!Ji(l,f)&&Ib(t).type!==er){const d=Xd(f,o,r,t);if(Hu(f,d),a==="out-in"&&l.type!==er)return r.isLeaving=!0,d.afterLeave=()=>{r.isLeaving=!1,t.update.active!==!1&&(t.effect.dirty=!0,t.update())},Ff(i);a==="in-out"&&l.type!==er&&(d.delayLeave=(m,_,D)=>{const O=Rb(r,f);O[String(f.key)]=f,m[Qs]=()=>{_(),m[Qs]=void 0,delete c.delayedLeave},c.delayedLeave=D})}return i}}},x4=C4;function Rb(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function Xd(n,e,t,r,s){const{appear:i,mode:o,persisted:a=!1,onBeforeEnter:l,onEnter:c,onAfterEnter:u,onEnterCancelled:f,onBeforeLeave:d,onLeave:m,onAfterLeave:_,onLeaveCancelled:D,onBeforeAppear:O,onAppear:x,onAfterAppear:w,onAppearCancelled:N}=e,V=String(n.key),p=Rb(t,n),k=(E,T)=>{E&&wr(E,r,9,T)},S=(E,T)=>{const M=T[1];k(E,T),et(E)?E.every(H=>H.length<=1)&&M():E.length<=1&&M()},b={mode:o,persisted:a,beforeEnter(E){let T=l;if(!t.isMounted)if(i)T=O||l;else return;E[Qs]&&E[Qs](!0);const M=p[V];M&&Ji(n,M)&&M.el[Qs]&&M.el[Qs](),k(T,[E])},enter(E){let T=c,M=u,H=f;if(!t.isMounted)if(i)T=x||c,M=w||u,H=N||f;else return;let y=!1;const A=E[Zc]=W=>{y||(y=!0,W?k(H,[E]):k(M,[E]),b.delayedLeave&&b.delayedLeave(),E[Zc]=void 0)};T?S(T,[E,A]):A()},leave(E,T){const M=String(n.key);if(E[Zc]&&E[Zc](!0),t.isUnmounting)return T();k(d,[E]);let H=!1;const y=E[Qs]=A=>{H||(H=!0,T(),A?k(D,[E]):k(_,[E]),E[Qs]=void 0,p[M]===n&&delete p[M])};p[M]=n,m?S(m,[E,y]):y()},clone(E){const T=Xd(E,e,t,r,s);return s&&s(T),T}};return b}function Ff(n){if(Vh(n))return n=Ii(n),n.children=null,n}function L1(n){if(!Vh(n))return n;const{shapeFlag:e,children:t}=n;if(t){if(e&16)return t[0];if(e&32&&lt(t.default))return t.default()}}function Hu(n,e){n.shapeFlag&6&&n.component?Hu(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function kb(n,e=!1,t){let r=[],s=0;for(let i=0;i<n.length;i++){let o=n[i];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:i);o.type===ur?(o.patchFlag&128&&s++,r=r.concat(kb(o.children,e,a))):(e||o.type!==er)&&r.push(a!=null?Ii(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}const M4=n=>n.__isTeleport,Cl=n=>n&&(n.disabled||n.disabled===""),V1=n=>typeof SVGElement<"u"&&n instanceof SVGElement,B1=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,Qd=(n,e)=>{const t=n&&n.to;return Ut(t)?e?e(t):null:t},P4={name:"Teleport",__isTeleport:!0,process(n,e,t,r,s,i,o,a,l,c){const{mc:u,pc:f,pbc:d,o:{insert:m,querySelector:_,createText:D,createComment:O}}=c,x=Cl(e.props);let{shapeFlag:w,children:N,dynamicChildren:V}=e;if(n==null){const p=e.el=D(""),k=e.anchor=D("");m(p,t,r),m(k,t,r);const S=e.target=Qd(e.props,_),b=e.targetAnchor=D("");S&&(m(b,S),o==="svg"||V1(S)?o="svg":(o==="mathml"||B1(S))&&(o="mathml"));const E=(T,M)=>{w&16&&u(N,T,M,s,i,o,a,l)};x?E(t,k):S&&E(S,b)}else{e.el=n.el;const p=e.anchor=n.anchor,k=e.target=n.target,S=e.targetAnchor=n.targetAnchor,b=Cl(n.props),E=b?t:k,T=b?p:S;if(o==="svg"||V1(k)?o="svg":(o==="mathml"||B1(k))&&(o="mathml"),V?(d(n.dynamicChildren,V,E,s,i,o,a),pm(n,e,!0)):l||f(n,e,E,T,s,i,o,a,!1),x)b?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):eu(e,t,p,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const M=e.target=Qd(e.props,_);M&&eu(e,M,null,c,0)}else b&&eu(e,k,S,c,1)}Cb(e)},remove(n,e,t,r,{um:s,o:{remove:i}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:u,target:f,props:d}=n;if(f&&i(u),o&&i(c),a&16){const m=o||!Cl(d);for(let _=0;_<l.length;_++){const D=l[_];s(D,e,t,m,!!D.dynamicChildren)}}},move:eu,hydrate:O4};function eu(n,e,t,{o:{insert:r},m:s},i=2){i===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:u}=n,f=i===2;if(f&&r(o,e,t),(!f||Cl(u))&&l&16)for(let d=0;d<c.length;d++)s(c[d],e,t,2);f&&r(a,e,t)}function O4(n,e,t,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const u=e.target=Qd(e.props,l);if(u){const f=u._lpa||u.firstChild;if(e.shapeFlag&16)if(Cl(e.props))e.anchor=c(o(n),e,a(n),t,r,s,i),e.targetAnchor=f;else{e.anchor=o(n);let d=f;for(;d;)if(d=o(d),d&&d.nodeType===8&&d.data==="teleport anchor"){e.targetAnchor=d,u._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(f,e,u,t,r,s,i)}Cb(e)}return e.anchor&&o(e.anchor)}const KB=P4;function Cb(n){const e=n.ctx;if(e&&e.ut){let t=n.children[0].el;for(;t&&t!==n.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const ur=Symbol.for("v-fgt"),Bh=Symbol.for("v-txt"),er=Symbol.for("v-cmt"),Eu=Symbol.for("v-stc"),xl=[];let Mr=null;function $t(n=!1){xl.push(Mr=n?null:[])}function N4(){xl.pop(),Mr=xl[xl.length-1]||null}let Gl=1;function F1(n){Gl+=n}function xb(n){return n.dynamicChildren=Gl>0?Mr||ia:null,N4(),Gl>0&&Mr&&Mr.push(n),n}function Nn(n,e,t,r,s,i){return xb(pt(n,e,t,r,s,i,!0))}function ba(n,e,t,r,s){return xb(vt(n,e,t,r,s,!0))}function ju(n){return n?n.__v_isVNode===!0:!1}function Ji(n,e){return n.type===e.type&&n.key===e.key}const Mb=({key:n})=>n??null,wu=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?Ut(n)||sn(n)||lt(n)?{i:ln,r:n,k:e,f:!!t}:n:null);function pt(n,e=null,t=null,r=0,s=null,i=n===ur?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&Mb(e),ref:e&&wu(e),scopeId:Dh,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:ln};return a?(gm(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=Ut(t)?8:16),Gl>0&&!o&&Mr&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&Mr.push(l),l}const vt=D4;function D4(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===ob)&&(n=er),ju(n)){const a=Ii(n,e,!0);return t&&gm(a,t),Gl>0&&!i&&Mr&&(a.shapeFlag&6?Mr[Mr.indexOf(n)]=a:Mr.push(a)),a.patchFlag=-2,a}if(G4(n)&&(n=n.__vccOpts),e){e=L4(e);let{class:a,style:l}=e;a&&!Ut(a)&&(e.class=mi(a)),Pt(l)&&(G2(l)&&!et(l)&&(l=rn({},l)),e.style=_c(l))}const o=Ut(n)?1:GS(n)?128:M4(n)?64:Pt(n)?4:lt(n)?2:0;return pt(n,e,t,r,s,o,i,!0)}function L4(n){return n?G2(n)||gb(n)?rn({},n):n:null}function Ii(n,e,t=!1,r=!1){const{props:s,ref:i,patchFlag:o,children:a,transition:l}=n,c=e?B4(s||{},e):s,u={__v_isVNode:!0,__v_skip:!0,type:n.type,props:c,key:c&&Mb(c),ref:e&&e.ref?t&&i?et(i)?i.concat(wu(e)):[i,wu(e)]:wu(e):i,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:a,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==ur?o===-1?16:o|16:o,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:l,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&Ii(n.ssContent),ssFallback:n.ssFallback&&Ii(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce};return l&&r&&Hu(u,l.clone(u)),u}function V4(n=" ",e=0){return vt(Bh,null,n,e)}function WB(n,e){const t=vt(Eu,null,n);return t.staticCount=e,t}function Ks(n="",e=!1){return e?($t(),ba(er,null,n)):vt(er,null,n)}function $r(n){return n==null||typeof n=="boolean"?vt(er):et(n)?vt(ur,null,n.slice()):typeof n=="object"?Js(n):vt(Bh,null,String(n))}function Js(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:Ii(n)}function gm(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(et(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),gm(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!gb(e)?e._ctx=ln:s===3&&ln&&(ln.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else lt(e)?(e={default:e,_ctx:ln},t=32):(e=String(e),r&64?(t=16,e=[V4(e)]):t=8);n.children=e,n.shapeFlag|=t}function B4(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=mi([e.class,r.class]));else if(s==="style")e.style=_c([e.style,r.style]);else if(Ah(s)){const i=e[s],o=r[s];o&&i!==o&&!(et(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function Ur(n,e,t,r=null){wr(n,e,7,[t,r])}const F4=db();let U4=0;function H4(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||F4,i={uid:U4++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new P2(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:yb(r,s),emitsOptions:rb(r,s),emit:null,emitted:null,propsDefaults:Lt,inheritAttrs:r.inheritAttrs,ctx:Lt,data:Lt,props:Lt,attrs:Lt,slots:Lt,refs:Lt,setupState:Lt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=jS.bind(null,i),n.ce&&n.ce(i),i}let dn=null;const j4=()=>dn||ln;let zu,Jd;{const n=C2(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};zu=e("__VUE_INSTANCE_SETTERS__",t=>dn=t),Jd=e("__VUE_SSR_SETTERS__",t=>Fh=t)}const bc=n=>{const e=dn;return zu(n),n.scope.on(),()=>{n.scope.off(),zu(e)}},U1=()=>{dn&&dn.scope.off(),zu(null)};function Pb(n){return n.vnode.shapeFlag&4}let Fh=!1;function z4(n,e=!1){e&&Jd(e);const{props:t,children:r}=n.vnode,s=Pb(n);d4(n,t,s,e),g4(n,r);const i=s?$4(n,e):void 0;return e&&Jd(!1),i}function $4(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=new Proxy(n.ctx,s4);const{setup:r}=t;if(r){const s=n.setupContext=r.length>1?K4(n):null,i=bc(n);Pi();const o=_i(r,n,0,[n.props,s]);if(Oi(),i(),A2(o)){if(o.then(U1,U1),e)return o.then(a=>{H1(n,a,e)}).catch(a=>{Ph(a,n,0)});n.asyncDep=o}else H1(n,o,e)}else Ob(n,e)}function H1(n,e,t){lt(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Pt(e)&&(n.setupState=Q2(e)),Ob(n,t)}let j1;function Ob(n,e,t){const r=n.type;if(!n.render){if(!e&&j1&&!r.render){const s=r.template||fm(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=rn(rn({isCustomElement:i,delimiters:a},o),l);r.render=j1(s,c)}}n.render=r.render||vr}{const s=bc(n);Pi();try{i4(n)}finally{Oi(),s()}}}const q4={get(n,e){return ir(n,"get",""),n[e]}};function K4(n){const e=t=>{n.exposed=t||{}};return{attrs:new Proxy(n.attrs,q4),slots:n.slots,emit:n.emit,expose:e}}function Uh(n){return n.exposed?n.exposeProxy||(n.exposeProxy=new Proxy(Q2(im(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Rl)return Rl[t](n)},has(e,t){return t in e||t in Rl}})):n.proxy}function W4(n,e=!0){return lt(n)?n.displayName||n.name:n.name||e&&n.__name}function G4(n){return lt(n)&&"__vccOpts"in n}const hr=(n,e)=>CS(n,e,Fh);function _m(n,e,t){const r=arguments.length;return r===2?Pt(e)&&!et(e)?ju(e)?vt(n,null,[e]):vt(n,e):vt(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&ju(t)&&(t=[t]),vt(n,e,t))}const Y4="3.4.29";/**
* @vue/runtime-dom v3.4.29
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const X4="http://www.w3.org/2000/svg",Q4="http://www.w3.org/1998/Math/MathML",ps=typeof document<"u"?document:null,z1=ps&&ps.createElement("template"),J4={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?ps.createElementNS(X4,n):e==="mathml"?ps.createElementNS(Q4,n):t?ps.createElement(n,{is:t}):ps.createElement(n);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>ps.createTextNode(n),createComment:n=>ps.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>ps.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{z1.innerHTML=r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n;const a=z1.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},Hs="transition",al="animation",Yl=Symbol("_vtc"),Nb=(n,{slots:e})=>_m(x4,Z4(n),e);Nb.displayName="Transition";const Db={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Nb.props=rn({},Ab,Db);const zi=(n,e=[])=>{et(n)?n.forEach(t=>t(...e)):n&&n(...e)},$1=n=>n?et(n)?n.some(e=>e.length>1):n.length>1:!1;function Z4(n){const e={};for(const H in n)H in Db||(e[H]=n[H]);if(n.css===!1)return e;const{name:t="v",type:r,duration:s,enterFromClass:i=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=i,appearActiveClass:c=o,appearToClass:u=a,leaveFromClass:f=`${t}-leave-from`,leaveActiveClass:d=`${t}-leave-active`,leaveToClass:m=`${t}-leave-to`}=n,_=eA(s),D=_&&_[0],O=_&&_[1],{onBeforeEnter:x,onEnter:w,onEnterCancelled:N,onLeave:V,onLeaveCancelled:p,onBeforeAppear:k=x,onAppear:S=w,onAppearCancelled:b=N}=e,E=(H,y,A)=>{$i(H,y?u:a),$i(H,y?c:o),A&&A()},T=(H,y)=>{H._isLeaving=!1,$i(H,f),$i(H,m),$i(H,d),y&&y()},M=H=>(y,A)=>{const W=H?S:w,X=()=>E(y,H,A);zi(W,[y,X]),q1(()=>{$i(y,H?l:i),js(y,H?u:a),$1(W)||K1(y,r,D,X)})};return rn(e,{onBeforeEnter(H){zi(x,[H]),js(H,i),js(H,o)},onBeforeAppear(H){zi(k,[H]),js(H,l),js(H,c)},onEnter:M(!1),onAppear:M(!0),onLeave(H,y){H._isLeaving=!0;const A=()=>T(H,y);js(H,f),js(H,d),rA(),q1(()=>{H._isLeaving&&($i(H,f),js(H,m),$1(V)||K1(H,r,O,A))}),zi(V,[H,A])},onEnterCancelled(H){E(H,!1),zi(N,[H])},onAppearCancelled(H){E(H,!0),zi(b,[H])},onLeaveCancelled(H){T(H),zi(p,[H])}})}function eA(n){if(n==null)return null;if(Pt(n))return[Uf(n.enter),Uf(n.leave)];{const e=Uf(n);return[e,e]}}function Uf(n){return JT(n)}function js(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[Yl]||(n[Yl]=new Set)).add(e)}function $i(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const t=n[Yl];t&&(t.delete(e),t.size||(n[Yl]=void 0))}function q1(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let tA=0;function K1(n,e,t,r){const s=n._endId=++tA,i=()=>{s===n._endId&&r()};if(t)return setTimeout(i,t);const{type:o,timeout:a,propCount:l}=nA(n,e);if(!o)return r();const c=o+"end";let u=0;const f=()=>{n.removeEventListener(c,d),i()},d=m=>{m.target===n&&++u>=l&&f()};setTimeout(()=>{u<l&&f()},a+1),n.addEventListener(c,d)}function nA(n,e){const t=window.getComputedStyle(n),r=_=>(t[_]||"").split(", "),s=r(`${Hs}Delay`),i=r(`${Hs}Duration`),o=W1(s,i),a=r(`${al}Delay`),l=r(`${al}Duration`),c=W1(a,l);let u=null,f=0,d=0;e===Hs?o>0&&(u=Hs,f=o,d=i.length):e===al?c>0&&(u=al,f=c,d=l.length):(f=Math.max(o,c),u=f>0?o>c?Hs:al:null,d=u?u===Hs?i.length:l.length:0);const m=u===Hs&&/\b(transform|all)(,|$)/.test(r(`${Hs}Property`).toString());return{type:u,timeout:f,propCount:d,hasTransform:m}}function W1(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>G1(t)+G1(n[r])))}function G1(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function rA(){return document.body.offsetHeight}function sA(n,e,t){const r=n[Yl];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const Y1=Symbol("_vod"),iA=Symbol("_vsh"),oA=Symbol(""),aA=/(^|;)\s*display\s*:/;function lA(n,e,t){const r=n.style,s=Ut(t);let i=!1;if(t&&!s){if(e)if(Ut(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Tu(r,a,"")}else for(const o in e)t[o]==null&&Tu(r,o,"");for(const o in t)o==="display"&&(i=!0),Tu(r,o,t[o])}else if(s){if(e!==t){const o=r[oA];o&&(t+=";"+o),r.cssText=t,i=aA.test(t)}}else e&&n.removeAttribute("style");Y1 in n&&(n[Y1]=i?r.display:"",n[iA]&&(r.display="none"))}const X1=/\s*!important$/;function Tu(n,e,t){if(et(t))t.forEach(r=>Tu(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=cA(n,e);X1.test(t)?n.setProperty(ko(r),t.replace(X1,""),"important"):n[r]=t}}const Q1=["Webkit","Moz","ms"],Hf={};function cA(n,e){const t=Hf[e];if(t)return t;let r=ts(e);if(r!=="filter"&&r in n)return Hf[e]=r;r=kh(r);for(let s=0;s<Q1.length;s++){const i=Q1[s]+r;if(i in n)return Hf[e]=i}return e}const J1="http://www.w3.org/1999/xlink";function Z1(n,e,t,r,s,i=sS(e)){r&&e.startsWith("xlink:")?t==null?n.removeAttributeNS(J1,e.slice(6,e.length)):n.setAttributeNS(J1,e,t):t==null||i&&!x2(t)?n.removeAttribute(e):n.setAttribute(e,i?"":String(t))}function uA(n,e,t,r,s,i,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,s,i),n[e]=t??"";return}const a=n.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const c=a==="OPTION"?n.getAttribute("value")||"":n.value,u=t==null?"":String(t);(c!==u||!("_value"in n))&&(n.value=u),t==null&&n.removeAttribute(e),n._value=t;return}let l=!1;if(t===""||t==null){const c=typeof n[e];c==="boolean"?t=x2(t):t==null&&c==="string"?(t="",l=!0):c==="number"&&(t=0,l=!0)}try{n[e]=t}catch{}l&&n.removeAttribute(e)}function Zi(n,e,t,r){n.addEventListener(e,t,r)}function hA(n,e,t,r){n.removeEventListener(e,t,r)}const eg=Symbol("_vei");function fA(n,e,t,r,s=null){const i=n[eg]||(n[eg]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=dA(e);if(r){const c=i[e]=gA(r,s);Zi(n,a,c,l)}else o&&(hA(n,a,o,l),i[e]=void 0)}}const tg=/(?:Once|Passive|Capture)$/;function dA(n){let e;if(tg.test(n)){e={};let r;for(;r=n.match(tg);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ko(n.slice(2)),e]}let jf=0;const pA=Promise.resolve(),mA=()=>jf||(pA.then(()=>jf=0),jf=Date.now());function gA(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;wr(_A(r,t.value),e,5,[r])};return t.value=n,t.attached=mA(),t}function _A(n,e){if(et(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const ng=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,yA=(n,e,t,r,s,i,o,a,l)=>{const c=s==="svg";e==="class"?sA(n,r,c):e==="style"?lA(n,t,r):Ah(e)?Xp(e)||fA(n,e,t,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):bA(n,e,r,c))?(uA(n,e,r,i,o,a,l),(e==="value"||e==="checked"||e==="selected")&&Z1(n,e,r,c,o,e!=="value")):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),Z1(n,e,r,c))};function bA(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&ng(e)&&lt(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return ng(e)&&Ut(t)?!1:e in n}const $u=n=>{const e=n.props["onUpdate:modelValue"]||!1;return et(e)?t=>bu(e,t):e};function vA(n){n.target.composing=!0}function rg(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const ua=Symbol("_assign"),GB={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[ua]=$u(s);const i=r||s.props&&s.props.type==="number";Zi(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=Lu(a)),n[ua](a)}),t&&Zi(n,"change",()=>{n.value=n.value.trim()}),e||(Zi(n,"compositionstart",vA),Zi(n,"compositionend",rg),Zi(n,"change",rg))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,oldValue:t,modifiers:{lazy:r,trim:s,number:i}},o){if(n[ua]=$u(o),n.composing)return;const a=(i||n.type==="number")&&!/^0\d/.test(n.value)?Lu(n.value):n.value,l=e??"";a!==l&&(document.activeElement===n&&n.type!=="range"&&(r&&e===t||s&&n.value.trim()===l)||(n.value=l))}},YB={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const s=Ih(e);Zi(n,"change",()=>{const i=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?Lu(qu(o)):qu(o));n[ua](n.multiple?s?new Set(i):i:i[0]),n._assigning=!0,Oh(()=>{n._assigning=!1})}),n[ua]=$u(r)},mounted(n,{value:e,modifiers:{number:t}}){sg(n,e)},beforeUpdate(n,e,t){n[ua]=$u(t)},updated(n,{value:e,modifiers:{number:t}}){n._assigning||sg(n,e)}};function sg(n,e,t){const r=n.multiple,s=et(e);if(!(r&&!s&&!Ih(e))){for(let i=0,o=n.options.length;i<o;i++){const a=n.options[i],l=qu(a);if(r)if(s){const c=typeof l;c==="string"||c==="number"?a.selected=e.some(u=>String(u)===String(l)):a.selected=oS(e,l)>-1}else a.selected=e.has(l);else if(Ch(qu(a),e)){n.selectedIndex!==i&&(n.selectedIndex=i);return}}!r&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function qu(n){return"_value"in n?n._value:n.value}const EA=["ctrl","shift","alt","meta"],wA={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>EA.some(t=>n[`${t}Key`]&&!e.includes(t))},XB=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=wA[e[o]];if(a&&a(s,e))return}return n(s,...i)})},TA={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},QB=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=ko(s.key);if(e.some(o=>o===i||TA[o]===i))return n(s)})},SA=rn({patchProp:yA},J4);let ig;function AA(){return ig||(ig=y4(SA))}const IA=(...n)=>{const e=AA().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=kA(r);if(!s)return;const i=e._component;!lt(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=t(s,!1,RA(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function RA(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function kA(n){return Ut(n)?document.querySelector(n):n}var CA=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let Lb;const Hh=n=>Lb=n,Vb=Symbol();function Zd(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var Ml;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(Ml||(Ml={}));function xA(){const n=O2(!0),e=n.run(()=>Mh({}));let t=[],r=[];const s=im({install(i){Hh(s),s._a=i,i.provide(Vb,s),i.config.globalProperties.$pinia=s,r.forEach(o=>t.push(o)),r=[]},use(i){return!this._a&&!CA?r.push(i):t.push(i),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return s}const Bb=()=>{};function og(n,e,t,r=Bb){n.push(e);const s=()=>{const i=n.indexOf(e);i>-1&&(n.splice(i,1),r())};return!t&&N2()&&lS(s),s}function zo(n,...e){n.slice().forEach(t=>{t(...e)})}const MA=n=>n();function ep(n,e){n instanceof Map&&e instanceof Map&&e.forEach((t,r)=>n.set(r,t)),n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],s=n[t];Zd(s)&&Zd(r)&&n.hasOwnProperty(t)&&!sn(r)&&!lo(r)?n[t]=ep(s,r):n[t]=r}return n}const PA=Symbol();function OA(n){return!Zd(n)||!n.hasOwnProperty(PA)}const{assign:Ws}=Object;function NA(n){return!!(sn(n)&&n.effect)}function DA(n,e,t,r){const{state:s,actions:i,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=s?s():{});const u=NS(t.state.value[n]);return Ws(u,i,Object.keys(o||{}).reduce((f,d)=>(f[d]=im(hr(()=>{Hh(t);const m=t._s.get(n);return o[d].call(m,m)})),f),{}))}return l=Fb(n,c,e,t,r,!0),l}function Fb(n,e,t={},r,s,i){let o;const a=Ws({actions:{}},t),l={deep:!0};let c,u,f=[],d=[],m;const _=r.state.value[n];!i&&!_&&(r.state.value[n]={}),Mh({});let D;function O(b){let E;c=u=!1,typeof b=="function"?(b(r.state.value[n]),E={type:Ml.patchFunction,storeId:n,events:m}):(ep(r.state.value[n],b),E={type:Ml.patchObject,payload:b,storeId:n,events:m});const T=D=Symbol();Oh().then(()=>{D===T&&(c=!0)}),u=!0,zo(f,E,r.state.value[n])}const x=i?function(){const{state:E}=t,T=E?E():{};this.$patch(M=>{Ws(M,T)})}:Bb;function w(){o.stop(),f=[],d=[],r._s.delete(n)}function N(b,E){return function(){Hh(r);const T=Array.from(arguments),M=[],H=[];function y(X){M.push(X)}function A(X){H.push(X)}zo(d,{args:T,name:b,store:p,after:y,onError:A});let W;try{W=E.apply(this&&this.$id===n?this:p,T)}catch(X){throw zo(H,X),X}return W instanceof Promise?W.then(X=>(zo(M,X),X)).catch(X=>(zo(H,X),Promise.reject(X))):(zo(M,W),W)}}const V={_p:r,$id:n,$onAction:og.bind(null,d),$patch:O,$reset:x,$subscribe(b,E={}){const T=og(f,b,E.detached,()=>M()),M=o.run(()=>kl(()=>r.state.value[n],H=>{(E.flush==="sync"?u:c)&&b({storeId:n,type:Ml.direct,events:m},H)},Ws({},l,E)));return T},$dispose:w},p=yc(V);r._s.set(n,p);const S=(r._a&&r._a.runWithContext||MA)(()=>r._e.run(()=>(o=O2()).run(e)));for(const b in S){const E=S[b];if(sn(E)&&!NA(E)||lo(E))i||(_&&OA(E)&&(sn(E)?E.value=_[b]:ep(E,_[b])),r.state.value[n][b]=E);else if(typeof E=="function"){const T=N(b,E);S[b]=T,a.actions[b]=E}}return Ws(p,S),Ws(wt(p),S),Object.defineProperty(p,"$state",{get:()=>r.state.value[n],set:b=>{O(E=>{Ws(E,b)})}}),r._p.forEach(b=>{Ws(p,o.run(()=>b({store:p,app:r._a,pinia:r,options:a})))}),_&&i&&t.hydrate&&t.hydrate(p.$state,_),c=!0,u=!0,p}function Ub(n,e,t){let r,s;const i=typeof e=="function";typeof n=="string"?(r=n,s=i?t:e):(s=n,r=n.id);function o(a,l){const c=f4();return a=a||(c?Tr(Vb,null):null),a&&Hh(a),a=Lb,a._s.has(r)||(i?Fb(r,e,s,a):DA(r,s,a)),a._s.get(r)}return o.$id=r,o}const ym=Ub("loading",{state:()=>({loading:!1}),actions:{startLoading(){this.loading=!0},stopLoading(){this.loading=!1}}}),Hb=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},LA={},bm=n=>(sb("data-v-ec417059"),n=n(),ib(),n),VA={class:"bottomNavContainer"},BA=bm(()=>pt("svg",{class:"iconSvgs",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},[pt("path",{fill:"#ffffff",d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"})],-1)),FA=bm(()=>pt("svg",{class:"iconSvgs",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},[pt("path",{fill:"#ffffff",d:"M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"})],-1)),UA=bm(()=>pt("svg",{class:"iconSvgs",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},[pt("path",{fill:"#ffffff",d:"M384 476.1L192 421.2V35.9L384 90.8V476.1zm32-1.2V88.4L543.1 37.5c15.8-6.3 32.9 5.3 32.9 22.3V394.6c0 9.8-6 18.6-15.1 22.3L416 474.8zM15.1 95.1L160 37.2V423.6L32.9 474.5C17.1 480.8 0 469.2 0 452.2V117.4c0-9.8 6-18.6 15.1-22.3z"})],-1));function HA(n,e){const t=nr("RouterLink");return $t(),Nn("div",VA,[vt(t,{to:"/calender"},{default:ui(()=>[BA]),_:1}),vt(t,{to:"/"},{default:ui(()=>[FA]),_:1}),vt(t,{to:"/map"},{default:ui(()=>[UA]),_:1})])}const jA=Hb(LA,[["render",HA],["__scopeId","data-v-ec417059"]]);var ag={ACSetupSvcPort:"23210",ACSvcPort:"17532",ADSK_CLM_WPAD_PROXY_CHECK:"FALSE",ALLUSERSPROFILE:"C:\\ProgramData",APPDATA:"C:\\Users\\david\\AppData\\Roaming",BESIEGE_GAME_ASSEMBLIES:"D:/SteamLibrary/steamapps/common/Besiege/Besiege_Data\\Managed/",BESIEGE_UNITY_ASSEMBLIES:"D:/SteamLibrary/steamapps/common/Besiege/Besiege_Data\\Managed/",ChocolateyInstall:"C:\\ProgramData\\chocolatey",ChocolateyLastPathUpdate:"133297499885031750",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_20824_RGQSWWEQUTKTCXXV",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"NUKAS-PC",ComSpec:"C:\\WINDOWS\\system32\\cmd.exe",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\WINDOWS\\notepad.exe",GIT_ASKPASS:"c:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\david",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\david",INIT_CWD:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog",INTEL_DEV_REDIST:"C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\david\\AppData\\Local",LOGONSERVER:"\\\\NUKAS-PC",MIC_LD_LIBRARY_PATH:"C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\compiler\\lib\\mic",NODE:"E:\\Program Files (x86)\\node.exe",NODE_ENV:"production",NODE_EXE:"E:\\Program Files (x86)\\\\node.exe",NPM_CLI_JS:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",npm_command:"run-script",npm_config_cache:"C:\\Users\\david\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\david\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\david\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\david\\.npm-init.js",npm_config_local_prefix:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog",npm_config_node_gyp:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"10.4.0",npm_config_prefix:"C:\\Users\\david\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\david\\.npmrc",npm_config_user_agent:"npm/10.4.0 node/v20.12.2 win32 x64 workspaces/false",npm_execpath:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"build",npm_lifecycle_script:"vite build",npm_node_execpath:"E:\\Program Files (x86)\\node.exe",npm_package_json:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog\\package.json",npm_package_name:"geografisk-have-interaktiv-kort",npm_package_version:"0.0.0",NPM_PREFIX_NPM_CLI_JS:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",NUMBER_OF_PROCESSORS:"8",OneDrive:"C:\\Users\\david\\OneDrive",OneDriveConsumer:"C:\\Users\\david\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog\\node_modules\\.bin;E:\\ReactSandbox\\eksamen\\node_modules\\.bin;E:\\ReactSandbox\\node_modules\\.bin;E:\\node_modules\\.bin;C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Python312\\Scripts\\;C:\\Python312\\;C:\\Python310\\Scripts\\;C:\\Python310\\;C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\redist\\intel64\\compiler;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Program Files\\NVIDIA Corporation\\NVIDIA NvDLISR;C:\\Program Files\\Microsoft SQL Server\\120\\Tools\\Binn\\;C:\\Program Files\\Common Files\\Autodesk Shared\\;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\ProgramData\\chocolatey\\bin;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\Git\\cmd;C:\\Program Files (x86)\\Microsoft SQL Server\\160\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\160\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\Client SDK\\ODBC\\170\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\160\\DTS\\Binn\\;C:\\Program Files (x86)\\Microsoft SQL Server\\160\\DTS\\Binn\\;C:\\Program Files\\Azure Data Studio\\bin;C:\\Program Files\\Microsoft SQL Server\\130\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\150\\Tools\\Binn\\;C:\\Program Files\\GitHub CLI\\;E:\\Program Files (x86)\\;C:\\Users\\david\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\david\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\david\\AppData\\Local\\GitHubDesktop\\bin;C:\\Users\\david\\.dotnet\\tools;C:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Program Files\\Azure Data Studio\\bin;C:\\Program Files\\Azure Data Studio\\bin;C:\\Users\\david\\.dotnet\\tools;C:\\Users\\david\\AppData\\Roaming\\npm;C:\\Users\\david\\AppData\\Local\\Google\\Cloud SDK\\google-cloud-sdk\\bin",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.PY;.PYW;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"AMD64 Family 23 Model 24 Stepping 1, AuthenticAMD",PROCESSOR_LEVEL:"23",PROCESSOR_REVISION:"1801",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\david\\Documents\\WindowsPowerShell\\Modules;C:\\Users\\david\\AppData\\Local\\Google\\Cloud SDK\\google-cloud-sdk\\platform\\PowerShell;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules;C:\\Program Files (x86)\\Microsoft SQL Server\\160\\Tools\\PowerShell\\Modules\\",PUBLIC:"C:\\Users\\Public",RlsSvcPort:"22112",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\WINDOWS",TEMP:"C:\\Users\\david\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.90.1",TMP:"C:\\Users\\david\\AppData\\Local\\Temp",USERDOMAIN:"NUKAS-PC",USERDOMAIN_ROAMINGPROFILE:"NUKAS-PC",USERNAME:"david",USERPROFILE:"C:\\Users\\david",VITE_FIREBASE_API_KEY:"AIzaSyBrXS9zQOlmv6BfZgrTLHY402zKsE7Zm9c",VITE_FIREBASE_APP_ID:"1:447721431608:web:d793a2a1904c6176cfbccd",VITE_FIREBASE_AUTH_DOMAIN:"geo-kort-og-lydbog.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://geo-kort-og-lydbog-default-rtdb.europe-west1.firebasedatabase.app",VITE_FIREBASE_MEASUREMENT_ID:"G-5N25FFYYME",VITE_FIREBASE_MESSAGING_SENDER_ID:"447721431608",VITE_FIREBASE_PROJECT_ID:"geo-kort-og-lydbog",VITE_FIREBASE_STORAGE_BUCKET:"geo-kort-og-lydbog.appspot.com",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-4f97f6e042-sock",VSCODE_INJECTION:"1",windir:"C:\\WINDOWS"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jb=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},zA=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},zb={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,u=i>>2,f=(i&3)<<4|a>>4;let d=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(d=64)),r.push(t[u],t[f],t[d],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(jb(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):zA(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const f=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||f==null)throw new $A;const d=i<<2|a>>4;if(r.push(d),c!==64){const m=a<<4&240|c>>2;if(r.push(m),f!==64){const _=c<<6&192|f;r.push(_)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class $A extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const qA=function(n){const e=jb(n);return zb.encodeByteArray(e,!0)},Ku=function(n){return qA(n).replace(/\./g,"")},$b=function(n){try{return zb.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KA(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WA=()=>KA().__FIREBASE_DEFAULTS__,GA=()=>{if(typeof process>"u"||typeof ag>"u")return;const n=ag.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},YA=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&$b(n[1]);return e&&JSON.parse(e)},jh=()=>{try{return WA()||GA()||YA()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},qb=n=>{var e,t;return(t=(e=jh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Kb=n=>{const e=qb(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Wb=()=>{var n;return(n=jh())===null||n===void 0?void 0:n.config},Gb=n=>{var e;return(e=jh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XA{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yb(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Ku(JSON.stringify(t)),Ku(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function QA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function JA(){var n;const e=(n=jh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ZA(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function e5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function t5(){const n=In();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function n5(){return!JA()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function r5(){try{return typeof indexedDB=="object"}catch{return!1}}function s5(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i5="FirebaseError";class as extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=i5,Object.setPrototypeOf(this,as.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vc.prototype.create)}}class vc{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?o5(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new as(s,a,r)}}function o5(n,e){return n.replace(a5,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const a5=/\{\$([^}]+)}/g;function l5(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Wu(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(lg(i)&&lg(o)){if(!Wu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function lg(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ec(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function ml(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function gl(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function c5(n,e){const t=new u5(n,e);return t.subscribe.bind(t)}class u5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");h5(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=zf),s.error===void 0&&(s.error=zf),s.complete===void 0&&(s.complete=zf);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function h5(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function zf(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wt(n){return n&&n._delegate?n._delegate:n}class Ri{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new XA;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(p5(e))try{this.getOrInitializeService({instanceIdentifier:Xi})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Xi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xi){return this.instances.has(e)}getOptions(e=Xi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:d5(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Xi){return this.component?this.component.multipleInstances?e:Xi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function d5(n){return n===Xi?void 0:n}function p5(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new f5(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gt;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(gt||(gt={}));const g5={debug:gt.DEBUG,verbose:gt.VERBOSE,info:gt.INFO,warn:gt.WARN,error:gt.ERROR,silent:gt.SILENT},_5=gt.INFO,y5={[gt.DEBUG]:"log",[gt.VERBOSE]:"log",[gt.INFO]:"info",[gt.WARN]:"warn",[gt.ERROR]:"error"},b5=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=y5[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class vm{constructor(e){this.name=e,this._logLevel=_5,this._logHandler=b5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in gt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?g5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,gt.DEBUG,...e),this._logHandler(this,gt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,gt.VERBOSE,...e),this._logHandler(this,gt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,gt.INFO,...e),this._logHandler(this,gt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,gt.WARN,...e),this._logHandler(this,gt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,gt.ERROR,...e),this._logHandler(this,gt.ERROR,...e)}}const v5=(n,e)=>e.some(t=>n instanceof t);let cg,ug;function E5(){return cg||(cg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function w5(){return ug||(ug=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Xb=new WeakMap,tp=new WeakMap,Qb=new WeakMap,$f=new WeakMap,Em=new WeakMap;function T5(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(yi(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Xb.set(t,n)}).catch(()=>{}),Em.set(e,n),e}function S5(n){if(tp.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});tp.set(n,e)}let np={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return tp.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Qb.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return yi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function A5(n){np=n(np)}function I5(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(qf(this),e,...t);return Qb.set(r,e.sort?e.sort():[e]),yi(r)}:w5().includes(n)?function(...e){return n.apply(qf(this),e),yi(Xb.get(this))}:function(...e){return yi(n.apply(qf(this),e))}}function R5(n){return typeof n=="function"?I5(n):(n instanceof IDBTransaction&&S5(n),v5(n,E5())?new Proxy(n,np):n)}function yi(n){if(n instanceof IDBRequest)return T5(n);if($f.has(n))return $f.get(n);const e=R5(n);return e!==n&&($f.set(n,e),Em.set(e,n)),e}const qf=n=>Em.get(n);function k5(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=yi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(yi(o.result),l.oldVersion,l.newVersion,yi(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const C5=["get","getKey","getAll","getAllKeys","count"],x5=["put","add","delete","clear"],Kf=new Map;function hg(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Kf.get(e))return Kf.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=x5.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||C5.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return Kf.set(e,i),i}A5(n=>({...n,get:(e,t,r)=>hg(e,t)||n.get(e,t,r),has:(e,t)=>!!hg(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(P5(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function P5(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const rp="@firebase/app",fg="0.10.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo=new vm("@firebase/app"),O5="@firebase/app-compat",N5="@firebase/analytics-compat",D5="@firebase/analytics",L5="@firebase/app-check-compat",V5="@firebase/app-check",B5="@firebase/auth",F5="@firebase/auth-compat",U5="@firebase/database",H5="@firebase/database-compat",j5="@firebase/functions",z5="@firebase/functions-compat",$5="@firebase/installations",q5="@firebase/installations-compat",K5="@firebase/messaging",W5="@firebase/messaging-compat",G5="@firebase/performance",Y5="@firebase/performance-compat",X5="@firebase/remote-config",Q5="@firebase/remote-config-compat",J5="@firebase/storage",Z5="@firebase/storage-compat",eI="@firebase/firestore",tI="@firebase/vertexai-preview",nI="@firebase/firestore-compat",rI="firebase",sI="10.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",iI={[rp]:"fire-core",[O5]:"fire-core-compat",[D5]:"fire-analytics",[N5]:"fire-analytics-compat",[V5]:"fire-app-check",[L5]:"fire-app-check-compat",[B5]:"fire-auth",[F5]:"fire-auth-compat",[U5]:"fire-rtdb",[H5]:"fire-rtdb-compat",[j5]:"fire-fn",[z5]:"fire-fn-compat",[$5]:"fire-iid",[q5]:"fire-iid-compat",[K5]:"fire-fcm",[W5]:"fire-fcm-compat",[G5]:"fire-perf",[Y5]:"fire-perf-compat",[X5]:"fire-rc",[Q5]:"fire-rc-compat",[J5]:"fire-gcs",[Z5]:"fire-gcs-compat",[eI]:"fire-fst",[nI]:"fire-fst-compat",[tI]:"fire-vertex","fire-js":"fire-js",[rI]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gu=new Map,oI=new Map,ip=new Map;function dg(n,e){try{n.container.addComponent(e)}catch(t){yo.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function bo(n){const e=n.name;if(ip.has(e))return yo.debug(`There were multiple attempts to register component ${e}.`),!1;ip.set(e,n);for(const t of Gu.values())dg(t,n);for(const t of oI.values())dg(t,n);return!0}function zh(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function gs(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},bi=new vc("app","Firebase",aI);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ri("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw bi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Co=sI;function Jb(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:sp,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw bi.create("bad-app-name",{appName:String(s)});if(t||(t=Wb()),!t)throw bi.create("no-options");const i=Gu.get(s);if(i){if(Wu(t,i.options)&&Wu(r,i.config))return i;throw bi.create("duplicate-app",{appName:s})}const o=new m5(s);for(const l of ip.values())o.addComponent(l);const a=new lI(t,r,o);return Gu.set(s,a),a}function wm(n=sp){const e=Gu.get(n);if(!e&&n===sp&&Wb())return Jb();if(!e)throw bi.create("no-app",{appName:n});return e}function Xr(n,e,t){var r;let s=(r=iI[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),yo.warn(a.join(" "));return}bo(new Ri(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cI="firebase-heartbeat-database",uI=1,Xl="firebase-heartbeat-store";let Wf=null;function Zb(){return Wf||(Wf=k5(cI,uI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Xl)}catch(t){console.warn(t)}}}}).catch(n=>{throw bi.create("idb-open",{originalErrorMessage:n.message})})),Wf}async function hI(n){try{const t=(await Zb()).transaction(Xl),r=await t.objectStore(Xl).get(ev(n));return await t.done,r}catch(e){if(e instanceof as)yo.warn(e.message);else{const t=bi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});yo.warn(t.message)}}}async function pg(n,e){try{const r=(await Zb()).transaction(Xl,"readwrite");await r.objectStore(Xl).put(e,ev(n)),await r.done}catch(t){if(t instanceof as)yo.warn(t.message);else{const r=bi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});yo.warn(r.message)}}}function ev(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=1024,dI=30*24*60*60*1e3;class pI{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gI(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=mg();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=dI}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=mg(),{heartbeatsToSend:r,unsentEntries:s}=mI(this._heartbeatsCache.heartbeats),i=Ku(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function mg(){return new Date().toISOString().substring(0,10)}function mI(n,e=fI){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),gg(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),gg(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class gI{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return r5()?s5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await hI(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return pg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return pg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function gg(n){return Ku(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _I(n){bo(new Ri("platform-logger",e=>new M5(e),"PRIVATE")),bo(new Ri("heartbeat",e=>new pI(e),"PRIVATE")),Xr(rp,fg,n),Xr(rp,fg,"esm2017"),Xr("fire-js","")}_I("");function Tm(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function tv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const yI=tv,nv=new vc("auth","Firebase",tv());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yu=new vm("@firebase/auth");function bI(n,...e){Yu.logLevel<=gt.WARN&&Yu.warn(`Auth (${Co}): ${n}`,...e)}function Su(n,...e){Yu.logLevel<=gt.ERROR&&Yu.error(`Auth (${Co}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nr(n,...e){throw Sm(n,...e)}function Qr(n,...e){return Sm(n,...e)}function rv(n,e,t){const r=Object.assign(Object.assign({},yI()),{[e]:t});return new vc("auth","Firebase",r).create(e,{appName:n.name})}function vi(n){return rv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Sm(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return nv.create(n,...e)}function rt(n,e,...t){if(!n)throw Sm(e,...t)}function _s(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Su(e),new Error(e)}function As(n,e){n||_s(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function op(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function vI(){return _g()==="http:"||_g()==="https:"}function _g(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(vI()||ZA()||"connection"in navigator)?navigator.onLine:!0}function wI(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wc{constructor(e,t){this.shortDelay=e,this.longDelay=t,As(t>e,"Short delay should be less than long delay!"),this.isMobile=QA()||e5()}get(){return EI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Am(n,e){As(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;_s("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;_s("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;_s("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TI={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI=new wc(3e4,6e4);function xo(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function Ni(n,e,t,r,s={}){return iv(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Ec(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode),sv.fetch()(ov(n,n.config.apiHost,t,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},i))})}async function iv(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},TI),e);try{const s=new II(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw tu(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw tu(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw tu(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw tu(n,"user-disabled",o);const u=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw rv(n,u,c);Nr(n,u)}}catch(s){if(s instanceof as)throw s;Nr(n,"network-request-failed",{message:String(s)})}}async function $h(n,e,t,r,s={}){const i=await Ni(n,e,t,r,s);return"mfaPendingCredential"in i&&Nr(n,"multi-factor-auth-required",{_serverResponse:i}),i}function ov(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?Am(n.config,s):`${n.config.apiScheme}://${s}`}function AI(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class II{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(Qr(this.auth,"network-request-failed")),SI.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function tu(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=Qr(n,e,r);return s.customData._tokenResponse=t,s}function yg(n){return n!==void 0&&n.enterprise!==void 0}class RI{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return AI(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function kI(n,e){return Ni(n,"GET","/v2/recaptchaConfig",xo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function CI(n,e){return Ni(n,"POST","/v1/accounts:delete",e)}async function av(n,e){return Ni(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pl(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function xI(n,e=!1){const t=Wt(n),r=await t.getIdToken(e),s=Im(r);rt(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Pl(Gf(s.auth_time)),issuedAtTime:Pl(Gf(s.iat)),expirationTime:Pl(Gf(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Gf(n){return Number(n)*1e3}function Im(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Su("JWT malformed, contained fewer than 3 sections"),null;try{const s=$b(t);return s?JSON.parse(s):(Su("Failed to decode base64 JWT payload"),null)}catch(s){return Su("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function bg(n){const e=Im(n);return rt(e,"internal-error"),rt(typeof e.exp<"u","internal-error"),rt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ql(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof as&&MI(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function MI({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Pl(this.lastLoginAt),this.creationTime=Pl(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xu(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Ql(n,av(t,{idToken:r}));rt(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?lv(i.providerUserInfo):[],a=NI(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),u=l?c:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new ap(i.createdAt,i.lastLoginAt),isAnonymous:u};Object.assign(n,f)}async function OI(n){const e=Wt(n);await Xu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function NI(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function lv(n){return n.map(e=>{var{providerId:t}=e,r=Tm(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DI(n,e){const t=await iv(n,{},async()=>{const r=Ec({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=ov(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",sv.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function LI(n,e){return Ni(n,"POST","/v2/accounts:revokeToken",xo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){rt(e.idToken,"internal-error"),rt(typeof e.idToken<"u","internal-error"),rt(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):bg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){rt(e.length!==0,"internal-error");const t=bg(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(rt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await DI(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new ha;return r&&(rt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(rt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(rt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ha,this.toJSON())}_performRefresh(){return _s("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zs(n,e){rt(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ys{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=Tm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new PI(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new ap(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Ql(this,this.stsTokenManager.getToken(this.auth,e));return rt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return xI(this,e)}reload(){return OI(this)}_assign(e){this!==e&&(rt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ys(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){rt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Xu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(gs(this.auth.app))return Promise.reject(vi(this.auth));const e=await this.getIdToken();return await Ql(this,CI(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,u;const f=(r=t.displayName)!==null&&r!==void 0?r:void 0,d=(s=t.email)!==null&&s!==void 0?s:void 0,m=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,_=(o=t.photoURL)!==null&&o!==void 0?o:void 0,D=(a=t.tenantId)!==null&&a!==void 0?a:void 0,O=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,x=(c=t.createdAt)!==null&&c!==void 0?c:void 0,w=(u=t.lastLoginAt)!==null&&u!==void 0?u:void 0,{uid:N,emailVerified:V,isAnonymous:p,providerData:k,stsTokenManager:S}=t;rt(N&&S,e,"internal-error");const b=ha.fromJSON(this.name,S);rt(typeof N=="string",e,"internal-error"),zs(f,e.name),zs(d,e.name),rt(typeof V=="boolean",e,"internal-error"),rt(typeof p=="boolean",e,"internal-error"),zs(m,e.name),zs(_,e.name),zs(D,e.name),zs(O,e.name),zs(x,e.name),zs(w,e.name);const E=new ys({uid:N,auth:e,email:d,emailVerified:V,displayName:f,isAnonymous:p,photoURL:_,phoneNumber:m,tenantId:D,stsTokenManager:b,createdAt:x,lastLoginAt:w});return k&&Array.isArray(k)&&(E.providerData=k.map(T=>Object.assign({},T))),O&&(E._redirectEventId=O),E}static async _fromIdTokenResponse(e,t,r=!1){const s=new ha;s.updateFromServerResponse(t);const i=new ys({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Xu(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];rt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?lv(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new ha;a.updateFromIdToken(r);const l=new ys({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new ap(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg=new Map;function bs(n){As(n instanceof Function,"Expected a class definition");let e=vg.get(n);return e?(As(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,vg.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}cv.type="NONE";const Eg=cv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Au(n,e,t){return`firebase:${n}:${e}:${t}`}class fa{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Au(this.userKey,s.apiKey,i),this.fullPersistenceKey=Au("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ys._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new fa(bs(Eg),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||bs(Eg);const o=Au(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const u=await c._get(o);if(u){const f=ys._fromJSON(e,u);c!==i&&(a=f),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new fa(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new fa(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wg(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fv(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uv(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pv(e))return"Blackberry";if(mv(e))return"Webos";if(Rm(e))return"Safari";if((e.includes("chrome/")||hv(e))&&!e.includes("edge/"))return"Chrome";if(dv(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function uv(n=In()){return/firefox\//i.test(n)}function Rm(n=In()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hv(n=In()){return/crios\//i.test(n)}function fv(n=In()){return/iemobile/i.test(n)}function dv(n=In()){return/android/i.test(n)}function pv(n=In()){return/blackberry/i.test(n)}function mv(n=In()){return/webos/i.test(n)}function qh(n=In()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function VI(n=In()){var e;return qh(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function BI(){return t5()&&document.documentMode===10}function gv(n=In()){return qh(n)||dv(n)||mv(n)||pv(n)||/windows phone/i.test(n)||fv(n)}function FI(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _v(n,e=[]){let t;switch(n){case"Browser":t=wg(In());break;case"Worker":t=`${wg(In())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Co}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UI{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HI(n,e={}){return Ni(n,"GET","/v2/passwordPolicy",xo(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jI=6;class zI{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:jI,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $I{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Tg(this),this.idTokenSubscription=new Tg(this),this.beforeStateQueue=new UI(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=nv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=bs(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await fa.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await av(this,{idToken:e}),r=await ys._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(gs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return rt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Xu(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=wI()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(gs(this.app))return Promise.reject(vi(this));const t=e?Wt(e):null;return t&&rt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&rt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return gs(this.app)?Promise.reject(vi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return gs(this.app)?Promise.reject(vi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(bs(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await HI(this),t=new zI(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new vc("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await LI(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&bs(e)||this._popupRedirectResolver;rt(t,this,"argument-error"),this.redirectPersistenceManager=await fa.create(this,[bs(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(rt(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return rt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_v(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&bI(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Va(n){return Wt(n)}class Tg{constructor(e){this.auth=e,this.observer=null,this.addObserver=c5(t=>this.observer=t)}get next(){return rt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Kh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function qI(n){Kh=n}function yv(n){return Kh.loadJS(n)}function KI(){return Kh.recaptchaEnterpriseScript}function WI(){return Kh.gapiScript}function GI(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const YI="recaptcha-enterprise",XI="NO_RECAPTCHA";class QI{constructor(e){this.type=YI,this.auth=Va(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{kI(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new RI(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;yg(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(XI)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&yg(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=KI();l.length!==0&&(l+=a),yv(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Sg(n,e,t,r=!1){const s=new QI(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ag(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Sg(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Sg(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(n,e){const t=zh(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(Wu(i,e??{}))return s;Nr(s,"already-initialized")}return t.initialize({options:e})}function ZI(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(bs);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function eR(n,e,t){const r=Va(n);rt(r._canInitEmulator,r,"emulator-config-failed"),rt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=bv(e),{host:o,port:a}=tR(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),nR()}function bv(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function tR(n){const e=bv(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Ig(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Ig(o)}}}function Ig(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function nR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class km{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return _s("not implemented")}_getIdTokenResponse(e){return _s("not implemented")}_linkToIdToken(e,t){return _s("not implemented")}_getReauthenticationResolver(e){return _s("not implemented")}}async function rR(n,e){return Ni(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sR(n,e){return $h(n,"POST","/v1/accounts:signInWithPassword",xo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iR(n,e){return $h(n,"POST","/v1/accounts:signInWithEmailLink",xo(n,e))}async function oR(n,e){return $h(n,"POST","/v1/accounts:signInWithEmailLink",xo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jl extends km{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new Jl(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Jl(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ag(e,t,"signInWithPassword",sR);case"emailLink":return iR(e,{email:this._email,oobCode:this._password});default:Nr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ag(e,r,"signUpPassword",rR);case"emailLink":return oR(e,{idToken:t,email:this._email,oobCode:this._password});default:Nr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function da(n,e){return $h(n,"POST","/v1/accounts:signInWithIdp",xo(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aR="http://localhost";class vo extends km{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new vo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Nr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=Tm(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new vo(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return da(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,da(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,da(e,t)}buildRequest(){const e={requestUri:aR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ec(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function cR(n){const e=ml(gl(n)).link,t=e?ml(gl(e)).deep_link_id:null,r=ml(gl(n)).deep_link_id;return(r?ml(gl(r)).link:null)||r||t||e||n}class Cm{constructor(e){var t,r,s,i,o,a;const l=ml(gl(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,u=(r=l.oobCode)!==null&&r!==void 0?r:null,f=lR((s=l.mode)!==null&&s!==void 0?s:null);rt(c&&u&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=u,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=cR(e);try{return new Cm(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ba{constructor(){this.providerId=Ba.PROVIDER_ID}static credential(e,t){return Jl._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Cm.parseLink(t);return rt(r,"argument-error"),Jl._fromEmailAndCode(e,r.code,r.tenantId)}}Ba.PROVIDER_ID="password";Ba.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ba.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tc extends vv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si extends Tc{constructor(){super("facebook.com")}static credential(e){return vo._fromParams({providerId:si.PROVIDER_ID,signInMethod:si.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return si.credentialFromTaggedObject(e)}static credentialFromError(e){return si.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return si.credential(e.oauthAccessToken)}catch{return null}}}si.FACEBOOK_SIGN_IN_METHOD="facebook.com";si.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii extends Tc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return vo._fromParams({providerId:ii.PROVIDER_ID,signInMethod:ii.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ii.credentialFromTaggedObject(e)}static credentialFromError(e){return ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ii.credential(t,r)}catch{return null}}}ii.GOOGLE_SIGN_IN_METHOD="google.com";ii.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends Tc{constructor(){super("github.com")}static credential(e){return vo._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return oi.credential(e.oauthAccessToken)}catch{return null}}}oi.GITHUB_SIGN_IN_METHOD="github.com";oi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ai extends Tc{constructor(){super("twitter.com")}static credential(e,t){return vo._fromParams({providerId:ai.PROVIDER_ID,signInMethod:ai.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ai.credentialFromTaggedObject(e)}static credentialFromError(e){return ai.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return ai.credential(t,r)}catch{return null}}}ai.TWITTER_SIGN_IN_METHOD="twitter.com";ai.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await ys._fromIdTokenResponse(e,r,s),o=Rg(r);return new va({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Rg(r);return new va({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Rg(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu extends as{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Qu.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new Qu(e,t,r,s)}}function Ev(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Qu._fromErrorAndOperation(n,i,e,r):i})}async function uR(n,e,t=!1){const r=await Ql(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return va._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hR(n,e,t=!1){const{auth:r}=n;if(gs(r.app))return Promise.reject(vi(r));const s="reauthenticate";try{const i=await Ql(n,Ev(r,s,e,n),t);rt(i.idToken,r,"internal-error");const o=Im(i.idToken);rt(o,r,"internal-error");const{sub:a}=o;return rt(n.uid===a,r,"user-mismatch"),va._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Nr(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wv(n,e,t=!1){if(gs(n.app))return Promise.reject(vi(n));const r="signIn",s=await Ev(n,r,e),i=await va._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function fR(n,e){return wv(Va(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dR(n){const e=Va(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function pR(n,e,t){return gs(n.app)?Promise.reject(vi(n)):fR(Wt(n),Ba.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&dR(n),r})}function mR(n,e,t,r){return Wt(n).onIdTokenChanged(e,t,r)}function gR(n,e,t){return Wt(n).beforeAuthStateChanged(e,t)}function _R(n,e,t,r){return Wt(n).onAuthStateChanged(e,t,r)}function yR(n){return Wt(n).signOut()}const Ju="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tv{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Ju,"1"),this.storage.removeItem(Ju),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(){const n=In();return Rm(n)||qh(n)}const vR=1e3,ER=10;class Sv extends Tv{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=bR()&&FI(),this.fallbackToPolling=gv(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);BI()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,ER):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},vR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Sv.type="LOCAL";const wR=Sv;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Av extends Tv{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Av.type="SESSION";const Iv=Av;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TR(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wh{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new Wh(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await TR(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Wh.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xm(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=xm("",20);s.port1.start();const u=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(f){const d=f;if(d.data.eventId===c)switch(d.data.status){case"ack":clearTimeout(u),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(d.data.response);break;default:clearTimeout(u),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(){return window}function AR(n){Jr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rv(){return typeof Jr().WorkerGlobalScope<"u"&&typeof Jr().importScripts=="function"}async function IR(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RR(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function kR(){return Rv()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kv="firebaseLocalStorageDb",CR=1,Zu="firebaseLocalStorage",Cv="fbase_key";class Sc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Gh(n,e){return n.transaction([Zu],e?"readwrite":"readonly").objectStore(Zu)}function xR(){const n=indexedDB.deleteDatabase(kv);return new Sc(n).toPromise()}function lp(){const n=indexedDB.open(kv,CR);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Zu,{keyPath:Cv})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Zu)?e(r):(r.close(),await xR(),e(await lp()))})})}async function kg(n,e,t){const r=Gh(n,!0).put({[Cv]:e,value:t});return new Sc(r).toPromise()}async function MR(n,e){const t=Gh(n,!1).get(e),r=await new Sc(t).toPromise();return r===void 0?null:r.value}function Cg(n,e){const t=Gh(n,!0).delete(e);return new Sc(t).toPromise()}const PR=800,OR=3;class xv{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await lp(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>OR)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Rv()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Wh._getInstance(kR()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await IR(),!this.activeServiceWorker)return;this.sender=new SR(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RR()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await lp();return await kg(e,Ju,"1"),await Cg(e,Ju),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>kg(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>MR(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Cg(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Gh(s,!1).getAll();return new Sc(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),PR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xv.type="LOCAL";const NR=xv;new wc(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DR(n,e){return e?bs(e):(rt(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mm extends km{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return da(e,this._buildIdpRequest())}_linkToIdToken(e,t){return da(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return da(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function LR(n){return wv(n.auth,new Mm(n),n.bypassAuthState)}function VR(n){const{auth:e,user:t}=n;return rt(t,e,"internal-error"),hR(t,new Mm(n),n.bypassAuthState)}async function BR(n){const{auth:e,user:t}=n;return rt(t,e,"internal-error"),uR(t,new Mm(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return LR;case"linkViaPopup":case"linkViaRedirect":return BR;case"reauthViaPopup":case"reauthViaRedirect":return VR;default:Nr(this.auth,"internal-error")}}resolve(e){As(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){As(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR=new wc(2e3,1e4);class na extends Mv{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,na.currentPopupAction&&na.currentPopupAction.cancel(),na.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return rt(e,this.auth,"internal-error"),e}async onExecution(){As(this.filter.length===1,"Popup operations only handle one event");const e=xm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Qr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Qr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,na.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Qr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,FR.get())};e()}}na.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="pendingRedirect",Iu=new Map;class HR extends Mv{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Iu.get(this.auth._key());if(!e){try{const r=await jR(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Iu.set(this.auth._key(),e)}return this.bypassAuthState||Iu.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function jR(n,e){const t=qR(e),r=$R(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function zR(n,e){Iu.set(n._key(),e)}function $R(n){return bs(n._redirectPersistence)}function qR(n){return Au(UR,n.config.apiKey,n.name)}async function KR(n,e,t=!1){if(gs(n.app))return Promise.reject(vi(n));const r=Va(n),s=DR(r,e),o=await new HR(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WR=10*60*1e3;class GR{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!YR(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!Pv(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(Qr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WR&&this.cachedEventUids.clear(),this.cachedEventUids.has(xg(e))}saveEventToCache(e){this.cachedEventUids.add(xg(e)),this.lastProcessedEventTime=Date.now()}}function xg(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Pv({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function YR(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Pv(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function XR(n,e={}){return Ni(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QR=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,JR=/^https?/;async function ZR(n){if(n.config.emulator)return;const{authorizedDomains:e}=await XR(n);for(const t of e)try{if(e6(t))return}catch{}Nr(n,"unauthorized-domain")}function e6(n){const e=op(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!JR.test(t))return!1;if(QR.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t6=new wc(3e4,6e4);function Mg(){const n=Jr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function n6(n){return new Promise((e,t)=>{var r,s,i;function o(){Mg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Mg(),t(Qr(n,"network-request-failed"))},timeout:t6.get()})}if(!((s=(r=Jr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Jr().gapi)===null||i===void 0)&&i.load)o();else{const a=GI("iframefcb");return Jr()[a]=()=>{gapi.load?o():t(Qr(n,"network-request-failed"))},yv(`${WI()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw Ru=null,e})}let Ru=null;function r6(n){return Ru=Ru||n6(n),Ru}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6=new wc(5e3,15e3),i6="__/auth/iframe",o6="emulator/auth/iframe",a6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},l6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function c6(n){const e=n.config;rt(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Am(e,o6):`https://${n.config.authDomain}/${i6}`,r={apiKey:e.apiKey,appName:n.name,v:Co},s=l6.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ec(r).slice(1)}`}async function u6(n){const e=await r6(n),t=Jr().gapi;return rt(t,n,"internal-error"),e.open({where:document.body,url:c6(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:a6,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Qr(n,"network-request-failed"),a=Jr().setTimeout(()=>{i(o)},s6.get());function l(){Jr().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},f6=500,d6=600,p6="_blank",m6="http://localhost";class Pg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function g6(n,e,t,r=f6,s=d6){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},h6),{width:r.toString(),height:s.toString(),top:i,left:o}),c=In().toLowerCase();t&&(a=hv(c)?p6:t),uv(c)&&(e=e||m6,l.scrollbars="yes");const u=Object.entries(l).reduce((d,[m,_])=>`${d}${m}=${_},`,"");if(VI(c)&&a!=="_self")return _6(e||"",a),new Pg(null);const f=window.open(e||"",a,u);rt(f,n,"popup-blocked");try{f.focus()}catch{}return new Pg(f)}function _6(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y6="__/auth/handler",b6="emulator/auth/handler",v6=encodeURIComponent("fac");async function Og(n,e,t,r,s,i){rt(n.config.authDomain,n,"auth-domain-config-required"),rt(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Co,eventId:s};if(e instanceof vv){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",l5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[u,f]of Object.entries({}))o[u]=f}if(e instanceof Tc){const u=e.getScopes().filter(f=>f!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const l=await n._getAppCheckToken(),c=l?`#${v6}=${encodeURIComponent(l)}`:"";return`${E6(n)}?${Ec(a).slice(1)}${c}`}function E6({config:n}){return n.emulator?Am(n,b6):`https://${n.authDomain}/${y6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yf="webStorageSupport";class w6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Iv,this._completeRedirectFn=KR,this._overrideRedirectResult=zR}async _openPopup(e,t,r,s){var i;As((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Og(e,t,r,op(),s);return g6(e,o,xm())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await Og(e,t,r,op(),s);return AR(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(As(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await u6(e),r=new GR(e);return t.register("authEvent",s=>(rt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Yf,{type:Yf},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Yf];o!==void 0&&t(!!o),Nr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ZR(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return gv()||Rm()||qh()}}const T6=w6;var Ng="@firebase/auth",Dg="1.7.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){rt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A6(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function I6(n){bo(new Ri("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;rt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_v(n)},c=new $I(r,s,i,l);return ZI(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),bo(new Ri("auth-internal",e=>{const t=Va(e.getProvider("auth").getImmediate());return(r=>new S6(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Xr(Ng,Dg,A6(n)),Xr(Ng,Dg,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R6=5*60,k6=Gb("authIdTokenMaxAge")||R6;let Lg=null;const C6=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>k6)return;const s=t==null?void 0:t.token;Lg!==s&&(Lg=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function eh(n=wm()){const e=zh(n,"auth");if(e.isInitialized())return e.getImmediate();const t=JI(n,{popupRedirectResolver:T6,persistence:[NR,wR,Iv]}),r=Gb("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=C6(i.toString());gR(t,o,()=>o(t.currentUser)),mR(t,a=>o(a))}}const s=qb("auth");return s&&eR(t,`http://${s}`),t}function x6(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}qI({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=Qr("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",x6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});I6("Browser");/*!
  * vue-router v4.3.3
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const Xo=typeof document<"u";function M6(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const Ct=Object.assign;function Xf(n,e){const t={};for(const r in e){const s=e[r];t[r]=Dr(s)?s.map(n):n(s)}return t}const Ol=()=>{},Dr=Array.isArray,Ov=/#/g,P6=/&/g,O6=/\//g,N6=/=/g,D6=/\?/g,Nv=/\+/g,L6=/%5B/g,V6=/%5D/g,Dv=/%5E/g,B6=/%60/g,Lv=/%7B/g,F6=/%7C/g,Vv=/%7D/g,U6=/%20/g;function Pm(n){return encodeURI(""+n).replace(F6,"|").replace(L6,"[").replace(V6,"]")}function H6(n){return Pm(n).replace(Lv,"{").replace(Vv,"}").replace(Dv,"^")}function cp(n){return Pm(n).replace(Nv,"%2B").replace(U6,"+").replace(Ov,"%23").replace(P6,"%26").replace(B6,"`").replace(Lv,"{").replace(Vv,"}").replace(Dv,"^")}function j6(n){return cp(n).replace(N6,"%3D")}function z6(n){return Pm(n).replace(Ov,"%23").replace(D6,"%3F")}function $6(n){return n==null?"":z6(n).replace(O6,"%2F")}function Zl(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const q6=/\/$/,K6=n=>n.replace(q6,"");function Qf(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=X6(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:Zl(o)}}function W6(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function Vg(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function G6(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&Ea(e.matched[r],t.matched[s])&&Bv(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function Ea(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function Bv(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!Y6(n[t],e[t]))return!1;return!0}function Y6(n,e){return Dr(n)?Bg(n,e):Dr(e)?Bg(e,n):n===e}function Bg(n,e){return Dr(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function X6(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}var ec;(function(n){n.pop="pop",n.push="push"})(ec||(ec={}));var Nl;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Nl||(Nl={}));function Q6(n){if(!n)if(Xo){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),K6(n)}const J6=/^[^#]+#/;function Z6(n,e){return n.replace(J6,"#")+e}function ek(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const Yh=()=>({left:window.scrollX,top:window.scrollY});function tk(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=ek(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function Fg(n,e){return(history.state?history.state.position-e:-1)+n}const up=new Map;function nk(n,e){up.set(n,e)}function rk(n){const e=up.get(n);return up.delete(n),e}let sk=()=>location.protocol+"//"+location.host;function Fv(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),Vg(l,"")}return Vg(t,n)+r+s}function ik(n,e,t,r){let s=[],i=[],o=null;const a=({state:d})=>{const m=Fv(n,location),_=t.value,D=e.value;let O=0;if(d){if(t.value=m,e.value=d,o&&o===_){o=null;return}O=D?d.position-D.position:0}else r(m);s.forEach(x=>{x(t.value,_,{delta:O,type:ec.pop,direction:O?O>0?Nl.forward:Nl.back:Nl.unknown})})};function l(){o=t.value}function c(d){s.push(d);const m=()=>{const _=s.indexOf(d);_>-1&&s.splice(_,1)};return i.push(m),m}function u(){const{history:d}=window;d.state&&d.replaceState(Ct({},d.state,{scroll:Yh()}),"")}function f(){for(const d of i)d();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",u,{passive:!0}),{pauseListeners:l,listen:c,destroy:f}}function Ug(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?Yh():null}}function ok(n){const{history:e,location:t}=window,r={value:Fv(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,u){const f=n.indexOf("#"),d=f>-1?(t.host&&document.querySelector("base")?n:n.slice(f))+l:sk()+n+l;try{e[u?"replaceState":"pushState"](c,"",d),s.value=c}catch(m){console.error(m),t[u?"replace":"assign"](d)}}function o(l,c){const u=Ct({},e.state,Ug(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,u,!0),r.value=l}function a(l,c){const u=Ct({},s.value,e.state,{forward:l,scroll:Yh()});i(u.current,u,!0);const f=Ct({},Ug(r.value,l,null),{position:u.position+1},c);i(l,f,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function ak(n){n=Q6(n);const e=ok(n),t=ik(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=Ct({location:"",base:n,go:r,createHref:Z6.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function lk(n){return typeof n=="string"||n&&typeof n=="object"}function Uv(n){return typeof n=="string"||typeof n=="symbol"}const $s={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Hv=Symbol("");var Hg;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(Hg||(Hg={}));function wa(n,e){return Ct(new Error,{type:n,[Hv]:!0},e)}function fs(n,e){return n instanceof Error&&Hv in n&&(e==null||!!(n.type&e))}const jg="[^/]+?",ck={sensitive:!1,strict:!1,start:!0,end:!0},uk=/[.+*?^${}()[\]/\\]/g;function hk(n,e){const t=Ct({},ck,e),r=[];let s=t.start?"^":"";const i=[];for(const c of n){const u=c.length?[]:[90];t.strict&&!c.length&&(s+="/");for(let f=0;f<c.length;f++){const d=c[f];let m=40+(t.sensitive?.25:0);if(d.type===0)f||(s+="/"),s+=d.value.replace(uk,"\\$&"),m+=40;else if(d.type===1){const{value:_,repeatable:D,optional:O,regexp:x}=d;i.push({name:_,repeatable:D,optional:O});const w=x||jg;if(w!==jg){m+=10;try{new RegExp(`(${w})`)}catch(V){throw new Error(`Invalid custom RegExp for param "${_}" (${w}): `+V.message)}}let N=D?`((?:${w})(?:/(?:${w}))*)`:`(${w})`;f||(N=O&&c.length<2?`(?:/${N})`:"/"+N),O&&(N+="?"),s+=N,m+=20,O&&(m+=-8),D&&(m+=-20),w===".*"&&(m+=-50)}u.push(m)}r.push(u)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(c){const u=c.match(o),f={};if(!u)return null;for(let d=1;d<u.length;d++){const m=u[d]||"",_=i[d-1];f[_.name]=m&&_.repeatable?m.split("/"):m}return f}function l(c){let u="",f=!1;for(const d of n){(!f||!u.endsWith("/"))&&(u+="/"),f=!1;for(const m of d)if(m.type===0)u+=m.value;else if(m.type===1){const{value:_,repeatable:D,optional:O}=m,x=_ in c?c[_]:"";if(Dr(x)&&!D)throw new Error(`Provided param "${_}" is an array but it is not repeatable (* or + modifiers)`);const w=Dr(x)?x.join("/"):x;if(!w)if(O)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):f=!0);else throw new Error(`Missing required param "${_}"`);u+=w}}return u||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function fk(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function jv(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=fk(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(zg(r))return 1;if(zg(s))return-1}return s.length-r.length}function zg(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const dk={type:0,value:""},pk=/[a-zA-Z0-9_]/;function mk(n){if(!n)return[[]];if(n==="/")return[[dk]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(m){throw new Error(`ERR (${t})/"${c}": ${m}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",u="";function f(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&f(),o()):l===":"?(f(),t=1):d();break;case 4:d(),t=r;break;case 1:l==="("?t=2:pk.test(l)?d():(f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:t=3:u+=l;break;case 3:f(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,u="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),f(),o(),s}function gk(n,e,t){const r=hk(mk(n.path),t),s=Ct(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function _k(n,e){const t=[],r=new Map;e=Kg({strict:!1,end:!0,sensitive:!1},e);function s(u){return r.get(u)}function i(u,f,d){const m=!d,_=yk(u);_.aliasOf=d&&d.record;const D=Kg(e,u),O=[_];if("alias"in u){const N=typeof u.alias=="string"?[u.alias]:u.alias;for(const V of N)O.push(Ct({},_,{components:d?d.record.components:_.components,path:V,aliasOf:d?d.record:_}))}let x,w;for(const N of O){const{path:V}=N;if(f&&V[0]!=="/"){const p=f.record.path,k=p[p.length-1]==="/"?"":"/";N.path=f.record.path+(V&&k+V)}if(x=gk(N,f,D),d?d.alias.push(x):(w=w||x,w!==x&&w.alias.push(x),m&&u.name&&!qg(x)&&o(u.name)),zv(x)&&l(x),_.children){const p=_.children;for(let k=0;k<p.length;k++)i(p[k],x,d&&d.children[k])}d=d||x}return w?()=>{o(w)}:Ol}function o(u){if(Uv(u)){const f=r.get(u);f&&(r.delete(u),t.splice(t.indexOf(f),1),f.children.forEach(o),f.alias.forEach(o))}else{const f=t.indexOf(u);f>-1&&(t.splice(f,1),u.record.name&&r.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function a(){return t}function l(u){const f=Ek(u,t);t.splice(f,0,u),u.record.name&&!qg(u)&&r.set(u.record.name,u)}function c(u,f){let d,m={},_,D;if("name"in u&&u.name){if(d=r.get(u.name),!d)throw wa(1,{location:u});D=d.record.name,m=Ct($g(f.params,d.keys.filter(w=>!w.optional).concat(d.parent?d.parent.keys.filter(w=>w.optional):[]).map(w=>w.name)),u.params&&$g(u.params,d.keys.map(w=>w.name))),_=d.stringify(m)}else if(u.path!=null)_=u.path,d=t.find(w=>w.re.test(_)),d&&(m=d.parse(_),D=d.record.name);else{if(d=f.name?r.get(f.name):t.find(w=>w.re.test(f.path)),!d)throw wa(1,{location:u,currentLocation:f});D=d.record.name,m=Ct({},f.params,u.params),_=d.stringify(m)}const O=[];let x=d;for(;x;)O.unshift(x.record),x=x.parent;return{name:D,path:_,params:m,matched:O,meta:vk(O)}}return n.forEach(u=>i(u)),{addRoute:i,resolve:c,removeRoute:o,getRoutes:a,getRecordMatcher:s}}function $g(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function yk(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:bk(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function bk(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function qg(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function vk(n){return n.reduce((e,t)=>Ct(e,t.meta),{})}function Kg(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function Ek(n,e){let t=0,r=e.length;for(;t!==r;){const i=t+r>>1;jv(n,e[i])<0?r=i:t=i+1}const s=wk(n);return s&&(r=e.lastIndexOf(s,r-1)),r}function wk(n){let e=n;for(;e=e.parent;)if(zv(e)&&jv(n,e)===0)return e}function zv({record:n}){return!!(n.name||n.components&&Object.keys(n.components).length||n.redirect)}function Tk(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(Nv," "),o=i.indexOf("="),a=Zl(o<0?i:i.slice(0,o)),l=o<0?null:Zl(i.slice(o+1));if(a in e){let c=e[a];Dr(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function Wg(n){let e="";for(let t in n){const r=n[t];if(t=j6(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Dr(r)?r.map(i=>i&&cp(i)):[r&&cp(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function Sk(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Dr(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const Ak=Symbol(""),Gg=Symbol(""),Xh=Symbol(""),Om=Symbol(""),hp=Symbol("");function ll(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function Zs(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=d=>{d===!1?l(wa(4,{from:t,to:e})):d instanceof Error?l(d):lk(d)?l(wa(2,{from:e,to:d})):(o&&r.enterCallbacks[s]===o&&typeof d=="function"&&o.push(d),a())},u=i(()=>n.call(r&&r.instances[s],e,t,c));let f=Promise.resolve(u);n.length<3&&(f=f.then(c)),f.catch(d=>l(d))})}function Jf(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(Ik(l)){const u=(l.__vccOpts||l)[e];u&&i.push(Zs(u,t,r,o,a,s))}else{let c=l();i.push(()=>c.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${o.path}"`));const f=M6(u)?u.default:u;o.components[a]=f;const m=(f.__vccOpts||f)[e];return m&&Zs(m,t,r,o,a,s)()}))}}return i}function Ik(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function Yg(n){const e=Tr(Xh),t=Tr(Om),r=hr(()=>{const l=aa(n.to);return e.resolve(l)}),s=hr(()=>{const{matched:l}=r.value,{length:c}=l,u=l[c-1],f=t.matched;if(!u||!f.length)return-1;const d=f.findIndex(Ea.bind(null,u));if(d>-1)return d;const m=Xg(l[c-2]);return c>1&&Xg(u)===m&&f[f.length-1].path!==m?f.findIndex(Ea.bind(null,l[c-2])):d}),i=hr(()=>s.value>-1&&xk(t.params,r.value.params)),o=hr(()=>s.value>-1&&s.value===t.matched.length-1&&Bv(t.params,r.value.params));function a(l={}){return Ck(l)?e[aa(n.replace)?"replace":"push"](aa(n.to)).catch(Ol):Promise.resolve()}return{route:r,href:hr(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}const Rk=ub({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Yg,setup(n,{slots:e}){const t=yc(Yg(n)),{options:r}=Tr(Xh),s=hr(()=>({[Qg(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Qg(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&e.default(t);return n.custom?i:_m("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),kk=Rk;function Ck(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function xk(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Dr(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function Xg(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Qg=(n,e,t)=>n??e??t,Mk=ub({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=Tr(hp),s=hr(()=>n.route||r.value),i=Tr(Gg,0),o=hr(()=>{let c=aa(i);const{matched:u}=s.value;let f;for(;(f=u[c])&&!f.components;)c++;return c}),a=hr(()=>s.value.matched[o.value]);vu(Gg,hr(()=>o.value+1)),vu(Ak,a),vu(hp,s);const l=Mh();return kl(()=>[l.value,a.value,n.name],([c,u,f],[d,m,_])=>{u&&(u.instances[f]=c,m&&m!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=m.leaveGuards),u.updateGuards.size||(u.updateGuards=m.updateGuards))),c&&u&&(!m||!Ea(u,m)||!d)&&(u.enterCallbacks[f]||[]).forEach(D=>D(c))},{flush:"post"}),()=>{const c=s.value,u=n.name,f=a.value,d=f&&f.components[u];if(!d)return Jg(t.default,{Component:d,route:c});const m=f.props[u],_=m?m===!0?c.params:typeof m=="function"?m(c):m:null,O=_m(d,Ct({},_,e,{onVnodeUnmounted:x=>{x.component.isUnmounted&&(f.instances[u]=null)},ref:l}));return Jg(t.default,{Component:O,route:c})||O}}});function Jg(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const Pk=Mk;function Ok(n){const e=_k(n.routes,n),t=n.parseQuery||Tk,r=n.stringifyQuery||Wg,s=n.history,i=ll(),o=ll(),a=ll(),l=xS($s);let c=$s;Xo&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Xf.bind(null,Z=>""+Z),f=Xf.bind(null,$6),d=Xf.bind(null,Zl);function m(Z,q){let ee,le;return Uv(Z)?(ee=e.getRecordMatcher(Z),le=q):le=Z,e.addRoute(le,ee)}function _(Z){const q=e.getRecordMatcher(Z);q&&e.removeRoute(q)}function D(){return e.getRoutes().map(Z=>Z.record)}function O(Z){return!!e.getRecordMatcher(Z)}function x(Z,q){if(q=Ct({},q||l.value),typeof Z=="string"){const K=Qf(t,Z,q.path),re=e.resolve({path:K.path},q),he=s.createHref(K.fullPath);return Ct(K,re,{params:d(re.params),hash:Zl(K.hash),redirectedFrom:void 0,href:he})}let ee;if(Z.path!=null)ee=Ct({},Z,{path:Qf(t,Z.path,q.path).path});else{const K=Ct({},Z.params);for(const re in K)K[re]==null&&delete K[re];ee=Ct({},Z,{params:f(K)}),q.params=f(q.params)}const le=e.resolve(ee,q),Ee=Z.hash||"";le.params=u(d(le.params));const Oe=W6(r,Ct({},Z,{hash:H6(Ee),path:le.path})),j=s.createHref(Oe);return Ct({fullPath:Oe,hash:Ee,query:r===Wg?Sk(Z.query):Z.query||{}},le,{redirectedFrom:void 0,href:j})}function w(Z){return typeof Z=="string"?Qf(t,Z,l.value.path):Ct({},Z)}function N(Z,q){if(c!==Z)return wa(8,{from:q,to:Z})}function V(Z){return S(Z)}function p(Z){return V(Ct(w(Z),{replace:!0}))}function k(Z){const q=Z.matched[Z.matched.length-1];if(q&&q.redirect){const{redirect:ee}=q;let le=typeof ee=="function"?ee(Z):ee;return typeof le=="string"&&(le=le.includes("?")||le.includes("#")?le=w(le):{path:le},le.params={}),Ct({query:Z.query,hash:Z.hash,params:le.path!=null?{}:Z.params},le)}}function S(Z,q){const ee=c=x(Z),le=l.value,Ee=Z.state,Oe=Z.force,j=Z.replace===!0,K=k(ee);if(K)return S(Ct(w(K),{state:typeof K=="object"?Ct({},Ee,K.state):Ee,force:Oe,replace:j}),q||ee);const re=ee;re.redirectedFrom=q;let he;return!Oe&&G6(r,le,ee)&&(he=wa(16,{to:re,from:le}),L(le,le,!0,!1)),(he?Promise.resolve(he):T(re,le)).catch(_e=>fs(_e)?fs(_e,2)?_e:J(_e):Q(_e,re,le)).then(_e=>{if(_e){if(fs(_e,2))return S(Ct({replace:j},w(_e.to),{state:typeof _e.to=="object"?Ct({},Ee,_e.to.state):Ee,force:Oe}),q||re)}else _e=H(re,le,!0,j,Ee);return M(re,le,_e),_e})}function b(Z,q){const ee=N(Z,q);return ee?Promise.reject(ee):Promise.resolve()}function E(Z){const q=B.values().next().value;return q&&typeof q.runWithContext=="function"?q.runWithContext(Z):Z()}function T(Z,q){let ee;const[le,Ee,Oe]=Nk(Z,q);ee=Jf(le.reverse(),"beforeRouteLeave",Z,q);for(const K of le)K.leaveGuards.forEach(re=>{ee.push(Zs(re,Z,q))});const j=b.bind(null,Z,q);return ee.push(j),ie(ee).then(()=>{ee=[];for(const K of i.list())ee.push(Zs(K,Z,q));return ee.push(j),ie(ee)}).then(()=>{ee=Jf(Ee,"beforeRouteUpdate",Z,q);for(const K of Ee)K.updateGuards.forEach(re=>{ee.push(Zs(re,Z,q))});return ee.push(j),ie(ee)}).then(()=>{ee=[];for(const K of Oe)if(K.beforeEnter)if(Dr(K.beforeEnter))for(const re of K.beforeEnter)ee.push(Zs(re,Z,q));else ee.push(Zs(K.beforeEnter,Z,q));return ee.push(j),ie(ee)}).then(()=>(Z.matched.forEach(K=>K.enterCallbacks={}),ee=Jf(Oe,"beforeRouteEnter",Z,q,E),ee.push(j),ie(ee))).then(()=>{ee=[];for(const K of o.list())ee.push(Zs(K,Z,q));return ee.push(j),ie(ee)}).catch(K=>fs(K,8)?K:Promise.reject(K))}function M(Z,q,ee){a.list().forEach(le=>E(()=>le(Z,q,ee)))}function H(Z,q,ee,le,Ee){const Oe=N(Z,q);if(Oe)return Oe;const j=q===$s,K=Xo?history.state:{};ee&&(le||j?s.replace(Z.fullPath,Ct({scroll:j&&K&&K.scroll},Ee)):s.push(Z.fullPath,Ee)),l.value=Z,L(Z,q,ee,j),J()}let y;function A(){y||(y=s.listen((Z,q,ee)=>{if(!z.listening)return;const le=x(Z),Ee=k(le);if(Ee){S(Ct(Ee,{replace:!0}),le).catch(Ol);return}c=le;const Oe=l.value;Xo&&nk(Fg(Oe.fullPath,ee.delta),Yh()),T(le,Oe).catch(j=>fs(j,12)?j:fs(j,2)?(S(j.to,le).then(K=>{fs(K,20)&&!ee.delta&&ee.type===ec.pop&&s.go(-1,!1)}).catch(Ol),Promise.reject()):(ee.delta&&s.go(-ee.delta,!1),Q(j,le,Oe))).then(j=>{j=j||H(le,Oe,!1),j&&(ee.delta&&!fs(j,8)?s.go(-ee.delta,!1):ee.type===ec.pop&&fs(j,20)&&s.go(-1,!1)),M(le,Oe,j)}).catch(Ol)}))}let W=ll(),X=ll(),ne;function Q(Z,q,ee){J(Z);const le=X.list();return le.length?le.forEach(Ee=>Ee(Z,q,ee)):console.error(Z),Promise.reject(Z)}function ce(){return ne&&l.value!==$s?Promise.resolve():new Promise((Z,q)=>{W.add([Z,q])})}function J(Z){return ne||(ne=!Z,A(),W.list().forEach(([q,ee])=>Z?ee(Z):q()),W.reset()),Z}function L(Z,q,ee,le){const{scrollBehavior:Ee}=n;if(!Xo||!Ee)return Promise.resolve();const Oe=!ee&&rk(Fg(Z.fullPath,0))||(le||!ee)&&history.state&&history.state.scroll||null;return Oh().then(()=>Ee(Z,q,Oe)).then(j=>j&&tk(j)).catch(j=>Q(j,Z,q))}const C=Z=>s.go(Z);let I;const B=new Set,z={currentRoute:l,listening:!0,addRoute:m,removeRoute:_,hasRoute:O,getRoutes:D,resolve:x,options:n,push:V,replace:p,go:C,back:()=>C(-1),forward:()=>C(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:X.add,isReady:ce,install(Z){const q=this;Z.component("RouterLink",kk),Z.component("RouterView",Pk),Z.config.globalProperties.$router=q,Object.defineProperty(Z.config.globalProperties,"$route",{enumerable:!0,get:()=>aa(l)}),Xo&&!I&&l.value===$s&&(I=!0,V(s.location).catch(Ee=>{}));const ee={};for(const Ee in $s)Object.defineProperty(ee,Ee,{get:()=>l.value[Ee],enumerable:!0});Z.provide(Xh,q),Z.provide(Om,K2(ee)),Z.provide(hp,l);const le=Z.unmount;B.add(Z),Z.unmount=function(){B.delete(Z),B.size<1&&(c=$s,y&&y(),y=null,l.value=$s,I=!1,ne=!1),le()}}};function ie(Z){return Z.reduce((q,ee)=>q.then(()=>E(ee)),Promise.resolve())}return z}function Nk(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>Ea(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>Ea(c,l))||s.push(l))}return[t,r,s]}function Dk(){return Tr(Xh)}function JB(){return Tr(Om)}var Lk="firebase",Vk="10.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xr(Lk,Vk,"app");var Zg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var co,$v;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,b){function E(){}E.prototype=b.prototype,S.D=b.prototype,S.prototype=new E,S.prototype.constructor=S,S.C=function(T,M,H){for(var y=Array(arguments.length-2),A=2;A<arguments.length;A++)y[A-2]=arguments[A];return b.prototype[M].apply(T,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(S,b,E){E||(E=0);var T=Array(16);if(typeof b=="string")for(var M=0;16>M;++M)T[M]=b.charCodeAt(E++)|b.charCodeAt(E++)<<8|b.charCodeAt(E++)<<16|b.charCodeAt(E++)<<24;else for(M=0;16>M;++M)T[M]=b[E++]|b[E++]<<8|b[E++]<<16|b[E++]<<24;b=S.g[0],E=S.g[1],M=S.g[2];var H=S.g[3],y=b+(H^E&(M^H))+T[0]+3614090360&4294967295;b=E+(y<<7&4294967295|y>>>25),y=H+(M^b&(E^M))+T[1]+3905402710&4294967295,H=b+(y<<12&4294967295|y>>>20),y=M+(E^H&(b^E))+T[2]+606105819&4294967295,M=H+(y<<17&4294967295|y>>>15),y=E+(b^M&(H^b))+T[3]+3250441966&4294967295,E=M+(y<<22&4294967295|y>>>10),y=b+(H^E&(M^H))+T[4]+4118548399&4294967295,b=E+(y<<7&4294967295|y>>>25),y=H+(M^b&(E^M))+T[5]+1200080426&4294967295,H=b+(y<<12&4294967295|y>>>20),y=M+(E^H&(b^E))+T[6]+2821735955&4294967295,M=H+(y<<17&4294967295|y>>>15),y=E+(b^M&(H^b))+T[7]+4249261313&4294967295,E=M+(y<<22&4294967295|y>>>10),y=b+(H^E&(M^H))+T[8]+1770035416&4294967295,b=E+(y<<7&4294967295|y>>>25),y=H+(M^b&(E^M))+T[9]+2336552879&4294967295,H=b+(y<<12&4294967295|y>>>20),y=M+(E^H&(b^E))+T[10]+4294925233&4294967295,M=H+(y<<17&4294967295|y>>>15),y=E+(b^M&(H^b))+T[11]+2304563134&4294967295,E=M+(y<<22&4294967295|y>>>10),y=b+(H^E&(M^H))+T[12]+1804603682&4294967295,b=E+(y<<7&4294967295|y>>>25),y=H+(M^b&(E^M))+T[13]+4254626195&4294967295,H=b+(y<<12&4294967295|y>>>20),y=M+(E^H&(b^E))+T[14]+2792965006&4294967295,M=H+(y<<17&4294967295|y>>>15),y=E+(b^M&(H^b))+T[15]+1236535329&4294967295,E=M+(y<<22&4294967295|y>>>10),y=b+(M^H&(E^M))+T[1]+4129170786&4294967295,b=E+(y<<5&4294967295|y>>>27),y=H+(E^M&(b^E))+T[6]+3225465664&4294967295,H=b+(y<<9&4294967295|y>>>23),y=M+(b^E&(H^b))+T[11]+643717713&4294967295,M=H+(y<<14&4294967295|y>>>18),y=E+(H^b&(M^H))+T[0]+3921069994&4294967295,E=M+(y<<20&4294967295|y>>>12),y=b+(M^H&(E^M))+T[5]+3593408605&4294967295,b=E+(y<<5&4294967295|y>>>27),y=H+(E^M&(b^E))+T[10]+38016083&4294967295,H=b+(y<<9&4294967295|y>>>23),y=M+(b^E&(H^b))+T[15]+3634488961&4294967295,M=H+(y<<14&4294967295|y>>>18),y=E+(H^b&(M^H))+T[4]+3889429448&4294967295,E=M+(y<<20&4294967295|y>>>12),y=b+(M^H&(E^M))+T[9]+568446438&4294967295,b=E+(y<<5&4294967295|y>>>27),y=H+(E^M&(b^E))+T[14]+3275163606&4294967295,H=b+(y<<9&4294967295|y>>>23),y=M+(b^E&(H^b))+T[3]+4107603335&4294967295,M=H+(y<<14&4294967295|y>>>18),y=E+(H^b&(M^H))+T[8]+1163531501&4294967295,E=M+(y<<20&4294967295|y>>>12),y=b+(M^H&(E^M))+T[13]+2850285829&4294967295,b=E+(y<<5&4294967295|y>>>27),y=H+(E^M&(b^E))+T[2]+4243563512&4294967295,H=b+(y<<9&4294967295|y>>>23),y=M+(b^E&(H^b))+T[7]+1735328473&4294967295,M=H+(y<<14&4294967295|y>>>18),y=E+(H^b&(M^H))+T[12]+2368359562&4294967295,E=M+(y<<20&4294967295|y>>>12),y=b+(E^M^H)+T[5]+4294588738&4294967295,b=E+(y<<4&4294967295|y>>>28),y=H+(b^E^M)+T[8]+2272392833&4294967295,H=b+(y<<11&4294967295|y>>>21),y=M+(H^b^E)+T[11]+1839030562&4294967295,M=H+(y<<16&4294967295|y>>>16),y=E+(M^H^b)+T[14]+4259657740&4294967295,E=M+(y<<23&4294967295|y>>>9),y=b+(E^M^H)+T[1]+2763975236&4294967295,b=E+(y<<4&4294967295|y>>>28),y=H+(b^E^M)+T[4]+1272893353&4294967295,H=b+(y<<11&4294967295|y>>>21),y=M+(H^b^E)+T[7]+4139469664&4294967295,M=H+(y<<16&4294967295|y>>>16),y=E+(M^H^b)+T[10]+3200236656&4294967295,E=M+(y<<23&4294967295|y>>>9),y=b+(E^M^H)+T[13]+681279174&4294967295,b=E+(y<<4&4294967295|y>>>28),y=H+(b^E^M)+T[0]+3936430074&4294967295,H=b+(y<<11&4294967295|y>>>21),y=M+(H^b^E)+T[3]+3572445317&4294967295,M=H+(y<<16&4294967295|y>>>16),y=E+(M^H^b)+T[6]+76029189&4294967295,E=M+(y<<23&4294967295|y>>>9),y=b+(E^M^H)+T[9]+3654602809&4294967295,b=E+(y<<4&4294967295|y>>>28),y=H+(b^E^M)+T[12]+3873151461&4294967295,H=b+(y<<11&4294967295|y>>>21),y=M+(H^b^E)+T[15]+530742520&4294967295,M=H+(y<<16&4294967295|y>>>16),y=E+(M^H^b)+T[2]+3299628645&4294967295,E=M+(y<<23&4294967295|y>>>9),y=b+(M^(E|~H))+T[0]+4096336452&4294967295,b=E+(y<<6&4294967295|y>>>26),y=H+(E^(b|~M))+T[7]+1126891415&4294967295,H=b+(y<<10&4294967295|y>>>22),y=M+(b^(H|~E))+T[14]+2878612391&4294967295,M=H+(y<<15&4294967295|y>>>17),y=E+(H^(M|~b))+T[5]+4237533241&4294967295,E=M+(y<<21&4294967295|y>>>11),y=b+(M^(E|~H))+T[12]+1700485571&4294967295,b=E+(y<<6&4294967295|y>>>26),y=H+(E^(b|~M))+T[3]+2399980690&4294967295,H=b+(y<<10&4294967295|y>>>22),y=M+(b^(H|~E))+T[10]+4293915773&4294967295,M=H+(y<<15&4294967295|y>>>17),y=E+(H^(M|~b))+T[1]+2240044497&4294967295,E=M+(y<<21&4294967295|y>>>11),y=b+(M^(E|~H))+T[8]+1873313359&4294967295,b=E+(y<<6&4294967295|y>>>26),y=H+(E^(b|~M))+T[15]+4264355552&4294967295,H=b+(y<<10&4294967295|y>>>22),y=M+(b^(H|~E))+T[6]+2734768916&4294967295,M=H+(y<<15&4294967295|y>>>17),y=E+(H^(M|~b))+T[13]+1309151649&4294967295,E=M+(y<<21&4294967295|y>>>11),y=b+(M^(E|~H))+T[4]+4149444226&4294967295,b=E+(y<<6&4294967295|y>>>26),y=H+(E^(b|~M))+T[11]+3174756917&4294967295,H=b+(y<<10&4294967295|y>>>22),y=M+(b^(H|~E))+T[2]+718787259&4294967295,M=H+(y<<15&4294967295|y>>>17),y=E+(H^(M|~b))+T[9]+3951481745&4294967295,S.g[0]=S.g[0]+b&4294967295,S.g[1]=S.g[1]+(M+(y<<21&4294967295|y>>>11))&4294967295,S.g[2]=S.g[2]+M&4294967295,S.g[3]=S.g[3]+H&4294967295}r.prototype.u=function(S,b){b===void 0&&(b=S.length);for(var E=b-this.blockSize,T=this.B,M=this.h,H=0;H<b;){if(M==0)for(;H<=E;)s(this,S,H),H+=this.blockSize;if(typeof S=="string"){for(;H<b;)if(T[M++]=S.charCodeAt(H++),M==this.blockSize){s(this,T),M=0;break}}else for(;H<b;)if(T[M++]=S[H++],M==this.blockSize){s(this,T),M=0;break}}this.h=M,this.o+=b},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var b=1;b<S.length-8;++b)S[b]=0;var E=8*this.o;for(b=S.length-8;b<S.length;++b)S[b]=E&255,E/=256;for(this.u(S),S=Array(16),b=E=0;4>b;++b)for(var T=0;32>T;T+=8)S[E++]=this.g[b]>>>T&255;return S};function i(S,b){var E=a;return Object.prototype.hasOwnProperty.call(E,S)?E[S]:E[S]=b(S)}function o(S,b){this.h=b;for(var E=[],T=!0,M=S.length-1;0<=M;M--){var H=S[M]|0;T&&H==b||(E[M]=H,T=!1)}this.g=E}var a={};function l(S){return-128<=S&&128>S?i(S,function(b){return new o([b|0],0>b?-1:0)}):new o([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return f;if(0>S)return O(c(-S));for(var b=[],E=1,T=0;S>=E;T++)b[T]=S/E|0,E*=4294967296;return new o(b,0)}function u(S,b){if(S.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(S.charAt(0)=="-")return O(u(S.substring(1),b));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=c(Math.pow(b,8)),T=f,M=0;M<S.length;M+=8){var H=Math.min(8,S.length-M),y=parseInt(S.substring(M,M+H),b);8>H?(H=c(Math.pow(b,H)),T=T.j(H).add(c(y))):(T=T.j(E),T=T.add(c(y)))}return T}var f=l(0),d=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(D(this))return-O(this).m();for(var S=0,b=1,E=0;E<this.g.length;E++){var T=this.i(E);S+=(0<=T?T:4294967296+T)*b,b*=4294967296}return S},n.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(_(this))return"0";if(D(this))return"-"+O(this).toString(S);for(var b=c(Math.pow(S,6)),E=this,T="";;){var M=V(E,b).g;E=x(E,M.j(b));var H=((0<E.g.length?E.g[0]:E.h)>>>0).toString(S);if(E=M,_(E))return H+T;for(;6>H.length;)H="0"+H;T=H+T}},n.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function _(S){if(S.h!=0)return!1;for(var b=0;b<S.g.length;b++)if(S.g[b]!=0)return!1;return!0}function D(S){return S.h==-1}n.l=function(S){return S=x(this,S),D(S)?-1:_(S)?0:1};function O(S){for(var b=S.g.length,E=[],T=0;T<b;T++)E[T]=~S.g[T];return new o(E,~S.h).add(d)}n.abs=function(){return D(this)?O(this):this},n.add=function(S){for(var b=Math.max(this.g.length,S.g.length),E=[],T=0,M=0;M<=b;M++){var H=T+(this.i(M)&65535)+(S.i(M)&65535),y=(H>>>16)+(this.i(M)>>>16)+(S.i(M)>>>16);T=y>>>16,H&=65535,y&=65535,E[M]=y<<16|H}return new o(E,E[E.length-1]&-2147483648?-1:0)};function x(S,b){return S.add(O(b))}n.j=function(S){if(_(this)||_(S))return f;if(D(this))return D(S)?O(this).j(O(S)):O(O(this).j(S));if(D(S))return O(this.j(O(S)));if(0>this.l(m)&&0>S.l(m))return c(this.m()*S.m());for(var b=this.g.length+S.g.length,E=[],T=0;T<2*b;T++)E[T]=0;for(T=0;T<this.g.length;T++)for(var M=0;M<S.g.length;M++){var H=this.i(T)>>>16,y=this.i(T)&65535,A=S.i(M)>>>16,W=S.i(M)&65535;E[2*T+2*M]+=y*W,w(E,2*T+2*M),E[2*T+2*M+1]+=H*W,w(E,2*T+2*M+1),E[2*T+2*M+1]+=y*A,w(E,2*T+2*M+1),E[2*T+2*M+2]+=H*A,w(E,2*T+2*M+2)}for(T=0;T<b;T++)E[T]=E[2*T+1]<<16|E[2*T];for(T=b;T<2*b;T++)E[T]=0;return new o(E,0)};function w(S,b){for(;(S[b]&65535)!=S[b];)S[b+1]+=S[b]>>>16,S[b]&=65535,b++}function N(S,b){this.g=S,this.h=b}function V(S,b){if(_(b))throw Error("division by zero");if(_(S))return new N(f,f);if(D(S))return b=V(O(S),b),new N(O(b.g),O(b.h));if(D(b))return b=V(S,O(b)),new N(O(b.g),b.h);if(30<S.g.length){if(D(S)||D(b))throw Error("slowDivide_ only works with positive integers.");for(var E=d,T=b;0>=T.l(S);)E=p(E),T=p(T);var M=k(E,1),H=k(T,1);for(T=k(T,2),E=k(E,2);!_(T);){var y=H.add(T);0>=y.l(S)&&(M=M.add(E),H=y),T=k(T,1),E=k(E,1)}return b=x(S,M.j(b)),new N(M,b)}for(M=f;0<=S.l(b);){for(E=Math.max(1,Math.floor(S.m()/b.m())),T=Math.ceil(Math.log(E)/Math.LN2),T=48>=T?1:Math.pow(2,T-48),H=c(E),y=H.j(b);D(y)||0<y.l(S);)E-=T,H=c(E),y=H.j(b);_(H)&&(H=d),M=M.add(H),S=x(S,y)}return new N(M,S)}n.A=function(S){return V(this,S).h},n.and=function(S){for(var b=Math.max(this.g.length,S.g.length),E=[],T=0;T<b;T++)E[T]=this.i(T)&S.i(T);return new o(E,this.h&S.h)},n.or=function(S){for(var b=Math.max(this.g.length,S.g.length),E=[],T=0;T<b;T++)E[T]=this.i(T)|S.i(T);return new o(E,this.h|S.h)},n.xor=function(S){for(var b=Math.max(this.g.length,S.g.length),E=[],T=0;T<b;T++)E[T]=this.i(T)^S.i(T);return new o(E,this.h^S.h)};function p(S){for(var b=S.g.length+1,E=[],T=0;T<b;T++)E[T]=S.i(T)<<1|S.i(T-1)>>>31;return new o(E,S.h)}function k(S,b){var E=b>>5;b%=32;for(var T=S.g.length-E,M=[],H=0;H<T;H++)M[H]=0<b?S.i(H+E)>>>b|S.i(H+E+1)<<32-b:S.i(H+E);return new o(M,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,$v=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=u,co=o}).apply(typeof Zg<"u"?Zg:typeof self<"u"?self:typeof window<"u"?window:{});var nu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var qv,Kv,_l,Wv,ku,fp,Gv,Yv,Xv;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,g,R){return h==Array.prototype||h==Object.prototype||(h[g]=R.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof nu=="object"&&nu];for(var g=0;g<h.length;++g){var R=h[g];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}var r=t(this);function s(h,g){if(g)e:{var R=r;h=h.split(".");for(var $=0;$<h.length-1;$++){var pe=h[$];if(!(pe in R))break e;R=R[pe]}h=h[h.length-1],$=R[h],g=g($),g!=$&&g!=null&&e(R,h,{configurable:!0,writable:!0,value:g})}}function i(h,g){h instanceof String&&(h+="");var R=0,$=!1,pe={next:function(){if(!$&&R<h.length){var we=R++;return{value:g(we,h[we]),done:!1}}return $=!0,{done:!0,value:void 0}}};return pe[Symbol.iterator]=function(){return pe},pe}s("Array.prototype.values",function(h){return h||function(){return i(this,function(g,R){return R})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(h){var g=typeof h;return g=g!="object"?g:h?Array.isArray(h)?"array":g:"null",g=="array"||g=="object"&&typeof h.length=="number"}function c(h){var g=typeof h;return g=="object"&&h!=null||g=="function"}function u(h,g,R){return h.call.apply(h.bind,arguments)}function f(h,g,R){if(!h)throw Error();if(2<arguments.length){var $=Array.prototype.slice.call(arguments,2);return function(){var pe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(pe,$),h.apply(g,pe)}}return function(){return h.apply(g,arguments)}}function d(h,g,R){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?u:f,d.apply(null,arguments)}function m(h,g){var R=Array.prototype.slice.call(arguments,1);return function(){var $=R.slice();return $.push.apply($,arguments),h.apply(this,$)}}function _(h,g){function R(){}R.prototype=g.prototype,h.aa=g.prototype,h.prototype=new R,h.prototype.constructor=h,h.Qb=function($,pe,we){for(var He=Array(arguments.length-2),Ot=2;Ot<arguments.length;Ot++)He[Ot-2]=arguments[Ot];return g.prototype[pe].apply($,He)}}function D(h){const g=h.length;if(0<g){const R=Array(g);for(let $=0;$<g;$++)R[$]=h[$];return R}return[]}function O(h,g){for(let R=1;R<arguments.length;R++){const $=arguments[R];if(l($)){const pe=h.length||0,we=$.length||0;h.length=pe+we;for(let He=0;He<we;He++)h[pe+He]=$[He]}else h.push($)}}class x{constructor(g,R){this.i=g,this.j=R,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function w(h){return/^[\s\xa0]*$/.test(h)}function N(){var h=a.navigator;return h&&(h=h.userAgent)?h:""}function V(h){return V[" "](h),h}V[" "]=function(){};var p=N().indexOf("Gecko")!=-1&&!(N().toLowerCase().indexOf("webkit")!=-1&&N().indexOf("Edge")==-1)&&!(N().indexOf("Trident")!=-1||N().indexOf("MSIE")!=-1)&&N().indexOf("Edge")==-1;function k(h,g,R){for(const $ in h)g.call(R,h[$],$,h)}function S(h,g){for(const R in h)g.call(void 0,h[R],R,h)}function b(h){const g={};for(const R in h)g[R]=h[R];return g}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(h,g){let R,$;for(let pe=1;pe<arguments.length;pe++){$=arguments[pe];for(R in $)h[R]=$[R];for(let we=0;we<E.length;we++)R=E[we],Object.prototype.hasOwnProperty.call($,R)&&(h[R]=$[R])}}function M(h){var g=1;h=h.split(":");const R=[];for(;0<g&&h.length;)R.push(h.shift()),g--;return h.length&&R.push(h.join(":")),R}function H(h){a.setTimeout(()=>{throw h},0)}function y(){var h=ce;let g=null;return h.g&&(g=h.g,h.g=h.g.next,h.g||(h.h=null),g.next=null),g}class A{constructor(){this.h=this.g=null}add(g,R){const $=W.get();$.set(g,R),this.h?this.h.next=$:this.g=$,this.h=$}}var W=new x(()=>new X,h=>h.reset());class X{constructor(){this.next=this.g=this.h=null}set(g,R){this.h=g,this.g=R,this.next=null}reset(){this.next=this.g=this.h=null}}let ne,Q=!1,ce=new A,J=()=>{const h=a.Promise.resolve(void 0);ne=()=>{h.then(L)}};var L=()=>{for(var h;h=y();){try{h.h.call(h.g)}catch(R){H(R)}var g=W;g.j(h),100>g.h&&(g.h++,h.next=g.g,g.g=h)}Q=!1};function C(){this.s=this.s,this.C=this.C}C.prototype.s=!1,C.prototype.ma=function(){this.s||(this.s=!0,this.N())},C.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function I(h,g){this.type=h,this.g=this.target=g,this.defaultPrevented=!1}I.prototype.h=function(){this.defaultPrevented=!0};var B=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var h=!1,g=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const R=()=>{};a.addEventListener("test",R,g),a.removeEventListener("test",R,g)}catch{}return h}();function z(h,g){if(I.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var R=this.type=h.type,$=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=g,g=h.relatedTarget){if(p){e:{try{V(g.nodeName);var pe=!0;break e}catch{}pe=!1}pe||(g=null)}}else R=="mouseover"?g=h.fromElement:R=="mouseout"&&(g=h.toElement);this.relatedTarget=g,$?(this.clientX=$.clientX!==void 0?$.clientX:$.pageX,this.clientY=$.clientY!==void 0?$.clientY:$.pageY,this.screenX=$.screenX||0,this.screenY=$.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ie[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&z.aa.h.call(this)}}_(z,I);var ie={2:"touch",3:"pen",4:"mouse"};z.prototype.h=function(){z.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var Z="closure_listenable_"+(1e6*Math.random()|0),q=0;function ee(h,g,R,$,pe){this.listener=h,this.proxy=null,this.src=g,this.type=R,this.capture=!!$,this.ha=pe,this.key=++q,this.da=this.fa=!1}function le(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Ee(h){this.src=h,this.g={},this.h=0}Ee.prototype.add=function(h,g,R,$,pe){var we=h.toString();h=this.g[we],h||(h=this.g[we]=[],this.h++);var He=j(h,g,$,pe);return-1<He?(g=h[He],R||(g.fa=!1)):(g=new ee(g,this.src,we,!!$,pe),g.fa=R,h.push(g)),g};function Oe(h,g){var R=g.type;if(R in h.g){var $=h.g[R],pe=Array.prototype.indexOf.call($,g,void 0),we;(we=0<=pe)&&Array.prototype.splice.call($,pe,1),we&&(le(g),h.g[R].length==0&&(delete h.g[R],h.h--))}}function j(h,g,R,$){for(var pe=0;pe<h.length;++pe){var we=h[pe];if(!we.da&&we.listener==g&&we.capture==!!R&&we.ha==$)return pe}return-1}var K="closure_lm_"+(1e6*Math.random()|0),re={};function he(h,g,R,$,pe){if(Array.isArray(g)){for(var we=0;we<g.length;we++)he(h,g[we],R,$,pe);return null}return R=Ae(R),h&&h[Z]?h.K(g,R,c($)?!!$.capture:!!$,pe):_e(h,g,R,!1,$,pe)}function _e(h,g,R,$,pe,we){if(!g)throw Error("Invalid event type");var He=c(pe)?!!pe.capture:!!pe,Ot=Se(h);if(Ot||(h[K]=Ot=new Ee(h)),R=Ot.add(g,R,$,He,we),R.proxy)return R;if($=De(),R.proxy=$,$.src=h,$.listener=R,h.addEventListener)B||(pe=He),pe===void 0&&(pe=!1),h.addEventListener(g.toString(),$,pe);else if(h.attachEvent)h.attachEvent(me(g.toString()),$);else if(h.addListener&&h.removeListener)h.addListener($);else throw Error("addEventListener and attachEvent are unavailable.");return R}function De(){function h(R){return g.call(h.src,h.listener,R)}const g=fe;return h}function v(h,g,R,$,pe){if(Array.isArray(g))for(var we=0;we<g.length;we++)v(h,g[we],R,$,pe);else $=c($)?!!$.capture:!!$,R=Ae(R),h&&h[Z]?(h=h.i,g=String(g).toString(),g in h.g&&(we=h.g[g],R=j(we,R,$,pe),-1<R&&(le(we[R]),Array.prototype.splice.call(we,R,1),we.length==0&&(delete h.g[g],h.h--)))):h&&(h=Se(h))&&(g=h.g[g.toString()],h=-1,g&&(h=j(g,R,$,pe)),(R=-1<h?g[h]:null)&&P(R))}function P(h){if(typeof h!="number"&&h&&!h.da){var g=h.src;if(g&&g[Z])Oe(g.i,h);else{var R=h.type,$=h.proxy;g.removeEventListener?g.removeEventListener(R,$,h.capture):g.detachEvent?g.detachEvent(me(R),$):g.addListener&&g.removeListener&&g.removeListener($),(R=Se(g))?(Oe(R,h),R.h==0&&(R.src=null,g[K]=null)):le(h)}}}function me(h){return h in re?re[h]:re[h]="on"+h}function fe(h,g){if(h.da)h=!0;else{g=new z(g,this);var R=h.listener,$=h.ha||h.src;h.fa&&P(h),h=R.call($,g)}return h}function Se(h){return h=h[K],h instanceof Ee?h:null}var Re="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ae(h){return typeof h=="function"?h:(h[Re]||(h[Re]=function(g){return h.handleEvent(g)}),h[Re])}function Te(){C.call(this),this.i=new Ee(this),this.M=this,this.F=null}_(Te,C),Te.prototype[Z]=!0,Te.prototype.removeEventListener=function(h,g,R,$){v(this,h,g,R,$)};function Ne(h,g){var R,$=h.F;if($)for(R=[];$;$=$.F)R.push($);if(h=h.M,$=g.type||g,typeof g=="string")g=new I(g,h);else if(g instanceof I)g.target=g.target||h;else{var pe=g;g=new I($,h),T(g,pe)}if(pe=!0,R)for(var we=R.length-1;0<=we;we--){var He=g.g=R[we];pe=Ue(He,$,!0,g)&&pe}if(He=g.g=h,pe=Ue(He,$,!0,g)&&pe,pe=Ue(He,$,!1,g)&&pe,R)for(we=0;we<R.length;we++)He=g.g=R[we],pe=Ue(He,$,!1,g)&&pe}Te.prototype.N=function(){if(Te.aa.N.call(this),this.i){var h=this.i,g;for(g in h.g){for(var R=h.g[g],$=0;$<R.length;$++)le(R[$]);delete h.g[g],h.h--}}this.F=null},Te.prototype.K=function(h,g,R,$){return this.i.add(String(h),g,!1,R,$)},Te.prototype.L=function(h,g,R,$){return this.i.add(String(h),g,!0,R,$)};function Ue(h,g,R,$){if(g=h.i.g[String(g)],!g)return!0;g=g.concat();for(var pe=!0,we=0;we<g.length;++we){var He=g[we];if(He&&!He.da&&He.capture==R){var Ot=He.listener,bn=He.ha||He.src;He.fa&&Oe(h.i,He),pe=Ot.call(bn,$)!==!1&&pe}}return pe&&!$.defaultPrevented}function Ie(h,g,R){if(typeof h=="function")R&&(h=d(h,R));else if(h&&typeof h.handleEvent=="function")h=d(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(h,g||0)}function Je(h){h.g=Ie(()=>{h.g=null,h.i&&(h.i=!1,Je(h))},h.l);const g=h.h;h.h=null,h.m.apply(null,g)}class dt extends C{constructor(g,R){super(),this.m=g,this.l=R,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Je(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function F(h){C.call(this),this.h=h,this.g={}}_(F,C);var U=[];function Y(h){k(h.g,function(g,R){this.g.hasOwnProperty(R)&&P(g)},h),h.g={}}F.prototype.N=function(){F.aa.N.call(this),Y(this)},F.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var te=a.JSON.stringify,se=a.JSON.parse,G=class{stringify(h){return a.JSON.stringify(h,void 0)}parse(h){return a.JSON.parse(h,void 0)}};function ae(){}ae.prototype.h=null;function ue(h){return h.h||(h.h=h.i())}function oe(){}var ye={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function de(){I.call(this,"d")}_(de,I);function be(){I.call(this,"c")}_(be,I);var Le={},We=null;function Ce(){return We=We||new Te}Le.La="serverreachability";function Ke(h){I.call(this,Le.La,h)}_(Ke,I);function ge(h){const g=Ce();Ne(g,new Ke(g))}Le.STAT_EVENT="statevent";function ze(h,g){I.call(this,Le.STAT_EVENT,h),this.stat=g}_(ze,I);function Xe(h){const g=Ce();Ne(g,new ze(g,h))}Le.Ma="timingevent";function xe(h,g){I.call(this,Le.Ma,h),this.size=g}_(xe,I);function je(h,g){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){h()},g)}function ke(){this.g=!0}ke.prototype.xa=function(){this.g=!1};function Qe(h,g,R,$,pe,we){h.info(function(){if(h.g)if(we)for(var He="",Ot=we.split("&"),bn=0;bn<Ot.length;bn++){var St=Ot[bn].split("=");if(1<St.length){var xn=St[0];St=St[1];var Mn=xn.split("_");He=2<=Mn.length&&Mn[1]=="type"?He+(xn+"="+St+"&"):He+(xn+"=redacted&")}}else He=null;else He=we;return"XMLHTTP REQ ("+$+") [attempt "+pe+"]: "+g+`
`+R+`
`+He})}function xt(h,g,R,$,pe,we,He){h.info(function(){return"XMLHTTP RESP ("+$+") [ attempt "+pe+"]: "+g+`
`+R+`
`+we+" "+He})}function Fe(h,g,R,$){h.info(function(){return"XMLHTTP TEXT ("+g+"): "+ot(h,R)+($?" "+$:"")})}function nt(h,g){h.info(function(){return"TIMEOUT: "+g})}ke.prototype.info=function(){};function ot(h,g){if(!h.g)return g;if(!g)return null;try{var R=JSON.parse(g);if(R){for(h=0;h<R.length;h++)if(Array.isArray(R[h])){var $=R[h];if(!(2>$.length)){var pe=$[1];if(Array.isArray(pe)&&!(1>pe.length)){var we=pe[0];if(we!="noop"&&we!="stop"&&we!="close")for(var He=1;He<pe.length;He++)pe[He]=""}}}}return te(R)}catch{return g}}var Rt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Rn={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Dt;function kt(){}_(kt,ae),kt.prototype.g=function(){return new XMLHttpRequest},kt.prototype.i=function(){return{}},Dt=new kt;function Ft(h,g,R,$){this.j=h,this.i=g,this.l=R,this.R=$||1,this.U=new F(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new kn}function kn(){this.i=null,this.g="",this.h=!1}var Cn={},jn={};function zn(h,g,R){h.L=1,h.v=us(yn(g)),h.m=R,h.P=!0,on(h,null)}function on(h,g){h.F=Date.now(),Os(h),h.A=yn(h.v);var R=h.A,$=h.R;Array.isArray($)||($=[String($)]),W0(R.i,"t",$),h.C=0,R=h.j.J,h.h=new kn,h.g=h1(h.j,R?g:null,!h.m),0<h.O&&(h.M=new dt(d(h.Y,h,h.g),h.O)),g=h.U,R=h.g,$=h.ca;var pe="readystatechange";Array.isArray(pe)||(pe&&(U[0]=pe.toString()),pe=U);for(var we=0;we<pe.length;we++){var He=he(R,pe[we],$||g.handleEvent,!1,g.h||g);if(!He)break;g.g[He.key]=He}g=h.H?b(h.H):{},h.m?(h.u||(h.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,g)):(h.u="GET",h.g.ea(h.A,h.u,null,g)),ge(),Qe(h.i,h.u,h.A,h.l,h.R,h.m)}Ft.prototype.ca=function(h){h=h.target;const g=this.M;g&&hs(h)==3?g.j():this.Y(h)},Ft.prototype.Y=function(h){try{if(h==this.g)e:{const Mn=hs(this.g);var g=this.g.Ba();const jo=this.g.Z();if(!(3>Mn)&&(Mn!=3||this.g&&(this.h.h||this.g.oa()||e1(this.g)))){this.J||Mn!=4||g==7||(g==8||0>=jo?ge(3):ge(2)),Do(this);var R=this.g.Z();this.X=R;t:if(ar(this)){var $=e1(this.g);h="";var pe=$.length,we=hs(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Tt(this),Ns(this);var He="";break t}this.h.i=new a.TextDecoder}for(g=0;g<pe;g++)this.h.h=!0,h+=this.h.i.decode($[g],{stream:!(we&&g==pe-1)});$.length=0,this.h.g+=h,this.C=0,He=this.h.g}else He=this.g.oa();if(this.o=R==200,xt(this.i,this.u,this.A,this.l,this.R,Mn,R),this.o){if(this.T&&!this.K){t:{if(this.g){var Ot,bn=this.g;if((Ot=bn.g?bn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!w(Ot)){var St=Ot;break t}}St=null}if(R=St)Fe(this.i,this.l,R,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Lo(this,R);else{this.o=!1,this.s=3,Xe(12),Tt(this),Ns(this);break e}}if(this.P){R=!0;let Rr;for(;!this.J&&this.C<He.length;)if(Rr=Ps(this,He),Rr==jn){Mn==4&&(this.s=4,Xe(14),R=!1),Fe(this.i,this.l,null,"[Incomplete Response]");break}else if(Rr==Cn){this.s=4,Xe(15),Fe(this.i,this.l,He,"[Invalid Chunk]"),R=!1;break}else Fe(this.i,this.l,Rr,null),Lo(this,Rr);if(ar(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mn!=4||He.length!=0||this.h.h||(this.s=1,Xe(16),R=!1),this.o=this.o&&R,!R)Fe(this.i,this.l,He,"[Invalid Chunked Response]"),Tt(this),Ns(this);else if(0<He.length&&!this.W){this.W=!0;var xn=this.j;xn.g==this&&xn.ba&&!xn.M&&(xn.j.info("Great, no buffering proxy detected. Bytes received: "+He.length),Of(xn),xn.M=!0,Xe(11))}}else Fe(this.i,this.l,He,null),Lo(this,He);Mn==4&&Tt(this),this.o&&!this.J&&(Mn==4?a1(this.j,this):(this.o=!1,Os(this)))}else qT(this.g),R==400&&0<He.indexOf("Unknown SID")?(this.s=3,Xe(12)):(this.s=0,Xe(13)),Tt(this),Ns(this)}}}catch{}finally{}};function ar(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function Ps(h,g){var R=h.C,$=g.indexOf(`
`,R);return $==-1?jn:(R=Number(g.substring(R,$)),isNaN(R)?Cn:($+=1,$+R>g.length?jn:(g=g.slice($,$+R),h.C=$+R,g)))}Ft.prototype.cancel=function(){this.J=!0,Tt(this)};function Os(h){h.S=Date.now()+h.I,Ga(h,h.I)}function Ga(h,g){if(h.B!=null)throw Error("WatchDog timer not null");h.B=je(d(h.ba,h),g)}function Do(h){h.B&&(a.clearTimeout(h.B),h.B=null)}Ft.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(nt(this.i,this.A),this.L!=2&&(ge(),Xe(17)),Tt(this),this.s=2,Ns(this)):Ga(this,this.S-h)};function Ns(h){h.j.G==0||h.J||a1(h.j,h)}function Tt(h){Do(h);var g=h.M;g&&typeof g.ma=="function"&&g.ma(),h.M=null,Y(h.U),h.g&&(g=h.g,h.g=null,g.abort(),g.ma())}function Lo(h,g){try{var R=h.j;if(R.G!=0&&(R.g==h||ls(R.h,h))){if(!h.K&&ls(R.h,h)&&R.G==3){try{var $=R.Da.g.parse(g)}catch{$=null}if(Array.isArray($)&&$.length==3){var pe=$;if(pe[0]==0){e:if(!R.u){if(R.g)if(R.g.F+3e3<h.F)$c(R),jc(R);else break e;Pf(R),Xe(18)}}else R.za=pe[1],0<R.za-R.T&&37500>pe[2]&&R.F&&R.v==0&&!R.C&&(R.C=je(d(R.Za,R),6e3));if(1>=Ya(R.h)&&R.ca){try{R.ca()}catch{}R.ca=void 0}}else Ui(R,11)}else if((h.K||R.g==h)&&$c(R),!w(g))for(pe=R.Da.g.parse(g),g=0;g<pe.length;g++){let St=pe[g];if(R.T=St[0],St=St[1],R.G==2)if(St[0]=="c"){R.K=St[1],R.ia=St[2];const xn=St[3];xn!=null&&(R.la=xn,R.j.info("VER="+R.la));const Mn=St[4];Mn!=null&&(R.Aa=Mn,R.j.info("SVER="+R.Aa));const jo=St[5];jo!=null&&typeof jo=="number"&&0<jo&&($=1.5*jo,R.L=$,R.j.info("backChannelRequestTimeoutMs_="+$)),$=R;const Rr=h.g;if(Rr){const Kc=Rr.g?Rr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Kc){var we=$.h;we.g||Kc.indexOf("spdy")==-1&&Kc.indexOf("quic")==-1&&Kc.indexOf("h2")==-1||(we.j=we.l,we.g=new Set,we.h&&(Xa(we,we.h),we.h=null))}if($.D){const Nf=Rr.g?Rr.g.getResponseHeader("X-HTTP-Session-Id"):null;Nf&&($.ya=Nf,It($.I,$.D,Nf))}}R.G=3,R.l&&R.l.ua(),R.ba&&(R.R=Date.now()-h.F,R.j.info("Handshake RTT: "+R.R+"ms")),$=R;var He=h;if($.qa=u1($,$.J?$.ia:null,$.W),He.K){Xt($.h,He);var Ot=He,bn=$.L;bn&&(Ot.I=bn),Ot.B&&(Do(Ot),Os(Ot)),$.g=He}else i1($);0<R.i.length&&zc(R)}else St[0]!="stop"&&St[0]!="close"||Ui(R,7);else R.G==3&&(St[0]=="stop"||St[0]=="close"?St[0]=="stop"?Ui(R,7):Mf(R):St[0]!="noop"&&R.l&&R.l.ta(St),R.v=0)}}ge(4)}catch{}}var Fc=class{constructor(h,g){this.g=h,this.map=g}};function Vo(h){this.l=h||10,a.PerformanceNavigationTiming?(h=a.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bo(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ya(h){return h.h?1:h.g?h.g.size:0}function ls(h,g){return h.h?h.h==g:h.g?h.g.has(g):!1}function Xa(h,g){h.g?h.g.add(g):h.h=g}function Xt(h,g){h.h&&h.h==g?h.h=null:h.g&&h.g.has(g)&&h.g.delete(g)}Vo.prototype.cancel=function(){if(this.i=Fo(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Fo(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let g=h.i;for(const R of h.g.values())g=g.concat(R.D);return g}return D(h.i)}function Qa(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(l(h)){for(var g=[],R=h.length,$=0;$<R;$++)g.push(h[$]);return g}g=[],R=0;for($ in h)g[R++]=h[$];return g}function Ja(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(l(h)||typeof h=="string"){var g=[];h=h.length;for(var R=0;R<h;R++)g.push(R);return g}g=[],R=0;for(const $ in h)g[R++]=$;return g}}}function _n(h,g){if(h.forEach&&typeof h.forEach=="function")h.forEach(g,void 0);else if(l(h)||typeof h=="string")Array.prototype.forEach.call(h,g,void 0);else for(var R=Ja(h),$=Qa(h),pe=$.length,we=0;we<pe;we++)g.call(void 0,$[we],R&&R[we],h)}var Ds=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cs(h,g){if(h){h=h.split("&");for(var R=0;R<h.length;R++){var $=h[R].indexOf("="),pe=null;if(0<=$){var we=h[R].substring(0,$);pe=h[R].substring($+1)}else we=h[R];g(we,pe?decodeURIComponent(pe.replace(/\+/g," ")):"")}}}function Ir(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof Ir){this.h=h.h,Ls(this,h.j),this.o=h.o,this.g=h.g,Fr(this,h.s),this.l=h.l;var g=h.i,R=new tl;R.i=g.i,g.g&&(R.g=new Map(g.g),R.h=g.h),Vs(this,R),this.m=h.m}else h&&(g=String(h).match(Ds))?(this.h=!1,Ls(this,g[1]||"",!0),this.o=Za(g[2]||""),this.g=Za(g[3]||"",!0),Fr(this,g[4]),this.l=Za(g[5]||"",!0),Vs(this,g[6]||"",!0),this.m=Za(g[7]||"")):(this.h=!1,this.i=new tl(null,this.h))}Ir.prototype.toString=function(){var h=[],g=this.j;g&&h.push(el(g,$0,!0),":");var R=this.g;return(R||g=="file")&&(h.push("//"),(g=this.o)&&h.push(el(g,$0,!0),"@"),h.push(encodeURIComponent(String(R)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),R=this.s,R!=null&&h.push(":",String(R))),(R=this.l)&&(this.g&&R.charAt(0)!="/"&&h.push("/"),h.push(el(R,R.charAt(0)=="/"?DT:NT,!0))),(R=this.i.toString())&&h.push("?",R),(R=this.m)&&h.push("#",el(R,VT)),h.join("")};function yn(h){return new Ir(h)}function Ls(h,g,R){h.j=R?Za(g,!0):g,h.j&&(h.j=h.j.replace(/:$/,""))}function Fr(h,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);h.s=g}else h.s=null}function Vs(h,g,R){g instanceof tl?(h.i=g,BT(h.i,h.h)):(R||(g=el(g,LT)),h.i=new tl(g,h.h))}function It(h,g,R){h.i.set(g,R)}function us(h){return It(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Za(h,g){return h?g?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function el(h,g,R){return typeof h=="string"?(h=encodeURI(h).replace(g,OT),R&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function OT(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var $0=/[#\/\?@]/g,NT=/[#\?:]/g,DT=/[#\?]/g,LT=/[#\?@]/g,VT=/#/g;function tl(h,g){this.h=this.g=null,this.i=h||null,this.j=!!g}function Bs(h){h.g||(h.g=new Map,h.h=0,h.i&&cs(h.i,function(g,R){h.add(decodeURIComponent(g.replace(/\+/g," ")),R)}))}n=tl.prototype,n.add=function(h,g){Bs(this),this.i=null,h=Uo(this,h);var R=this.g.get(h);return R||this.g.set(h,R=[]),R.push(g),this.h+=1,this};function q0(h,g){Bs(h),g=Uo(h,g),h.g.has(g)&&(h.i=null,h.h-=h.g.get(g).length,h.g.delete(g))}function K0(h,g){return Bs(h),g=Uo(h,g),h.g.has(g)}n.forEach=function(h,g){Bs(this),this.g.forEach(function(R,$){R.forEach(function(pe){h.call(g,pe,$,this)},this)},this)},n.na=function(){Bs(this);const h=Array.from(this.g.values()),g=Array.from(this.g.keys()),R=[];for(let $=0;$<g.length;$++){const pe=h[$];for(let we=0;we<pe.length;we++)R.push(g[$])}return R},n.V=function(h){Bs(this);let g=[];if(typeof h=="string")K0(this,h)&&(g=g.concat(this.g.get(Uo(this,h))));else{h=Array.from(this.g.values());for(let R=0;R<h.length;R++)g=g.concat(h[R])}return g},n.set=function(h,g){return Bs(this),this.i=null,h=Uo(this,h),K0(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[g]),this.h+=1,this},n.get=function(h,g){return h?(h=this.V(h),0<h.length?String(h[0]):g):g};function W0(h,g,R){q0(h,g),0<R.length&&(h.i=null,h.g.set(Uo(h,g),D(R)),h.h+=R.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],g=Array.from(this.g.keys());for(var R=0;R<g.length;R++){var $=g[R];const we=encodeURIComponent(String($)),He=this.V($);for($=0;$<He.length;$++){var pe=we;He[$]!==""&&(pe+="="+encodeURIComponent(String(He[$]))),h.push(pe)}}return this.i=h.join("&")};function Uo(h,g){return g=String(g),h.j&&(g=g.toLowerCase()),g}function BT(h,g){g&&!h.j&&(Bs(h),h.i=null,h.g.forEach(function(R,$){var pe=$.toLowerCase();$!=pe&&(q0(this,$),W0(this,pe,R))},h)),h.j=g}function FT(h,g){const R=new ke;if(a.Image){const $=new Image;$.onload=m(Fs,R,"TestLoadImage: loaded",!0,g,$),$.onerror=m(Fs,R,"TestLoadImage: error",!1,g,$),$.onabort=m(Fs,R,"TestLoadImage: abort",!1,g,$),$.ontimeout=m(Fs,R,"TestLoadImage: timeout",!1,g,$),a.setTimeout(function(){$.ontimeout&&$.ontimeout()},1e4),$.src=h}else g(!1)}function UT(h,g){const R=new ke,$=new AbortController,pe=setTimeout(()=>{$.abort(),Fs(R,"TestPingServer: timeout",!1,g)},1e4);fetch(h,{signal:$.signal}).then(we=>{clearTimeout(pe),we.ok?Fs(R,"TestPingServer: ok",!0,g):Fs(R,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(pe),Fs(R,"TestPingServer: error",!1,g)})}function Fs(h,g,R,$,pe){try{pe&&(pe.onload=null,pe.onerror=null,pe.onabort=null,pe.ontimeout=null),$(R)}catch{}}function HT(){this.g=new G}function jT(h,g,R){const $=R||"";try{_n(h,function(pe,we){let He=pe;c(pe)&&(He=te(pe)),g.push($+we+"="+encodeURIComponent(He))})}catch(pe){throw g.push($+"type="+encodeURIComponent("_badmap")),pe}}function nl(h){this.l=h.Ub||null,this.j=h.eb||!1}_(nl,ae),nl.prototype.g=function(){return new Uc(this.l,this.j)},nl.prototype.i=function(h){return function(){return h}}({});function Uc(h,g){Te.call(this),this.D=h,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}_(Uc,Te),n=Uc.prototype,n.open=function(h,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=g,this.readyState=1,sl(this)},n.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(g.body=h),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,rl(this)),this.readyState=0},n.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,sl(this)),this.g&&(this.readyState=3,sl(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;G0(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function G0(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}n.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var g=h.value?h.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!h.done}))&&(this.response=this.responseText+=g)}h.done?rl(this):sl(this),this.readyState==3&&G0(this)}},n.Ra=function(h){this.g&&(this.response=this.responseText=h,rl(this))},n.Qa=function(h){this.g&&(this.response=h,rl(this))},n.ga=function(){this.g&&rl(this)};function rl(h){h.readyState=4,h.l=null,h.j=null,h.v=null,sl(h)}n.setRequestHeader=function(h,g){this.u.append(h,g)},n.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],g=this.h.entries();for(var R=g.next();!R.done;)R=R.value,h.push(R[0]+": "+R[1]),R=g.next();return h.join(`\r
`)};function sl(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Uc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function Y0(h){let g="";return k(h,function(R,$){g+=$,g+=":",g+=R,g+=`\r
`}),g}function xf(h,g,R){e:{for($ in R){var $=!1;break e}$=!0}$||(R=Y0(R),typeof h=="string"?R!=null&&encodeURIComponent(String(R)):It(h,g,R))}function jt(h){Te.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}_(jt,Te);var zT=/^https?$/i,$T=["POST","PUT"];n=jt.prototype,n.Ha=function(h){this.J=h},n.ea=function(h,g,R,$){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);g=g?g.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Dt.g(),this.v=this.o?ue(this.o):ue(Dt),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(g,String(h),!0),this.B=!1}catch(we){X0(this,we);return}if(h=R||"",R=new Map(this.headers),$)if(Object.getPrototypeOf($)===Object.prototype)for(var pe in $)R.set(pe,$[pe]);else if(typeof $.keys=="function"&&typeof $.get=="function")for(const we of $.keys())R.set(we,$.get(we));else throw Error("Unknown input type for opt_headers: "+String($));$=Array.from(R.keys()).find(we=>we.toLowerCase()=="content-type"),pe=a.FormData&&h instanceof a.FormData,!(0<=Array.prototype.indexOf.call($T,g,void 0))||$||pe||R.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[we,He]of R)this.g.setRequestHeader(we,He);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Z0(this),this.u=!0,this.g.send(h),this.u=!1}catch(we){X0(this,we)}};function X0(h,g){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=g,h.m=5,Q0(h),Hc(h)}function Q0(h){h.A||(h.A=!0,Ne(h,"complete"),Ne(h,"error"))}n.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,Ne(this,"complete"),Ne(this,"abort"),Hc(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Hc(this,!0)),jt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?J0(this):this.bb())},n.bb=function(){J0(this)};function J0(h){if(h.h&&typeof o<"u"&&(!h.v[1]||hs(h)!=4||h.Z()!=2)){if(h.u&&hs(h)==4)Ie(h.Ea,0,h);else if(Ne(h,"readystatechange"),hs(h)==4){h.h=!1;try{const He=h.Z();e:switch(He){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var R;if(!(R=g)){var $;if($=He===0){var pe=String(h.D).match(Ds)[1]||null;!pe&&a.self&&a.self.location&&(pe=a.self.location.protocol.slice(0,-1)),$=!zT.test(pe?pe.toLowerCase():"")}R=$}if(R)Ne(h,"complete"),Ne(h,"success");else{h.m=6;try{var we=2<hs(h)?h.g.statusText:""}catch{we=""}h.l=we+" ["+h.Z()+"]",Q0(h)}}finally{Hc(h)}}}}function Hc(h,g){if(h.g){Z0(h);const R=h.g,$=h.v[0]?()=>{}:null;h.g=null,h.v=null,g||Ne(h,"ready");try{R.onreadystatechange=$}catch{}}}function Z0(h){h.I&&(a.clearTimeout(h.I),h.I=null)}n.isActive=function(){return!!this.g};function hs(h){return h.g?h.g.readyState:0}n.Z=function(){try{return 2<hs(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(h){if(this.g){var g=this.g.responseText;return h&&g.indexOf(h)==0&&(g=g.substring(h.length)),se(g)}};function e1(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function qT(h){const g={};h=(h.g&&2<=hs(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let $=0;$<h.length;$++){if(w(h[$]))continue;var R=M(h[$]);const pe=R[0];if(R=R[1],typeof R!="string")continue;R=R.trim();const we=g[pe]||[];g[pe]=we,we.push(R)}S(g,function($){return $.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function il(h,g,R){return R&&R.internalChannelParams&&R.internalChannelParams[h]||g}function t1(h){this.Aa=0,this.i=[],this.j=new ke,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=il("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=il("baseRetryDelayMs",5e3,h),this.cb=il("retryDelaySeedMs",1e4,h),this.Wa=il("forwardChannelMaxRetries",2,h),this.wa=il("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Vo(h&&h.concurrentRequestLimit),this.Da=new HT,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=t1.prototype,n.la=8,n.G=1,n.connect=function(h,g,R,$){Xe(0),this.W=h,this.H=g||{},R&&$!==void 0&&(this.H.OSID=R,this.H.OAID=$),this.F=this.X,this.I=u1(this,null,this.W),zc(this)};function Mf(h){if(n1(h),h.G==3){var g=h.U++,R=yn(h.I);if(It(R,"SID",h.K),It(R,"RID",g),It(R,"TYPE","terminate"),ol(h,R),g=new Ft(h,h.j,g),g.L=2,g.v=us(yn(R)),R=!1,a.navigator&&a.navigator.sendBeacon)try{R=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!R&&a.Image&&(new Image().src=g.v,R=!0),R||(g.g=h1(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Os(g)}c1(h)}function jc(h){h.g&&(Of(h),h.g.cancel(),h.g=null)}function n1(h){jc(h),h.u&&(a.clearTimeout(h.u),h.u=null),$c(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&a.clearTimeout(h.s),h.s=null)}function zc(h){if(!Bo(h.h)&&!h.s){h.s=!0;var g=h.Ga;ne||J(),Q||(ne(),Q=!0),ce.add(g,h),h.B=0}}function KT(h,g){return Ya(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=g.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=je(d(h.Ga,h,g),l1(h,h.B)),h.B++,!0)}n.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const pe=new Ft(this,this.j,h);let we=this.o;if(this.S&&(we?(we=b(we),T(we,this.S)):we=this.S),this.m!==null||this.O||(pe.H=we,we=null),this.P)e:{for(var g=0,R=0;R<this.i.length;R++){t:{var $=this.i[R];if("__data__"in $.map&&($=$.map.__data__,typeof $=="string")){$=$.length;break t}$=void 0}if($===void 0)break;if(g+=$,4096<g){g=R;break e}if(g===4096||R===this.i.length-1){g=R+1;break e}}g=1e3}else g=1e3;g=s1(this,pe,g),R=yn(this.I),It(R,"RID",h),It(R,"CVER",22),this.D&&It(R,"X-HTTP-Session-Id",this.D),ol(this,R),we&&(this.O?g="headers="+encodeURIComponent(String(Y0(we)))+"&"+g:this.m&&xf(R,this.m,we)),Xa(this.h,pe),this.Ua&&It(R,"TYPE","init"),this.P?(It(R,"$req",g),It(R,"SID","null"),pe.T=!0,zn(pe,R,null)):zn(pe,R,g),this.G=2}}else this.G==3&&(h?r1(this,h):this.i.length==0||Bo(this.h)||r1(this))};function r1(h,g){var R;g?R=g.l:R=h.U++;const $=yn(h.I);It($,"SID",h.K),It($,"RID",R),It($,"AID",h.T),ol(h,$),h.m&&h.o&&xf($,h.m,h.o),R=new Ft(h,h.j,R,h.B+1),h.m===null&&(R.H=h.o),g&&(h.i=g.D.concat(h.i)),g=s1(h,R,1e3),R.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Xa(h.h,R),zn(R,$,g)}function ol(h,g){h.H&&k(h.H,function(R,$){It(g,$,R)}),h.l&&_n({},function(R,$){It(g,$,R)})}function s1(h,g,R){R=Math.min(h.i.length,R);var $=h.l?d(h.l.Na,h.l,h):null;e:{var pe=h.i;let we=-1;for(;;){const He=["count="+R];we==-1?0<R?(we=pe[0].g,He.push("ofs="+we)):we=0:He.push("ofs="+we);let Ot=!0;for(let bn=0;bn<R;bn++){let St=pe[bn].g;const xn=pe[bn].map;if(St-=we,0>St)we=Math.max(0,pe[bn].g-100),Ot=!1;else try{jT(xn,He,"req"+St+"_")}catch{$&&$(xn)}}if(Ot){$=He.join("&");break e}}}return h=h.i.splice(0,R),g.D=h,$}function i1(h){if(!h.g&&!h.u){h.Y=1;var g=h.Fa;ne||J(),Q||(ne(),Q=!0),ce.add(g,h),h.v=0}}function Pf(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=je(d(h.Fa,h),l1(h,h.v)),h.v++,!0)}n.Fa=function(){if(this.u=null,o1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=je(d(this.ab,this),h)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Xe(10),jc(this),o1(this))};function Of(h){h.A!=null&&(a.clearTimeout(h.A),h.A=null)}function o1(h){h.g=new Ft(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var g=yn(h.qa);It(g,"RID","rpc"),It(g,"SID",h.K),It(g,"AID",h.T),It(g,"CI",h.F?"0":"1"),!h.F&&h.ja&&It(g,"TO",h.ja),It(g,"TYPE","xmlhttp"),ol(h,g),h.m&&h.o&&xf(g,h.m,h.o),h.L&&(h.g.I=h.L);var R=h.g;h=h.ia,R.L=1,R.v=us(yn(g)),R.m=null,R.P=!0,on(R,h)}n.Za=function(){this.C!=null&&(this.C=null,jc(this),Pf(this),Xe(19))};function $c(h){h.C!=null&&(a.clearTimeout(h.C),h.C=null)}function a1(h,g){var R=null;if(h.g==g){$c(h),Of(h),h.g=null;var $=2}else if(ls(h.h,g))R=g.D,Xt(h.h,g),$=1;else return;if(h.G!=0){if(g.o)if($==1){R=g.m?g.m.length:0,g=Date.now()-g.F;var pe=h.B;$=Ce(),Ne($,new xe($,R)),zc(h)}else i1(h);else if(pe=g.s,pe==3||pe==0&&0<g.X||!($==1&&KT(h,g)||$==2&&Pf(h)))switch(R&&0<R.length&&(g=h.h,g.i=g.i.concat(R)),pe){case 1:Ui(h,5);break;case 4:Ui(h,10);break;case 3:Ui(h,6);break;default:Ui(h,2)}}}function l1(h,g){let R=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(R*=2),R*g}function Ui(h,g){if(h.j.info("Error code "+g),g==2){var R=d(h.fb,h),$=h.Xa;const pe=!$;$=new Ir($||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Ls($,"https"),us($),pe?FT($.toString(),R):UT($.toString(),R)}else Xe(2);h.G=0,h.l&&h.l.sa(g),c1(h),n1(h)}n.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Xe(2)):(this.j.info("Failed to ping google.com"),Xe(1))};function c1(h){if(h.G=0,h.ka=[],h.l){const g=Fo(h.h);(g.length!=0||h.i.length!=0)&&(O(h.ka,g),O(h.ka,h.i),h.h.i.length=0,D(h.i),h.i.length=0),h.l.ra()}}function u1(h,g,R){var $=R instanceof Ir?yn(R):new Ir(R);if($.g!="")g&&($.g=g+"."+$.g),Fr($,$.s);else{var pe=a.location;$=pe.protocol,g=g?g+"."+pe.hostname:pe.hostname,pe=+pe.port;var we=new Ir(null);$&&Ls(we,$),g&&(we.g=g),pe&&Fr(we,pe),R&&(we.l=R),$=we}return R=h.D,g=h.ya,R&&g&&It($,R,g),It($,"VER",h.la),ol(h,$),$}function h1(h,g,R){if(g&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=h.Ca&&!h.pa?new jt(new nl({eb:R})):new jt(h.pa),g.Ha(h.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function f1(){}n=f1.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function qc(){}qc.prototype.g=function(h,g){return new lr(h,g)};function lr(h,g){Te.call(this),this.g=new t1(g),this.l=h,this.h=g&&g.messageUrlParams||null,h=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(h?h["X-WebChannel-Content-Type"]=g.messageContentType:h={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(h?h["X-WebChannel-Client-Profile"]=g.va:h={"X-WebChannel-Client-Profile":g.va}),this.g.S=h,(h=g&&g.Sb)&&!w(h)&&(this.g.m=h),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!w(g)&&(this.g.D=g,h=this.h,h!==null&&g in h&&(h=this.h,g in h&&delete h[g])),this.j=new Ho(this)}_(lr,Te),lr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},lr.prototype.close=function(){Mf(this.g)},lr.prototype.o=function(h){var g=this.g;if(typeof h=="string"){var R={};R.__data__=h,h=R}else this.u&&(R={},R.__data__=te(h),h=R);g.i.push(new Fc(g.Ya++,h)),g.G==3&&zc(g)},lr.prototype.N=function(){this.g.l=null,delete this.j,Mf(this.g),delete this.g,lr.aa.N.call(this)};function d1(h){de.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var g=h.__sm__;if(g){e:{for(const R in g){h=R;break e}h=void 0}(this.i=h)&&(h=this.i,g=g!==null&&h in g?g[h]:void 0),this.data=g}else this.data=h}_(d1,de);function p1(){be.call(this),this.status=1}_(p1,be);function Ho(h){this.g=h}_(Ho,f1),Ho.prototype.ua=function(){Ne(this.g,"a")},Ho.prototype.ta=function(h){Ne(this.g,new d1(h))},Ho.prototype.sa=function(h){Ne(this.g,new p1)},Ho.prototype.ra=function(){Ne(this.g,"b")},qc.prototype.createWebChannel=qc.prototype.g,lr.prototype.send=lr.prototype.o,lr.prototype.open=lr.prototype.m,lr.prototype.close=lr.prototype.close,Xv=function(){return new qc},Yv=function(){return Ce()},Gv=Le,fp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Rt.NO_ERROR=0,Rt.TIMEOUT=8,Rt.HTTP_ERROR=6,ku=Rt,Rn.COMPLETE="complete",Wv=Rn,oe.EventType=ye,ye.OPEN="a",ye.CLOSE="b",ye.ERROR="c",ye.MESSAGE="d",Te.prototype.listen=Te.prototype.K,_l=oe,Kv=nl,jt.prototype.listenOnce=jt.prototype.L,jt.prototype.getLastError=jt.prototype.Ka,jt.prototype.getLastErrorCode=jt.prototype.Ba,jt.prototype.getStatus=jt.prototype.Z,jt.prototype.getResponseJson=jt.prototype.Oa,jt.prototype.getResponseText=jt.prototype.oa,jt.prototype.send=jt.prototype.ea,jt.prototype.setWithCredentials=jt.prototype.Ha,qv=jt}).apply(typeof nu<"u"?nu:typeof self<"u"?self:typeof window<"u"?window:{});const e_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Dn.UNAUTHENTICATED=new Dn(null),Dn.GOOGLE_CREDENTIALS=new Dn("google-credentials-uid"),Dn.FIRST_PARTY=new Dn("first-party-uid"),Dn.MOCK_USER=new Dn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fa="10.12.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo=new vm("@firebase/firestore");function cl(){return Eo.logLevel}function Ye(n,...e){if(Eo.logLevel<=gt.DEBUG){const t=e.map(Nm);Eo.debug(`Firestore (${Fa}): ${n}`,...t)}}function Is(n,...e){if(Eo.logLevel<=gt.ERROR){const t=e.map(Nm);Eo.error(`Firestore (${Fa}): ${n}`,...t)}}function Ta(n,...e){if(Eo.logLevel<=gt.WARN){const t=e.map(Nm);Eo.warn(`Firestore (${Fa}): ${n}`,...t)}}function Nm(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function st(n="Unexpected state"){const e=`FIRESTORE (${Fa}) INTERNAL ASSERTION FAILED: `+n;throw Is(e),new Error(e)}function Nt(n,e){n||st()}function ut(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Me={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class qe extends as{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Bk{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Dn.UNAUTHENTICATED))}shutdown(){}}class Fk{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class Uk{constructor(e){this.t=e,this.currentUser=Dn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new Es;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Es,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Es)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Nt(typeof r.accessToken=="string"),new Qv(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Nt(e===null||typeof e=="string"),new Dn(e)}}class Hk{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Dn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class jk{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Hk(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Dn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zk{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class $k{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=i=>{i.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,Ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Nt(typeof t.token=="string"),this.R=t.token,new zk(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jv{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=qk(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function At(n,e){return n<e?-1:n>e?1:0}function Sa(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new qe(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new qe(Me.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new qe(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new qe(Me.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return cn.fromMillis(Date.now())}static fromDate(e){return cn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new cn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e){this.timestamp=e}static fromTimestamp(e){return new at(e)}static min(){return new at(new cn(0,0))}static max(){return new at(new cn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc{constructor(e,t,r){t===void 0?t=0:t>e.length&&st(),r===void 0?r=e.length-t:r>e.length-t&&st(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return tc.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof tc?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Vt extends tc{construct(e,t,r){return new Vt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new qe(Me.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new Vt(t)}static emptyPath(){return new Vt([])}}const Kk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Sn extends tc{construct(e,t,r){return new Sn(e,t,r)}static isValidIdentifier(e){return Kk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Sn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Sn(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new qe(Me.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new qe(Me.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new qe(Me.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new qe(Me.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Sn(t)}static emptyPath(){return new Sn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e){this.path=e}static fromPath(e){return new Ze(Vt.fromString(e))}static fromName(e){return new Ze(Vt.fromString(e).popFirst(5))}static empty(){return new Ze(Vt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Vt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Vt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ze(new Vt(e.slice()))}}function Wk(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=at.fromTimestamp(r===1e9?new cn(t+1,0):new cn(t,r));return new ki(s,Ze.empty(),e)}function Gk(n){return new ki(n.readTime,n.key,-1)}class ki{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ki(at.min(),Ze.empty(),-1)}static max(){return new ki(at.max(),Ze.empty(),-1)}}function Yk(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=Ze.comparator(n.documentKey,e.documentKey),t!==0?t:At(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xk="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Qk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ac(n){if(n.code!==Me.FAILED_PRECONDITION||n.message!==Xk)throw n;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&st(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ve((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Ve?t:Ve.resolve(t)}catch(t){return Ve.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Ve.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Ve.reject(t)}static resolve(e){return new Ve((t,r)=>{t(e)})}static reject(e){return new Ve((t,r)=>{r(e)})}static waitFor(e){return new Ve((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=Ve.resolve(!1);for(const r of e)t=t.next(s=>s?Ve.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new Ve((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(u=>{o[c]=u,++a,a===i&&r(o)},u=>s(u))}})}static doWhile(e,t){return new Ve((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function Jk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ic(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dm{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Dm.oe=-1;function Qh(n){return n==null}function th(n){return n===0&&1/n==-1/0}function Zk(n){return typeof n=="number"&&Number.isInteger(n)&&!th(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t_(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Mo(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Zv(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ht{constructor(e,t){this.comparator=e,this.root=t||En.EMPTY}insert(e,t){return new Ht(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new Ht(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ru(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ru(this.root,e,this.comparator,!1)}getReverseIterator(){return new ru(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ru(this.root,e,this.comparator,!0)}}class ru{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??En.RED,this.left=s??En.EMPTY,this.right=i??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new En(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return En.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw st();const e=this.left.check();if(e!==this.right.check())throw st();return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw st()}get value(){throw st()}get color(){throw st()}get left(){throw st()}get right(){throw st()}copy(e,t,r,s,i){return this}insert(e,t,r){return new En(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e){this.comparator=e,this.data=new Ht(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new n_(this.data.getIterator())}getIteratorFrom(e){return new n_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof An)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new An(this.comparator);return t.data=e,t}}class n_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dr{constructor(e){this.fields=e,e.sort(Sn.comparator)}static empty(){return new dr([])}unionWith(e){let t=new An(Sn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new dr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Sa(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new eE("Invalid base64 string: "+i):i}}(e);return new Bn(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Bn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Bn.EMPTY_BYTE_STRING=new Bn("");const e9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ci(n){if(Nt(!!n),typeof n=="string"){let e=0;const t=e9.exec(n);if(Nt(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:en(n.seconds),nanos:en(n.nanos)}}function en(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function wo(n){return typeof n=="string"?Bn.fromBase64String(n):Bn.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lm(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Vm(n){const e=n.mapValue.fields.__previous_value__;return Lm(e)?Vm(e):e}function nc(n){const e=Ci(n.mapValue.fields.__local_write_time__.timestampValue);return new cn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{constructor(e,t,r,s,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class rc{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new rc("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof rc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function To(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Lm(n)?4:n9(n)?9007199254740991:10:st()}function ns(n,e){if(n===e)return!0;const t=To(n);if(t!==To(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return nc(n).isEqual(nc(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ci(s.timestampValue),a=Ci(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return wo(s.bytesValue).isEqual(wo(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return en(s.geoPointValue.latitude)===en(i.geoPointValue.latitude)&&en(s.geoPointValue.longitude)===en(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return en(s.integerValue)===en(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=en(s.doubleValue),a=en(i.doubleValue);return o===a?th(o)===th(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Sa(n.arrayValue.values||[],e.arrayValue.values||[],ns);case 10:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(t_(o)!==t_(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!ns(o[l],a[l])))return!1;return!0}(n,e);default:return st()}}function sc(n,e){return(n.values||[]).find(t=>ns(t,e))!==void 0}function Aa(n,e){if(n===e)return 0;const t=To(n),r=To(e);if(t!==r)return At(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return At(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=en(i.integerValue||i.doubleValue),l=en(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return r_(n.timestampValue,e.timestampValue);case 4:return r_(nc(n),nc(e));case 5:return At(n.stringValue,e.stringValue);case 6:return function(i,o){const a=wo(i),l=wo(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const u=At(a[c],l[c]);if(u!==0)return u}return At(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=At(en(i.latitude),en(o.latitude));return a!==0?a:At(en(i.longitude),en(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,o){const a=i.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){const u=Aa(a[c],l[c]);if(u)return u}return At(a.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===su.mapValue&&o===su.mapValue)return 0;if(i===su.mapValue)return 1;if(o===su.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},u=Object.keys(c);l.sort(),u.sort();for(let f=0;f<l.length&&f<u.length;++f){const d=At(l[f],u[f]);if(d!==0)return d;const m=Aa(a[l[f]],c[u[f]]);if(m!==0)return m}return At(l.length,u.length)}(n.mapValue,e.mapValue);default:throw st()}}function r_(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return At(n,e);const t=Ci(n),r=Ci(e),s=At(t.seconds,r.seconds);return s!==0?s:At(t.nanos,r.nanos)}function Ia(n){return dp(n)}function dp(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Ci(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return wo(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return Ze.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=dp(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${dp(t.fields[o])}`;return s+"}"}(n.mapValue):st()}function s_(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function pp(n){return!!n&&"integerValue"in n}function Bm(n){return!!n&&"arrayValue"in n}function i_(n){return!!n&&"nullValue"in n}function o_(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Cu(n){return!!n&&"mapValue"in n}function Dl(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Mo(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Dl(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Dl(n.arrayValue.values[t]);return e}return Object.assign({},n)}function n9(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e){this.value=e}static empty(){return new tr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Cu(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dl(t)}setAll(e){let t=Sn.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=Dl(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());Cu(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ns(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Cu(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){Mo(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new tr(Dl(this.value))}}function tE(n){const e=[];return Mo(n.fields,(t,r)=>{const s=new Sn([t]);if(Cu(r)){const i=tE(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new dr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ln{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ln(e,0,at.min(),at.min(),at.min(),tr.empty(),0)}static newFoundDocument(e,t,r,s){return new Ln(e,1,t,at.min(),r,s,0)}static newNoDocument(e,t){return new Ln(e,2,t,at.min(),at.min(),tr.empty(),0)}static newUnknownDocument(e,t){return new Ln(e,3,t,at.min(),at.min(),tr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(at.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=tr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=tr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=at.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ln&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ln(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,t){this.position=e,this.inclusive=t}}function a_(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=Ze.comparator(Ze.fromName(o.referenceValue),t.key):r=Aa(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function l_(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ns(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rh{constructor(e,t="asc"){this.field=e,this.dir=t}}function r9(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{}class tn extends nE{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new i9(e,t,r):t==="array-contains"?new l9(e,r):t==="in"?new c9(e,r):t==="not-in"?new u9(e,r):t==="array-contains-any"?new h9(e,r):new tn(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new o9(e,r):new a9(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Aa(t,this.value)):t!==null&&To(this.value)===To(t)&&this.matchesComparison(Aa(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return st()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Lr extends nE{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Lr(e,t)}matches(e){return rE(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function rE(n){return n.op==="and"}function sE(n){return s9(n)&&rE(n)}function s9(n){for(const e of n.filters)if(e instanceof Lr)return!1;return!0}function mp(n){if(n instanceof tn)return n.field.canonicalString()+n.op.toString()+Ia(n.value);if(sE(n))return n.filters.map(e=>mp(e)).join(",");{const e=n.filters.map(t=>mp(t)).join(",");return`${n.op}(${e})`}}function iE(n,e){return n instanceof tn?function(r,s){return s instanceof tn&&r.op===s.op&&r.field.isEqual(s.field)&&ns(r.value,s.value)}(n,e):n instanceof Lr?function(r,s){return s instanceof Lr&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&iE(o,s.filters[a]),!0):!1}(n,e):void st()}function oE(n){return n instanceof tn?function(t){return`${t.field.canonicalString()} ${t.op} ${Ia(t.value)}`}(n):n instanceof Lr?function(t){return t.op.toString()+" {"+t.getFilters().map(oE).join(" ,")+"}"}(n):"Filter"}class i9 extends tn{constructor(e,t,r){super(e,t,r),this.key=Ze.fromName(r.referenceValue)}matches(e){const t=Ze.comparator(e.key,this.key);return this.matchesComparison(t)}}class o9 extends tn{constructor(e,t){super(e,"in",t),this.keys=aE("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class a9 extends tn{constructor(e,t){super(e,"not-in",t),this.keys=aE("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function aE(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>Ze.fromName(r.referenceValue))}class l9 extends tn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Bm(t)&&sc(t.arrayValue,this.value)}}class c9 extends tn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&sc(this.value.arrayValue,t)}}class u9 extends tn{constructor(e,t){super(e,"not-in",t)}matches(e){if(sc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!sc(this.value.arrayValue,t)}}class h9 extends tn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Bm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>sc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function c_(n,e=null,t=[],r=[],s=null,i=null,o=null){return new f9(n,e,t,r,s,i,o)}function Fm(n){const e=ut(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>mp(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Qh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Ia(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Ia(r)).join(",")),e.ue=t}return e.ue}function Um(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!r9(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!iE(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!l_(n.startAt,e.startAt)&&l_(n.endAt,e.endAt)}function gp(n){return Ze.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rc{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function d9(n,e,t,r,s,i,o,a){return new Rc(n,e,t,r,s,i,o,a)}function Hm(n){return new Rc(n)}function u_(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function lE(n){return n.collectionGroup!==null}function Ll(n){const e=ut(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new An(Sn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new rh(i,r))}),t.has(Sn.keyField().canonicalString())||e.ce.push(new rh(Sn.keyField(),r))}return e.ce}function Zr(n){const e=ut(n);return e.le||(e.le=p9(e,Ll(n))),e.le}function p9(n,e){if(n.limitType==="F")return c_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new rh(s.field,i)});const t=n.endAt?new nh(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new nh(n.startAt.position,n.startAt.inclusive):null;return c_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function _p(n,e){const t=n.filters.concat([e]);return new Rc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function yp(n,e,t){return new Rc(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Jh(n,e){return Um(Zr(n),Zr(e))&&n.limitType===e.limitType}function cE(n){return`${Fm(Zr(n))}|lt:${n.limitType}`}function Qo(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>oE(s)).join(", ")}]`),Qh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Ia(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Ia(s)).join(",")),`Target(${r})`}(Zr(n))}; limitType=${n.limitType})`}function Zh(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ze.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of Ll(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=a_(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Ll(r),s)||r.endAt&&!function(o,a,l){const c=a_(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Ll(r),s))}(n,e)}function m9(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function uE(n){return(e,t)=>{let r=!1;for(const s of Ll(n)){const i=g9(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function g9(n,e,t){const r=n.field.isKeyField()?Ze.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Aa(l,c):st()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return st()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Mo(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return Zv(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _9=new Ht(Ze.comparator);function Rs(){return _9}const hE=new Ht(Ze.comparator);function yl(...n){let e=hE;for(const t of n)e=e.insert(t.key,t);return e}function fE(n){let e=hE;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function no(){return Vl()}function dE(){return Vl()}function Vl(){return new Ua(n=>n.toString(),(n,e)=>n.isEqual(e))}const y9=new Ht(Ze.comparator),b9=new An(Ze.comparator);function mt(...n){let e=b9;for(const t of n)e=e.add(t);return e}const v9=new An(At);function E9(){return v9}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:th(e)?"-0":e}}function mE(n){return{integerValue:""+n}}function w9(n,e){return Zk(e)?mE(e):pE(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef{constructor(){this._=void 0}}function T9(n,e,t){return n instanceof sh?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Lm(i)&&(i=Vm(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof ic?_E(n,e):n instanceof oc?yE(n,e):function(s,i){const o=gE(s,i),a=h_(o)+h_(s.Pe);return pp(o)&&pp(s.Pe)?mE(a):pE(s.serializer,a)}(n,e)}function S9(n,e,t){return n instanceof ic?_E(n,e):n instanceof oc?yE(n,e):t}function gE(n,e){return n instanceof ih?function(r){return pp(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class sh extends ef{}class ic extends ef{constructor(e){super(),this.elements=e}}function _E(n,e){const t=bE(e);for(const r of n.elements)t.some(s=>ns(s,r))||t.push(r);return{arrayValue:{values:t}}}class oc extends ef{constructor(e){super(),this.elements=e}}function yE(n,e){let t=bE(e);for(const r of n.elements)t=t.filter(s=>!ns(s,r));return{arrayValue:{values:t}}}class ih extends ef{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function h_(n){return en(n.integerValue||n.doubleValue)}function bE(n){return Bm(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function A9(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof ic&&s instanceof ic||r instanceof oc&&s instanceof oc?Sa(r.elements,s.elements,ns):r instanceof ih&&s instanceof ih?ns(r.Pe,s.Pe):r instanceof sh&&s instanceof sh}(n.transform,e.transform)}class I9{constructor(e,t){this.version=e,this.transformResults=t}}class Pr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Pr}static exists(e){return new Pr(void 0,e)}static updateTime(e){return new Pr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xu(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class tf{}function vE(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new jm(n.key,Pr.none()):new kc(n.key,n.data,Pr.none());{const t=n.data,r=tr.empty();let s=new An(Sn.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Di(n.key,r,new dr(s.toArray()),Pr.none())}}function R9(n,e,t){n instanceof kc?function(s,i,o){const a=s.value.clone(),l=d_(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Di?function(s,i,o){if(!xu(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=d_(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(EE(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Bl(n,e,t,r){return n instanceof kc?function(i,o,a,l){if(!xu(i.precondition,o))return a;const c=i.value.clone(),u=p_(i.fieldTransforms,l,o);return c.setAll(u),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof Di?function(i,o,a,l){if(!xu(i.precondition,o))return a;const c=p_(i.fieldTransforms,l,o),u=o.data;return u.setAll(EE(i)),u.setAll(c),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(n,e,t,r):function(i,o,a){return xu(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function k9(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=gE(r.transform,s||null);i!=null&&(t===null&&(t=tr.empty()),t.set(r.field,i))}return t||null}function f_(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Sa(r,s,(i,o)=>A9(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class kc extends tf{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Di extends tf{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function EE(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function d_(n,e,t){const r=new Map;Nt(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,S9(o,a,t[s]))}return r}function p_(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,T9(i,o,e))}return r}class jm extends tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class C9 extends tf{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x9{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&R9(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Bl(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Bl(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=dE();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=vE(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(at.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),mt())}isEqual(e){return this.batchId===e.batchId&&Sa(this.mutations,e.mutations,(t,r)=>f_(t,r))&&Sa(this.baseMutations,e.baseMutations,(t,r)=>f_(t,r))}}class zm{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Nt(e.mutations.length===r.length);let s=function(){return y9}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new zm(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M9{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P9{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zt,_t;function O9(n){switch(n){default:return st();case Me.CANCELLED:case Me.UNKNOWN:case Me.DEADLINE_EXCEEDED:case Me.RESOURCE_EXHAUSTED:case Me.INTERNAL:case Me.UNAVAILABLE:case Me.UNAUTHENTICATED:return!1;case Me.INVALID_ARGUMENT:case Me.NOT_FOUND:case Me.ALREADY_EXISTS:case Me.PERMISSION_DENIED:case Me.FAILED_PRECONDITION:case Me.ABORTED:case Me.OUT_OF_RANGE:case Me.UNIMPLEMENTED:case Me.DATA_LOSS:return!0}}function wE(n){if(n===void 0)return Is("GRPC error has no .code"),Me.UNKNOWN;switch(n){case Zt.OK:return Me.OK;case Zt.CANCELLED:return Me.CANCELLED;case Zt.UNKNOWN:return Me.UNKNOWN;case Zt.DEADLINE_EXCEEDED:return Me.DEADLINE_EXCEEDED;case Zt.RESOURCE_EXHAUSTED:return Me.RESOURCE_EXHAUSTED;case Zt.INTERNAL:return Me.INTERNAL;case Zt.UNAVAILABLE:return Me.UNAVAILABLE;case Zt.UNAUTHENTICATED:return Me.UNAUTHENTICATED;case Zt.INVALID_ARGUMENT:return Me.INVALID_ARGUMENT;case Zt.NOT_FOUND:return Me.NOT_FOUND;case Zt.ALREADY_EXISTS:return Me.ALREADY_EXISTS;case Zt.PERMISSION_DENIED:return Me.PERMISSION_DENIED;case Zt.FAILED_PRECONDITION:return Me.FAILED_PRECONDITION;case Zt.ABORTED:return Me.ABORTED;case Zt.OUT_OF_RANGE:return Me.OUT_OF_RANGE;case Zt.UNIMPLEMENTED:return Me.UNIMPLEMENTED;case Zt.DATA_LOSS:return Me.DATA_LOSS;default:return st()}}(_t=Zt||(Zt={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N9(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=new co([4294967295,4294967295],0);function m_(n){const e=N9().encode(n),t=new $v;return t.update(e),new Uint8Array(t.digest())}function g_(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new co([t,r],0),new co([s,i],0)]}class $m{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new bl(`Invalid padding: ${t}`);if(r<0)throw new bl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bl(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new bl(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=co.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(co.fromNumber(r)));return s.compare(D9)===1&&(s=new co([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=m_(e),[r,s]=g_(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new $m(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=m_(e),[r,s]=g_(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class bl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Cc.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new nf(at.min(),s,new Ht(At),Rs(),mt())}}class Cc{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Cc(r,t,mt(),mt(),mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class TE{constructor(e,t){this.targetId=e,this.me=t}}class SE{constructor(e,t,r=Bn.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class __{constructor(){this.fe=0,this.ge=b_(),this.pe=Bn.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=mt(),t=mt(),r=mt();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:st()}}),new Cc(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=b_()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Nt(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class L9{constructor(e){this.Le=e,this.Be=new Map,this.ke=Rs(),this.qe=y_(),this.Qe=new Ht(At)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:st()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(gp(i))if(r===0){const o=new Ze(i.path);this.Ue(t,o,Ln.newNoDocument(o,at.min()))}else Nt(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=wo(r).toUint8Array()}catch(l){if(l instanceof eE)return Ta("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new $m(o,s,i)}catch(l){return Ta(l instanceof bl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&gp(a.target)){const l=new Ze(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Ln.newNoDocument(l,e))}i.be&&(t.set(o,i.Ce()),i.ve())}});let r=mt();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new nf(e,t,this.Qe,this.ke,r);return this.ke=Rs(),this.qe=y_(),this.Qe=new Ht(At),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new __,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new An(At),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||Ye("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new __),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function y_(){return new Ht(Ze.comparator)}function b_(){return new Ht(Ze.comparator)}const V9={asc:"ASCENDING",desc:"DESCENDING"},B9={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},F9={and:"AND",or:"OR"};class U9{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bp(n,e){return n.useProto3Json||Qh(e)?e:{value:e}}function oh(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function AE(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function H9(n,e){return oh(n,e.toTimestamp())}function es(n){return Nt(!!n),at.fromTimestamp(function(t){const r=Ci(t);return new cn(r.seconds,r.nanos)}(n))}function qm(n,e){return vp(n,e).canonicalString()}function vp(n,e){const t=function(s){return new Vt(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function IE(n){const e=Vt.fromString(n);return Nt(ME(e)),e}function Ep(n,e){return qm(n.databaseId,e.path)}function Zf(n,e){const t=IE(e);if(t.get(1)!==n.databaseId.projectId)throw new qe(Me.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new qe(Me.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Ze(kE(t))}function RE(n,e){return qm(n.databaseId,e)}function j9(n){const e=IE(n);return e.length===4?Vt.emptyPath():kE(e)}function wp(n){return new Vt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function kE(n){return Nt(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function v_(n,e,t){return{name:Ep(n,e),fields:t.value.mapValue.fields}}function z9(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:st()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,u){return c.useProto3Json?(Nt(u===void 0||typeof u=="string"),Bn.fromBase64String(u||"")):(Nt(u===void 0||u instanceof Buffer||u instanceof Uint8Array),Bn.fromUint8Array(u||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const u=c.code===void 0?Me.UNKNOWN:wE(c.code);return new qe(u,c.message||"")}(o);t=new SE(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Zf(n,r.document.name),i=es(r.document.updateTime),o=r.document.createTime?es(r.document.createTime):at.min(),a=new tr({mapValue:{fields:r.document.fields}}),l=Ln.newFoundDocument(s,i,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];t=new Mu(c,u,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Zf(n,r.document),i=r.readTime?es(r.readTime):at.min(),o=Ln.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Mu([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Zf(n,r.document),i=r.removedTargetIds||[];t=new Mu([],i,s,null)}else{if(!("filter"in e))return st();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new P9(s,i),a=r.targetId;t=new TE(a,o)}}return t}function $9(n,e){let t;if(e instanceof kc)t={update:v_(n,e.key,e.value)};else if(e instanceof jm)t={delete:Ep(n,e.key)};else if(e instanceof Di)t={update:v_(n,e.key,e.data),updateMask:Z9(e.fieldMask)};else{if(!(e instanceof C9))return st();t={verify:Ep(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof sh)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ic)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof oc)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof ih)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw st()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:H9(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:st()}(n,e.precondition)),t}function q9(n,e){return n&&n.length>0?(Nt(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?es(s.updateTime):es(i);return o.isEqual(at.min())&&(o=es(i)),new I9(o,s.transformResults||[])}(t,e))):[]}function K9(n,e){return{documents:[RE(n,e.path)]}}function W9(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=RE(n,s);const i=function(c){if(c.length!==0)return xE(Lr.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(u=>function(d){return{field:Jo(d.field),direction:X9(d.dir)}}(u))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=bp(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function G9(n){let e=j9(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Nt(r===1);const u=t.from[0];u.allDescendants?s=u.collectionId:e=e.child(u.collectionId)}let i=[];t.where&&(i=function(f){const d=CE(f);return d instanceof Lr&&sE(d)?d.getFilters():[d]}(t.where));let o=[];t.orderBy&&(o=function(f){return f.map(d=>function(_){return new rh(Zo(_.field),function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction))}(d))}(t.orderBy));let a=null;t.limit&&(a=function(f){let d;return d=typeof f=="object"?f.value:f,Qh(d)?null:d}(t.limit));let l=null;t.startAt&&(l=function(f){const d=!!f.before,m=f.values||[];return new nh(m,d)}(t.startAt));let c=null;return t.endAt&&(c=function(f){const d=!f.before,m=f.values||[];return new nh(m,d)}(t.endAt)),d9(e,s,o,i,a,"F",l,c)}function Y9(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return st()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function CE(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Zo(t.unaryFilter.field);return tn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Zo(t.unaryFilter.field);return tn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Zo(t.unaryFilter.field);return tn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Zo(t.unaryFilter.field);return tn.create(o,"!=",{nullValue:"NULL_VALUE"});default:return st()}}(n):n.fieldFilter!==void 0?function(t){return tn.create(Zo(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return st()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Lr.create(t.compositeFilter.filters.map(r=>CE(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return st()}}(t.compositeFilter.op))}(n):st()}function X9(n){return V9[n]}function Q9(n){return B9[n]}function J9(n){return F9[n]}function Jo(n){return{fieldPath:n.canonicalString()}}function Zo(n){return Sn.fromServerFormat(n.fieldPath)}function xE(n){return n instanceof tn?function(t){if(t.op==="=="){if(o_(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NAN"}};if(i_(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(o_(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NAN"}};if(i_(t.value))return{unaryFilter:{field:Jo(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jo(t.field),op:Q9(t.op),value:t.value}}}(n):n instanceof Lr?function(t){const r=t.getFilters().map(s=>xE(s));return r.length===1?r[0]:{compositeFilter:{op:J9(t.op),filters:r}}}(n):st()}function Z9(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function ME(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,t,r,s,i=at.min(),o=at.min(),a=Bn.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new hi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new hi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new hi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new hi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.ct=e}}function tC(n){const e=G9({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?yp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(){this._n=new rC}addToCollectionParentIndex(e,t){return this._n.add(t),Ve.resolve()}getCollectionParents(e,t){return Ve.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return Ve.resolve()}deleteFieldIndex(e,t){return Ve.resolve()}deleteAllFieldIndexes(e){return Ve.resolve()}createTargetIndexes(e,t){return Ve.resolve()}getDocumentsMatchingTarget(e,t){return Ve.resolve(null)}getIndexType(e,t){return Ve.resolve(0)}getFieldIndexes(e,t){return Ve.resolve([])}getNextCollectionGroupToUpdate(e){return Ve.resolve(null)}getMinOffset(e,t){return Ve.resolve(ki.min())}getMinOffsetFromCollectionGroup(e,t){return Ve.resolve(ki.min())}updateCollectionGroup(e,t,r){return Ve.resolve()}updateIndexEntries(e,t){return Ve.resolve()}}class rC{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new An(Vt.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new An(Vt.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Ra(0)}static Ln(){return new Ra(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{constructor(){this.changes=new Ua(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ln.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?Ve.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&Bl(r.mutation,s,dr.empty(),cn.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,mt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=mt()){const s=no();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=yl();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=no();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,mt()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=Rs();const o=Vl(),a=function(){return Vl()}();return t.forEach((l,c)=>{const u=r.get(c.key);s.has(c.key)&&(u===void 0||u.mutation instanceof Di)?i=i.insert(c.key,c):u!==void 0?(o.set(c.key,u.mutation.getFieldMask()),Bl(u.mutation,c,u.mutation.getFieldMask(),cn.now())):o.set(c.key,dr.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,u)=>o.set(c,u)),t.forEach((c,u)=>{var f;return a.set(c,new iC(u,(f=o.get(c))!==null&&f!==void 0?f:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Vl();let s=new Ht((o,a)=>o-a),i=mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let u=r.get(l)||dr.empty();u=a.applyToLocalView(c,u),r.set(l,u);const f=(s.get(a.batchId)||mt()).add(l);s=s.insert(a.batchId,f)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,u=l.value,f=dE();u.forEach(d=>{if(!i.has(d)){const m=vE(t.get(d),r.get(d));m!==null&&f.set(d,m),i=i.add(d)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,f))}return Ve.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return Ze.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):lE(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):Ve.resolve(no());let a=-1,l=i;return o.next(c=>Ve.forEach(c,(u,f)=>(a<f.largestBatchId&&(a=f.largestBatchId),i.get(u)?Ve.resolve():this.remoteDocumentCache.getEntry(e,u).next(d=>{l=l.insert(u,d)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,mt())).next(u=>({batchId:a,changes:fE(u)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ze(t)).next(r=>{let s=yl();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=yl();return this.indexManager.getCollectionParents(e,i).next(a=>Ve.forEach(a,l=>{const c=function(f,d){return new Rc(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(u=>{u.forEach((f,d)=>{o=o.insert(f,d)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const u=c.getKey();o.get(u)===null&&(o=o.insert(u,Ln.newInvalidDocument(u)))});let a=yl();return o.forEach((l,c)=>{const u=i.get(l);u!==void 0&&Bl(u.mutation,c,dr.empty(),cn.now()),Zh(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return Ve.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:es(s.createTime)}}(t)),Ve.resolve()}getNamedQuery(e,t){return Ve.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(s){return{name:s.name,query:tC(s.bundledQuery),readTime:es(s.readTime)}}(t)),Ve.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(){this.overlays=new Ht(Ze.comparator),this.hr=new Map}getOverlay(e,t){return Ve.resolve(this.overlays.get(t))}getOverlays(e,t){const r=no();return Ve.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),Ve.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.hr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.hr.delete(r)),Ve.resolve()}getOverlaysForCollection(e,t,r){const s=no(),i=t.length+1,o=new Ze(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return Ve.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Ht((c,u)=>c-u);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let u=i.get(c.largestBatchId);u===null&&(u=no(),i=i.insert(c.largestBatchId,u)),u.set(c.getKey(),c)}}const a=no(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,u)=>a.set(c,u)),!(a.size()>=s)););return Ve.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.hr.get(s.largestBatchId).delete(r.key);this.hr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new M9(t,r));let i=this.hr.get(t);i===void 0&&(i=mt(),this.hr.set(t,i)),this.hr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Km{constructor(){this.Pr=new An(hn.Ir),this.Tr=new An(hn.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const r=new hn(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new hn(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){const t=new Ze(new Vt([])),r=new hn(t,e),s=new hn(t,e+1),i=[];return this.Tr.forEachInRange([r,s],o=>{this.Ar(o),i.push(o.key)}),i}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new Ze(new Vt([])),r=new hn(t,e),s=new hn(t,e+1);let i=mt();return this.Tr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new hn(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class hn{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return Ze.comparator(e.key,t.key)||At(e.pr,t.pr)}static Er(e,t){return At(e.pr,t.pr)||Ze.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new An(hn.Ir)}checkEmpty(e){return Ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new x9(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.wr=this.wr.add(new hn(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return Ve.resolve(o)}lookupMutationBatch(e,t){return Ve.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.br(r),i=s<0?0:s;return Ve.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ve.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return Ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new hn(t,0),s=new hn(t,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([r,s],o=>{const a=this.Sr(o.pr);i.push(a)}),Ve.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new An(At);return t.forEach(s=>{const i=new hn(s,0),o=new hn(s,Number.POSITIVE_INFINITY);this.wr.forEachInRange([i,o],a=>{r=r.add(a.pr)})}),Ve.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;Ze.isDocumentKey(i)||(i=i.child(""));const o=new hn(new Ze(i),0);let a=new An(At);return this.wr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.pr)),!0)},o),Ve.resolve(this.Dr(a))}Dr(e){const t=[];return e.forEach(r=>{const s=this.Sr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Nt(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return Ve.forEach(t.mutations,s=>{const i=new hn(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){const r=new hn(t,0),s=this.wr.firstAfterOrEqual(r);return Ve.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ve.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.vr=e,this.docs=function(){return new Ht(Ze.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Ve.resolve(r?r.document.mutableCopy():Ln.newInvalidDocument(t))}getEntries(e,t){let r=Rs();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ln.newInvalidDocument(s))}),Ve.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=Rs();const o=t.path,a=new Ze(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:u}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Yk(Gk(u),r)<=0||(s.has(u.key)||Zh(t,u))&&(i=i.insert(u.key,u.mutableCopy()))}return Ve.resolve(i)}getAllFromCollectionGroup(e,t,r,s){st()}Fr(e,t){return Ve.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new hC(this)}getSize(e){return Ve.resolve(this.size)}}class hC extends sC{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.ar.addEntry(e,s)):this.ar.removeEntry(r)}),Ve.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e){this.persistence=e,this.Mr=new Ua(t=>Fm(t),Um),this.lastRemoteSnapshotVersion=at.min(),this.highestTargetId=0,this.Or=0,this.Nr=new Km,this.targetCount=0,this.Lr=Ra.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,s)=>t(s)),Ve.resolve()}getLastRemoteSnapshotVersion(e){return Ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ve.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),Ve.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),Ve.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Ra(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,Ve.resolve()}updateTargetData(e,t){return this.qn(t),Ve.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,Ve.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),Ve.waitFor(i).next(()=>s)}getTargetCount(e){return Ve.resolve(this.targetCount)}getTargetData(e,t){const r=this.Mr.get(t)||null;return Ve.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),Ve.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),Ve.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),Ve.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Nr.gr(t);return Ve.resolve(r)}containsKey(e,t){return Ve.resolve(this.Nr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,t){this.Br={},this.overlays={},this.kr=new Dm(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new fC(this),this.indexManager=new nC,this.remoteDocumentCache=function(s){return new uC(s)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new eC(t),this.$r=new aC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new lC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new cC(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){Ye("MemoryPersistence","Starting transaction:",e);const s=new pC(this.kr.next());return this.referenceDelegate.Ur(),r(s).next(i=>this.referenceDelegate.Wr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gr(e,t){return Ve.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class pC extends Qk{constructor(e){super(),this.currentSequenceNumber=e}}class Wm{constructor(e){this.persistence=e,this.zr=new Km,this.jr=null}static Hr(e){return new Wm(e)}get Jr(){if(this.jr)return this.jr;throw st()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),Ve.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),Ve.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),Ve.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(s=>this.Jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Jr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ve.forEach(this.Jr,r=>{const s=Ze.fromPath(r);return this.Yr(e,s).next(i=>{i||t.removeEntry(s,at.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return Ve.or([()=>Ve.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gm{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=s}static Ki(e,t){let r=mt(),s=mt();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new Gm(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return n5()?8:Jk(In())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ji(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Hi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new mC;return this.Ji(e,t,o).next(a=>{if(i.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>i.result)}Yi(e,t,r,s){return r.documentReadCount<this.Wi?(cl()<=gt.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",Qo(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),Ve.resolve()):(cl()<=gt.DEBUG&&Ye("QueryEngine","Query:",Qo(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Gi*s?(cl()<=gt.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",Qo(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Zr(t))):Ve.resolve())}ji(e,t){if(u_(t))return Ve.resolve(null);let r=Zr(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=yp(t,null,"F"),r=Zr(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=mt(...i);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Zi(t,a);return this.Xi(t,c,o,l.readTime)?this.ji(e,yp(t,null,"F")):this.es(e,c,t,l)}))})))}Hi(e,t,r,s){return u_(t)||s.isEqual(at.min())?Ve.resolve(null):this.zi.getDocuments(e,r).next(i=>{const o=this.Zi(t,i);return this.Xi(t,o,r,s)?Ve.resolve(null):(cl()<=gt.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Qo(t)),this.es(e,o,t,Wk(s,-1)).next(a=>a))})}Zi(e,t){let r=new An(uE(e));return t.forEach((s,i)=>{Zh(e,i)&&(r=r.add(i))}),r}Xi(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ji(e,t,r){return cl()<=gt.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",Qo(t)),this.zi.getDocumentsMatchingQuery(e,t,ki.min(),r)}es(e,t,r,s){return this.zi.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,t,r,s){this.persistence=e,this.ts=t,this.serializer=s,this.ns=new Ht(At),this.rs=new Ua(i=>Fm(i),Um),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oC(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}}function yC(n,e,t,r){return new _C(n,e,t,r)}async function PE(n,e){const t=ut(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=mt();for(const c of s){o.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}for(const c of i){a.push(c.batchId);for(const u of c.mutations)l=l.add(u.key)}return t.localDocuments.getDocuments(r,l).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})}function bC(n,e){const t=ut(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.os.newChangeBuffer({trackRemovals:!0});return function(a,l,c,u){const f=c.batch,d=f.keys();let m=Ve.resolve();return d.forEach(_=>{m=m.next(()=>u.getEntry(l,_)).next(D=>{const O=c.docVersions.get(_);Nt(O!==null),D.version.compareTo(O)<0&&(f.applyToRemoteDocument(D,c),D.isValidDocument()&&(D.setReadTime(c.commitVersion),u.addEntry(D)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,f))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=mt();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function OE(n){const e=ut(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function vC(n,e){const t=ut(n),r=e.snapshotVersion;let s=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.os.newChangeBuffer({trackRemovals:!0});s=t.ns;const a=[];e.targetChanges.forEach((u,f)=>{const d=s.get(f);if(!d)return;a.push(t.Qr.removeMatchingKeys(i,u.removedDocuments,f).next(()=>t.Qr.addMatchingKeys(i,u.addedDocuments,f)));let m=d.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?m=m.withResumeToken(Bn.EMPTY_BYTE_STRING,at.min()).withLastLimboFreeSnapshotVersion(at.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,r)),s=s.insert(f,m),function(D,O,x){return D.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8?!0:x.addedDocuments.size+x.modifiedDocuments.size+x.removedDocuments.size>0}(d,m,u)&&a.push(t.Qr.updateTargetData(i,m))});let l=Rs(),c=mt();if(e.documentUpdates.forEach(u=>{e.resolvedLimboDocuments.has(u)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,u))}),a.push(EC(i,o,e.documentUpdates).next(u=>{l=u.cs,c=u.ls})),!r.isEqual(at.min())){const u=t.Qr.getLastRemoteSnapshotVersion(i).next(f=>t.Qr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(u)}return Ve.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.ns=s,i))}function EC(n,e,t){let r=mt(),s=mt();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=Rs();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(at.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Ye("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{cs:o,ls:s}})}function wC(n,e){const t=ut(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function TC(n,e){const t=ut(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Qr.getTargetData(r,e).next(i=>i?(s=i,Ve.resolve(s)):t.Qr.allocateTargetId(r).next(o=>(s=new hi(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.ns.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}async function Tp(n,e,t){const r=ut(n),s=r.ns.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ic(o))throw o;Ye("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(s.target)}function E_(n,e,t){const r=ut(n);let s=at.min(),i=mt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,u){const f=ut(l),d=f.rs.get(u);return d!==void 0?Ve.resolve(f.ns.get(d)):f.Qr.getTargetData(c,u)}(r,o,Zr(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?s:at.min(),t?i:mt())).next(a=>(SC(r,m9(e),a),{documents:a,hs:i})))}function SC(n,e,t){let r=n.ss.get(e)||at.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.ss.set(e,r)}class w_{constructor(){this.activeTargetIds=E9()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AC{constructor(){this.no=new w_,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new w_,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{io(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){Ye("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){Ye("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iu=null;function ed(){return iu===null?iu=function(){return 268435456+Math.round(2147483648*Math.random())}():iu++,"0x"+iu.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pn="WebChannelConnection";class CC extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${s}/databases/${i}`,this.bo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Do(){return!1}Co(t,r,s,i,o){const a=ed(),l=this.vo(t,r.toUriEncodedString());Ye("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(c,i,o),this.Mo(t,l,c,s).then(u=>(Ye("RestConnection",`Received RPC '${t}' ${a}: `,u),u),u=>{throw Ta("RestConnection",`RPC '${t}' ${a} failed with error: `,u,"url: ",l,"request:",s),u})}xo(t,r,s,i,o,a){return this.Co(t,r,s,i,o)}Fo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fa}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}vo(t,r){const s=RC[t];return`${this.wo}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,s){const i=ed();return new Promise((o,a)=>{const l=new qv;l.setWithCredentials(!0),l.listenOnce(Wv.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ku.NO_ERROR:const u=l.getResponseJson();Ye(Pn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(u)),o(u);break;case ku.TIMEOUT:Ye(Pn,`RPC '${e}' ${i} timed out`),a(new qe(Me.DEADLINE_EXCEEDED,"Request time out"));break;case ku.HTTP_ERROR:const f=l.getStatus();if(Ye(Pn,`RPC '${e}' ${i} failed with status:`,f,"response text:",l.getResponseText()),f>0){let d=l.getResponseJson();Array.isArray(d)&&(d=d[0]);const m=d==null?void 0:d.error;if(m&&m.status&&m.message){const _=function(O){const x=O.toLowerCase().replace(/_/g,"-");return Object.values(Me).indexOf(x)>=0?x:Me.UNKNOWN}(m.status);a(new qe(_,m.message))}else a(new qe(Me.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new qe(Me.UNAVAILABLE,"Connection failed."));break;default:st()}}finally{Ye(Pn,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);Ye(Pn,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",c,r,15)})}Oo(e,t,r){const s=ed(),i=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Xv(),a=Yv(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new Kv({})),this.Fo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const u=i.join("");Ye(Pn,`Creating RPC '${e}' stream ${s}: ${u}`,l);const f=o.createWebChannel(u,l);let d=!1,m=!1;const _=new kC({lo:O=>{m?Ye(Pn,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(d||(Ye(Pn,`Opening RPC '${e}' stream ${s} transport.`),f.open(),d=!0),Ye(Pn,`RPC '${e}' stream ${s} sending:`,O),f.send(O))},ho:()=>f.close()}),D=(O,x,w)=>{O.listen(x,N=>{try{w(N)}catch(V){setTimeout(()=>{throw V},0)}})};return D(f,_l.EventType.OPEN,()=>{m||(Ye(Pn,`RPC '${e}' stream ${s} transport opened.`),_.mo())}),D(f,_l.EventType.CLOSE,()=>{m||(m=!0,Ye(Pn,`RPC '${e}' stream ${s} transport closed`),_.po())}),D(f,_l.EventType.ERROR,O=>{m||(m=!0,Ta(Pn,`RPC '${e}' stream ${s} transport errored:`,O),_.po(new qe(Me.UNAVAILABLE,"The operation could not be completed")))}),D(f,_l.EventType.MESSAGE,O=>{var x;if(!m){const w=O.data[0];Nt(!!w);const N=w,V=N.error||((x=N[0])===null||x===void 0?void 0:x.error);if(V){Ye(Pn,`RPC '${e}' stream ${s} received error:`,V);const p=V.status;let k=function(E){const T=Zt[E];if(T!==void 0)return wE(T)}(p),S=V.message;k===void 0&&(k=Me.INTERNAL,S="Unknown error status: "+p+" with message "+V.message),m=!0,_.po(new qe(k,S)),f.close()}else Ye(Pn,`RPC '${e}' stream ${s} received:`,w),_.yo(w)}}),D(a,Gv.STAT_EVENT,O=>{O.stat===fp.PROXY?Ye(Pn,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===fp.NOPROXY&&Ye(Pn,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{_.fo()},0),_}}function td(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(n){return new U9(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NE{constructor(e,t,r=1e3,s=1.5,i=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=s,this.Bo=i,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),s=Math.max(0,t-r);s>0&&Ye("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,s,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DE{constructor(e,t,r,s,i,o,a,l){this.oi=e,this.Go=r,this.zo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new NE(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(e,t){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===Me.RESOURCE_EXHAUSTED?(Is(t.toString()),Is("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===Me.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ao(t)}__(){}auth(){this.state=1;const e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.jo===t&&this.u_(r,s)},r=>{e(()=>{const s=new qe(Me.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(s)})})}u_(e,t){const r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(s=>{r(()=>this.c_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_(e){return Ye("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(Ye("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class xC extends DE{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();const t=z9(this.serializer,e),r=function(i){if(!("targetChange"in i))return at.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?at.min():o.readTime?es(o.readTime):at.min()}(e);return this.listener.h_(t,r)}P_(e){const t={};t.database=wp(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=gp(l)?{documents:K9(i,l)}:{query:W9(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=AE(i,o.resumeToken);const c=bp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(at.min())>0){a.readTime=oh(i,o.snapshotVersion.toTimestamp());const c=bp(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=Y9(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){const t={};t.database=wp(this.serializer),t.removeTarget=e,this.i_(t)}}class MC extends DE{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(Nt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();const t=q9(e.writeResults,e.commitTime),r=es(e.commitTime);return this.listener.A_(r,t)}return Nt(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){const e={};e.database=wp(this.serializer),this.i_(e)}d_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>$9(this.serializer,r))};this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.m_=!1}f_(){if(this.m_)throw new qe(Me.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Co(e,vp(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new qe(Me.UNKNOWN,i.toString())})}xo(e,t,r,s,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,vp(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Me.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new qe(Me.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class OC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(Is(t),this.y_=!1):Ye("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=i,this.O_.io(o=>{r.enqueueAndForget(async()=>{Po(this)&&(Ye("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=ut(l);c.M_.add(4),await xc(c),c.N_.set("Unknown"),c.M_.delete(4),await sf(c)}(this))})}),this.N_=new OC(r,s)}}async function sf(n){if(Po(n))for(const e of n.x_)await e(!0)}async function xc(n){for(const e of n.x_)await e(!1)}function LE(n,e){const t=ut(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),Jm(t)?Qm(t):Ha(t).Xo()&&Xm(t,e))}function Ym(n,e){const t=ut(n),r=Ha(t);t.F_.delete(e),r.Xo()&&VE(t,e),t.F_.size===0&&(r.Xo()?r.n_():Po(t)&&t.N_.set("Unknown"))}function Xm(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(at.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ha(n).P_(e)}function VE(n,e){n.L_.xe(e),Ha(n).I_(e)}function Qm(n){n.L_=new L9({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Ha(n).start(),n.N_.w_()}function Jm(n){return Po(n)&&!Ha(n).Zo()&&n.F_.size>0}function Po(n){return ut(n).M_.size===0}function BE(n){n.L_=void 0}async function DC(n){n.N_.set("Online")}async function LC(n){n.F_.forEach((e,t)=>{Xm(n,e)})}async function VC(n,e){BE(n),Jm(n)?(n.N_.D_(e),Qm(n)):n.N_.set("Unknown")}async function BC(n,e,t){if(n.N_.set("Online"),e instanceof SE&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.F_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.F_.delete(a),s.L_.removeTarget(a))}(n,e)}catch(r){Ye("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ah(n,r)}else if(e instanceof Mu?n.L_.Ke(e):e instanceof TE?n.L_.He(e):n.L_.We(e),!t.isEqual(at.min()))try{const r=await OE(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.L_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const u=i.F_.get(c);u&&i.F_.set(c,u.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const u=i.F_.get(l);if(!u)return;i.F_.set(l,u.withResumeToken(Bn.EMPTY_BYTE_STRING,u.snapshotVersion)),VE(i,l);const f=new hi(u.target,l,c,u.sequenceNumber);Xm(i,f)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){Ye("RemoteStore","Failed to raise snapshot:",r),await ah(n,r)}}async function ah(n,e,t){if(!Ic(e))throw e;n.M_.add(1),await xc(n),n.N_.set("Offline"),t||(t=()=>OE(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Ye("RemoteStore","Retrying IndexedDB access"),await t(),n.M_.delete(1),await sf(n)})}function FE(n,e){return e().catch(t=>ah(n,t,e))}async function of(n){const e=ut(n),t=xi(e);let r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;FC(e);)try{const s=await wC(e.localStore,r);if(s===null){e.v_.length===0&&t.n_();break}r=s.batchId,UC(e,s)}catch(s){await ah(e,s)}UE(e)&&HE(e)}function FC(n){return Po(n)&&n.v_.length<10}function UC(n,e){n.v_.push(e);const t=xi(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function UE(n){return Po(n)&&!xi(n).Zo()&&n.v_.length>0}function HE(n){xi(n).start()}async function HC(n){xi(n).V_()}async function jC(n){const e=xi(n);for(const t of n.v_)e.d_(t.mutations)}async function zC(n,e,t){const r=n.v_.shift(),s=zm.from(r,e,t);await FE(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await of(n)}async function $C(n,e){e&&xi(n).E_&&await async function(r,s){if(function(o){return O9(o)&&o!==Me.ABORTED}(s.code)){const i=r.v_.shift();xi(r).t_(),await FE(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await of(r)}}(n,e),UE(n)&&HE(n)}async function S_(n,e){const t=ut(n);t.asyncQueue.verifyOperationInProgress(),Ye("RemoteStore","RemoteStore received new credentials");const r=Po(t);t.M_.add(3),await xc(t),r&&t.N_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),await sf(t)}async function qC(n,e){const t=ut(n);e?(t.M_.delete(2),await sf(t)):e||(t.M_.add(2),await xc(t),t.N_.set("Unknown"))}function Ha(n){return n.B_||(n.B_=function(t,r,s){const i=ut(t);return i.f_(),new xC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Po:DC.bind(null,n),To:LC.bind(null,n),Ao:VC.bind(null,n),h_:BC.bind(null,n)}),n.x_.push(async e=>{e?(n.B_.t_(),Jm(n)?Qm(n):n.N_.set("Unknown")):(await n.B_.stop(),BE(n))})),n.B_}function xi(n){return n.k_||(n.k_=function(t,r,s){const i=ut(t);return i.f_(),new MC(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:HC.bind(null,n),Ao:$C.bind(null,n),R_:jC.bind(null,n),A_:zC.bind(null,n)}),n.x_.push(async e=>{e?(n.k_.t_(),await of(n)):(await n.k_.stop(),n.v_.length>0&&(Ye("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))})),n.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zm{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Es,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new Zm(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new qe(Me.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function e0(n,e){if(Is("AsyncQueue",`${e}: ${n}`),Ic(n))return new qe(Me.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Ze.comparator(t.key,r.key):(t,r)=>Ze.comparator(t.key,r.key),this.keyedMap=yl(),this.sortedSet=new Ht(this.comparator)}static emptySet(e){return new pa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof pa)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new pa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A_{constructor(){this.q_=new Ht(Ze.comparator)}track(e){const t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):st():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}}class ka{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new ka(e,t,pa.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Jh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class WC{constructor(){this.queries=new Ua(e=>cE(e),Jh),this.onlineState="Unknown",this.z_=new Set}}async function jE(n,e){const t=ut(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.W_()&&e.G_()&&(r=2):(i=new KC,r=e.G_()?0:1);try{switch(r){case 0:i.K_=await t.onListen(s,!0);break;case 1:i.K_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=e0(o,`Initialization of query '${Qo(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.U_.push(e),e.j_(t.onlineState),i.K_&&e.H_(i.K_)&&t0(t)}async function zE(n,e){const t=ut(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.U_.indexOf(e);o>=0&&(i.U_.splice(o,1),i.U_.length===0?s=e.G_()?0:1:!i.W_()&&e.G_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function GC(n,e){const t=ut(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.U_)a.H_(s)&&(r=!0);o.K_=s}}r&&t0(t)}function YC(n,e,t){const r=ut(n),s=r.queries.get(e);if(s)for(const i of s.U_)i.onError(t);r.queries.delete(e)}function t0(n){n.z_.forEach(e=>{e.next()})}var Sp,I_;(I_=Sp||(Sp={})).J_="default",I_.Cache="cache";class $E{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new ka(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;const r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;const t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=ka.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Sp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qE{constructor(e){this.key=e}}class KE{constructor(e){this.key=e}}class XC{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=mt(),this.mutatedKeys=mt(),this.Ia=uE(e),this.Ta=new pa(this.Ia)}get Ea(){return this.la}da(e,t){const r=t?t.Aa:new A_,s=t?t.Ta:this.Ta;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((u,f)=>{const d=s.get(u),m=Zh(this.query,f)?f:null,_=!!d&&this.mutatedKeys.has(d.key),D=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let O=!1;d&&m?d.data.isEqual(m.data)?_!==D&&(r.track({type:3,doc:m}),O=!0):this.Ra(d,m)||(r.track({type:2,doc:m}),O=!0,(l&&this.Ia(m,l)>0||c&&this.Ia(m,c)<0)&&(a=!0)):!d&&m?(r.track({type:0,doc:m}),O=!0):d&&!m&&(r.track({type:1,doc:d}),O=!0,(l||c)&&(a=!0)),O&&(m?(o=o.add(m),i=D?i.add(u):i.delete(u)):(o=o.delete(u),i=i.delete(u)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),i=i.delete(u.key),r.track({type:1,doc:u})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:i}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const o=e.Aa.Q_();o.sort((u,f)=>function(m,_){const D=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return st()}};return D(m)-D(_)}(u.type,f.type)||this.Ia(u.doc,f.doc)),this.Va(r),s=s!=null&&s;const a=t&&!s?this.ma():[],l=this.Pa.size===0&&this.current&&!s?1:0,c=l!==this.ha;return this.ha=l,o.length!==0||c?{snapshot:new ka(this.query,e.Ta,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new A_,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=mt(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});const t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new KE(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new qE(r))}),t}pa(e){this.la=e.hs,this.Pa=mt();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return ka.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class QC{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class JC{constructor(e){this.key=e,this.wa=!1}}class ZC{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new Ua(a=>cE(a),Jh),this.Da=new Map,this.Ca=new Set,this.va=new Ht(Ze.comparator),this.Fa=new Map,this.Ma=new Km,this.xa={},this.Oa=new Map,this.Na=Ra.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function e8(n,e,t=!0){const r=JE(n);let s;const i=r.ba.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ya()):s=await WE(r,e,t,!0),s}async function t8(n,e){const t=JE(n);await WE(t,e,!0,!1)}async function WE(n,e,t,r){const s=await TC(n.localStore,Zr(e)),i=s.targetId,o=t?n.sharedClientState.addLocalQueryTarget(i):"not-current";let a;return r&&(a=await n8(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&LE(n.remoteStore,s),a}async function n8(n,e,t,r,s){n.Ba=(f,d,m)=>async function(D,O,x,w){let N=O.view.da(x);N.Xi&&(N=await E_(D.localStore,O.query,!1).then(({documents:S})=>O.view.da(S,N)));const V=w&&w.targetChanges.get(O.targetId),p=w&&w.targetMismatches.get(O.targetId)!=null,k=O.view.applyChanges(N,D.isPrimaryClient,V,p);return k_(D,O.targetId,k.fa),k.snapshot}(n,f,d,m);const i=await E_(n.localStore,e,!0),o=new XC(e,i.hs),a=o.da(i.documents),l=Cc.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);k_(n,t,c.fa);const u=new QC(e,t,o);return n.ba.set(e,u),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),c.snapshot}async function r8(n,e,t){const r=ut(n),s=r.ba.get(e),i=r.Da.get(s.targetId);if(i.length>1)return r.Da.set(s.targetId,i.filter(o=>!Jh(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Tp(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Ym(r.remoteStore,s.targetId),Ap(r,s.targetId)}).catch(Ac)):(Ap(r,s.targetId),await Tp(r.localStore,s.targetId,!0))}async function s8(n,e){const t=ut(n),r=t.ba.get(e),s=t.Da.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ym(t.remoteStore,r.targetId))}async function i8(n,e,t){const r=f8(n);try{const s=await function(o,a){const l=ut(o),c=cn.now(),u=a.reduce((m,_)=>m.add(_.key),mt());let f,d;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let _=Rs(),D=mt();return l.os.getEntries(m,u).next(O=>{_=O,_.forEach((x,w)=>{w.isValidDocument()||(D=D.add(x))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,_)).next(O=>{f=O;const x=[];for(const w of a){const N=k9(w,f.get(w.key).overlayedDocument);N!=null&&x.push(new Di(w.key,N,tE(N.value.mapValue),Pr.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,x,a)}).next(O=>{d=O;const x=O.applyToLocalDocumentSet(f,D);return l.documentOverlayCache.saveOverlays(m,O.batchId,x)})}).then(()=>({batchId:d.batchId,changes:fE(f)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.xa[o.currentUser.toKey()];c||(c=new Ht(At)),c=c.insert(a,l),o.xa[o.currentUser.toKey()]=c}(r,s.batchId,t),await Mc(r,s.changes),await of(r.remoteStore)}catch(s){const i=e0(s,"Failed to persist write");t.reject(i)}}async function GE(n,e){const t=ut(n);try{const r=await vC(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Fa.get(i);o&&(Nt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.wa=!0:s.modifiedDocuments.size>0?Nt(o.wa):s.removedDocuments.size>0&&(Nt(o.wa),o.wa=!1))}),await Mc(t,r,e)}catch(r){await Ac(r)}}function R_(n,e,t){const r=ut(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.ba.forEach((i,o)=>{const a=o.view.j_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ut(o);l.onlineState=a;let c=!1;l.queries.forEach((u,f)=>{for(const d of f.U_)d.j_(a)&&(c=!0)}),c&&t0(l)}(r.eventManager,e),s.length&&r.Sa.h_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function o8(n,e,t){const r=ut(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Fa.get(e),i=s&&s.key;if(i){let o=new Ht(Ze.comparator);o=o.insert(i,Ln.newNoDocument(i,at.min()));const a=mt().add(i),l=new nf(at.min(),new Map,new Ht(At),o,a);await GE(r,l),r.va=r.va.remove(i),r.Fa.delete(e),n0(r)}else await Tp(r.localStore,e,!1).then(()=>Ap(r,e,t)).catch(Ac)}async function a8(n,e){const t=ut(n),r=e.batch.batchId;try{const s=await bC(t.localStore,e);XE(t,r,null),YE(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Mc(t,s)}catch(s){await Ac(s)}}async function l8(n,e,t){const r=ut(n);try{const s=await function(o,a){const l=ut(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let u;return l.mutationQueue.lookupMutationBatch(c,a).next(f=>(Nt(f!==null),u=f.keys(),l.mutationQueue.removeMutationBatch(c,f))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,u,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,u)).next(()=>l.localDocuments.getDocuments(c,u))})}(r.localStore,e);XE(r,e,t),YE(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Mc(r,s)}catch(s){await Ac(s)}}function YE(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function XE(n,e,t){const r=ut(n);let s=r.xa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.xa[r.currentUser.toKey()]=s}}function Ap(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||QE(n,r)})}function QE(n,e){n.Ca.delete(e.path.canonicalString());const t=n.va.get(e);t!==null&&(Ym(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),n0(n))}function k_(n,e,t){for(const r of t)r instanceof qE?(n.Ma.addReference(r.key,e),c8(n,r)):r instanceof KE?(Ye("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||QE(n,r.key)):st()}function c8(n,e){const t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(Ye("SyncEngine","New document in limbo: "+t),n.Ca.add(r),n0(n))}function n0(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){const e=n.Ca.values().next().value;n.Ca.delete(e);const t=new Ze(Vt.fromString(e)),r=n.Na.next();n.Fa.set(r,new JC(t)),n.va=n.va.insert(t,r),LE(n.remoteStore,new hi(Zr(Hm(t.path)),r,"TargetPurposeLimboResolution",Dm.oe))}}async function Mc(n,e,t){const r=ut(n),s=[],i=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,l)=>{o.push(r.Ba(l,e,t).then(c=>{if((c||t)&&r.isPrimaryClient){const u=c&&!c.fromCache;r.sharedClientState.updateQueryState(l.targetId,u?"current":"not-current")}if(c){s.push(c);const u=Gm.Ki(l.targetId,c);i.push(u)}}))}),await Promise.all(o),r.Sa.h_(s),await async function(l,c){const u=ut(l);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>Ve.forEach(c,d=>Ve.forEach(d.qi,m=>u.persistence.referenceDelegate.addReference(f,d.targetId,m)).next(()=>Ve.forEach(d.Qi,m=>u.persistence.referenceDelegate.removeReference(f,d.targetId,m)))))}catch(f){if(!Ic(f))throw f;Ye("LocalStore","Failed to update sequence numbers: "+f)}for(const f of c){const d=f.targetId;if(!f.fromCache){const m=u.ns.get(d),_=m.snapshotVersion,D=m.withLastLimboFreeSnapshotVersion(_);u.ns=u.ns.insert(d,D)}}}(r.localStore,i))}async function u8(n,e){const t=ut(n);if(!t.currentUser.isEqual(e)){Ye("SyncEngine","User change. New user:",e.toKey());const r=await PE(t.localStore,e);t.currentUser=e,function(i,o){i.Oa.forEach(a=>{a.forEach(l=>{l.reject(new qe(Me.CANCELLED,o))})}),i.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Mc(t,r.us)}}function h8(n,e){const t=ut(n),r=t.Fa.get(e);if(r&&r.wa)return mt().add(r.key);{let s=mt();const i=t.Da.get(e);if(!i)return s;for(const o of i){const a=t.ba.get(o);s=s.unionWith(a.view.Ea)}return s}}function JE(n){const e=ut(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=GE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=h8.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=o8.bind(null,e),e.Sa.h_=GC.bind(null,e.eventManager),e.Sa.ka=YC.bind(null,e.eventManager),e}function f8(n){const e=ut(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=a8.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=l8.bind(null,e),e}class C_{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=rf(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return yC(this.persistence,new gC,e.initialUser,this.serializer)}createPersistence(e){return new dC(Wm.Hr,this.serializer)}createSharedClientState(e){return new AC}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class d8{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>R_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=u8.bind(null,this.syncEngine),await qC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new WC}()}createDatastore(e){const t=rf(e.databaseInfo.databaseId),r=function(i){return new CC(i)}(e.databaseInfo);return function(i,o,a,l){return new PC(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new NC(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>R_(this.syncEngine,t,0),function(){return T_.D()?new T_:new IC}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,u){const f=new ZC(s,i,o,a,l,c);return u&&(f.La=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(r){const s=ut(r);Ye("RemoteStore","RemoteStore shutting down."),s.M_.add(5),await xc(s),s.O_.shutdown(),s.N_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):Is("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p8{constructor(e,t,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Dn.UNAUTHENTICATED,this.clientId=Jv.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{Ye("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(Ye("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new qe(Me.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Es;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=e0(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function nd(n,e){n.asyncQueue.verifyOperationInProgress(),Ye("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await PE(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function x_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await g8(n);Ye("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>S_(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>S_(e.remoteStore,s)),n._onlineComponents=e}function m8(n){return n.name==="FirebaseError"?n.code===Me.FAILED_PRECONDITION||n.code===Me.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function g8(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Ye("FirestoreClient","Using user provided OfflineComponentProvider");try{await nd(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!m8(t))throw t;Ta("Error using user provided cache. Falling back to memory cache: "+t),await nd(n,new C_)}}else Ye("FirestoreClient","Using default OfflineComponentProvider"),await nd(n,new C_);return n._offlineComponents}async function e3(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Ye("FirestoreClient","Using user provided OnlineComponentProvider"),await x_(n,n._uninitializedComponentsProvider._online)):(Ye("FirestoreClient","Using default OnlineComponentProvider"),await x_(n,new d8))),n._onlineComponents}function _8(n){return e3(n).then(e=>e.syncEngine)}async function t3(n){const e=await e3(n),t=e.eventManager;return t.onListen=e8.bind(null,e.syncEngine),t.onUnlisten=r8.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=t8.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=s8.bind(null,e.syncEngine),t}function y8(n,e,t={}){const r=new Es;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new ZE({next:d=>{o.enqueueAndForget(()=>zE(i,f));const m=d.docs.has(a);!m&&d.fromCache?c.reject(new qe(Me.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&d.fromCache&&l&&l.source==="server"?c.reject(new qe(Me.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new $E(Hm(a.path),u,{includeMetadataChanges:!0,ra:!0});return jE(i,f)}(await t3(n),n.asyncQueue,e,t,r)),r.promise}function b8(n,e,t={}){const r=new Es;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const u=new ZE({next:d=>{o.enqueueAndForget(()=>zE(i,f)),d.fromCache&&l.source==="server"?c.reject(new qe(Me.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(d)},error:d=>c.reject(d)}),f=new $E(a,u,{includeMetadataChanges:!0,ra:!0});return jE(i,f)}(await t3(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n3(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r3(n,e,t){if(!t)throw new qe(Me.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function v8(n,e,t,r){if(e===!0&&r===!0)throw new qe(Me.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function P_(n){if(!Ze.isDocumentKey(n))throw new qe(Me.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function O_(n){if(Ze.isDocumentKey(n))throw new qe(Me.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function af(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":st()}function ks(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new qe(Me.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=af(n);throw new qe(Me.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new qe(Me.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new qe(Me.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}v8("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=n3((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new qe(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new qe(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new qe(Me.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lf{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new N_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new qe(Me.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new qe(Me.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new N_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Bk;switch(r.type){case"firstParty":return new jk(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new qe(Me.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=M_.get(t);r&&(Ye("ComponentProvider","Removing Datastore"),M_.delete(t),r.terminate())}(this),Promise.resolve()}}function E8(n,e,t,r={}){var s;const i=(n=ks(n,lf))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&Ta("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Dn.MOCK_USER;else{a=Yb(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new qe(Me.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Dn(c)}n._authCredentials=new Fk(new Qv(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ja(this.firestore,e,this._query)}}class rr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ei(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new rr(this.firestore,e,this._key)}}class Ei extends ja{constructor(e,t,r){super(e,t,Hm(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new rr(this.firestore,null,new Ze(e))}withConverter(e){return new Ei(this.firestore,e,this._path)}}function nF(n,e,...t){if(n=Wt(n),r3("collection","path",e),n instanceof lf){const r=Vt.fromString(e,...t);return O_(r),new Ei(n,null,r)}{if(!(n instanceof rr||n instanceof Ei))throw new qe(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Vt.fromString(e,...t));return O_(r),new Ei(n.firestore,null,r)}}function w8(n,e,...t){if(n=Wt(n),arguments.length===1&&(e=Jv.newId()),r3("doc","path",e),n instanceof lf){const r=Vt.fromString(e,...t);return P_(r),new rr(n,null,new Ze(r))}{if(!(n instanceof rr||n instanceof Ei))throw new qe(Me.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Vt.fromString(e,...t));return P_(r),new rr(n.firestore,n instanceof Ei?n.converter:null,new Ze(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new NE(this,"async_queue_retry"),this.hu=()=>{const t=td();t&&Ye("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};const e=td();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=td();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const t=new Es;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Ic(e))throw e;Ye("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(e){const t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Is("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const s=Zm.createAndSchedule(this,e,t,r,i=>this.Eu(i));return this._u.push(s),s}Pu(){this.au&&st()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}class za extends lf{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=function(){return new T8}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||s3(this),this._firestoreClient.terminate()}}function S8(n,e){const t=typeof n=="object"?n:wm(),r=typeof n=="string"?n:"(default)",s=zh(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Kb("firestore");i&&E8(s,...i)}return s}function r0(n){return n._firestoreClient||s3(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function s3(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,u){return new t9(a,l,c,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,n3(u.experimentalLongPollingOptions),u.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._firestoreClient=new p8(n._authCredentials,n._appCheckCredentials,n._queue,i),!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ca(Bn.fromBase64String(e))}catch(t){throw new qe(Me.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ca(Bn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new qe(Me.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Sn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s0{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new qe(Me.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new qe(Me.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A8=/^__.*__$/;class I8{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Di(e,this.data,this.fieldMask,t,this.fieldTransforms):new kc(e,this.data,t,this.fieldTransforms)}}class i3{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Di(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function o3(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw st()}}class o0{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.mu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new o0(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.gu({path:r,yu:!1});return s.wu(e),s}Su(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.gu({path:r,yu:!1});return s.mu(),s}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return lh(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(o3(this.fu)&&A8.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class R8{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||rf(e)}Fu(e,t,r,s=!1){return new o0({fu:e,methodName:t,vu:r,path:Sn.emptyPath(),yu:!1,Cu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function a0(n){const e=n._freezeSettings(),t=rf(n._databaseId);return new R8(n._databaseId,!!e.ignoreUndefinedProperties,t)}function k8(n,e,t,r,s,i={}){const o=n.Fu(i.merge||i.mergeFields?2:0,e,t,s);l0("Data must be an object, but it was:",o,r);const a=a3(r,o);let l,c;if(i.merge)l=new dr(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const u=[];for(const f of i.mergeFields){const d=Ip(e,f,t);if(!o.contains(d))throw new qe(Me.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);c3(u,d)||u.push(d)}l=new dr(u),c=o.fieldTransforms.filter(f=>l.covers(f.field))}else l=null,c=o.fieldTransforms;return new I8(new tr(a),l,c)}class uf extends s0{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof uf}}function C8(n,e,t,r){const s=n.Fu(1,e,t);l0("Data must be an object, but it was:",s,r);const i=[],o=tr.empty();Mo(r,(l,c)=>{const u=c0(e,l,t);c=Wt(c);const f=s.Su(u);if(c instanceof uf)i.push(u);else{const d=Pc(c,f);d!=null&&(i.push(u),o.set(u,d))}});const a=new dr(i);return new i3(o,a,s.fieldTransforms)}function x8(n,e,t,r,s,i){const o=n.Fu(1,e,t),a=[Ip(e,r,t)],l=[s];if(i.length%2!=0)throw new qe(Me.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(Ip(e,i[d])),l.push(i[d+1]);const c=[],u=tr.empty();for(let d=a.length-1;d>=0;--d)if(!c3(c,a[d])){const m=a[d];let _=l[d];_=Wt(_);const D=o.Su(m);if(_ instanceof uf)c.push(m);else{const O=Pc(_,D);O!=null&&(c.push(m),u.set(m,O))}}const f=new dr(c);return new i3(u,f,o.fieldTransforms)}function M8(n,e,t,r=!1){return Pc(t,n.Fu(r?4:3,e))}function Pc(n,e){if(l3(n=Wt(n)))return l0("Unsupported field value:",e,n),a3(n,e);if(n instanceof s0)return function(r,s){if(!o3(s.fu))throw s.Du(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Du(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Pc(a,s.bu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return w9(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=cn.fromDate(r);return{timestampValue:oh(s.serializer,i)}}if(r instanceof cn){const i=new cn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:oh(s.serializer,i)}}if(r instanceof i0)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ca)return{bytesValue:AE(s.serializer,r._byteString)};if(r instanceof rr){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:qm(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.Du(`Unsupported field value: ${af(r)}`)}(n,e)}function a3(n,e){const t={};return Zv(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Mo(n,(r,s)=>{const i=Pc(s,e.pu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function l3(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof cn||n instanceof i0||n instanceof Ca||n instanceof rr||n instanceof s0)}function l0(n,e,t){if(!l3(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=af(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function Ip(n,e,t){if((e=Wt(e))instanceof cf)return e._internalPath;if(typeof e=="string")return c0(n,e);throw lh("Field path arguments must be of type string or ",n,!1,void 0,t)}const P8=new RegExp("[~\\*/\\[\\]]");function c0(n,e,t){if(e.search(P8)>=0)throw lh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new cf(...e.split("."))._internalPath}catch{throw lh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function lh(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new qe(Me.INVALID_ARGUMENT,a+n+l)}function c3(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u3{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new rr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new O8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(u0("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class O8 extends u3{data(){return super.data()}}function u0(n,e){return typeof e=="string"?c0(n,e):e instanceof cf?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N8(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new qe(Me.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class h0{}class D8 extends h0{}function rF(n,e,...t){let r=[];e instanceof h0&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof f0).length,a=i.filter(l=>l instanceof hf).length;if(o>1||o>0&&a>0)throw new qe(Me.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class hf extends D8{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new hf(e,t,r)}_apply(e){const t=this._parse(e);return h3(e._query,t),new ja(e.firestore,e.converter,_p(e._query,t))}_parse(e){const t=a0(e.firestore);return function(i,o,a,l,c,u,f){let d;if(c.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new qe(Me.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){L_(f,u);const m=[];for(const _ of f)m.push(D_(l,i,_));d={arrayValue:{values:m}}}else d=D_(l,i,f)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||L_(f,u),d=M8(a,o,f,u==="in"||u==="not-in");return tn.create(c,u,d)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function sF(n,e,t){const r=e,s=u0("where",n);return hf._create(s,r,t)}class f0 extends h0{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new f0(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Lr.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)h3(o,l),o=_p(o,l)}(e._query,t),new ja(e.firestore,e.converter,_p(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function D_(n,e,t){if(typeof(t=Wt(t))=="string"){if(t==="")throw new qe(Me.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lE(e)&&t.indexOf("/")!==-1)throw new qe(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Vt.fromString(t));if(!Ze.isDocumentKey(r))throw new qe(Me.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return s_(n,new Ze(r))}if(t instanceof rr)return s_(n,t._key);throw new qe(Me.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${af(t)}.`)}function L_(n,e){if(!Array.isArray(n)||n.length===0)throw new qe(Me.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function h3(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new qe(Me.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new qe(Me.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class L8{convertValue(e,t="none"){switch(To(e)){case 0:return null;case 1:return e.booleanValue;case 2:return en(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(wo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw st()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Mo(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertGeoPoint(e){return new i0(en(e.latitude),en(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Vm(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(nc(e));default:return null}}convertTimestamp(e){const t=Ci(e);return new cn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Vt.fromString(e);Nt(ME(r));const s=new rc(r.get(1),r.get(3)),i=new Ze(r.popFirst(5));return s.isEqual(t)||Is(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V8(n,e,t){let r;return r=n?n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class f3 extends u3{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Pu(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(u0("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Pu extends f3{data(e={}){return super.data(e)}}class B8{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new vl(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Pu(this._firestore,this._userDataWriter,r.key,r,new vl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new qe(Me.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Pu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Pu(s._firestore,s._userDataWriter,a.doc.key,a.doc,new vl(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,u=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:F8(a.type),doc:l,oldIndex:c,newIndex:u}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function F8(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return st()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iF(n){n=ks(n,rr);const e=ks(n.firestore,za);return y8(r0(e),n._key).then(t=>U8(e,n,t))}class d3 extends L8{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ca(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new rr(this.firestore,null,t)}}function oF(n){n=ks(n,ja);const e=ks(n.firestore,za),t=r0(e),r=new d3(e);return N8(n._query),b8(t,n._query).then(s=>new B8(e,r,n,s))}function aF(n,e,t,...r){n=ks(n,rr);const s=ks(n.firestore,za),i=a0(s);let o;return o=typeof(e=Wt(e))=="string"||e instanceof cf?x8(i,"updateDoc",n._key,e,t,r):C8(i,"updateDoc",n._key,e),d0(s,[o.toMutation(n._key,Pr.exists(!0))])}function lF(n){return d0(ks(n.firestore,za),[new jm(n._key,Pr.none())])}function cF(n,e){const t=ks(n.firestore,za),r=w8(n),s=V8(n.converter,e);return d0(t,[k8(a0(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Pr.exists(!1))]).then(()=>r)}function d0(n,e){return function(r,s){const i=new Es;return r.asyncQueue.enqueueAndForget(async()=>i8(await _8(r),s,i)),i.promise}(r0(n),e)}function U8(n,e,t){const r=t.docs.get(e._key),s=new d3(n);return new f3(n,s,e._key,r,new vl(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){Fa=s})(Co),bo(new Ri("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new za(new Uk(r.getProvider("auth-internal")),new $k(r.getProvider("app-check-internal")),function(c,u){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new qe(Me.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new rc(c.options.projectId,u)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Xr(e_,"4.6.3",e),Xr(e_,"4.6.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p3="firebasestorage.googleapis.com",m3="storageBucket",H8=2*60*1e3,j8=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yt extends as{constructor(e,t,r=0){super(rd(e),`Firebase Storage: ${t} (${rd(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Yt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return rd(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Gt;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Gt||(Gt={}));function rd(n){return"storage/"+n}function p0(){const n="An unknown error occurred, please check the error payload for server response.";return new Yt(Gt.UNKNOWN,n)}function z8(n){return new Yt(Gt.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function $8(n){return new Yt(Gt.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function q8(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Yt(Gt.UNAUTHENTICATED,n)}function K8(){return new Yt(Gt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function W8(n){return new Yt(Gt.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function G8(){return new Yt(Gt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Y8(){return new Yt(Gt.CANCELED,"User canceled the upload/download.")}function X8(n){return new Yt(Gt.INVALID_URL,"Invalid URL '"+n+"'.")}function Q8(n){return new Yt(Gt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function J8(){return new Yt(Gt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+m3+"' property when initializing the app?")}function Z8(){return new Yt(Gt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ex(){return new Yt(Gt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function tx(n){return new Yt(Gt.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Rp(n){return new Yt(Gt.INVALID_ARGUMENT,n)}function g3(){return new Yt(Gt.APP_DELETED,"The Firebase app was deleted.")}function nx(n){return new Yt(Gt.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Fl(n,e){return new Yt(Gt.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function ul(n){throw new Yt(Gt.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=pr.makeFromUrl(e,t)}catch{return new pr(e,"")}if(r.path==="")return r;throw Q8(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(V){V.path.charAt(V.path.length-1)==="/"&&(V.path_=V.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c(V){V.path_=decodeURIComponent(V.path)}const u="v[A-Za-z0-9_]+",f=t.replace(/[.]/g,"\\."),d="(/([^?#]*).*)?$",m=new RegExp(`^https?://${f}/${u}/b/${s}/o${d}`,"i"),_={bucket:1,path:3},D=t===p3?"(?:storage.googleapis.com|storage.cloud.google.com)":t,O="([^?#]*)",x=new RegExp(`^https?://${D}/${s}/${O}`,"i"),N=[{regex:a,indices:l,postModify:i},{regex:m,indices:_,postModify:c},{regex:x,indices:{bucket:1,path:2},postModify:c}];for(let V=0;V<N.length;V++){const p=N[V],k=p.regex.exec(e);if(k){const S=k[p.indices.bucket];let b=k[p.indices.path];b||(b=""),r=new pr(S,b),p.postModify(r);break}}if(r==null)throw X8(e);return r}}class rx{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sx(n,e,t){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...O){c||(c=!0,e.apply(null,O))}function f(O){s=setTimeout(()=>{s=null,n(m,l())},O)}function d(){i&&clearTimeout(i)}function m(O,...x){if(c){d();return}if(O){d(),u.call(null,O,...x);return}if(l()||o){d(),u.call(null,O,...x);return}r<64&&(r*=2);let N;a===1?(a=2,N=0):N=(r+Math.random())*1e3,f(N)}let _=!1;function D(O){_||(_=!0,d(),!c&&(s!==null?(O||(a=2),clearTimeout(s),f(0)):O||(a=1)))}return f(0),i=setTimeout(()=>{o=!0,D(!0)},t),D}function ix(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ox(n){return n!==void 0}function ax(n){return typeof n=="object"&&!Array.isArray(n)}function m0(n){return typeof n=="string"||n instanceof String}function V_(n){return g0()&&n instanceof Blob}function g0(){return typeof Blob<"u"}function B_(n,e,t,r){if(r<e)throw Rp(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Rp(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function _3(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var uo;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(uo||(uo={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lx(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(e,t,r,s,i,o,a,l,c,u,f,d=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,_)=>{this.resolve_=m,this.reject_=_,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new ou(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===uo.NO_ERROR,l=i.getStatus();if(!a||lx(l,this.additionalRetryCodes_)&&this.retry){const u=i.getErrorCode()===uo.ABORT;r(!1,new ou(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new ou(c,i))})},t=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());ox(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=p0();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?g3():Y8();o(l)}else{const l=G8();o(l)}};this.canceled_?t(!1,new ou(!1,null,!0)):this.backoffId_=sx(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&ix(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ou{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function ux(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function hx(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function fx(n,e){e&&(n["X-Firebase-GMPID"]=e)}function dx(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function px(n,e,t,r,s,i,o=!0){const a=_3(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return fx(c,e),ux(c,t),hx(c,i),dx(c,r),new cx(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mx(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function gx(...n){const e=mx();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(g0())return new Blob(n);throw new Yt(Gt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function _x(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yx(n){if(typeof atob>"u")throw tx("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class sd{constructor(e,t){this.data=e,this.contentType=t||null}}function bx(n,e){switch(n){case Wr.RAW:return new sd(y3(e));case Wr.BASE64:case Wr.BASE64URL:return new sd(b3(n,e));case Wr.DATA_URL:return new sd(Ex(e),wx(e))}throw p0()}function y3(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=n.charCodeAt(++t);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function vx(n){let e;try{e=decodeURIComponent(n)}catch{throw Fl(Wr.DATA_URL,"Malformed data URL.")}return y3(e)}function b3(n,e){switch(n){case Wr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw Fl(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Wr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw Fl(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=yx(e)}catch(s){throw s.message.includes("polyfill")?s:Fl(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}class v3{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw Fl(Wr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=Tx(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function Ex(n){const e=new v3(n);return e.base64?b3(Wr.BASE64,e.rest):vx(e.rest)}function wx(n){return new v3(n).contentType}function Tx(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class li{constructor(e,t){let r=0,s="";V_(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(V_(this.data_)){const r=this.data_,s=_x(r,e,t);return s===null?null:new li(s)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new li(r,!0)}}static getBlob(...e){if(g0()){const t=e.map(r=>r instanceof li?r.data_:r);return new li(gx.apply(null,t))}else{const t=e.map(o=>m0(o)?bx(Wr.RAW,o).data:o.data_);let r=0;t.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new li(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E3(n){let e;try{e=JSON.parse(n)}catch{return null}return ax(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function Ax(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function w3(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ix(n,e){return e}let $n=class{constructor(e,t,r,s){this.server=e,this.local=t||e,this.writable=!!r,this.xform=s||Ix}},au=null;function Rx(n){return!m0(n)||n.length<2?n:w3(n)}function T3(){if(au)return au;const n=[];n.push(new $n("bucket")),n.push(new $n("generation")),n.push(new $n("metageneration")),n.push(new $n("name","fullPath",!0));function e(i,o){return Rx(o)}const t=new $n("name");t.xform=e,n.push(t);function r(i,o){return o!==void 0?Number(o):o}const s=new $n("size");return s.xform=r,n.push(s),n.push(new $n("timeCreated")),n.push(new $n("updated")),n.push(new $n("md5Hash",null,!0)),n.push(new $n("cacheControl",null,!0)),n.push(new $n("contentDisposition",null,!0)),n.push(new $n("contentEncoding",null,!0)),n.push(new $n("contentLanguage",null,!0)),n.push(new $n("contentType",null,!0)),n.push(new $n("metadata","customMetadata",!0)),au=n,au}function kx(n,e){function t(){const r=n.bucket,s=n.fullPath,i=new pr(r,s);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function Cx(n,e,t){const r={};r.type="file";const s=t.length;for(let i=0;i<s;i++){const o=t[i];r[o.local]=o.xform(r,e[o.server])}return kx(r,n),r}function S3(n,e,t){const r=E3(e);return r===null?null:Cx(n,r,t)}function xx(n,e,t,r){const s=E3(e);if(s===null||!m0(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const u=n.bucket,f=n.fullPath,d="/b/"+o(u)+"/o/"+o(f),m=_0(d,t,r),_=_3({alt:"media",token:c});return m+_})[0]}function Mx(n,e){const t={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class A3{constructor(e,t,r,s){this.url=e,this.method=t,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I3(n){if(!n)throw p0()}function Px(n,e){function t(r,s){const i=S3(n,s,e);return I3(i!==null),i}return t}function Ox(n,e){function t(r,s){const i=S3(n,s,e);return I3(i!==null),xx(i,s,n.host,n._protocol)}return t}function R3(n){function e(t,r){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=K8():s=q8():t.getStatus()===402?s=$8(n.bucket):t.getStatus()===403?s=W8(n.path):s=r,s.status=t.getStatus(),s.serverResponse=r.serverResponse,s}return e}function Nx(n){const e=R3(n);function t(r,s){let i=e(r,s);return r.getStatus()===404&&(i=z8(n.path)),i.serverResponse=s.serverResponse,i}return t}function Dx(n,e,t){const r=e.fullServerUrl(),s=_0(r,n.host,n._protocol),i="GET",o=n.maxOperationRetryTime,a=new A3(s,i,Ox(n,t),o);return a.errorHandler=Nx(e),a}function Lx(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function Vx(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=Lx(null,e)),r}function Bx(n,e,t,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let N="";for(let V=0;V<2;V++)N=N+Math.random().toString().slice(2);return N}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=Vx(e,r,s),u=Mx(c,t),f="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+u+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,d=`\r
--`+l+"--",m=li.getBlob(f,r,d);if(m===null)throw Z8();const _={name:c.fullPath},D=_0(i,n.host,n._protocol),O="POST",x=n.maxUploadRetryTime,w=new A3(D,O,Px(n,t),x);return w.urlParams=_,w.headers=o,w.body=m.uploadData(),w.errorHandler=R3(e),w}class Fx{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=uo.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=uo.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=uo.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,s){if(this.sent_)throw ul("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw ul("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw ul("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw ul("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw ul("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Ux extends Fx{initXhr(){this.xhr_.responseType="text"}}function k3(){return new Ux}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,t){this._service=e,t instanceof pr?this._location=t:this._location=pr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new So(e,t)}get root(){const e=new pr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return w3(this._location.path)}get storage(){return this._service}get parent(){const e=Sx(this._location.path);if(e===null)return null;const t=new pr(this._location.bucket,e);return new So(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw nx(e)}}function Hx(n,e,t){n._throwIfRoot("uploadBytes");const r=Bx(n.storage,n._location,T3(),new li(e,!0),t);return n.storage.makeRequestWithTokens(r,k3).then(s=>({metadata:s,ref:n}))}function jx(n){n._throwIfRoot("getDownloadURL");const e=Dx(n.storage,n._location,T3());return n.storage.makeRequestWithTokens(e,k3).then(t=>{if(t===null)throw ex();return t})}function zx(n,e){const t=Ax(n._location.path,e),r=new pr(n._location.bucket,t);return new So(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $x(n){return/^[A-Za-z]+:\/\//.test(n)}function qx(n,e){return new So(n,e)}function C3(n,e){if(n instanceof y0){const t=n;if(t._bucket==null)throw J8();const r=new So(t,t._bucket);return e!=null?C3(r,e):r}else return e!==void 0?zx(n,e):n}function Kx(n,e){if(e&&$x(e)){if(n instanceof y0)return qx(n,e);throw Rp("To use ref(service, url), the first argument must be a Storage instance.")}else return C3(n,e)}function F_(n,e){const t=e==null?void 0:e[m3];return t==null?null:pr.makeFromBucketSpec(t,n)}function Wx(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:Yb(s,n.app.options.projectId))}class y0{constructor(e,t,r,s,i){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=p3,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=H8,this._maxUploadRetryTime=j8,this._requests=new Set,s!=null?this._bucket=pr.makeFromBucketSpec(s,this._host):this._bucket=F_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=pr.makeFromBucketSpec(this._url,e):this._bucket=F_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){B_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){B_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new So(this,e)}_makeRequest(e,t,r,s,i=!0){if(this._deleted)return new rx(g3());{const o=px(e,this._appId,r,s,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const U_="@firebase/storage",H_="0.12.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x3="storage";function hF(n,e,t){return n=Wt(n),Hx(n,e,t)}function fF(n){return n=Wt(n),jx(n)}function dF(n,e){return n=Wt(n),Kx(n,e)}function Gx(n=wm(),e){n=Wt(n);const r=zh(n,x3).getImmediate({identifier:e}),s=Kb("storage");return s&&Yx(r,...s),r}function Yx(n,e,t,r={}){Wx(n,e,t,r)}function Xx(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new y0(t,r,s,e,Co)}function Qx(){bo(new Ri(x3,Xx,"PUBLIC").setMultipleInstances(!0)),Xr(U_,H_,""),Xr(U_,H_,"esm2017")}Qx();const Jx={apiKey:"AIzaSyBrXS9zQOlmv6BfZgrTLHY402zKsE7Zm9c",authDomain:"geo-kort-og-lydbog.firebaseapp.com",databaseURL:"https://geo-kort-og-lydbog-default-rtdb.europe-west1.firebasedatabase.app",projectId:"geo-kort-og-lydbog",storageBucket:"geo-kort-og-lydbog.appspot.com",messagingSenderId:"447721431608",appId:"1:447721431608:web:d793a2a1904c6176cfbccd",measurementId:"G-5N25FFYYME"},Zx={key:0,class:"loading-screen"},eM=pt("div",{class:"spinner-container"},[pt("div",{class:"spinner"})],-1),tM=[eM],M3={__name:"LoadingSpinner",setup(n){const e=ym(),t=hr(()=>e.loading);return(r,s)=>t.value?($t(),Nn("div",Zx,tM)):Ks("",!0)}},nM={__name:"App",setup(n){const e=Jb(Jx);S8(e),Gx(e);const t=ym(),r=Dk(),s=eh();return _R(s,i=>{r.currentRoute.value.path,t.stopLoading()}),t.startLoading(),(i,o)=>{const a=nr("router-view");return $t(),Nn("div",null,[vt(M3),vt(a),vt(jA)])}}},rM="modulepreload",sM=function(n){return"/"+n},j_={},Hr=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(t.map(a=>{if(a=sM(a),a in j_)return;j_[a]=!0;const l=a.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const u=document.createElement("link");if(u.rel=l?"stylesheet":rM,l||(u.as="script",u.crossOrigin=""),u.href=a,o&&u.setAttribute("nonce",o),document.head.appendChild(u),l)return new Promise((f,d)=>{u.addEventListener("load",f),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${a}`)))})}))}return s.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},iM="/assets/hero-img-CemFhB33.png",oM="/assets/geografiskhave_logo_hvid_med_tekst-BklwCJA6.svg",Oo=n=>(sb("data-v-0235b5a4"),n=n(),ib(),n),aM=Oo(()=>pt("div",{class:"bannerContainer"},[pt("img",{src:iM,alt:"Geografisk Have",class:"banner-image"}),pt("img",{src:oM,alt:"logo",class:"geografisk-logo"})],-1)),lM={class:"geografisk-have"},cM=Oo(()=>pt("h1",null,"Geografisk have",-1)),uM=Oo(()=>pt("p",null," Geografisk Have er en 14 ha stor oplevelsespark og botanisk have med mere end 2000 forskellige trer, buske og planter, som er opdelt i geografiske omrder. Lad dig inspirere af Naturhaven, Krydderurtehaven, Den kologiske Kkkenhave, Staudehaven og mange flere dejlige steder. ",-1)),hM={class:"button-container"},fM=Oo(()=>pt("button",null,"Kort",-1)),dM=Oo(()=>pt("button",null,"Om haven",-1)),pM=Oo(()=>pt("button",null,"Event",-1)),mM=Oo(()=>pt("button",{id:"empty"},"kun for medlemmer ",-1)),gM={__name:"HomePage",setup(n){return ym(),(e,t)=>{const r=nr("router-link");return $t(),Nn("div",null,[vt(M3),aM,pt("div",lM,[cM,uM,pt("div",hM,[vt(r,{to:"/map"},{default:ui(()=>[fM]),_:1}),vt(r,{to:"/omHaven"},{default:ui(()=>[dM]),_:1}),vt(r,{to:"/calender"},{default:ui(()=>[pM]),_:1}),vt(r,{to:"/admin"},{default:ui(()=>[mM]),_:1})])])])}}},_M=Hb(gM,[["__scopeId","data-v-0235b5a4"]]);function vn(n){this.content=n}vn.prototype={constructor:vn,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new vn(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new vn(t)},addToStart:function(n,e){return new vn([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new vn(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new vn(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=vn.from(n),n.size?new vn(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=vn.from(n),n.size?new vn(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=vn.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};vn.from=function(n){if(n instanceof vn)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new vn(e)};function P3(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=P3(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function O3(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,u=Math.min(o.text.length,a.text.length);for(;c<u&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=O3(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class Be{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,s+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new Be(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),s+=a.nodeSize),o=l}return new Be(r,s)}cutByIndex(e,t){return e==t?Be.empty:e==0&&t==this.content.length?this:new Be(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new Be(s,i)}addToStart(e){return new Be([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Be(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return P3(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return O3(this,e,t,r)}findIndex(e,t=-1){if(e==0)return lu(0,e);if(e==this.size)return lu(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=e)return o==e||t>0?lu(r+1,o):lu(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Be.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Be(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Be.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new Be(t||e,r)}static from(e){if(!e)return Be.empty;if(e instanceof Be)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Be([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Be.empty=new Be([],0);const id={index:0,offset:0};function lu(n,e){return id.index=n,id.offset=e,id}function ch(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!ch(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!ch(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Mt=class kp{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&ch(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return kp.none;if(e instanceof kp)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Mt.none=[];class uh extends Error{}class $e{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=D3(this.content,e+this.openStart,t);return r&&new $e(r,this.openStart,this.openEnd)}removeBetween(e,t){return new $e(N3(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return $e.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new $e(Be.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new $e(e,r,s)}}$e.empty=new $e(Be.empty,0,0);function N3(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(s==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(N3(i.content,e-s-1,t-s-1)))}function D3(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=D3(o.content,e-i-1,t);return a&&n.replaceChild(s,o.copy(a))}function yM(n,e,t){if(t.openStart>n.depth)throw new uh("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new uh("Inconsistent open depths");return L3(n,e,t,0)}function L3(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=L3(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return fo(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=bM(t,n);return fo(i,B3(n,o,a,e,r))}else return fo(i,hh(n,e,r))}function V3(n,e){if(!e.type.compatibleContent(n.type))throw new uh("Cannot join "+e.type.name+" onto "+n.type.name)}function Cp(n,e,t){let r=n.node(t);return V3(r,e.node(t)),r}function ho(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Ul(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(ho(n.nodeAfter,r),i++));for(let a=i;a<o;a++)ho(s.child(a),r);e&&e.depth==t&&e.textOffset&&ho(e.nodeBefore,r)}function fo(n,e){return n.type.checkContent(e),n.copy(e)}function B3(n,e,t,r,s){let i=n.depth>s&&Cp(n,e,s+1),o=r.depth>s&&Cp(t,r,s+1),a=[];return Ul(null,n,s,a),i&&o&&e.index(s)==t.index(s)?(V3(i,o),ho(fo(i,B3(n,e,t,r,s+1)),a)):(i&&ho(fo(i,hh(n,e,s+1)),a),Ul(e,t,s,a),o&&ho(fo(o,hh(t,r,s+1)),a)),Ul(r,null,s,a),new Be(a)}function hh(n,e,t){let r=[];if(Ul(null,n,t,r),n.depth>t){let s=Cp(n,e,t+1);ho(fo(s,hh(n,e,t+1)),r)}return Ul(e,null,t,r),new Be(r)}function bM(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy(Be.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class ac{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Mt.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new fh(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new ac(t,r,i)}static resolveCached(e,t){for(let s=0;s<od.length;s++){let i=od[s];if(i.pos==t&&i.doc==e)return i}let r=od[ad]=ac.resolve(e,t);return ad=(ad+1)%vM,r}}let od=[],ad=0,vM=12;class fh{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const EM=Object.create(null);let po=class xp{constructor(e,t,r,s=Mt.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||Be.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&ch(this.attrs,t||e.defaultAttrs||EM)&&Mt.sameSet(this.marks,r||Mt.none)}copy(e=null){return e==this.content?this:new xp(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new xp(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return $e.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new $e(c,s.depth-o,i.depth-o)}replace(e,t,r){return yM(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return ac.resolveCached(this,e)}resolveNoCache(e){return ac.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),F3(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=Be.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=Mt.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!Mt.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=Be.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,s,r)}};po.prototype.text=void 0;class dh extends po{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):F3(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new dh(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new dh(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function F3(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Ao{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new wM(e,t);if(r.next==null)return Ao.empty;let s=U3(r);r.next&&r.err("Unexpected trailing text");let i=CM(kM(s));return xM(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return Be.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:u,next:f}=o.next[c];if(!(u.isText||u.hasRequiredAttrs())&&s.indexOf(f)==-1){s.push(f);let d=i(f,a.concat(u));if(d)return d}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Ao.empty=new Ao(!0);class wM{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function U3(n){let e=[];do e.push(TM(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function TM(n){let e=[];do e.push(SM(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function SM(n){let e=RM(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=AM(n,e);else break;return e}function z_(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function AM(n,e){let t=z_(n),r=t;return n.eat(",")&&(n.next!="}"?r=z_(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function IM(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.groups.indexOf(e)>-1&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function RM(n){if(n.eat("(")){let e=U3(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=IM(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function kM(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let u=t();s(i(o.expr,l),u),l=u}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let u=t();r(l,u),s(i(o.expr,l),u),l=u}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function H3(n,e){return e-n}function $_(n,e){let t=[];return r(e),t.sort(H3);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&r(l)}}}function CM(n){let e=Object.create(null);return t($_(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<s.length;u++)s[u][0]==a&&(c=s[u][1]);$_(n,l).forEach(u=>{c||s.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new Ao(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(H3);i.next.push({type:s[o][0],next:e[a.join(",")]||t(a)})}return i}}function xM(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function j3(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function z3(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function $3(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new MM(n[t]);return e}let q_=class q3{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=$3(r.attrs),this.defaultAttrs=j3(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Ao.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:z3(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new po(this,this.computeAttrs(e),Be.from(t),Mt.setFrom(r))}createChecked(e=null,t,r){return t=Be.from(t),this.checkContent(t),new po(this,this.computeAttrs(e),t,Mt.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=Be.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore(Be.empty,!0);return i?new po(this,e,t.append(i),Mt.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Mt.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new q3(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class MM{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class ff{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=$3(s.attrs),this.excluded=null;let i=j3(this.attrs);this.instance=i?new Mt(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Mt(this,z3(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new ff(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class PM{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=vn.from(e.nodes),t.marks=vn.from(e.marks||{}),this.nodes=q_.compile(this.spec.nodes,this),this.marks=ff.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Ao.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?K_(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:K_(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof q_){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new dh(r,r.defaultAttrs,e,Mt.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return po.fromJSON(this,e)}markFromJSON(e){return Mt.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function K_(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function OM(n){return n.tag!=null}function NM(n){return n.style!=null}class xa{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{OM(r)?this.tags.push(r):NM(r)&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let s=e.nodes[r.node];return s.contentMatch.matchType(s)})}parse(e,t={}){let r=new G_(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new G_(this,t,!0);return r.addAll(e,t.from,t.to),$e.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(VM(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Y_(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=Y_(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new xa(e,xa.schemaRules(e)))}}const K3={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},DM={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},W3={ol:!0,ul:!0},ph=1,mh=2,Hl=4;function W_(n,e,t){return e!=null?(e?ph:0)|(e==="full"?mh:0):n&&n.whitespace=="pre"?ph|mh:t&~Hl}class cu{constructor(e,t,r,s,i,o,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=s,this.solid=i,this.options=a,this.content=[],this.activeMarks=Mt.none,this.stashMarks=[],this.match=o||(a&Hl?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Be.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&ph)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=Be.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Be.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let s=r[t];(this.type?this.type.allowsMarkType(s.type):BM(s.type,e))&&!s.isInSet(this.activeMarks)&&(this.activeMarks=s.addToSet(this.activeMarks),this.pendingMarks=s.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!K3.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class G_{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let s=t.topNode,i,o=W_(null,t.preserveWhitespace,0)|(r?Hl:0);s?i=new cu(s.type,s.attrs,Mt.none,Mt.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new cu(null,null,Mt.none,Mt.none,!0,null,o):i=new cu(e.schema.topNodeType,null,Mt.none,Mt.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.style;if(!r||!r.length)return t();let s=this.readStyles(e.style);if(!s)return;let[i,o]=s,a=this.top;for(let l=0;l<o.length;l++)this.removePendingMark(o[l],a);for(let l=0;l<i.length;l++)this.addPendingMark(i[l]);t();for(let l=0;l<i.length;l++)this.removePendingMark(i[l],a);for(let l=0;l<o.length;l++)this.addPendingMark(o[l])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&mh||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&ph)r.options&mh?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let s=r.content[r.content.length-1],i=e.previousSibling;(!s||i&&i.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),s;W3.hasOwnProperty(r)&&this.parser.normalizeLists&&LM(e);let i=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,t));if(i?i.ignore:DM.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(e=i.skip);let o,a=this.top,l=this.needsBlock;if(K3.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}i&&i.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(a),this.needsBlock=l}else this.withStyleRules(e,()=>{this.addElementByRule(e,i,i.consuming===!1?s:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=Mt.none,r=Mt.none;for(let s=0,i=e.length;s<i;s++){let o=e.item(s);for(let a=void 0;;){let l=this.parser.matchStyle(o,e.getPropertyValue(o),this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(c=>{l.clearMark(c)&&(r=c.addToSet(r))}):t=this.parser.schema.marks[l.mark].create(l.attrs).addToSet(t),l.consuming===!1)a=l;else break}}return[t,r]}addElementByRule(e,t,r){let s,i,o;t.node?(i=this.parser.schema.nodes[t.node],i.isLeaf?this.insertNode(i.create(t.attrs))||this.leafFallback(e):s=this.enter(i,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}s&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,t,r){let s=t||0;for(let i=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];i!=o;i=i.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(i);this.findAtPoint(e,s)}findPlace(e){let t,r;for(let s=this.open;s>=0;s--){let i=this.nodes[s],o=i.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=i,!o.length)||i.solid)break}if(!t)return!1;this.sync(r);for(let s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let s=0;s<e.marks.length;s++)(!t.type||t.type.allowsMarkType(e.marks[s].type))&&(r=e.marks[s].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let s=this.findPlace(e.create(t));return s&&this.enterInner(e,t,!0,r),s}enterInner(e,t=null,r=!1,s){this.closeExtra();let i=this.top;i.applyPending(e),i.match=i.match&&i.match.matchType(e);let o=W_(e,s,i.options);i.options&Hl&&i.content.length==0&&(o|=Hl),this.nodes.push(new cu(e,t,i.activeMarks,i.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let u=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&u.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=FM(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let s=this.nodes[r];if(s.pendingMarks.lastIndexOf(e)>-1)s.pendingMarks=e.removeFromSet(s.pendingMarks);else{s.activeMarks=e.removeFromSet(s.activeMarks);let o=s.popFromStashMark(e);o&&s.type&&s.type.allowsMarkType(o.type)&&(s.activeMarks=o.addToSet(s.activeMarks))}if(s==t)break}}}function LM(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&W3.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function VM(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Y_(n){let e={};for(let t in n)e[t]=n[t];return e}function BM(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&o(u))return!0}};if(o(s.contentMatch))return!0}}function FM(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class Gr{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=ld(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],u=this.serializeMark(c,o.isInline,t);u&&(i.push([c,s]),s.appendChild(u.dom),s=u.contentDOM||u.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=Gr.renderSpec(ld(t),this.nodes[e.type.name](e));if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&Gr.renderSpec(ld(r),s(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let s=t[0],i=s.indexOf(" ");i>0&&(r=s.slice(0,i),s=s.slice(i+1));let o,a=r?e.createElementNS(r,s):e.createElement(s),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let u in l)if(l[u]!=null){let f=u.indexOf(" ");f>0?a.setAttributeNS(u.slice(0,f),u.slice(f+1),l[u]):a.setAttribute(u,l[u])}}for(let u=c;u<t.length;u++){let f=t[u];if(f===0){if(u<t.length-1||u>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:d,contentDOM:m}=Gr.renderSpec(e,f,r);if(a.appendChild(d),m){if(o)throw new RangeError("Multiple content holes");o=m}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Gr(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=X_(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return X_(e.marks)}}function X_(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function ld(n){return n.document||window.document}const G3=65535,Y3=Math.pow(2,16);function UM(n,e){return n+e*Y3}function Q_(n){return n&G3}function HM(n){return(n-(n&G3))/Y3}const X3=1,Q3=2,Ou=4,J3=8;class Mp{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&J3)>0}get deletedBefore(){return(this.delInfo&(X3|Ou))>0}get deletedAfter(){return(this.delInfo&(Q3|Ou))>0}get deletedAcross(){return(this.delInfo&Ou)>0}}class fr{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&fr.empty)return fr.empty}recover(e){let t=0,r=Q_(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+HM(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+o],f=l+c;if(e<=f){let d=c?e==l?-1:e==f?1:t:t,m=l+s+(d<0?0:u);if(r)return m;let _=e==(t<0?l:f)?null:UM(a/3,e-l),D=e==l?Q3:e==f?X3:Ou;return(t<0?e!=l:e!=f)&&(D|=J3),new Mp(m,D,_)}s+=u-c}return r?e+s:new Mp(e+s,0,null)}touches(e,t){let r=0,s=Q_(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+t],u=this.ranges[s+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new fr(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?fr.empty:new fr(e<0?[0,-e,0]:[0,0,e])}}fr.empty=new fr([]);class ma{constructor(e=[],t,r=0,s=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=s}slice(e=0,t=this.maps.length){return new ma(this.maps,this.mirror,e,t)}copy(){return new ma(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let s=e.getMirror(t);this.appendMap(e.maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e.maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new ma;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this.maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this.maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new Mp(e,s,null)}}const cd=Object.create(null);class Un{getMap(){return fr.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=cd[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in cd)throw new RangeError("Duplicate use of step JSON ID "+e);return cd[e]=t,t.prototype.jsonID=e,t}}class nn{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new nn(e,null)}static fail(e){return new nn(null,e)}static fromReplace(e,t,r,s){try{return nn.ok(e.replace(t,r,s))}catch(i){if(i instanceof uh)return nn.fail(i.message);throw i}}}function b0(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(b0(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return Be.fromArray(r)}class fi extends Un{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new $e(b0(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return nn.fromReplace(e,this.from,this.to,i)}invert(){return new Yr(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new fi(t.pos,r.pos,this.mark)}merge(e){return e instanceof fi&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new fi(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new fi(t.from,t.to,e.markFromJSON(t.mark))}}Un.jsonID("addMark",fi);class Yr extends Un{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new $e(b0(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return nn.fromReplace(e,this.from,this.to,r)}invert(){return new fi(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Yr(t.pos,r.pos,this.mark)}merge(e){return e instanceof Yr&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Yr(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Yr(t.from,t.to,e.markFromJSON(t.mark))}}Un.jsonID("removeMark",Yr);class di extends Un{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return nn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return nn.fromReplace(e,this.pos,this.pos+1,new $e(Be.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new di(this.pos,t.marks[s]);return new di(this.pos,this.mark)}}return new Ma(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new di(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new di(t.pos,e.markFromJSON(t.mark))}}Un.jsonID("addNodeMark",di);class Ma extends Un{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return nn.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return nn.fromReplace(e,this.pos,this.pos+1,new $e(Be.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new di(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ma(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Ma(t.pos,e.markFromJSON(t.mark))}}Un.jsonID("removeNodeMark",Ma);class fn extends Un{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&Pp(e,this.from,this.to)?nn.fail("Structure replace would overwrite content"):nn.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new fr([this.from,this.to-this.from,this.slice.size])}invert(e){return new fn(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new fn(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof fn)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?$e.empty:new $e(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new fn(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?$e.empty:new $e(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new fn(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new fn(t.from,t.to,$e.fromJSON(e,t.slice),!!t.structure)}}Un.jsonID("replace",fn);class pn extends Un{constructor(e,t,r,s,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Pp(e,this.from,this.gapFrom)||Pp(e,this.gapTo,this.to)))return nn.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return nn.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?nn.fromReplace(e,this.from,this.to,r):nn.fail("Content does not fit in gap")}getMap(){return new fr([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new pn(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new pn(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new pn(t.from,t.to,t.gapFrom,t.gapTo,$e.fromJSON(e,t.slice),t.insert,!!t.structure)}}Un.jsonID("replaceAround",pn);function Pp(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function jM(n,e,t,r){let s=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let f=l.marks;if(!r.isInSet(f)&&u.type.allowsMarkType(r.type)){let d=Math.max(c,e),m=Math.min(c+l.nodeSize,t),_=r.addToSet(f);for(let D=0;D<f.length;D++)f[D].isInSet(_)||(o&&o.to==d&&o.mark.eq(f[D])?o.to=m:s.push(o=new Yr(d,m,f[D])));a&&a.to==d?a.to=m:i.push(a=new fi(d,m,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function zM(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof ff){let c=o.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let u=0;u<l.length;u++){let f=l[u],d;for(let m=0;m<s.length;m++){let _=s[m];_.step==i-1&&f.eq(s[m].style)&&(d=_)}d?(d.to=c,d.step=i):s.push({style:f,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>n.step(new Yr(o.from,o.to,o.style)))}function Z3(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,f=r.matchType(c.type);if(!f)o.push(new fn(a,u,$e.empty));else{r=f;for(let d=0;d<c.marks.length;d++)t.allowsMarkType(c.marks[d].type)||n.step(new Yr(a,u,c.marks[d]));if(s&&c.isText&&t.whitespace!="pre"){let d,m=/\r?\n|\r/g,_;for(;d=m.exec(c.text);)_||(_=new $e(Be.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new fn(a+d.index,a+d.index+d[0].length,_))}}a=u}if(!r.validEnd){let l=r.fillBefore(Be.empty,!0);n.replace(a,a,new $e(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function $M(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function $a(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,t))return r;if(r==0||s.type.spec.isolating||!$M(s,i,o))break}return null}function qM(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,u=Be.empty,f=0;for(let _=i,D=!1;_>t;_--)D||r.index(_)>0?(D=!0,u=Be.from(r.node(_).copy(u)),f++):l--;let d=Be.empty,m=0;for(let _=i,D=!1;_>t;_--)D||s.after(_+1)<s.end(_)?(D=!0,d=Be.from(s.node(_).copy(d)),m++):c++;n.step(new pn(l,c,o,a,new $e(u.append(d),f,m),u.size-f,!0))}function v0(n,e,t=null,r=n){let s=KM(n,e),i=s&&WM(r,e);return i?s.map(J_).concat({type:e,attrs:t}).concat(i.map(J_)):null}function J_(n){return{type:n,attrs:null}}function KM(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function WM(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function GM(n,e,t){let r=Be.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Be.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new pn(s,i,s,i,new $e(r,0,0),t.length,!0))}function YM(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,s)&&JM(n.doc,n.mapping.slice(i).map(a),r)){let l=null;if(r.schema.linebreakReplacement){let d=r.whitespace=="pre",m=!!r.contentMatch.matchType(r.schema.linebreakReplacement);d&&!m?l=!1:!d&&m&&(l=!0)}l===!1&&QM(n,o,a,i),Z3(n,n.mapping.slice(i).map(a,1),r,void 0,l===null);let c=n.mapping.slice(i),u=c.map(a,1),f=c.map(a+o.nodeSize,1);return n.step(new pn(u,f,u+1,f-1,new $e(Be.from(r.create(s,null,o.marks)),0,0),1,!0)),l===!0&&XM(n,o,a,i),!1}})}function XM(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function QM(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function JM(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function ZM(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new pn(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new $e(Be.from(o),0,0),1,!0))}function ga(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,u=t-2;c>i;c--,u--){let f=s.node(c),d=s.index(c);if(f.type.spec.isolating)return!1;let m=f.content.cutByIndex(d,f.childCount),_=r&&r[u+1];_&&(m=m.replaceChild(0,_.type.create(_.attrs)));let D=r&&r[u]||f;if(!f.canReplace(d+1,f.childCount)||!D.type.validContent(m))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function eP(n,e,t=1,r){let s=n.doc.resolve(e),i=Be.empty,o=Be.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){i=Be.from(s.node(a).copy(i));let u=r&&r[c];o=Be.from(u?u.type.create(u.attrs,o):s.node(a).copy(o))}n.step(new fn(e,e,new $e(i.append(o),t,t),!0))}function Li(n,e){let t=n.resolve(e),r=t.index();return ew(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function ew(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function df(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):t>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&ew(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function tP(n,e,t){let r=new fn(e-t,e+t,$e.empty,!0);n.step(r)}function nP(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function tw(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),u=!1;if(i==1)u=c.canReplace(l,l,s);else{let f=c.contentMatchAt(l).findWrapping(s.firstChild.type);u=f&&c.canReplaceWith(l,l,f[0])}if(u)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function pf(n,e,t=e,r=$e.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return nw(s,i,r)?new fn(e,t,r):new rP(s,i,r).fit()}function nw(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class rP{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=Be.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=Be.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new $e(i,o,a);return e>-1?new pn(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new fn(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=ud(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,f=null;if(t==1&&(o?c.matchType(o.type)||(f=c.fillBefore(Be.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:f};if(t==2&&o&&(u=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=ud(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new $e(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=ud(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new $e(El(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new $e(El(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let D=0;D<i.length;D++)this.openFrontierNode(i[D]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,u=[],{match:f,type:d}=this.frontier[t];if(s){for(let D=0;D<s.childCount;D++)u.push(s.child(D));f=f.matchFragment(s)}let m=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let D=a.child(c),O=f.matchType(D.type);if(!O)break;c++,(c>1||l==0||D.content.size)&&(f=O,u.push(rw(D.mark(d.allowedMarks(D.marks)),c==1?l:0,c==a.childCount?m:-1)))}let _=c==a.childCount;_||(m=-1),this.placed=wl(this.placed,t,Be.from(u)),this.frontier[t].match=f,_&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let D=0,O=a;D<m;D++){let x=O.lastChild;this.frontier.push({type:x.type,match:x.contentMatchAt(x.childCount)}),O=x.content}this.unplaced=_?e==0?$e.empty:new $e(El(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new $e(El(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!hd(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=hd(e,t,s,r,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=hd(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=wl(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=wl(this.placed,this.depth,Be.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(Be.empty,!0);t.childCount&&(this.placed=wl(this.placed,this.frontier.length,t))}}function El(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(El(n.firstChild.content,e-1,t)))}function wl(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(wl(n.lastChild.content,e-1,t)))}function ud(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function rw(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,rw(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(Be.empty,!0)))),n.copy(r)}function hd(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!sP(t,i.content,o)?a:null}function sP(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function iP(n){return n.spec.defining||n.spec.definingForContent}function oP(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if(nw(s,i,r))return n.step(new fn(e,t,r));let o=iw(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let d=s.depth,m=s.pos-1;d>0;d--,m--){let _=s.node(d).type.spec;if(_.defining||_.definingAsContext||_.isolating)break;o.indexOf(d)>-1?a=d:s.before(d)==m&&o.splice(1,0,-d)}let l=o.indexOf(a),c=[],u=r.openStart;for(let d=r.content,m=0;;m++){let _=d.firstChild;if(c.push(_),m==r.openStart)break;d=_.content}for(let d=u-1;d>=0;d--){let m=c[d],_=iP(m.type);if(_&&!m.sameMarkup(s.node(Math.abs(a)-1)))u=d;else if(_||!m.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let m=(d+u+1)%(r.openStart+1),_=c[m];if(_)for(let D=0;D<o.length;D++){let O=o[(D+l)%o.length],x=!0;O<0&&(x=!1,O=-O);let w=s.node(O-1),N=s.index(O-1);if(w.canReplaceWith(N,N,_.type,_.marks))return n.replace(s.before(O),x?i.after(O):t,new $e(sw(r.content,0,r.openStart,m),m,r.openEnd))}}let f=n.steps.length;for(let d=o.length-1;d>=0&&(n.replace(e,t,r),!(n.steps.length>f));d--){let m=o[d];m<0||(e=s.before(m),t=i.after(m))}}function sw(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(sw(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(Be.empty,!0))}return n}function aP(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=nP(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new $e(Be.from(r),0,0))}function lP(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=iw(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function iw(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class _a extends Un{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return nn.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return nn.fromReplace(e,this.pos,this.pos+1,new $e(Be.from(s),0,t.isLeaf?0:1))}getMap(){return fr.empty}invert(e){return new _a(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new _a(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new _a(t.pos,t.attr,t.value)}}Un.jsonID("attr",_a);class lc extends Un{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return nn.ok(r)}getMap(){return fr.empty}invert(e){return new lc(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new lc(t.attr,t.value)}}Un.jsonID("docAttr",lc);let Pa=class extends Error{};Pa=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Pa.prototype=Object.create(Error.prototype);Pa.prototype.constructor=Pa;Pa.prototype.name="TransformError";class cP{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new ma}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Pa(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=$e.empty){let s=pf(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new $e(Be.from(r),0,0))}delete(e,t){return this.replace(e,t,$e.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return oP(this,e,t,r),this}replaceRangeWith(e,t,r){return aP(this,e,t,r),this}deleteRange(e,t){return lP(this,e,t),this}lift(e,t){return qM(this,e,t),this}join(e,t=1){return tP(this,e,t),this}wrap(e,t){return GM(this,e,t),this}setBlockType(e,t=e,r,s=null){return YM(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return ZM(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new _a(e,t,r)),this}setDocAttribute(e,t){return this.step(new lc(e,t)),this}addNodeMark(e,t){return this.step(new di(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Mt)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Ma(e,t)),this}split(e,t=1,r){return eP(this,e,t,r),this}addMark(e,t,r){return jM(this,e,t,r),this}removeMark(e,t,r){return zM(this,e,t,r),this}clearIncompatible(e,t,r){return Z3(this,e,t,r),this}}const fd=Object.create(null);class ft{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new uP(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=$e.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?$e.empty:t),a==0&&ty(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),ty(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ct(e):ea(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?ea(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):ea(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Or(e.node(0))}static atStart(e){return ea(e,e,0,0,1)||new Or(e)}static atEnd(e){return ea(e,e,e.content.size,e.childCount,-1)||new Or(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=fd[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in fd)throw new RangeError("Duplicate use of selection JSON ID "+e);return fd[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ct.between(this.$anchor,this.$head).getBookmark()}}ft.prototype.visible=!0;class uP{constructor(e,t){this.$from=e,this.$to=t}}let Z_=!1;function ey(n){!Z_&&!n.parent.inlineContent&&(Z_=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ct extends ft{constructor(e,t=e){ey(e),ey(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return ft.near(r);let s=e.resolve(t.map(this.anchor));return new ct(s.parent.inlineContent?s:r,r)}replace(e,t=$e.empty){if(super.replace(e,t),t==$e.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ct&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new mf(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ct(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=ft.findFrom(t,r,!0)||ft.findFrom(t,-r,!0);if(i)t=i.$head;else return ft.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(ft.findFrom(e,-r,!0)||ft.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ct(e,t)}}ft.jsonID("text",ct);class mf{constructor(e,t){this.anchor=e,this.head=t}map(e){return new mf(e.map(this.anchor),e.map(this.head))}resolve(e){return ct.between(e.resolve(this.anchor),e.resolve(this.head))}}class tt extends ft{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?ft.near(i):new tt(i)}content(){return new $e(Be.from(this.node),0,0)}eq(e){return e instanceof tt&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new E0(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new tt(e.resolve(t.anchor))}static create(e,t){return new tt(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}tt.prototype.visible=!1;ft.jsonID("node",tt);class E0{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new mf(r,r):new E0(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&tt.isSelectable(r)?new tt(t):ft.near(t)}}class Or extends ft{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=$e.empty){if(t==$e.empty){e.delete(0,e.doc.content.size);let r=ft.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Or(e)}map(e){return new Or(e)}eq(e){return e instanceof Or}getBookmark(){return hP}}ft.jsonID("all",Or);const hP={map(){return this},resolve(n){return new Or(n)}};function ea(n,e,t,r,s,i=!1){if(e.inlineContent)return ct.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&tt.isSelectable(a))return tt.create(n,t-(s<0?a.nodeSize:0))}else{let l=ea(n,a,t+s,s<0?a.childCount:0,s,i);if(l)return l}t+=a.nodeSize*s}return null}function ty(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof fn||s instanceof pn))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,u)=>{o==null&&(o=u)}),n.setSelection(ft.near(n.doc.resolve(o),t))}const ny=1,uu=2,ry=4;class fP extends cP{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|ny)&~uu,this.storedMarks=null,this}get selectionSet(){return(this.updated&ny)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=uu,this}ensureMarks(e){return Mt.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&uu)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~uu,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Mt.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),this.selection.empty||this.setSelection(ft.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=ry,this}get scrolledIntoView(){return(this.updated&ry)>0}}function sy(n,e){return!e||!n?n:n.bind(e)}class Tl{constructor(e,t,r){this.name=e,this.init=sy(t.init,r),this.apply=sy(t.apply,r)}}const dP=[new Tl("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Tl("selection",{init(n,e){return n.selection||ft.atStart(e.doc)},apply(n){return n.selection}}),new Tl("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Tl("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class dd{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=dP.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Tl(r.key,r.spec.state,r))})}}class ra{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,o)){if(u.setMeta("appendedTransaction",e),!s){s=[];for(let f=0;f<this.config.plugins.length;f++)s.push(f<o?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new ra(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new fP(this)}static create(e){let t=new dd(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new ra(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new dd(this.schema,e.plugins),r=t.fields,s=new ra(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new dd(e.schema,e.plugins),i=new ra(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=po.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=ft.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function ow(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=ow(s,e,{})),t[r]=s}return t}class Ar{constructor(e){this.spec=e,this.props={},e.props&&ow(e.props,this,this.props),this.key=e.key?e.key.key:aw("plugin")}getState(e){return e[this.key]}}const pd=Object.create(null);function aw(n){return n in pd?n+"$"+ ++pd[n]:(pd[n]=0,n+"$")}class Vi{constructor(e="key"){this.key=aw(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const wn=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},cc=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Op=null;const ms=function(n,e,t){let r=Op||(Op=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},pP=function(){Op=null},Io=function(n,e,t,r){return t&&(iy(n,e,t,r,-1)||iy(n,e,t,r,1))},mP=/^(img|br|input|textarea|hr)$/i;function iy(n,e,t,r,s){for(;;){if(n==t&&e==r)return!0;if(e==(s<0?0:Kr(n))){let i=n.parentNode;if(!i||i.nodeType!=1||Oc(n)||mP.test(n.nodeName)||n.contentEditable=="false")return!1;e=wn(n)+(s<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.contentEditable=="false")return!1;e=s<0?Kr(n):0}else return!1}}function Kr(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function gP(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Kr(n)}else if(n.parentNode&&!Oc(n))e=wn(n),n=n.parentNode;else return null}}function _P(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Oc(n))e=wn(n)+1,n=n.parentNode;else return null}}function yP(n,e,t){for(let r=e==0,s=e==Kr(n);r||s;){if(n==t)return!0;let i=wn(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==Kr(n)}}function Oc(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const gf=function(n){return n.focusNode&&Io(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function eo(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function bP(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function vP(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const rs=typeof navigator<"u"?navigator:null,oy=typeof document<"u"?document:null,Bi=rs&&rs.userAgent||"",Np=/Edge\/(\d+)/.exec(Bi),lw=/MSIE \d/.exec(Bi),Dp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Bi),sr=!!(lw||Dp||Np),wi=lw?document.documentMode:Dp?+Dp[1]:Np?+Np[1]:0,Vr=!sr&&/gecko\/(\d+)/i.test(Bi);Vr&&+(/Firefox\/(\d+)/.exec(Bi)||[0,0])[1];const Lp=!sr&&/Chrome\/(\d+)/.exec(Bi),Kn=!!Lp,EP=Lp?+Lp[1]:0,Wn=!sr&&!!rs&&/Apple Computer/.test(rs.vendor),Oa=Wn&&(/Mobile\/\w+/.test(Bi)||!!rs&&rs.maxTouchPoints>2),br=Oa||(rs?/Mac/.test(rs.platform):!1),wP=rs?/Win/.test(rs.platform):!1,Cr=/Android \d/.test(Bi),Nc=!!oy&&"webkitFontSmoothing"in oy.documentElement.style,TP=Nc?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function SP(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function ds(n,e){return typeof n=="number"?n:n[e]}function AP(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function ay(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;o=cc(o)){if(o.nodeType!=1)continue;let a=o,l=a==i.body,c=l?SP(i):AP(a),u=0,f=0;if(e.top<c.top+ds(r,"top")?f=-(c.top-e.top+ds(s,"top")):e.bottom>c.bottom-ds(r,"bottom")&&(f=e.bottom-e.top>c.bottom-c.top?e.top+ds(s,"top")-c.top:e.bottom-c.bottom+ds(s,"bottom")),e.left<c.left+ds(r,"left")?u=-(c.left-e.left+ds(s,"left")):e.right>c.right-ds(r,"right")&&(u=e.right-c.right+ds(s,"right")),u||f)if(l)i.defaultView.scrollBy(u,f);else{let d=a.scrollLeft,m=a.scrollTop;f&&(a.scrollTop+=f),u&&(a.scrollLeft+=u);let _=a.scrollLeft-d,D=a.scrollTop-m;e={left:e.left-_,top:e.top-D,right:e.right-_,bottom:e.bottom-D}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function IP(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:cw(n.dom)}}function cw(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=cc(r));return e}function RP({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;uw(t,r==0?0:r-e)}function uw(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let $o=null;function kP(n){if(n.setActive)return n.setActive();if($o)return n.focus($o);let e=cw(n);n.focus($o==null?{get preventScroll(){return $o={preventScroll:!0},!0}}:void 0),$o||($o=!1,uw(e,0))}function hw(n,e){let t,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let u=n.firstChild,f=0;u;u=u.nextSibling,f++){let d;if(u.nodeType==1)d=u.getClientRects();else if(u.nodeType==3)d=ms(u).getClientRects();else continue;for(let m=0;m<d.length;m++){let _=d[m];if(_.top<=o&&_.bottom>=a){o=Math.max(_.bottom,o),a=Math.min(_.top,a);let D=_.left>e.left?_.left-e.left:_.right<e.left?e.left-_.right:0;if(D<r){t=u,r=D,s=D&&t.nodeType==3?{left:_.right<e.left?_.right:_.left,top:e.top}:e,u.nodeType==1&&D&&(i=f+(e.left>=(_.left+_.right)/2?1:0));continue}}else _.top>e.top&&!l&&_.left<=e.left&&_.right>=e.left&&(l=u,c={left:Math.max(_.left,Math.min(_.right,e.left)),top:_.top});!t&&(e.left>=_.right&&e.top>=_.top||e.left>=_.left&&e.top>=_.bottom)&&(i=f+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?CP(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:hw(t,s)}function CP(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=Gs(r,1);if(i.top!=i.bottom&&w0(e,i))return{node:n,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function w0(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function xP(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function MP(n,e,t){let{node:r,offset:s}=hw(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function PP(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0);if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)){let l=a.dom.getBoundingClientRect();if(a.node.isBlock&&a.parent&&(!o&&l.left>r.left||l.top>r.top?s=a.posBefore:(!o&&l.right<r.left||l.bottom<r.top)&&(s=a.posAfter),o=!0),!a.contentDOM&&s<0&&!a.node.isText)return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter}i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function fw(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(w0(e,c))return fw(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function OP(n,e){let t=n.dom.ownerDocument,r,s=0,i=vP(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!w0(e,c)||(o=fw(n.dom,e,c),!o))return null}if(Wn)for(let c=o;r&&c;c=cc(c))c.draggable&&(r=void 0);if(o=xP(o,e),r){if(Vr&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let u=r.childNodes[s],f;u.nodeName=="IMG"&&(f=u.getBoundingClientRect()).right<=e.left&&f.bottom>e.top&&s++}let c;Nc&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=PP(n,r,s,e))}a==null&&(a=MP(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function ly(n){return n.top<n.bottom||n.left<n.right}function Gs(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(ly(r))return r}return Array.prototype.find.call(t,ly)||n.getBoundingClientRect()}const NP=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function dw(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=Nc||Vr;if(r.nodeType==3)if(o&&(NP.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=Gs(ms(r,s,s),t);if(Vr&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=Gs(ms(r,s-1,s-1),-1);if(c.top==l.top){let u=Gs(ms(r,s,s+1),-1);if(u.top!=l.top)return hl(u,u.left<c.left)}}return l}else{let l=s,c=s,u=t<0?1:-1;return t<0&&!s?(c++,u=-1):t>=0&&s==r.nodeValue.length?(l--,u=1):t<0?l--:c++,hl(Gs(ms(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==Kr(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return md(l.getBoundingClientRect(),!1)}if(i==null&&s<Kr(r)){let l=r.childNodes[s];if(l.nodeType==1)return md(l.getBoundingClientRect(),!0)}return md(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==Kr(r))){let l=r.childNodes[s-1],c=l.nodeType==3?ms(l,Kr(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return hl(Gs(c,1),!1)}if(i==null&&s<Kr(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?ms(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return hl(Gs(c,-1),!0)}return hl(Gs(r.nodeType==3?ms(r):r,-t),t>=0)}function hl(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function md(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function pw(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function DP(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return pw(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=dw(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=ms(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?o.top-u.top>(u.bottom-o.top)*2:u.bottom-o.bottom>(o.bottom-u.top)*2))return!1}}return!0})}const LP=/[\u0590-\u08ac]/;function VP(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return!LP.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:pw(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:f}=n.domSelectionRange(),d=a.caretBidiLevel;a.modify("move",t,"character");let m=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:_,focusOffset:D}=n.domSelectionRange(),O=_&&!m.contains(_.nodeType==1?_:_.parentNode)||l==_&&c==D;try{a.collapse(u,f),l&&(l!=u||c!=f)&&a.extend&&a.extend(l,c)}catch{}return d!=null&&(a.caretBidiLevel=d),O})}let cy=null,uy=null,hy=!1;function BP(n,e,t){return cy==e&&uy==t?hy:(cy=e,uy=t,hy=t=="up"||t=="down"?DP(n,e,t):VP(n,e,t))}const Sr=0,fy=1,ro=2,ss=3;class Dc{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=Sr,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>wn(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)s=s.children[0];return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof gw){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof mw&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?wn(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?wn(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let u=o+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=o;for(let f=a;f>0;f--){let d=this.children[f-1];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(1)){s=wn(d.dom)+1;break}e-=d.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let f=this.children[u];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(-1)){i=wn(f.dom);break}t+=f.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let d=0,m=0;d<this.children.length;d++){let _=this.children[d],D=m+_.size;if(i>m&&o<D)return _.setSelection(e-m-_.border,t-m-_.border,r,s);m=D}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.getSelection(),u=!1;if((Vr||Wn)&&e==t){let{node:d,offset:m}=a;if(d.nodeType==3){if(u=!!(m&&d.nodeValue[m-1]==`
`),u&&m==d.nodeValue.length)for(let _=d,D;_;_=_.parentNode){if(D=_.nextSibling){D.nodeName=="BR"&&(a=l={node:D.parentNode,offset:wn(D)+1});break}let O=_.pmViewDesc;if(O&&O.node&&O.node.isBlock)break}}else{let _=d.childNodes[m-1];u=_&&(_.nodeName=="BR"||_.contentEditable=="false")}}if(Vr&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let d=c.focusNode.childNodes[c.focusOffset];d&&d.contentEditable=="false"&&(s=!0)}if(!(s||u&&Wn)&&Io(a.node,a.offset,c.anchorNode,c.anchorOffset)&&Io(l.node,l.offset,c.focusNode,c.focusOffset))return;let f=!1;if((c.extend||e==t)&&!u){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),f=!0}catch{}}if(!f){if(e>t){let m=a;a=l,l=m}let d=document.createRange();d.setEnd(l.node,l.offset),d.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(d)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?ro:fy,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=ss:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?ro:ss}r=o}this.dirty=ro}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?ro:fy;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class mw extends Dc{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==Sr&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class FP extends Dc{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class Ro extends Dc{constructor(e,t,r,s){super(e,[],r,s),this.mark=t}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=Gr.renderSpec(document,t.type.spec.toDOM(t,r))),new Ro(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&ss||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=ss&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Sr){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Sr}}slice(e,t,r){let s=Ro.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=Fp(i,t,o,r)),e>0&&(i=Fp(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}}class Ti extends Dc{constructor(e,t,r,s,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),u=c&&c.dom,f=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:f}=Gr.renderSpec(document,t.type.spec.toDOM(t)));!f&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let d=u;return u=bw(u,r,t),c?l=new UP(e,t,r,s,u,f||null,d,c,i,o+1):t.isText?new _f(e,t,r,s,u,d,i):new Ti(e,t,r,s,u,f||null,d,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Be.empty)}return e}matchesNode(e,t,r){return this.dirty==Sr&&e.eq(this.node)&&Bp(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new jP(this,o&&o.node,e);qP(this.node,this.innerDeco,(c,u,f)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!f&&l.syncToMarks(u==this.node.childCount?Mt.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,s)},(c,u,f,d)=>{l.syncToMarks(c.marks,r,e);let m;l.findNodeMatch(c,u,f,d)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(m=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,f,m,e)||l.updateNextNode(c,u,f,e,d,s)||l.addNode(c,u,f,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==ro)&&(o&&this.protectLocalComposition(e,o),_w(this.contentDOM,this.children,e),Oa&&KP(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ct)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=WP(this.node.content,o,r-t,s-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new FP(this,i,t,s);e.input.compositionNodes.push(o),this.children=Fp(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==ss||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=Sr}updateOuterDeco(e){if(Bp(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=yw(this.dom,this.nodeDOM,Vp(this.outerDeco,this.node,t),Vp(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function dy(n,e,t,r,s){bw(r,e,n);let i=new Ti(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class _f extends Ti{constructor(e,t,r,s,i,o,a){super(e,t,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==ss||this.dirty!=Sr&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Sr||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=Sr,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new _f(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=ss)}get domAtom(){return!1}isText(e){return this.node.text==e}}class gw extends Dc{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Sr&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class UP extends Ti{constructor(e,t,r,s,i,o,a,l,c,u){super(e,t,r,s,i,o,a,c,u),this.spec=l}update(e,t,r,s){if(this.dirty==ss)return!1;if(this.spec.update){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function _w(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=py(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof Ro){let l=r?r.previousSibling:n.lastChild;_w(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=py(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const jl=function(n){n&&(this.nodeName=n)};jl.prototype=Object.create(null);const so=[new jl];function Vp(n,e,t){if(n.length==0)return so;let r=t?so[0]:new jl,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new jl(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&s.length==1&&s.push(r=new jl(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function yw(n,e,t,r){if(t==so&&r==so)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=so[0]),s=l}HP(s,a||so[0],o)}return s}function HP(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function bw(n,e,t){return yw(n,n,so,Vp(e,t,n.nodeType!=1))}function Bp(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function py(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class jP{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=zP(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=Sr,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=Ro.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==ss&&o.dom==o.contentDOM&&(o.dirty=ro),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Ti){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,f,d=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=ss&&Bp(t,l.outerDeco));if(!d&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!d&&(f=this.recreateWrapper(l,e,t,r,s,o)))return this.top.children[this.index]=f,f.contentDOM&&(f.dirty=ro,f.updateChildren(s,o+1),f.dirty=Sr),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let a=Ti.create(this.top,t,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,i){let o=Ti.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new mw(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof Ro;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof _f)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Wn||Kn)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new gw(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function zP(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof Ro)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function $P(n,e){return n.type.side-e.type.side}function qP(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,s,e.forChild(i,u),c),i+=u.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,f;for(;o<s.length&&s[o].to==i;){let O=s[o++];O.widget&&(u?(f||(f=[u])).push(O):u=O)}if(u)if(f){f.sort($P);for(let O=0;O<f.length;O++)t(f[O],c,!!l)}else t(u,c,!!l);let d,m;if(l)m=-1,d=l,l=null;else if(c<n.childCount)m=c,d=n.child(c++);else break;for(let O=0;O<a.length;O++)a[O].to<=i&&a.splice(O--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let _=i+d.nodeSize;if(d.isText){let O=_;o<s.length&&s[o].from<O&&(O=s[o].from);for(let x=0;x<a.length;x++)a[x].to<O&&(O=a[x].to);O<_&&(l=d.cut(O-i),d=d.cut(0,O-i),_=O,m=-1)}else for(;o<s.length&&s[o].to<_;)o++;let D=d.isInline&&!d.isLeaf?a.filter(O=>!O.inline):a.slice();r(d,D,e.forChild(i,d),m),i=_}}function KP(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function WP(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Fp(n,e,t,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),u>t&&i.push(l.slice(t-c,l.size,r)))}return i}function T0(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(gf(t)){for(l=a;s&&!s.node;)s=s.parent;let u=s.node;if(s&&u.isAtom&&tt.isSelectable(u)&&s.parent&&!(u.isInline&&yP(t.focusNode,t.focusOffset,s.dom))){let f=s.posBefore;c=new tt(o==f?a:r.resolve(f))}}else{let u=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(u<0)return null;l=r.resolve(u)}if(!c){let u=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=S0(n,l,a,u)}return c}function vw(n){return n.editable?n.hasFocus():ww(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function ws(n,e=!1){let t=n.state.selection;if(Ew(n,t),!!vw(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Kn){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Io(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)YP(n);else{let{anchor:r,head:s}=t,i,o;my&&!(t instanceof ct)&&(t.$from.parent.inlineContent||(i=gy(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=gy(n,t.to))),n.docView.setSelection(r,s,n.root,e),my&&(i&&_y(i),o&&_y(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&GP(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const my=Wn||Kn&&EP<63;function gy(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(Wn&&s&&s.contentEditable=="false")return gd(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return gd(s);if(i)return gd(i)}}function gd(n){return n.contentEditable="true",Wn&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function _y(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function GP(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!vw(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function YP(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setEnd(r.parentNode,wn(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&sr&&wi<=11&&(r.disabled=!0,r.disabled=!1)}function Ew(n,e){if(e instanceof tt){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(yy(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else yy(n)}function yy(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function S0(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ct.between(e,t,r)}function by(n){return n.editable&&!n.hasFocus()?!1:ww(n)}function ww(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function XP(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Io(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Up(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&ft.findFrom(i,e)}function ei(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function vy(n,e,t){let r=n.state.selection;if(r instanceof ct)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return ei(n,new ct(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=Up(n.state,e);return s&&s instanceof tt?ei(n,s):!1}else if(!(br&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?tt.isSelectable(i)?ei(n,new tt(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):Nc?ei(n,new ct(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof tt&&r.node.isInline)return ei(n,new ct(e>0?r.$to:r.$from));{let s=Up(n.state,e);return s?ei(n,s):!1}}}function gh(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function zl(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function qo(n,e){return e<0?QP(n):JP(n)}function QP(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(Vr&&t.nodeType==1&&r<gh(t)&&zl(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(zl(a,-1))s=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(Tw(t))break;{let a=t.previousSibling;for(;a&&zl(a,-1);)s=t.parentNode,i=wn(a),a=a.previousSibling;if(a)t=a,r=gh(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Hp(n,t,r):s&&Hp(n,s,i)}function JP(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=gh(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(zl(a,1))i=t,o=++r;else break}else{if(Tw(t))break;{let a=t.nextSibling;for(;a&&zl(a,1);)i=a.parentNode,o=wn(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=gh(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&Hp(n,i,o)}function Tw(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function ZP(n,e){for(;n&&e==n.childNodes.length&&!Oc(n);)e=wn(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function e7(n,e){for(;n&&!e&&!Oc(n);)e=wn(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Hp(n,e,t){if(e.nodeType!=3){let i,o;(o=ZP(e,t))?(e=o,t=0):(i=e7(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(gf(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&ws(n)},50)}function Ey(n,e){let t=n.state.doc.resolve(e);if(!(Kn||wP)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function wy(n,e,t){let r=n.state.selection;if(r instanceof ct&&!r.empty||t.indexOf("s")>-1||br&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=Up(n.state,e);if(o&&o instanceof tt)return ei(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof Or?ft.near(o,e):ft.findFrom(o,e);return a?ei(n,a):!1}return!1}function Ty(n,e){if(!(n.state.selection instanceof ct))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function Sy(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function t7(n){if(!Wn||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;Sy(n,r,"true"),setTimeout(()=>Sy(n,r,"false"),20)}return!1}function n7(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function r7(n,e){let t=e.keyCode,r=n7(e);if(t==8||br&&t==72&&r=="c")return Ty(n,-1)||qo(n,-1);if(t==46&&!e.shiftKey||br&&t==68&&r=="c")return Ty(n,1)||qo(n,1);if(t==13||t==27)return!0;if(t==37||br&&t==66&&r=="c"){let s=t==37?Ey(n,n.state.selection.from)=="ltr"?-1:1:-1;return vy(n,s,r)||qo(n,s)}else if(t==39||br&&t==70&&r=="c"){let s=t==39?Ey(n,n.state.selection.from)=="ltr"?1:-1:1;return vy(n,s,r)||qo(n,s)}else{if(t==38||br&&t==80&&r=="c")return wy(n,-1,r)||qo(n,-1);if(t==40||br&&t==78&&r=="c")return t7(n)||wy(n,1,r)||qo(n,1);if(r==(br?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Sw(n,e){n.someProp("transformCopied",m=>{e=m(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let m=r.firstChild;t.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=n.someProp("clipboardSerializer")||Gr.fromSchema(n.state.schema),a=xw(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,u,f=0;for(;c&&c.nodeType==1&&(u=Cw[c.nodeName.toLowerCase()]);){for(let m=u.length-1;m>=0;m--){let _=a.createElement(u[m]);for(;l.firstChild;)_.appendChild(l.firstChild);l.appendChild(_),f++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${f?` -${f}`:""} ${JSON.stringify(t)}`);let d=n.someProp("clipboardTextSerializer",m=>m(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:d,slice:e}}function Aw(n,e,t,r,s){let i=s.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",d=>{e=d(e,i||r,n)}),i)return e?new $e(Be.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):$e.empty;let f=n.someProp("clipboardTextParser",d=>d(e,s,r,n));if(f)a=f;else{let d=s.marks(),{schema:m}=n.state,_=Gr.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(D=>{let O=o.appendChild(document.createElement("p"));D&&O.appendChild(_.serializeNode(m.text(D,d)))})}}else n.someProp("transformPastedHTML",f=>{t=f(t,n)}),o=o7(t),Nc&&a7(o);let c=o&&o.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let f=+u[3];f>0;f--){let d=o.firstChild;for(;d&&d.nodeType!=1;)d=d.nextSibling;if(!d)break;o=d}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||xa.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||u),context:s,ruleFromNode(d){return d.nodeName=="BR"&&!d.nextSibling&&d.parentNode&&!s7.test(d.parentNode.nodeName)?{ignore:!0}:null}})),u)a=l7(Ay(a,+u[1],+u[2]),u[4]);else if(a=$e.maxOpen(i7(a.content,s),!0),a.openStart||a.openEnd){let f=0,d=0;for(let m=a.content.firstChild;f<a.openStart&&!m.type.spec.isolating;f++,m=m.firstChild);for(let m=a.content.lastChild;d<a.openEnd&&!m.type.spec.isolating;d++,m=m.lastChild);a=Ay(a,f,d)}return n.someProp("transformPasted",f=>{a=f(a,n)}),a}const s7=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function i7(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&Rw(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=kw(o[o.length-1],i.length));let u=Iw(a,l);o.push(u),s=s.matchType(u.type),i=l}}),o)return Be.from(o)}return n}function Iw(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,Be.from(n));return n}function Rw(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=Rw(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(Be.from(Iw(t,n,s+1))))}}function kw(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,kw(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(Be.empty,!0);return n.copy(t.append(r))}function jp(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=jp(a,e,t,r,s+1,i)),s>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(Be.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function Ay(n,e,t){return e<n.openStart&&(n=new $e(jp(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new $e(jp(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const Cw={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Iy=null;function xw(){return Iy||(Iy=document.implementation.createHTMLDocument("title"))}function o7(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=xw().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&Cw[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=n,s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function a7(n){let e=n.querySelectorAll(Kn?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function l7(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=Be.from(l.create(r[a+1],s)),i++,o++}return new $e(s,i,o)}const Gn={},Yn={},c7={touchstart:!0,touchmove:!0};class u7{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function h7(n){for(let e in Gn){let t=Gn[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{d7(n,r)&&!A0(n,r)&&(n.editable||!(r.type in Yn))&&t(n,r)},c7[e]?{passive:!0}:void 0)}Wn&&n.dom.addEventListener("input",()=>null),zp(n)}function pi(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function f7(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function zp(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>A0(n,r))})}function A0(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function d7(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function p7(n,e){!A0(n,e)&&Gn[e.type]&&(n.editable||!(e.type in Yn))&&Gn[e.type](n,e)}Yn.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!Pw(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Cr&&Kn&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),Oa&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,eo(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||r7(n,t)?t.preventDefault():pi(n,"key")};Yn.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Yn.keypress=(n,e)=>{let t=e;if(Pw(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||br&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ct)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode);!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",i=>i(n,r.$from.pos,r.$to.pos,s))&&n.dispatch(n.state.tr.insertText(s).scrollIntoView()),t.preventDefault()}};function yf(n){return{left:n.clientX,top:n.clientY}}function m7(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function I0(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),s,!0):a(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function ya(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function g7(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&tt.isSelectable(r)?(ya(n,new tt(t)),!0):!1}function _7(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof tt&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(tt.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(ya(n,tt.create(n.state.doc,s)),!0):!1}function y7(n,e,t,r,s){return I0(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?_7(n,t):g7(n,t))}function b7(n,e,t,r){return I0(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function v7(n,e,t,r){return I0(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||E7(n,t,r)}function E7(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(ya(n,ct.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)ya(n,ct.create(r,a+1,a+1+o.content.size));else if(tt.isSelectable(o))ya(n,tt.create(r,a));else continue;return!0}}function R0(n){return _h(n)}const Mw=br?"metaKey":"ctrlKey";Gn.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=R0(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&m7(t,n.input.lastClick)&&!t[Mw]&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i};let o=n.posAtCoords(yf(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new w7(n,o,t,!!r)):(i=="doubleClick"?b7:v7)(n,o.pos,o.inside,t)?t.preventDefault():pi(n,"pointer"))};class w7{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Mw],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,o=u.depth?u.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof tt&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Vr&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),pi(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ws(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(yf(e))),this.updateAllowDefault(e),this.allowDefault||!t?pi(this.view,"pointer"):y7(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Wn&&this.mightDrag&&!this.mightDrag.node.isAtom||Kn&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ya(this.view,ft.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):pi(this.view,"pointer")}move(e){this.updateAllowDefault(e),pi(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Gn.touchstart=n=>{n.input.lastTouch=Date.now(),R0(n),pi(n,"pointer")};Gn.touchmove=n=>{n.input.lastTouch=Date.now(),pi(n,"pointer")};Gn.contextmenu=n=>R0(n);function Pw(n,e){return n.composing?!0:Wn&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const T7=Cr?5e3:-1;Yn.compositionstart=Yn.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),_h(n,!0),n.markCursor=null;else if(_h(n),Vr&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}Ow(n,T7)};Yn.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Ow(n,20))};function Ow(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>_h(n),e))}function Nw(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=A7());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function S7(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=gP(e.focusNode,e.focusOffset),r=_P(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let o=t.pmViewDesc;if(!(!o||!o.isText(t.nodeValue)))return r}}return t||r}function A7(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function _h(n,e=!1){if(!(Cr&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),Nw(n),e||n.docView&&n.docView.dirty){let t=T0(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function I7(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const uc=sr&&wi<15||Oa&&TP<604;Gn.copy=Yn.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=uc?null:t.clipboardData,o=r.content(),{dom:a,text:l}=Sw(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):I7(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function R7(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function k7(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?hc(n,r.value,null,s,e):hc(n,r.textContent,r.innerHTML,s,e)},50)}function hc(n,e,t,r,s){let i=Aw(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||$e.empty)))return!0;if(!i)return!1;let o=R7(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function Dw(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Yn.paste=(n,e)=>{let t=e;if(n.composing&&!Cr)return;let r=uc?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&hc(n,Dw(r),r.getData("text/html"),s,t)?t.preventDefault():k7(n,t)};class Lw{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Vw=br?"altKey":"ctrlKey";Gn.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(yf(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof tt?s.to-1:s.to))){if(r&&r.mightDrag)o=tt.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let f=n.docView.nearestDesc(t.target,!0);f&&f.node.type.spec.draggable&&f!=n.docView&&(o=tt.create(n.state.doc,f.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:u}=Sw(n,a);t.dataTransfer.clearData(),t.dataTransfer.setData(uc?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",uc||t.dataTransfer.setData("text/plain",c),n.dragging=new Lw(u,!t[Vw],o)};Gn.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Yn.dragover=Yn.dragenter=(n,e)=>e.preventDefault();Yn.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(yf(t));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",_=>{o=_(o,n)}):o=Aw(n,Dw(t.dataTransfer),uc?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&!t[Vw]);if(n.someProp("handleDrop",_=>_(n,t,o||$e.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?tw(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:_}=r;_?_.replace(c):c.deleteSelection()}let u=c.mapping.map(l),f=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,d=c.doc;if(f?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(d))return;let m=c.doc.resolve(u);if(f&&tt.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new tt(m));else{let _=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((D,O,x,w)=>_=w),c.setSelection(S0(n,m,c.doc.resolve(_)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Gn.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&ws(n)},20))};Gn.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Gn.beforeinput=(n,e)=>{if(Kn&&Cr&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,eo(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in Yn)Gn[n]=Yn[n];function fc(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class yh{constructor(e,t){this.toDOM=e,this.spec=t||mo,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new Er(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof yh&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&fc(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Si{constructor(e,t){this.attrs=e,this.spec=t||mo}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new Er(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Si&&fc(this.attrs,e.attrs)&&fc(this.spec,e.spec)}static is(e){return e.type instanceof Si}destroy(){}}class k0{constructor(e,t){this.attrs=e,this.spec=t||mo}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new Er(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof k0&&fc(this.attrs,e.attrs)&&fc(this.spec,e.spec)}destroy(){}}class Er{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new Er(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new Er(e,e,new yh(t,r))}static inline(e,t,r,s){return new Er(e,t,new Si(r,s))}static node(e,t,r,s){return new Er(e,t,new k0(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof Si}get widget(){return this.type instanceof yh}}const ta=[],mo={};class an{constructor(e,t){this.local=e.length?e:ta,this.children=t.length?t:ta}static create(e,t){return t.length?bh(t,e,0,mo):On}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,s+a,i)}}map(e,t,r){return this==On||e.maps.length==0?this:this.mapInner(e,t,0,0,r||mo)}mapInner(e,t,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?C7(this.children,o||[],e,t,r,s,i):o?new an(o.sort(go),ta):On}add(e,t){return t.length?this==On?an.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=Fw(t,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,u,c+1):s.splice(i,0,l,l+a.nodeSize,bh(u,a,c+1,mo)),i+=3}});let o=Bw(i?Uw(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new an(o.length?this.local.concat(o).sort(go):this.local,s||this.children)}remove(e){return e.length==0||this==On?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+t,l=r[i+1]+t;for(let u=0,f;u<e.length;u++)(f=e[u])&&f.from>a&&f.to<l&&(e[u]=null,(o||(o=[])).push(f));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=On?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new an(s,r):On}forChild(e,t){if(this==On)return this;if(t.isLeaf)return an.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof Si){let c=Math.max(i,l.from)-i,u=Math.min(o,l.to)-i;c<u&&(s||(s=[])).push(l.copy(c,u))}}if(s){let a=new an(s.sort(go),ta);return r?new ci([a,r]):a}return r||On}eq(e){if(this==e)return!0;if(!(e instanceof an)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return C0(this.localsInner(e))}localsInner(e){if(this==On)return ta;if(e.inlineContent||!this.local.some(Si.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Si||t.push(this.local[r]);return t}}an.empty=new an([],[]);an.removeOverlap=C0;const On=an.empty;class ci{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,mo));return ci.from(r)}forChild(e,t){if(t.isLeaf)return an.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=On&&(i instanceof ci?r=r.concat(i.members):r.push(i))}return ci.from(r)}eq(e){if(!(e instanceof ci)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?C0(r?t:t.sort(go)):ta}static from(e){switch(e.length){case 0:return On;case 1:return e[0];default:return new ci(e.every(t=>t instanceof an)?e:e.reduce((t,r)=>t.concat(r instanceof an?r:r.members),[]))}}}function C7(n,e,t,r,s,i,o){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let f=0;t.maps[c].forEach((d,m,_,D)=>{let O=D-_-(m-d);for(let x=0;x<a.length;x+=3){let w=a[x+1];if(w<0||d>w+u-f)continue;let N=a[x]+u-f;m>=N?a[x+1]=d<=N?-2:-1:d>=u&&O&&(a[x]+=O,a[x+1]+=O)}f+=O}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),f=u-s;if(f<0||f>=r.content.size){l=!0;continue}let d=t.map(n[c+1]+i,-1),m=d-s,{index:_,offset:D}=r.content.findIndex(f),O=r.maybeChild(_);if(O&&D==f&&D+O.nodeSize==m){let x=a[c+2].mapInner(t,O,u+1,n[c]+i+1,o);x!=On?(a[c]=f,a[c+1]=m,a[c+2]=x):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=x7(a,n,e,t,s,i,o),u=bh(c,r,0,o);e=u.local;for(let f=0;f<a.length;f+=3)a[f+1]<0&&(a.splice(f,3),f-=3);for(let f=0,d=0;f<u.children.length;f+=3){let m=u.children[f];for(;d<a.length&&a[d]<m;)d+=3;a.splice(d,0,u.children[f],u.children[f+1],u.children[f+2])}}return new an(e.sort(go),a)}function Bw(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new Er(s.from+e,s.to+e,s.type))}return t}function x7(n,e,t,r,s,i,o){function a(l,c){for(let u=0;u<l.local.length;u++){let f=l.local[u].map(r,s,c);f?t.push(f):o.onRemove&&o.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function Fw(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function Uw(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function bh(n,e,t,r){let s=[],i=!1;e.forEach((a,l)=>{let c=Fw(n,a,l+t);if(c){i=!0;let u=bh(c,a,t+l+1,r);u!=On&&s.push(l,l+a.nodeSize,u)}});let o=Bw(i?Uw(n):n,-t).sort(go);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new an(o,s):On}function go(n,e){return n.from-e.from||n.to-e.to}function C0(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),Ry(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),Ry(e,s,r.copy(i.from,r.to)));break}}}return e}function Ry(n,e,t){for(;e<n.length&&go(t,n[e])>0;)e++;n.splice(e,0,t)}function _d(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=On&&e.push(r)}),n.cursorWrapper&&e.push(an.create(n.state.doc,[n.cursorWrapper.deco])),ci.from(e)}const M7={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},P7=sr&&wi<=11;class O7{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class N7{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new O7,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);sr&&wi<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),P7&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,M7)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(by(this.view)){if(this.suppressingSelectionUpdates)return ws(this.view);if(sr&&wi<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Io(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=cc(i))t.add(i);for(let i=e.anchorNode;i;i=cc(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&by(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let f=this.registerMutation(t[u],l);f&&(i=i<0?f.from:Math.min(f.from,i),o=o<0?f.to:Math.max(f.to,o),f.typeOver&&(a=!0))}if(Vr&&l.length){let u=l.filter(f=>f.nodeName=="BR");if(u.length==2){let[f,d]=u;f.parentNode&&f.parentNode.parentNode==d.parentNode?d.remove():f.remove()}else{let{focusNode:f}=this.currentSelection;for(let d of u){let m=d.parentNode;m&&m.nodeName=="LI"&&(!f||V7(e,f)!=m)&&d.remove()}}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&gf(r)&&(c=T0(e))&&c.eq(ft.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,ws(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),D7(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||ws(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let f=e.addedNodes[u];t.push(f),f.nodeType==3&&(this.lastChangedTextNode=f)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(sr&&wi<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:f,nextSibling:d}=e.addedNodes[u];(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(s=f),(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d)}let o=s&&s.parentNode==e.target?wn(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?wn(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let ky=new WeakMap,Cy=!1;function D7(n){if(!ky.has(n)&&(ky.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Vr,Cy)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Cy=!0}}function xy(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return Io(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function L7(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return xy(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?xy(n,t):null}function V7(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function B7(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],gf(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Kn&&n.input.lastKeyCode===8)for(let O=i;O>s;O--){let x=r.childNodes[O-1],w=x.pmViewDesc;if(x.nodeName=="BR"&&!w){i=O;break}if(!w||w.size)break}let f=n.state.doc,d=n.someProp("domParser")||xa.fromSchema(n.state.schema),m=f.resolve(o),_=null,D=d.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:i,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:F7,context:m});if(c&&c[0].pos!=null){let O=c[0].pos,x=c[1]&&c[1].pos;x==null&&(x=O),_={anchor:O+o,head:x+o}}return{doc:D,sel:_,from:o,to:a}}function F7(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Wn&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Wn&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const U7=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function H7(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let E=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,T=T0(n,E);if(T&&!n.state.selection.eq(T)){if(Kn&&Cr&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",H=>H(n,eo(13,"Enter"))))return;let M=n.state.tr.setSelection(T);E=="pointer"?M.setMeta("pointer",!0):E=="key"&&M.scrollIntoView(),i&&M.setMeta("composition",i),n.dispatch(M)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=B7(n,e,t),u=n.state.doc,f=u.slice(c.from,c.to),d,m;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(d=n.state.selection.to,m="end"):(d=n.state.selection.from,m="start"),n.input.lastKeyCode=null;let _=$7(f.content,c.doc.content,c.from,d,m);if((Oa&&n.input.lastIOSEnter>Date.now()-225||Cr)&&s.some(E=>E.nodeType==1&&!U7.test(E.nodeName))&&(!_||_.endA>=_.endB)&&n.someProp("handleKeyDown",E=>E(n,eo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!_)if(r&&l instanceof ct&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))_={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let E=My(n,n.state.doc,c.sel);if(E&&!E.eq(n.state.selection)){let T=n.state.tr.setSelection(E);i&&T.setMeta("composition",i),n.dispatch(T)}}return}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&_.start==_.endB&&n.state.selection instanceof ct&&(_.start>n.state.selection.from&&_.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?_.start=n.state.selection.from:_.endA<n.state.selection.to&&_.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(_.endB+=n.state.selection.to-_.endA,_.endA=n.state.selection.to)),sr&&wi<=11&&_.endB==_.start+1&&_.endA==_.start&&_.start>c.from&&c.doc.textBetween(_.start-c.from-1,_.start-c.from+1)==" "&&(_.start--,_.endA--,_.endB--);let D=c.doc.resolveNoCache(_.start-c.from),O=c.doc.resolveNoCache(_.endB-c.from),x=u.resolve(_.start),w=D.sameParent(O)&&D.parent.inlineContent&&x.end()>=_.endA,N;if((Oa&&n.input.lastIOSEnter>Date.now()-225&&(!w||s.some(E=>E.nodeName=="DIV"||E.nodeName=="P"))||!w&&D.pos<c.doc.content.size&&!D.sameParent(O)&&(N=ft.findFrom(c.doc.resolve(D.pos+1),1,!0))&&N.head==O.pos)&&n.someProp("handleKeyDown",E=>E(n,eo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>_.start&&z7(u,_.start,_.endA,D,O)&&n.someProp("handleKeyDown",E=>E(n,eo(8,"Backspace")))){Cr&&Kn&&n.domObserver.suppressSelectionUpdates();return}Kn&&Cr&&_.endB==_.start&&(n.input.lastAndroidDelete=Date.now()),Cr&&!w&&D.start()!=O.start()&&O.parentOffset==0&&D.depth==O.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==_.endA&&(_.endB-=2,O=c.doc.resolveNoCache(_.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(E){return E(n,eo(13,"Enter"))})},20));let V=_.start,p=_.endA,k,S,b;if(w){if(D.pos==O.pos)sr&&wi<=11&&D.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>ws(n),20)),k=n.state.tr.delete(V,p),S=u.resolve(_.start).marksAcross(u.resolve(_.endA));else if(_.endA==_.endB&&(b=j7(D.parent.content.cut(D.parentOffset,O.parentOffset),x.parent.content.cut(x.parentOffset,_.endA-x.start()))))k=n.state.tr,b.type=="add"?k.addMark(V,p,b.mark):k.removeMark(V,p,b.mark);else if(D.parent.child(D.index()).isText&&D.index()==O.index()-(O.textOffset?0:1)){let E=D.parent.textBetween(D.parentOffset,O.parentOffset);if(n.someProp("handleTextInput",T=>T(n,V,p,E)))return;k=n.state.tr.insertText(E,V,p)}}if(k||(k=n.state.tr.replace(V,p,c.doc.slice(_.start-c.from,_.endB-c.from))),c.sel){let E=My(n,k.doc,c.sel);E&&!(Kn&&Cr&&n.composing&&E.empty&&(_.start!=_.endB||n.input.lastAndroidDelete<Date.now()-100)&&(E.head==V||E.head==k.mapping.map(p)-1)||sr&&E.empty&&E.head==V)&&k.setSelection(E)}S&&k.ensureMarks(S),i&&k.setMeta("composition",i),n.dispatch(k.scrollIntoView())}function My(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:S0(n,e.resolve(t.anchor),e.resolve(t.head))}function j7(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,a,l;for(let u=0;u<r.length;u++)s=r[u].removeFromSet(s);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=u=>u.mark(a.addToSet(u.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(Be.from(c).eq(n))return{mark:a,type:o}}function z7(n,e,t,r,s){if(t-e<=s.pos-r.pos||yd(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(yd(i,!0,!0));return!o.parent.isTextblock||o.pos>t||yd(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function yd(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function $7(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&Py(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&Py(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function Py(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class q7{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new u7,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Vy),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Dy(this),Ny(this),this.nodeViews=Ly(this),this.docView=dy(this.state.doc,Oy(this),_d(this),this.dom,this),this.domObserver=new N7(this,(r,s,i,o)=>H7(this,r,s,i,o)),this.domObserver.start(),h7(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&zp(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Vy),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(Nw(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let m=Ly(this);W7(m,this.nodeViews)&&(this.nodeViews=m,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&zp(this),this.editable=Dy(this),Ny(this);let l=_d(this),c=Oy(this),u=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",f=i||!this.docView.matchesNode(e.doc,c,l);(f||!e.selection.eq(s.selection))&&(o=!0);let d=u=="preserve"&&o&&this.dom.style.overflowAnchor==null&&IP(this);if(o){this.domObserver.stop();let m=f&&(sr||Kn)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&K7(s.selection,e.selection);if(f){let _=Kn?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=S7(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=dy(e.doc,c,l,this.dom,this)),_&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&XP(this))?ws(this,m):(Ew(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():d&&RP(d)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof tt){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&ay(this,t.getBoundingClientRect(),e)}else ay(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new Lw(e.slice,e.move,s<0?void 0:tt.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=t?t(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(sr){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&kP(this.dom),ws(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return OP(this,e)}coordsAtPos(e,t=1){return dw(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return BP(this,t||this.state,e)}pasteHTML(e,t){return hc(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return hc(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(f7(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],_d(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,pP())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return p7(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return Wn&&this.root.nodeType===11&&bP(this.dom.ownerDocument)==this.dom&&L7(this,e)||e}domSelection(){return this.root.getSelection()}}function Oy(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[Er.node(0,n.state.doc.content.size,e)]}function Ny(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:Er.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function Dy(n){return!n.someProp("editable",e=>e(n.state)===!1)}function K7(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function Ly(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function W7(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function Vy(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Mi={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},vh={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},G7=typeof navigator<"u"&&/Mac/.test(navigator.platform),Y7=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var Tn=0;Tn<10;Tn++)Mi[48+Tn]=Mi[96+Tn]=String(Tn);for(var Tn=1;Tn<=24;Tn++)Mi[Tn+111]="F"+Tn;for(var Tn=65;Tn<=90;Tn++)Mi[Tn]=String.fromCharCode(Tn+32),vh[Tn]=String.fromCharCode(Tn);for(var bd in Mi)vh.hasOwnProperty(bd)||(vh[bd]=Mi[bd]);function X7(n){var e=G7&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||Y7&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?vh:Mi)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const Q7=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function J7(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))Q7?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function Z7(n){let e=Object.create(null);for(let t in n)e[J7(t)]=n[t];return e}function vd(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function eO(n){return new Ar({props:{handleKeyDown:Hw(n)}})}function Hw(n){let e=Z7(n);return function(t,r){let s=X7(r),i,o=e[vd(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[vd(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||s.charCodeAt(0)>127)&&(i=Mi[r.keyCode])&&i!=s){let a=e[vd(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const tO=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function jw(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const nO=(n,e,t)=>{let r=jw(n,t);if(!r)return!1;let s=x0(r);if(!s){let o=r.blockRange(),a=o&&$a(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(!i.type.spec.isolating&&Kw(n,s,e))return!0;if(r.parent.content.size==0&&(Na(i,"end")||tt.isSelectable(i))){let o=pf(n.doc,r.before(),r.after(),$e.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Na(i,"end")?ft.findFrom(a.doc.resolve(a.mapping.map(s.pos,-1)),-1):tt.create(a.doc,s.pos-i.nodeSize)),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},rO=(n,e,t)=>{let r=jw(n,t);if(!r)return!1;let s=x0(r);return s?zw(n,s,e):!1},sO=(n,e,t)=>{let r=$w(n,t);if(!r)return!1;let s=M0(r);return s?zw(n,s,e):!1};function zw(n,e,t){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let u=s.lastChild;if(!u)return!1;s=u}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=pf(n.doc,i,l,$e.empty);if(!c||c.from!=i||c instanceof fn&&c.slice.size>=l-i)return!1;if(t){let u=n.tr.step(c);u.setSelection(ct.create(u.doc,i)),t(u.scrollIntoView())}return!0}function Na(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const iO=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=x0(r)}let o=i&&i.nodeBefore;return!o||!tt.isSelectable(o)?!1:(e&&e(n.tr.setSelection(tt.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function x0(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function $w(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const oO=(n,e,t)=>{let r=$w(n,t);if(!r)return!1;let s=M0(r);if(!s)return!1;let i=s.nodeAfter;if(Kw(n,s,e))return!0;if(r.parent.content.size==0&&(Na(i,"start")||tt.isSelectable(i))){let o=pf(n.doc,r.before(),r.after(),$e.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(Na(i,"start")?ft.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):tt.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},aO=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=M0(r)}let o=i&&i.nodeAfter;return!o||!tt.isSelectable(o)?!1:(e&&e(n.tr.setSelection(tt.create(n.doc,i.pos)).scrollIntoView()),!0)};function M0(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const lO=(n,e)=>{let t=n.selection,r=t instanceof tt,s;if(r){if(t.node.isTextblock||!Li(n.doc,t.from))return!1;s=t.from}else if(s=df(n.doc,t.from,-1),s==null)return!1;if(e){let i=n.tr.join(s);r&&i.setSelection(tt.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},cO=(n,e)=>{let t=n.selection,r;if(t instanceof tt){if(t.node.isTextblock||!Li(n.doc,t.to))return!1;r=t.to}else if(r=df(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},uO=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),i=s&&$a(s);return i==null?!1:(e&&e(n.tr.lift(s,i).scrollIntoView()),!0)},hO=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function qw(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const fO=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=qw(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(ft.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},dO=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof Or||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=qw(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(ct.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},pO=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(ga(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&$a(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)},mO=(n,e)=>{let{$from:t,to:r}=n.selection,s,i=t.sharedDepth(r);return i==0?!1:(s=t.before(i),e&&e(n.tr.setSelection(tt.create(n.doc,s))),!0)};function gO(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||Li(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function Kw(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i,o;if(r.type.spec.isolating||s.type.spec.isolating)return!1;if(gO(n,e,t))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(i=(o=r.contentMatchAt(r.childCount)).findWrapping(s.type))&&o.matchType(i[0]||s.type).validEnd){if(t){let f=e.pos+s.nodeSize,d=Be.empty;for(let D=i.length-1;D>=0;D--)d=Be.from(i[D].create(null,d));d=Be.from(r.copy(d));let m=n.tr.step(new pn(e.pos-1,f,e.pos,f,new $e(d,1,0),i.length,!0)),_=f+2*i.length;Li(m.doc,_)&&m.join(_),t(m.scrollIntoView())}return!0}let l=ft.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),u=c&&$a(c);if(u!=null&&u>=e.depth)return t&&t(n.tr.lift(c,u).scrollIntoView()),!0;if(a&&Na(s,"start",!0)&&Na(r,"end")){let f=r,d=[];for(;d.push(f),!f.isTextblock;)f=f.lastChild;let m=s,_=1;for(;!m.isTextblock;m=m.firstChild)_++;if(f.canReplace(f.childCount,f.childCount,m.content)){if(t){let D=Be.empty;for(let x=d.length-1;x>=0;x--)D=Be.from(d[x].copy(D));let O=n.tr.step(new pn(e.pos-d.length,e.pos+s.nodeSize,e.pos+_,e.pos+s.nodeSize-_,new $e(D,d.length,0),0,!0));t(O.scrollIntoView())}return!0}}return!1}function Ww(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection(ct.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const _O=Ww(-1),yO=Ww(1);function bO(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=o&&v0(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function By(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let u=t.doc.resolve(c),f=u.index();s=u.parent.canReplaceWith(f,f+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function vO(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=!1,l=o;if(!o)return!1;if(o.depth>=2&&s.node(o.depth-1).type.compatibleContent(n)&&o.startIndex==0){if(s.index(o.depth-1)==0)return!1;let u=t.doc.resolve(o.start-2);l=new fh(u,u,o.depth),o.endIndex<o.parent.childCount&&(o=new fh(s,t.doc.resolve(i.end(o.depth)),o.depth)),a=!0}let c=v0(l,n,e,o);return c?(r&&r(EO(t.tr,o,c,a,n).scrollIntoView()),!0):!1}}function EO(n,e,t,r,s){let i=Be.empty;for(let u=t.length-1;u>=0;u--)i=Be.from(t[u].type.create(t[u].attrs,i));n.step(new pn(e.start-(r?2:0),e.end,e.start,e.end,new $e(i,0,0),t.length,!0));let o=0;for(let u=0;u<t.length;u++)t[u].type==s&&(o=u+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,f=e.endIndex,d=!0;u<f;u++,d=!1)!d&&ga(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function wO(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?TO(e,t,n,i):SO(e,t,i):!0:!1}}function TO(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new pn(i-1,o,i,o,new $e(Be.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new fh(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=$a(r);if(a==null)return!1;s.lift(r,a);let l=s.mapping.map(i,-1)-1;return Li(s.doc,l)&&s.join(l),e(s.scrollIntoView()),!0}function SO(n,e,t){let r=n.tr,s=t.parent;for(let m=t.end,_=t.endIndex-1,D=t.startIndex;_>D;_--)m-=s.child(_).nodeSize,r.delete(m-1,m+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?Be.empty:Be.from(s))))return!1;let f=i.pos,d=f+o.nodeSize;return r.step(new pn(f-(a?1:0),d+(l?1:0),f+1,d-1,new $e((a?Be.empty:Be.from(s.copy(Be.empty))).append(l?Be.empty:Be.from(s.copy(Be.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function AO(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=Be.from(c?n.create():null),f=new $e(Be.from(n.create(null,Be.from(a.type.create(null,u)))),c?3:1,0),d=i.start,m=i.end;t(e.tr.step(new pn(d-(c?3:1),m,d,m,f,1,!0)).scrollIntoView())}return!0}}function bf(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,i=t.storedMarks,t}}}class vf{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const f=l(...u)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),f}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!e,c=e||i.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(d=>d===!0)),f={...Object.fromEntries(Object.entries(r).map(([d,m])=>[d,(...D)=>{const O=this.buildProps(c,t),x=m(...D)(O);return a.push(x),f}])),run:u};return f}createCan(e){const{rawCommands:t,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:e,editor:s,view:o,state:bf({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class IO{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function Ge(n,e,t){return n.config[e]===void 0&&n.parent?Ge(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?Ge(n.parent,e,t):null}):n.config[e]}function Ef(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function Gw(n){const e=[],{nodeExtensions:t,markExtensions:r}=Ef(n),s=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=Ge(o,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(f=>{Object.entries(u.attributes).forEach(([d,m])=>{e.push({type:f,name:d,attribute:{...i,...m}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=Ge(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,f])=>{const d={...i,...f};typeof(d==null?void 0:d.default)=="function"&&(d.default=d.default()),d!=null&&d.isRequired&&(d==null?void 0:d.default)===void 0&&delete d.default,e.push({type:o.name,name:u,attribute:d})})}),e}function gn(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function un(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?i.split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(u=>!l.includes(u));r[s]=[...l,...c].join(" ")}else s==="style"?r[s]=[r[s],i].join("; "):r[s]=i}),r},{})}function $p(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>un(t,r),{})}function Yw(n){return typeof n=="function"}function ht(n,e=void 0,...t){return Yw(n)?e?n.bind(e)(...t):n(...t):n}function RO(n={}){return Object.keys(n).length===0&&n.constructor===Object}function kO(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function Fy(n,e){return n.style?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):kO(t.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function Uy(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&RO(t)?!1:t!=null))}function CO(n,e){var t;const r=Gw(n),{nodeExtensions:s,markExtensions:i}=Ef(n),o=(t=s.find(c=>Ge(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(s.map(c=>{const u=r.filter(x=>x.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},d=n.reduce((x,w)=>{const N=Ge(w,"extendNodeSchema",f);return{...x,...N?N(c):{}}},{}),m=Uy({...d,content:ht(Ge(c,"content",f)),marks:ht(Ge(c,"marks",f)),group:ht(Ge(c,"group",f)),inline:ht(Ge(c,"inline",f)),atom:ht(Ge(c,"atom",f)),selectable:ht(Ge(c,"selectable",f)),draggable:ht(Ge(c,"draggable",f)),code:ht(Ge(c,"code",f)),defining:ht(Ge(c,"defining",f)),isolating:ht(Ge(c,"isolating",f)),attrs:Object.fromEntries(u.map(x=>{var w;return[x.name,{default:(w=x==null?void 0:x.attribute)===null||w===void 0?void 0:w.default}]}))}),_=ht(Ge(c,"parseHTML",f));_&&(m.parseDOM=_.map(x=>Fy(x,u)));const D=Ge(c,"renderHTML",f);D&&(m.toDOM=x=>D({node:x,HTMLAttributes:$p(x,u)}));const O=Ge(c,"renderText",f);return O&&(m.toText=O),[c.name,m]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(O=>O.type===c.name),f={name:c.name,options:c.options,storage:c.storage,editor:e},d=n.reduce((O,x)=>{const w=Ge(x,"extendMarkSchema",f);return{...O,...w?w(c):{}}},{}),m=Uy({...d,inclusive:ht(Ge(c,"inclusive",f)),excludes:ht(Ge(c,"excludes",f)),group:ht(Ge(c,"group",f)),spanning:ht(Ge(c,"spanning",f)),code:ht(Ge(c,"code",f)),attrs:Object.fromEntries(u.map(O=>{var x;return[O.name,{default:(x=O==null?void 0:O.attribute)===null||x===void 0?void 0:x.default}]}))}),_=ht(Ge(c,"parseHTML",f));_&&(m.parseDOM=_.map(O=>Fy(O,u)));const D=Ge(c,"renderHTML",f);return D&&(m.toDOM=O=>D({mark:O,HTMLAttributes:$p(O,u)})),[c.name,m]}));return new PM({topNode:o,nodes:a,marks:l})}function Ed(n,e){return e.nodes[n]||e.marks[n]||null}function Hy(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const xO=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,c;const u=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";t+=u.slice(0,Math.max(0,r-i))}),t};function P0(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class wf{constructor(e){this.find=e.find,this.handler=e.handler}}const MO=(n,e)=>{if(P0(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function hu(n){var e;const{editor:t,from:r,to:s,text:i,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(d=>d.type.spec.code))return!1;let u=!1;const f=xO(c)+i;return o.forEach(d=>{if(u)return;const m=MO(f,d.find);if(!m)return;const _=l.state.tr,D=bf({state:l.state,transaction:_}),O={from:r-(m[0].length-i.length),to:s},{commands:x,chain:w,can:N}=new vf({editor:t,state:D});d.handler({state:D,range:O,match:m,commands:x,chain:w,can:N})===null||!_.steps.length||(_.setMeta(a,{transform:_,from:r,to:s,text:i}),l.dispatch(_),u=!0)}),u}function PO(n){const{editor:e,rules:t}=n,r=new Ar({state:{init(){return null},apply(s,i){const o=s.getMeta(r);if(o)return o;const a=s.getMeta("applyInputRules");return!!a&&setTimeout(()=>{const{from:c,text:u}=a,f=c+u.length;hu({editor:e,from:c,to:f,text:u,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return hu({editor:e,from:i,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&hu({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?hu({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function OO(n){return typeof n=="number"}class NO{constructor(e){this.find=e.find,this.handler=e.handler}}const DO=(n,e,t)=>{if(P0(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function LO(n){const{editor:e,state:t,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:u}=new vf({editor:e,state:t}),f=[];return t.doc.nodesBetween(r,s,(m,_)=>{if(!m.isTextblock||m.type.spec.code)return;const D=Math.max(r,_),O=Math.min(s,_+m.content.size),x=m.textBetween(D-_,O-_,void 0,"");DO(x,i.find,o).forEach(N=>{if(N.index===void 0)return;const V=D+N.index+1,p=V+N[0].length,k={from:t.tr.mapping.map(V),to:t.tr.mapping.map(p)},S=i.handler({state:t,range:k,match:N,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});f.push(S)})}),f.every(m=>m!==null)}const VO=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function BO(n){const{editor:e,rules:t}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a=typeof DragEvent<"u"?new DragEvent("drop"):null;const l=({state:u,from:f,to:d,rule:m,pasteEvt:_})=>{const D=u.tr,O=bf({state:u,transaction:D});if(!(!LO({editor:e,state:O,from:Math.max(f-1,0),to:d.b-1,rule:m,pasteEvent:_,dropEvent:a})||!D.steps.length))return a=typeof DragEvent<"u"?new DragEvent("drop"):null,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,D};return t.map(u=>new Ar({view(f){const d=m=>{var _;r=!((_=f.dom.parentElement)===null||_===void 0)&&_.contains(m.target)?f.dom.parentElement:null};return window.addEventListener("dragstart",d),{destroy(){window.removeEventListener("dragstart",d)}}},props:{handleDOMEvents:{drop:(f,d)=>(i=r===f.dom.parentElement,a=d,!1),paste:(f,d)=>{var m;const _=(m=d.clipboardData)===null||m===void 0?void 0:m.getData("text/html");return o=d,s=!!(_!=null&&_.includes("data-pm-slice")),!1}}},appendTransaction:(f,d,m)=>{const _=f[0],D=_.getMeta("uiEvent")==="paste"&&!s,O=_.getMeta("uiEvent")==="drop"&&!i,x=_.getMeta("applyPasteRules"),w=!!x;if(!D&&!O&&!w)return;if(w){const{from:p,text:k}=x,S=p+k.length,b=VO(k);return l({rule:u,state:m,from:p,to:{b:S},pasteEvt:b})}const N=d.doc.content.findDiffStart(m.doc.content),V=d.doc.content.findDiffEnd(m.doc.content);if(!(!OO(N)||!V||N===V.b))return l({rule:u,state:m,from:N,to:V,pasteEvt:o})}}))}function FO(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class sa{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=sa.resolve(e),this.schema=CO(this.extensions,t),this.setupExtensions()}static resolve(e){const t=sa.sort(sa.flatten(e)),r=FO(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=Ge(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=Ge(r,"priority")||100,o=Ge(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Ed(t.name,this.schema)},s=Ge(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=sa.sort([...this.extensions].reverse()),r=[],s=[],i=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:Ed(o.name,this.schema)},l=[],c=Ge(o,"addKeyboardShortcuts",a);let u={};if(o.type==="mark"&&o.config.exitable&&(u.ArrowRight=()=>is.handleExit({editor:e,mark:o})),c){const D=Object.fromEntries(Object.entries(c()).map(([O,x])=>[O,()=>x({editor:e})]));u={...u,...D}}const f=eO(u);l.push(f);const d=Ge(o,"addInputRules",a);Hy(o,e.options.enableInputRules)&&d&&r.push(...d());const m=Ge(o,"addPasteRules",a);Hy(o,e.options.enablePasteRules)&&m&&s.push(...m());const _=Ge(o,"addProseMirrorPlugins",a);if(_){const D=_();l.push(...D)}return l}).flat();return[PO({editor:e,rules:r}),...BO({editor:e,rules:s}),...i]}get attributes(){return Gw(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=Ef(this.extensions);return Object.fromEntries(t.filter(r=>!!Ge(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:gn(r.name,this.schema)},o=Ge(r,"addNodeView",i);if(!o)return[];const a=(l,c,u,f)=>{const d=$p(l,s);return o()({editor:e,node:l,getPos:u,decorations:f,HTMLAttributes:d,extension:r})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Ed(e.name,this.schema)};e.type==="mark"&&(!((t=ht(Ge(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const s=Ge(e,"onBeforeCreate",r),i=Ge(e,"onCreate",r),o=Ge(e,"onUpdate",r),a=Ge(e,"onSelectionUpdate",r),l=Ge(e,"onTransaction",r),c=Ge(e,"onFocus",r),u=Ge(e,"onBlur",r),f=Ge(e,"onDestroy",r);s&&this.editor.on("beforeCreate",s),i&&this.editor.on("create",i),o&&this.editor.on("update",o),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),f&&this.editor.on("destroy",f)})}}function UO(n){return Object.prototype.toString.call(n).slice(8,-1)}function wd(n){return UO(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Tf(n,e){const t={...n};return wd(n)&&wd(e)&&Object.keys(e).forEach(r=>{wd(e[r])?r in n?t[r]=Tf(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class or{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ht(Ge(this,"addOptions",{name:this.name}))),this.storage=ht(Ge(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new or(e)}configure(e={}){const t=this.extend();return t.parent=this.parent,t.options=Tf(this.options,e),t.storage=ht(Ge(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new or({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ht(Ge(t,"addOptions",{name:t.name})),t.storage=ht(Ge(t,"addStorage",{name:t.name,options:t.options})),t}}function Xw(n,e,t){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let a="";return n.nodesBetween(r,s,(l,c,u,f)=>{var d;l.isBlock&&c>r&&(a+=i);const m=o==null?void 0:o[l.type.name];if(m)return u&&(a+=m({node:l,pos:c,parent:u,index:f,range:e})),!1;l.isText&&(a+=(d=l==null?void 0:l.text)===null||d===void 0?void 0:d.slice(Math.max(r,c)-c,s-c))}),a}function Qw(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const HO=or.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Ar({key:new Vi("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=Qw(t);return Xw(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),jO=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),zO=(n=!1)=>({commands:e})=>e.setContent("",n),$O=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,f=c.resolve(u.map(l)),d=c.resolve(u.map(l+a.nodeSize)),m=f.blockRange(d);if(!m)return;const _=$a(m);if(a.type.isTextblock){const{defaultType:D}=f.parent.contentMatchAt(f.index());e.setNodeMarkup(m.start,D)}(_||_===0)&&e.lift(m,_)})}),!0},qO=n=>e=>n(e),KO=()=>({state:n,dispatch:e})=>dO(n,e),WO=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new ct(r.doc.resolve(o-1))),!0},GO=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},YO=n=>({tr:e,state:t,dispatch:r})=>{const s=gn(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},XO=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},QO=()=>({state:n,dispatch:e})=>tO(n,e),JO=()=>({commands:n})=>n.keyboardShortcut("Enter"),ZO=()=>({state:n,dispatch:e})=>fO(n,e);function Eh(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:P0(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function qp(n,e,t={}){return n.find(r=>r.type===e&&Eh(r.attrs,t))}function eN(n,e,t={}){return!!qp(n,e,t)}function O0(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const s=qp([...r.node.marks],e,t);if(!s)return;let i=r.index,o=n.start()+r.offset,a=i+1,l=o+r.node.nodeSize;for(qp([...r.node.marks],e,t);i>0&&s.isInSet(n.parent.child(i-1).marks);)i-=1,o-=n.parent.child(i).nodeSize;for(;a<n.parent.childCount&&eN([...n.parent.child(a).marks],e,t);)l+=n.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function Fi(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const tN=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const i=Fi(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:u}=a;if(s){const f=O0(l,i,e);if(f&&f.from<=c&&f.to>=u){const d=ct.create(o,f.from,f.to);t.setSelection(d)}}return!0},nN=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Jw(n){return n instanceof ct}function io(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function Zw(n,e=null){if(!e)return null;const t=ft.atStart(n),r=ft.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,i=r.to;return e==="all"?ct.create(n,io(0,s,i),io(n.content.size,s,i)):ct.create(n,io(e,s,i),io(e,s,i))}function N0(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const rN=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{N0()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!Jw(t.state.selection))return o(),!0;const a=Zw(s.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},sN=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),iN=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),eT=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&eT(r)}return n};function jy(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return eT(t)}function wh(n,e,t){t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,s=typeof n=="string";if(r)try{return Array.isArray(n)&&n.length>0?Be.fromArray(n.map(o=>e.nodeFromJSON(o))):e.nodeFromJSON(n)}catch(i){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),wh("",e,t)}if(s){const i=xa.fromSchema(e);return t.slice?i.parseSlice(jy(n),t.parseOptions).content:i.parse(jy(n),t.parseOptions)}return wh("",e,t)}function oN(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof fn||s instanceof pn))return;const i=n.mapping.maps[r];let o=0;i.forEach((a,l,c,u)=>{o===0&&(o=u)}),n.setSelection(ft.near(n.doc.resolve(o),t))}const aN=n=>n.toString().startsWith("<"),lN=(n,e,t)=>({tr:r,dispatch:s,editor:i})=>{if(s){t={parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};const o=wh(e,i.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(o.toString()==="<>")return!0;let{from:a,to:l}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},c=!0,u=!0;if((aN(o)?o:[o]).forEach(m=>{m.check(),c=c?m.isText&&m.marks.length===0:!1,u=u?m.isBlock:!1}),a===l&&u){const{parent:m}=r.doc.resolve(a);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(a-=1,l+=1)}let d;c?(Array.isArray(e)?d=e.map(m=>m.text||"").join(""):typeof e=="object"&&e&&e.text?d=e.text:d=e,r.insertText(d,a,l)):(d=o,r.replaceWith(a,l,d)),t.updateSelection&&oN(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:a,text:d}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:a,text:d})}return!0},cN=()=>({state:n,dispatch:e})=>lO(n,e),uN=()=>({state:n,dispatch:e})=>cO(n,e),hN=()=>({state:n,dispatch:e})=>nO(n,e),fN=()=>({state:n,dispatch:e})=>oO(n,e),dN=()=>({tr:n,state:e,dispatch:t})=>{try{const r=df(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},pN=()=>({state:n,dispatch:e,tr:t})=>{try{const r=df(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},mN=()=>({state:n,dispatch:e})=>rO(n,e),gN=()=>({state:n,dispatch:e})=>sO(n,e);function tT(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function _N(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))N0()||tT()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const yN=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const i=_N(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&s&&r.maybeStep(u)}),!0};function dc(n,e,t={}){const{from:r,to:s,empty:i}=n.selection,o=e?gn(e,n.schema):null,a=[];n.doc.nodesBetween(r,s,(f,d)=>{if(f.isText)return;const m=Math.max(r,d),_=Math.min(s,d+f.nodeSize);a.push({node:f,from:m,to:_})});const l=s-r,c=a.filter(f=>o?o.name===f.node.type.name:!0).filter(f=>Eh(f.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((f,d)=>f+d.to-d.from,0)>=l}const bN=(n,e={})=>({state:t,dispatch:r})=>{const s=gn(n,t.schema);return dc(t,s,e)?uO(t,r):!1},vN=()=>({state:n,dispatch:e})=>pO(n,e),EN=n=>({state:e,dispatch:t})=>{const r=gn(n,e.schema);return wO(r)(e,t)},wN=()=>({state:n,dispatch:e})=>hO(n,e);function Sf(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function zy(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const TN=(n,e)=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Sf(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=gn(n,r.schema)),a==="mark"&&(o=Fi(n,r.schema)),s&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&t.setNodeMarkup(u,void 0,zy(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(f=>{o===f.type&&t.addMark(u,u+c.nodeSize,o.create(zy(f.attrs,e)))})})}),!0):!1},SN=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),AN=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),IN=()=>({state:n,dispatch:e})=>iO(n,e),RN=()=>({state:n,dispatch:e})=>aO(n,e),kN=()=>({state:n,dispatch:e})=>mO(n,e),CN=()=>({state:n,dispatch:e})=>yO(n,e),xN=()=>({state:n,dispatch:e})=>_O(n,e);function nT(n,e,t={}){return wh(n,e,{slice:!1,parseOptions:t})}const MN=(n,e=!1,t={})=>({tr:r,editor:s,dispatch:i})=>{const{doc:o}=r,a=nT(n,s.schema,t);return i&&r.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!e),!0};function Af(n,e){const t=Fi(e,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function PN(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function ON(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function D0(n){return e=>ON(e.$from,n)}function NN(n,e){const t=Gr.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}function DN(n,e){const t={from:0,to:n.content.size};return Xw(n,t,e)}function LN(n,e){const t=gn(e,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function VN(n,e){const t=Sf(typeof e=="string"?e:e.name,n.schema);return t==="node"?LN(n,e):t==="mark"?Af(n,e):{}}function rT(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const i=t.resolve(n-1),o=O0(i,s.type);o&&r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function Nu(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function Kp(n,e,t={}){const{empty:r,ranges:s}=n.selection,i=e?Fi(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(f=>i?i.name===f.type.name:!0).find(f=>Eh(f.attrs,t,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:f,$to:d})=>{const m=f.pos,_=d.pos;n.doc.nodesBetween(m,_,(D,O)=>{if(!D.isText&&!D.marks.length)return;const x=Math.max(m,O),w=Math.min(_,O+D.nodeSize),N=w-x;o+=N,a.push(...D.marks.map(V=>({mark:V,from:x,to:w})))})}),o===0)return!1;const l=a.filter(f=>i?i.name===f.mark.type.name:!0).filter(f=>Eh(f.mark.attrs,t,{strict:!1})).reduce((f,d)=>f+d.to-d.from,0),c=a.filter(f=>i?f.mark.type!==i&&f.mark.type.excludes(i):!0).reduce((f,d)=>f+d.to-d.from,0);return(l>0?l+c:l)>=o}function BN(n,e,t={}){if(!e)return dc(n,null,t)||Kp(n,null,t);const r=Sf(e,n.schema);return r==="node"?dc(n,e,t):r==="mark"?Kp(n,e,t):!1}function $y(n,e){const{nodeExtensions:t}=Ef(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=ht(Ge(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function FN(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function UN(n,e,t){var r;const{selection:s}=e;let i=null;if(Jw(s)&&(i=s.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,f,d)=>{if(c)return!1;if(u.isInline){const m=!d||d.type.allowsMarkType(t),_=!!t.isInSet(u.marks)||!u.marks.some(D=>D.type.excludes(t));c=m&&_}return!c}),c})}const HN=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=t,{empty:o,ranges:a}=i,l=Fi(n,r.schema);if(s)if(o){const c=Af(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,f=c.$to.pos;r.doc.nodesBetween(u,f,(d,m)=>{const _=Math.max(m,u),D=Math.min(m+d.nodeSize,f);d.marks.find(x=>x.type===l)?d.marks.forEach(x=>{l===x.type&&t.addMark(_,D,l.create({...x.attrs,...e}))}):t.addMark(_,D,l.create(e))})});return UN(r,t,l)},jN=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),zN=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const i=gn(n,t.schema);return i.isTextblock?s().command(({commands:o})=>By(i,e)(t)?!0:o.clearNodes()).command(({state:o})=>By(i,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},$N=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=io(n,0,r.content.size),i=tt.create(r,s);e.setSelection(i)}return!0},qN=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=ct.atStart(r).from,a=ct.atEnd(r).to,l=io(s,o,a),c=io(i,o,a),u=ct.create(r,l,c);e.setSelection(u)}return!0},KN=n=>({state:e,dispatch:t})=>{const r=gn(n,e.schema);return AO(r)(e,t)};function qy(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e==null?void 0:e.includes(s.type.name));n.tr.ensureMarks(r)}}const WN=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=s.extensionManager.attributes,u=Nu(c,a.node().type.name,a.node().attrs);if(i instanceof tt&&i.node.isBlock)return!a.parentOffset||!ga(o,a.pos)?!1:(r&&(n&&qy(t,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const f=l.parentOffset===l.parent.content.size;i instanceof ct&&e.deleteSelection();const d=a.depth===0?void 0:PN(a.node(-1).contentMatchAt(a.indexAfter(-1)));let m=f&&d?[{type:d,attrs:u}]:void 0,_=ga(e.doc,e.mapping.map(a.pos),1,m);if(!m&&!_&&ga(e.doc,e.mapping.map(a.pos),1,d?[{type:d}]:void 0)&&(_=!0,m=d?[{type:d,attrs:u}]:void 0),_&&(e.split(e.mapping.map(a.pos),1,m),d&&!f&&!a.parentOffset&&a.parent.type!==d)){const D=e.mapping.map(a.before()),O=e.doc.resolve(D);a.node(-1).canReplaceWith(O.index(),O.index()+1,d)&&e.setNodeMarkup(e.mapping.map(a.before()),d)}n&&qy(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return!0},GN=n=>({tr:e,state:t,dispatch:r,editor:s})=>{var i;const o=gn(n,t.schema),{$from:a,$to:l}=t.selection,c=t.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const u=a.node(-1);if(u.type!==o)return!1;const f=s.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let O=Be.empty;const x=a.index(-1)?1:a.index(-2)?2:3;for(let S=a.depth-x;S>=a.depth-3;S-=1)O=Be.from(a.node(S).copy(O));const w=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,N=Nu(f,a.node().type.name,a.node().attrs),V=((i=o.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(N))||void 0;O=O.append(Be.from(o.createAndFill(null,V)||void 0));const p=a.before(a.depth-(x-1));e.replace(p,a.after(-w),new $e(O,4-x,0));let k=-1;e.doc.nodesBetween(p,e.doc.content.size,(S,b)=>{if(k>-1)return!1;S.isTextblock&&S.content.size===0&&(k=b+1)}),k>-1&&e.setSelection(ct.near(e.doc.resolve(k))),e.scrollIntoView()}return!0}const d=l.pos===a.end()?u.contentMatchAt(0).defaultType:null,m=Nu(f,u.type.name,u.attrs),_=Nu(f,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const D=d?[{type:o,attrs:m},{type:d,attrs:_}]:[{type:o,attrs:m}];if(!ga(e.doc,a.pos,2))return!1;if(r){const{selection:O,storedMarks:x}=t,{splittableMarks:w}=s.extensionManager,N=x||O.$to.parentOffset&&O.$from.marks();if(e.split(a.pos,2,D).scrollIntoView(),!N||!r)return!0;const V=N.filter(p=>w.includes(p.type.name));e.ensureMarks(V)}return!0},Td=(n,e)=>{const t=D0(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Li(n.doc,t.pos)&&n.join(t.pos),!0},Sd=(n,e)=>{const t=D0(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&Li(n.doc,r)&&n.join(r),!0},YN=(n,e,t,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:f,splittableMarks:d}=s.extensionManager,m=gn(n,o.schema),_=gn(e,o.schema),{selection:D,storedMarks:O}=o,{$from:x,$to:w}=D,N=x.blockRange(w),V=O||D.$to.parentOffset&&D.$from.marks();if(!N)return!1;const p=D0(k=>$y(k.type.name,f))(D);if(N.depth>=1&&p&&N.depth-p.depth<=1){if(p.node.type===m)return c.liftListItem(_);if($y(p.node.type.name,f)&&m.validContent(p.node.content)&&a)return l().command(()=>(i.setNodeMarkup(p.pos,m),!0)).command(()=>Td(i,m)).command(()=>Sd(i,m)).run()}return!t||!V||!a?l().command(()=>u().wrapInList(m,r)?!0:c.clearNodes()).wrapInList(m,r).command(()=>Td(i,m)).command(()=>Sd(i,m)).run():l().command(()=>{const k=u().wrapInList(m,r),S=V.filter(b=>d.includes(b.type.name));return i.ensureMarks(S),k?!0:c.clearNodes()}).wrapInList(m,r).command(()=>Td(i,m)).command(()=>Sd(i,m)).run()},XN=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=t,o=Fi(n,r.schema);return Kp(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},QN=(n,e,t={})=>({state:r,commands:s})=>{const i=gn(n,r.schema),o=gn(e,r.schema);return dc(r,i,t)?s.setNode(o):s.setNode(i,t)},JN=(n,e={})=>({state:t,commands:r})=>{const s=gn(n,t.schema);return dc(t,s,e)?r.lift(s):r.wrapIn(s,e)},ZN=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},eD=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},tD=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=Fi(n,r.schema),{$from:c,empty:u,ranges:f}=a;if(!s)return!0;if(u&&o){let{from:d,to:m}=a;const _=(i=c.marks().find(O=>O.type===l))===null||i===void 0?void 0:i.attrs,D=O0(c,l,_);D&&(d=D.from,m=D.to),t.removeMark(d,m,l)}else f.forEach(d=>{t.removeMark(d.$from.pos,d.$to.pos,l)});return t.removeStoredMark(l),!0},nD=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Sf(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=gn(n,r.schema)),a==="mark"&&(o=Fi(n,r.schema)),s&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;r.doc.nodesBetween(c,u,(f,d)=>{i&&i===f.type&&t.setNodeMarkup(d,void 0,{...f.attrs,...e}),o&&f.marks.length&&f.marks.forEach(m=>{if(o===m.type){const _=Math.max(d,c),D=Math.min(d+f.nodeSize,u);t.addMark(_,D,o.create({...m.attrs,...e}))}})})}),!0):!1},rD=(n,e={})=>({state:t,dispatch:r})=>{const s=gn(n,t.schema);return bO(s,e)(t,r)},sD=(n,e={})=>({state:t,dispatch:r})=>{const s=gn(n,t.schema);return vO(s,e)(t,r)};var iD=Object.freeze({__proto__:null,blur:jO,clearContent:zO,clearNodes:$O,command:qO,createParagraphNear:KO,cut:WO,deleteCurrentNode:GO,deleteNode:YO,deleteRange:XO,deleteSelection:QO,enter:JO,exitCode:ZO,extendMarkRange:tN,first:nN,focus:rN,forEach:sN,insertContent:iN,insertContentAt:lN,joinUp:cN,joinDown:uN,joinBackward:hN,joinForward:fN,joinItemBackward:dN,joinItemForward:pN,joinTextblockBackward:mN,joinTextblockForward:gN,keyboardShortcut:yN,lift:bN,liftEmptyBlock:vN,liftListItem:EN,newlineInCode:wN,resetAttributes:TN,scrollIntoView:SN,selectAll:AN,selectNodeBackward:IN,selectNodeForward:RN,selectParentNode:kN,selectTextblockEnd:CN,selectTextblockStart:xN,setContent:MN,setMark:HN,setMeta:jN,setNode:zN,setNodeSelection:$N,setTextSelection:qN,sinkListItem:KN,splitBlock:WN,splitListItem:GN,toggleList:YN,toggleMark:XN,toggleNode:QN,toggleWrap:JN,undoInputRule:ZN,unsetAllMarks:eD,unsetMark:tD,updateAttributes:nD,wrapIn:rD,wrapInList:sD});const oD=or.create({name:"commands",addCommands(){return{...iD}}}),aD=or.create({name:"editable",addProseMirrorPlugins(){return[new Ar({key:new Vi("editable"),props:{editable:()=>this.editor.options.editable}})]}}),lD=or.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Ar({key:new Vi("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),cD=or.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:f}=l,{pos:d,parent:m}=f,_=f.parent.isTextblock&&d>0?a.doc.resolve(d-1):f,D=_.parent.type.spec.isolating,O=f.pos-f.parentOffset,x=D&&_.parent.childCount===1?O===f.pos:ft.atStart(c).from===d;return!u||!m.type.isTextblock||m.textContent.length||!x||x&&f.parent.type.name==="paragraph"?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return N0()||tT()?i:s},addProseMirrorPlugins(){return[new Ar({key:new Vi("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(_=>_.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:s,from:i,to:o}=e.selection,a=ft.atStart(e.doc).from,l=ft.atEnd(e.doc).to;if(s||!(i===a&&o===l)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const f=t.tr,d=bf({state:t,transaction:f}),{commands:m}=new vf({editor:this.editor,state:d});if(m.clearNodes(),!!f.steps.length)return f}})]}}),uD=or.create({name:"tabindex",addProseMirrorPlugins(){return[new Ar({key:new Vi("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});class to{constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new to(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new to(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new to(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,i=this.pos+r+1,o=this.resolvedPos.doc.resolve(i);if(!s&&o.depth<=this.depth)return;const a=new to(o,this.editor,s,s?t:null);s&&(a.actualDepth=this.depth+1),e.push(new to(o,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const i=s.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==t[l])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];if(!this.children||this.children.length===0)return s;const i=Object.keys(t);return this.children.forEach(o=>{r&&s.length>0||(o.node.type.name===e&&i.every(l=>t[l]===o.node.attrs[l])&&s.push(o),!(r&&s.length>0)&&(s=s.concat(o.querySelectorAll(e,t,r))))}),s}setAttribute(e){const t=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,e).setTextSelection(t.from).run()}}const hD=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function fD(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}let pF=class extends IO{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=fD(hD,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Yw(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});this.view.updateState(s)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(s=>!s.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[aD,HO.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),oD,lD,cD,uD]:[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new sa(s,this)}createCommandManager(){this.commandManager=new vf({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=nT(this.options.content,this.schema,this.options.parseOptions),t=Zw(e,this.options.autofocus);this.view=new q7(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:ra.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return VN(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return BN(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return NN(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return DN(this.state.doc,{blockSeparator:t,textSerializers:{...Qw(this.schema),...r}})}get isEmpty(){return FN(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new to(t,this)}get $doc(){return this.$pos(0)}};function Da(n){return new wf({find:n.find,handler:({state:e,range:t,match:r})=>{const s=ht(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),u=c+o.length;if(rT(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(D=>D===n.type&&D!==m.mark.type)).filter(m=>m.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+l,c);const d=t.from+l+o.length;i.addMark(t.from+l,d,n.type.create(s||{})),i.removeStoredMark(n.type)}}})}function dD(n){return new wf({find:n.find,handler:({state:e,range:t,match:r})=>{const s=ht(n.getAttributes,void 0,r)||{},{tr:i}=e,o=t.from;let a=t.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=o+c;u>a?u=a:a=u+r[1].length;const f=r[0][r[0].length-1];i.insertText(f,o+r[0].length-1),i.replaceWith(u,a,l)}else r[0]&&i.insert(o-1,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a));i.scrollIntoView()}})}function Wp(n){return new wf({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),i=ht(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function pc(n){return new wf({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const i=ht(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&v0(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:f,storedMarks:d}=e,{splittableMarks:m}=n.editor.extensionManager,_=d||f.$to.parentOffset&&f.$from.marks();if(_){const D=_.filter(O=>m.includes(O.type.name));o.ensureMarks(D)}}if(n.keepAttributes){const f=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(f,i).run()}const u=o.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Li(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&o.join(t.from-1)}})}class is{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ht(Ge(this,"addOptions",{name:this.name}))),this.storage=ht(Ge(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new is(e)}configure(e={}){const t=this.extend();return t.options=Tf(this.options,e),t.storage=ht(Ge(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new is({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ht(Ge(t,"addOptions",{name:t.name})),t.storage=ht(Ge(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}class Fn{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ht(Ge(this,"addOptions",{name:this.name}))),this.storage=ht(Ge(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Fn(e)}configure(e={}){const t=this.extend();return t.options=Tf(this.options,e),t.storage=ht(Ge(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Fn({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ht(Ge(t,"addOptions",{name:t.name})),t.storage=ht(Ge(t,"addStorage",{name:t.name,options:t.options})),t}}function La(n){return new NO({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const i=ht(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),f=t.from+l.indexOf(a),d=f+a.length;if(rT(t.from,t.to,e.doc).filter(_=>_.mark.type.excluded.find(O=>O===n.type&&O!==_.mark.type)).filter(_=>_.to>f).length)return null;d<t.to&&o.delete(d,t.to),f>t.from&&o.delete(t.from+u,f),c=t.from+u+a.length,o.addMark(t.from+u,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}const pD=/^\s*>\s$/,mD=Fn.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",un(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[pc({find:pD,type:this.type})]}}),gD=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,_D=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,yD=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,bD=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,vD=is.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",un(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Da({find:gD,type:this.type}),Da({find:yD,type:this.type})]},addPasteRules(){return[La({find:_D,type:this.type}),La({find:bD,type:this.type})]}}),ED=Fn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",un(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ky=is.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",un(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Af(n,this.type);return Object.entries(t).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),Wy=/^\s*([-+*])\s$/,wD=Fn.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",un(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(ED.name,this.editor.getAttributes(Ky.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=pc({find:Wy,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=pc({find:Wy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Ky.name),editor:this.editor})),[n]}}),TD=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,SD=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,AD=is.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",un(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Da({find:TD,type:this.type})]},addPasteRules(){return[La({find:SD,type:this.type})]}}),ID=/^```([a-z]+)?[\s\n]$/,RD=/^~~~([a-z]+)?[\s\n]$/,kD=Fn.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",un(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:i}=t;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0||r.nodeAt(a)?!1:n.commands.exitCode()}}},addInputRules(){return[Wp({find:ID,type:this.type,getAttributes:n=>({language:n[1]})}),Wp({find:RD,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new Ar({key:new Vi("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!t||!i)return!1;const{tr:o}=n.state;return n.state.selection.from===n.state.doc.nodeSize-(1+n.state.selection.$to.depth*2)?o.insert(n.state.selection.from-1,this.type.create({language:i})):o.replaceSelectionWith(this.type.create({language:i})),o.setSelection(ct.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(t.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),CD=Fn.create({name:"doc",topNode:!0,content:"block+"});function xD(n={}){return new Ar({view(e){return new MD(e,n)}})}class MD{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),f=a?u.bottom:u.top;a&&l&&(f=(f+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:f-this.width/2,bottom:f+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let s=this.editorView.dom.offsetParent;this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let i,o;if(!s||s==document.body&&getComputedStyle(s).position=="static")i=-pageXOffset,o=-pageYOffset;else{let a=s.getBoundingClientRect();i=a.left-s.scrollLeft,o=a.top-s.scrollTop}this.element.style.left=r.left-i+"px",this.element.style.top=r.top-o+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=tw(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const PD=or.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[xD(this.options)]}});class qt extends ft{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return qt.valid(r)?new qt(r):ft.near(r)}content(){return $e.empty}eq(e){return e instanceof qt&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new qt(e.resolve(t.pos))}getBookmark(){return new L0(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!OD(e)||!ND(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&qt.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=t;let l=e.doc.resolve(s);if(qt.valid(l))return l}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!tt.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*t),r=!1;continue e}break}i=o,s+=t;let a=e.doc.resolve(s);if(qt.valid(a))return a}return null}}}qt.prototype.visible=!1;qt.findFrom=qt.findGapCursorFrom;ft.jsonID("gapcursor",qt);class L0{constructor(e){this.pos=e}map(e){return new L0(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return qt.valid(t)?new qt(t):ft.near(t)}}function OD(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function ND(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function DD(){return new Ar({props:{decorations:FD,createSelectionBetween(n,e,t){return e.pos==t.pos&&qt.valid(t)?new qt(t):null},handleClick:VD,handleKeyDown:LD,handleDOMEvents:{beforeinput:BD}}})}const LD=Hw({ArrowLeft:fu("horiz",-1),ArrowRight:fu("horiz",1),ArrowUp:fu("vert",-1),ArrowDown:fu("vert",1)});function fu(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof ct){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=qt.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new qt(c))),!0):!1}}function VD(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!qt.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&tt.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new qt(r))),!0)}function BD(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof qt))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=Be.empty;for(let o=r.length-1;o>=0;o--)s=Be.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(t.pos,t.pos,new $e(s,0,0));return i.setSelection(ct.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function FD(n){if(!(n.selection instanceof qt))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",an.create(n.doc,[Er.widget(n.selection.head,e,{key:"gapcursor"})])}const UD=or.create({name:"gapCursor",addProseMirrorPlugins(){return[DD()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=ht(Ge(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),HD=Fn.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",un(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&o){const f=l.filter(d=>a.includes(d.type.name));c.ensureMarks(f)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),jD=Fn.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,un(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Wp({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Th=200,mn=function(){};mn.prototype.append=function(e){return e.length?(e=mn.from(e),!this.length&&e||e.length<Th&&this.leafAppend(e)||this.length<Th&&e.leafPrepend(this)||this.appendInner(e)):this};mn.prototype.prepend=function(e){return e.length?mn.from(e).append(this):this};mn.prototype.appendInner=function(e){return new zD(this,e)};mn.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?mn.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};mn.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};mn.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};mn.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};mn.from=function(e){return e instanceof mn?e:e&&e.length?new sT(e):mn.empty};var sT=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Th)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Th)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(mn);mn.empty=new sT([]);var zD=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(mn);const $D=500;class xr{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],u=[];return this.items.forEach((f,d)=>{if(!f.step){s||(s=this.remapping(r,d+1),i=s.maps.length),i--,u.push(f);return}if(s){u.push(new zr(f.map));let m=f.step.map(s.slice(i)),_;m&&o.maybeStep(m).doc&&(_=o.mapping.maps[o.mapping.maps.length-1],c.push(new zr(_,void 0,void 0,c.length+u.length))),i--,_&&s.appendMap(_,i)}else o.maybeStep(f.step);if(f.selection)return a=s?f.selection.map(s.slice(i)):f.selection,l=new xr(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let f=e.steps[u].invert(e.docs[u]),d=new zr(e.mapping.maps[u],f,t),m;(m=l&&l.merge(d))&&(d=m,u?i.pop():a=a.slice(0,a.length-1)),i.push(d),t&&(o++,t=void 0),s||(l=d)}let c=o-r.depth;return c>KD&&(a=qD(a,c),o-=c),new xr(a.append(i),o)}remapping(e,t){let r=new ma;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new xr(this.items.append(e.map(t=>new zr(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(d=>{d.selection&&a--},s);let l=t;this.items.forEach(d=>{let m=i.getMirror(--l);if(m==null)return;o=Math.min(o,m);let _=i.maps[m];if(d.step){let D=e.steps[m].invert(e.docs[m]),O=d.selection&&d.selection.map(i.slice(l+1,m));O&&a++,r.push(new zr(_,D,O))}else r.push(new zr(_))},s);let c=[];for(let d=t;d<o;d++)c.push(new zr(i.maps[d]));let u=this.items.slice(0,s).append(c).append(r),f=new xr(u,a);return f.emptyItemCount()>$D&&(f=f.compress(this.items.length-r.length)),f}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=o.selection&&o.selection.map(t.slice(r));u&&i++;let f=new zr(c.invert(),l,u),d,m=s.length-1;(d=s.length&&s[m].merge(f))?s[m]=d:s.push(f)}}else o.map&&r--},this.items.length,0),new xr(mn.from(s.reverse()),i)}}xr.empty=new xr(mn.empty,0);function qD(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class zr{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new zr(t.getMap().invert(),t,this.selection)}}}class ti{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const KD=20;function WD(n,e,t,r){let s=t.getMeta(_o),i;if(s)return s.historyState;t.getMeta(XD)&&(n=new ti(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(_o))return o.getMeta(_o).redo?new ti(n.done.addTransform(t,void 0,r,Du(e)),n.undone,Gy(t.mapping.maps[t.steps.length-1]),n.prevTime,n.prevComposition):new ti(n.done,n.undone.addTransform(t,void 0,r,Du(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!GD(t,n.prevRanges)),c=o?Ad(n.prevRanges,t.mapping):Gy(t.mapping.maps[t.steps.length-1]);return new ti(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,Du(e)),xr.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new ti(n.done.rebased(t,i),n.undone.rebased(t,i),Ad(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new ti(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Ad(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function GD(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function Gy(n){let e=[];return n.forEach((t,r,s,i)=>e.push(s,i)),e}function Ad(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function YD(n,e,t){let r=Du(e),s=_o.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new ti(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(_o,{redo:t,historyState:l})}let Id=!1,Yy=null;function Du(n){let e=n.plugins;if(Yy!=e){Id=!1,Yy=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Id=!0;break}}return Id}const _o=new Vi("history"),XD=new Vi("closeHistory");function QD(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Ar({key:_o,state:{init(){return new ti(xr.empty,xr.empty,null,0,-1)},apply(e,t,r){return WD(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?oT:r=="historyRedo"?aT:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function iT(n,e){return(t,r)=>{let s=_o.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=YD(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const oT=iT(!1,!0),aT=iT(!0,!0),JD=or.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>oT(n,e),redo:()=>({state:n,dispatch:e})=>aT(n,e)}},addProseMirrorPlugins(){return[QD(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),ZD=Fn.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",un(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{$to:t}=e.selection,r=n();return t.parentOffset===0?r.insertContentAt(Math.max(t.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:s,dispatch:i})=>{var o;if(i){const{$to:a}=s.selection,l=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?s.setSelection(ct.create(s.doc,a.pos+1)):a.nodeAfter.isBlock?s.setSelection(tt.create(s.doc,a.pos)):s.setSelection(ct.create(s.doc,a.pos));else{const c=(o=a.parent.type.contentMatch.defaultType)===null||o===void 0?void 0:o.create();c&&(s.insert(l,c),s.setSelection(ct.create(s.doc,l+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[dD({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),eL=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,tL=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,nL=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,rL=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,sL=is.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",un(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Da({find:eL,type:this.type}),Da({find:nL,type:this.type})]},addPasteRules(){return[La({find:tL,type:this.type}),La({find:rL,type:this.type})]}}),iL=Fn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",un(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),oL=Fn.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",un(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Xy=is.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",un(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=Af(n,this.type);return Object.entries(t).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),Qy=/^(\d+)\.\s$/,aL=Fn.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",un(this.options.HTMLAttributes,t),0]:["ol",un(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(oL.name,this.editor.getAttributes(Xy.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=pc({find:Qy,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=pc({find:Qy,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Xy.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),lL=Fn.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",un(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),cL=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,uL=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,hL=is.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",un(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Da({find:cL,type:this.type})]},addPasteRules(){return[La({find:uL,type:this.type})]}}),fL=Fn.create({name:"text",group:"inline"}),gF=or.create({name:"starterKit",addExtensions(){var n,e,t,r,s,i,o,a,l,c,u,f,d,m,_,D,O,x;const w=[];return this.options.blockquote!==!1&&w.push(mD.configure((n=this.options)===null||n===void 0?void 0:n.blockquote)),this.options.bold!==!1&&w.push(vD.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&w.push(wD.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&w.push(AD.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&w.push(kD.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&w.push(CD.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&w.push(PD.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&w.push(UD.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&w.push(HD.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&w.push(jD.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&w.push(JD.configure((u=this.options)===null||u===void 0?void 0:u.history)),this.options.horizontalRule!==!1&&w.push(ZD.configure((f=this.options)===null||f===void 0?void 0:f.horizontalRule)),this.options.italic!==!1&&w.push(sL.configure((d=this.options)===null||d===void 0?void 0:d.italic)),this.options.listItem!==!1&&w.push(iL.configure((m=this.options)===null||m===void 0?void 0:m.listItem)),this.options.orderedList!==!1&&w.push(aL.configure((_=this.options)===null||_===void 0?void 0:_.orderedList)),this.options.paragraph!==!1&&w.push(lL.configure((D=this.options)===null||D===void 0?void 0:D.paragraph)),this.options.strike!==!1&&w.push(hL.configure((O=this.options)===null||O===void 0?void 0:O.strike)),this.options.text!==!1&&w.push(fL.configure((x=this.options)===null||x===void 0?void 0:x.text)),w}}),_F=or.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>n.style.textAlign||this.options.defaultAlignment,renderHTML:n=>n.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${n.textAlign}`}}}}]},addCommands(){return{setTextAlign:n=>({commands:e})=>this.options.alignments.includes(n)?this.options.types.map(t=>e.updateAttributes(t,{textAlign:n})).every(t=>t):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.map(e=>n.resetAttributes(e,"textAlign")).every(e=>e)}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),yF=Ub("auth",{state:()=>({errorMessage:"",isLoggedIn:!1}),actions:{async login(n,e){const t=eh();try{const s=(await pR(t,n,e)).user;this.isLoggedIn=!0,Sh.push("/admin")}catch(r){this.errorMessage=r.message,console.error("Login error:",r.message)}},async logout(){const n=eh();try{await yR(n),this.isLoggedIn=!1,Sh.push("/")}catch(e){console.error("Logout error:",e.message)}},clearErrorMessage(){this.errorMessage=""}}});(function(){try{if(typeof document<"u"){var n=document.createElement("style");n.appendChild(document.createTextNode(".ar-line-control{position:relative;height:8px;border-radius:5px;background-color:#e6e6e6}.ar-line-control__head{position:absolute;height:inherit;background-color:#616161;border-radius:inherit}.ar-volume{display:flex;align-items:center;line-height:10px}.ar-volume-bar{width:50px;height:6px;background:#e6e6e6;border-radius:4px;position:relative}.ar-volume__icon{fill:#747474;width:24px;height:24px;border:0;border-radius:0;padding:0;background-color:unset;margin-right:3px}.ar-player{width:380px;height:unset;border:0;border-radius:0;display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:unset;font-family:Roboto,sans-serif}.ar-player>.ar-player-bar{border:1px solid #E8E8E8;border-radius:24px;margin:0 0 0 5px}.ar-player>.ar-player-bar>.ar-player__progress{width:125px}.ar-player-bar{display:flex;align-items:center;height:38px;padding:0 12px;margin:0 5px}.ar-player-actions{width:55%;display:flex;align-items:center;justify-content:space-around}.ar-player__progress{width:160px;margin:0 8px}.ar-player__time{color:#54545480;font-size:16px;width:41px}.ar-player__play{width:45px;height:45px;background-color:#fff;box-shadow:0 2px 11px 11px #00000012}.ar-player__play--active{fill:#fff!important;background-color:#05cbcd!important}.ar-player__play--active:hover{fill:#505050!important}.ar{width:420px;font-family:Roboto,sans-serif;border-radius:16px;background-color:#fafafa;box-shadow:0 4px 18px #0000002b;position:relative;box-sizing:content-box}.ar-content{padding:16px;display:flex;flex-direction:column;align-items:center}.ar-records{height:138px;padding-top:1px;overflow-y:auto;margin-bottom:20px}.ar-records__record{width:320px;height:45px;padding:0 10px;margin:0 auto;line-height:45px;display:flex;justify-content:space-between;border-bottom:1px solid #E8E8E8;position:relative}.ar-records__record--selected{border:1px solid #E8E8E8;border-radius:24px;background-color:#fff;margin-top:-1px;padding:0 34px}.ar-recorder{position:relative;display:flex;flex-direction:column;align-items:center}.ar-recorder__duration{color:#aeaeae;font-size:32px;font-weight:500;margin-top:20px;margin-bottom:16px}.ar-recorder__stop{position:absolute;top:10px;right:-52px}.ar-recorder__time-limit{position:absolute;color:#aeaeae;font-size:12px;top:128px}.ar-recorder__records-limit{position:absolute;color:#aeaeae;font-size:13px;top:78px}.ar-spinner{display:flex;height:30px;position:absolute;left:0;right:0;top:0;bottom:0;margin:auto;width:144px;z-index:10}.ar-spinner__dot{display:block;margin:0 8px;border-radius:50%;width:30px;height:30px;background:#05cbcd;animation-name:blink;animation-duration:1.4s;animation-iteration-count:infinite;animation-fill-mode:both}.ar-spinner__dot:nth-child(2){animation-delay:.2s}.ar-spinner__dot:nth-child(3){animation-delay:.4s}@keyframes blink{0%{opacity:.2}20%{opacity:1}to{opacity:.2}}.ar__text{color:#54545480;font-size:16px}.ar__blur{filter:blur(2px);opacity:.7}.ar__overlay{position:absolute;width:100%;height:100%;z-index:10}.ar__upload-status{text-align:center;font-size:10px;padding:2px;letter-spacing:1px;position:absolute;bottom:0}.ar__upload-status--success{color:green}.ar__upload-status--fail{color:red}.ar__rm{cursor:pointer;position:absolute;width:6px;height:6px;padding:6px;line-height:6px;margin:auto;left:10px;bottom:0;top:0;color:#f4785a}.ar__downloader,.ar__uploader{position:absolute;top:0;bottom:0;margin:auto}.ar__downloader{right:115px}.ar__uploader{right:85px}.ar-icon{fill:#747474;border-radius:50%;border:1px solid #05CBCD;background-color:#fff;padding:5px;cursor:pointer;transition:.2s}.ar-icon:hover{fill:#505050}.ar-icon--no-border{border:0;border-radius:0;padding:0}.ar-icon--rec{fill:#fff;background-color:#ff6b64;border-color:transparent}.ar-icon--pulse{animation:ripple .5s linear infinite}@keyframes ripple{0%{box-shadow:0 0 #ff00001a,0 0 0 1px #ff00001a,0 0 0 5px #ff00001a}to{box-shadow:0 0 #ff00001a,0 0 0 10px #ff00001a,0 0 0 20px #f000}}.ar-icon__xs{width:18px;height:18px;line-height:18px}.ar-icon__sm{width:30px;height:30px;line-height:30px}.ar-icon__lg{width:45px;height:45px;line-height:45px;box-shadow:0 2px 5px 1px #9e9e9e80}")),document.head.appendChild(n)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();const No=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},dL={name:"IconButton",props:{name:{type:String}},data:function(){return{icons:{download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 12v7H5v-7H3v7c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-7h-2zm-6 .67l2.59-2.58L17 11.5l-5 5-5-5 1.41-1.41L11 12.67V3h2z"/><path fill="none" d="M0 0h24v24H0z"/></svg>',mic:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',pause:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',play:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/><path d="M0 0h24v24H0z" fill="none"/></svg>',save:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>',stop:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M6 6h12v12H6z"/></svg>',volume:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'}}}},pL=["innerHTML"];function mL(n,e,t,r,s,i){return $t(),Nn("div",{innerHTML:n.icons[t.name]},null,8,pL)}const Lc=No(dL,[["render",mL]]);function Rd(n,e){const t=e.getBoundingClientRect().width,r=n.target.getBoundingClientRect().left;let s=(n.clientX-r)/t;try{if(!n.target.className.match(/^ar-line-control/))return}catch{return}return s=s<0?0:s,s=s>1?1:s,s}function ni(n){return new Date(n*1e3).toISOString().substr(14,5)}const gL={name:"LineControl",props:{refId:{type:String},eventName:{type:String},percentage:{type:Number,default:0},rowDirection:{type:Boolean,default:!0}},methods:{onMouseDown(n){const e=Rd(n,this.$refs[this.refId]);this.$emit("change-linehead",e),document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp)},onMouseUp(n){document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("mousemove",this.onMouseMove);const e=Rd(n,this.$refs[this.refId]);this.$emit("change-linehead",e)},onMouseMove(n){const e=Rd(n,this.$refs[this.refId]);this.$emit("change-linehead",e)}},computed:{calculateSize(){const n=this.percentage<1?this.percentage*100:this.percentage;return`${this.rowDirection?"width":"height"}: ${n}%`}}};function _L(n,e,t,r,s,i){return $t(),Nn("div",{ref:t.refId,class:"ar-line-control",onMousedown:e[0]||(e[0]=(...o)=>i.onMouseDown&&i.onMouseDown(...o))},[pt("div",{class:"ar-line-control__head",style:_c(i.calculateSize)},null,4)],544)}const lT=No(gL,[["render",_L]]),yL={name:"VolumeControl",data(){return{volume:.8}},components:{IconButton:Lc,LineControl:lT},methods:{onChangeLinehead(n){this.$emit("change-volume",n),this.volume=n}}},bL={class:"ar-volume"};function vL(n,e,t,r,s,i){const o=nr("icon-button"),a=nr("line-control");return $t(),Nn("div",bL,[vt(o,{class:"ar-volume__icon",name:"volume"}),vt(a,{class:"ar-volume-bar","ref-id":"volume",percentage:s.volume,onChangeLinehead:i.onChangeLinehead},null,8,["percentage","onChangeLinehead"])])}const EL=No(yL,[["render",vL]]),wL={name:"AudioPlayer",props:{src:{type:String},record:{type:Object},filename:{type:String}},data(){return{isPlaying:!1,duration:ni(0),playedTime:ni(0),progress:0}},components:{IconButton:Lc,LineControl:lT,VolumeControl:EL},mounted:function(){this.player=document.getElementById(this.playerUniqId),this.player.addEventListener("ended",()=>{this.isPlaying=!1}),this.player.addEventListener("loadeddata",()=>{this._resetProgress(),this.duration=ni(this.player.duration)}),this.player.addEventListener("timeupdate",this._onTimeUpdate)},computed:{audioSource(){return this.src||this.record.url||(this._resetProgress(),null)},playBtnIcon(){return this.isPlaying?"pause":"play"},playerUniqId(){return`audio-player${this._uid}`}},methods:{playback(){this.audioSource&&(this.isPlaying?this.player.pause():setTimeout(()=>{this.player.play()},0),this.isPlaying=!this.isPlaying)},_resetProgress(){this.isPlaying&&this.player.pause(),this.duration=ni(0),this.playedTime=ni(0),this.progress=0,this.isPlaying=!1},_onTimeUpdate(){this.playedTime=ni(this.player.currentTime),this.progress=this.player.currentTime/this.player.duration*100},_onUpdateProgress(n){n&&(this.player.currentTime=n*this.player.duration)},_onChangeVolume(n){n&&(this.player.volume=n)}}},TL={class:"ar-player"},SL={class:"ar-player-actions"},AL={class:"ar-player-bar"},IL={class:"ar-player__time"},RL={class:"ar-player__time"},kL=["id","src"];function CL(n,e,t,r,s,i){const o=nr("icon-button"),a=nr("line-control"),l=nr("volume-control");return $t(),Nn("div",TL,[pt("div",SL,[vt(o,{id:"play",class:mi(["ar-icon ar-icon__lg ar-player__play",{"ar-player__play--active":s.isPlaying}]),name:i.playBtnIcon,onClick:i.playback},null,8,["name","class","onClick"])]),pt("div",AL,[pt("div",IL,Ys(s.playedTime),1),vt(a,{class:"ar-player__progress","ref-id":"progress",percentage:s.progress,onChangeLinehead:i._onUpdateProgress},null,8,["percentage","onChangeLinehead"]),pt("div",RL,Ys(s.duration),1),vt(l,{onChangeVolume:i._onChangeVolume},null,8,["onChangeVolume"])]),pt("audio",{id:i.playerUniqId,src:i.audioSource},null,8,kL)])}const Gp=No(wL,[["render",CL]]),xL={name:"Downloader",props:{record:{type:Object},filename:{type:String}},components:{IconButton:Lc},methods:{download(){if(!this.record.url)return;const n=this.record.blob.type.split("/")[1],e=document.createElement("a");e.href=this.record.url,e.download=`${this.filename}.${n}`,e.click()}}};function ML(n,e,t,r,s,i){const o=nr("icon-button");return $t(),ba(o,{id:"download",class:"ar-icon ar-icon__xs ar-icon--no-border",name:"download",onClick:i.download},null,8,["onClick"])}const PL=No(xL,[["render",ML]]),cT={props:{filename:{type:String,default:"record"},format:{type:String,default:"mp3"},headers:{type:Object,default:()=>({})},uploadUrl:{type:String}}},OL={name:"Uploader",mixins:[cT],props:{record:{type:Object}},emits:["start-upload","end-upload"],components:{IconButton:Lc},methods:{upload(){if(!this.record.url)return;this.$emit("start-upload");const n=new FormData;n.append("audio",this.record.blob,`${this.filename}.mp3`);const e=Object.assign(this.headers,{});e["Content-Type"]=`multipart/form-data; boundary=${n._boundary}`,this.$http.post(this.uploadUrl,n,{headers:e}).then(t=>{this.$emit("end-upload",{status:"success",response:t})}).catch(t=>{this.$emit("end-upload",{status:"fail",response:t})})}}};function NL(n,e,t,r,s,i){const o=nr("icon-button");return $t(),ba(o,{name:"save",class:"ar-icon ar-icon__xs ar-icon--no-border",onClick:i.upload},null,8,["onClick"])}const DL=No(OL,[["render",NL]]);function LL(n){return new Int8Array(n)}function uT(n){return new Int16Array(n)}function hT(n){return new Int32Array(n)}function fT(n){return new Float32Array(n)}function VL(n){return new Float64Array(n)}function dT(n){if(n.length==1)return fT(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(dT(n));return t}function pT(n){if(n.length==1)return hT(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(pT(n));return t}function mT(n){if(n.length==1)return uT(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(mT(n));return t}function gT(n){if(n.length==1)return new Array(n[0]);var e=n[0];n=n.slice(1);for(var t=[],r=0;r<e;r++)t.push(gT(n));return t}var _T={};_T.fill=function(n,e,t,r){if(arguments.length==2)for(var s=0;s<n.length;s++)n[s]=arguments[1];else for(var s=e;s<t;s++)n[s]=r};var Vc={};Vc.arraycopy=function(n,e,t,r,s){for(var i=e+s;e<i;)t[r++]=n[e++]};Vc.out={};Vc.out.println=function(n){console.log(n)};Vc.out.printf=function(){console.log.apply(console,arguments)};var If={};If.SQRT2=1.4142135623730951;If.FAST_LOG10=function(n){return Math.log10(n)};If.FAST_LOG10_X=function(n,e){return Math.log10(n)*e};function Cs(n){this.ordinal=n}Cs.short_block_allowed=new Cs(0);Cs.short_block_coupled=new Cs(1);Cs.short_block_dispensed=new Cs(2);Cs.short_block_forced=new Cs(3);var yT={};yT.MAX_VALUE=34028235e31;function mr(n){this.ordinal=n}mr.vbr_off=new mr(0);mr.vbr_mt=new mr(1);mr.vbr_rh=new mr(2);mr.vbr_abr=new mr(3);mr.vbr_mtrh=new mr(4);mr.vbr_default=mr.vbr_mtrh;var BL=function(n){},Bt={System:Vc,VbrMode:mr,Float:yT,ShortBlock:Cs,Util:If,Arrays:_T,new_array_n:gT,new_byte:LL,new_double:VL,new_float:fT,new_float_n:dT,new_int:hT,new_int_n:pT,new_short:uT,new_short_n:mT,assert:BL},kd,Jy;function FL(){if(Jy)return kd;Jy=1;var n=Bt,e=n.System,t=n.Util,r=n.Arrays,s=n.new_float,i=Hn();function o(){var a=[-.1482523854003001,32.308141959636465,296.40344946382766,883.1344870032432,11113.947376231741,1057.2713659324597,305.7402417275812,30.825928907280012,3.8533188138216365,59.42900443849514,709.5899960123345,5281.91112291017,-5829.66483675846,-817.6293103748613,-76.91656988279972,-4.594269939176596,.9063471690191471,.1960342806591213,-.15466694054279598,34.324387823855965,301.8067566458425,817.599602898885,11573.795901679885,1181.2520595540152,321.59731579894424,31.232021761053772,3.7107095756221318,53.650946155329365,684.167428119626,5224.56624370173,-6366.391851890084,-908.9766368219582,-89.83068876699639,-5.411397422890401,.8206787908286602,.3901806440322567,-.16070888947830023,36.147034243915876,304.11815768187864,732.7429163887613,11989.60988270091,1300.012278487897,335.28490093152146,31.48816102859945,3.373875931311736,47.232241542899175,652.7371796173471,5132.414255594984,-6909.087078780055,-1001.9990371107289,-103.62185754286375,-6.104916304710272,.7416505462720353,.5805693545089249,-.16636367662261495,37.751650073343995,303.01103387567713,627.9747488785183,12358.763425278165,1412.2779918482834,346.7496836825721,31.598286663170416,3.1598635433980946,40.57878626349686,616.1671130880391,5007.833007176154,-7454.040671756168,-1095.7960341867115,-118.24411666465777,-6.818469345853504,.6681786379192989,.7653668647301797,-.1716176790982088,39.11551877123304,298.3413246578966,503.5259106886539,12679.589408408976,1516.5821921214542,355.9850766329023,31.395241710249053,2.9164211881972335,33.79716964664243,574.8943997801362,4853.234992253242,-7997.57021486075,-1189.7624067269965,-133.6444792601766,-7.7202770609839915,.5993769336819237,.9427934736519954,-.17645823955292173,40.21879108166477,289.9982036694474,359.3226160751053,12950.259102786438,1612.1013903507662,362.85067106591504,31.045922092242872,2.822222032597987,26.988862316190684,529.8996541764288,4671.371946949588,-8535.899136645805,-1282.5898586244496,-149.58553632943463,-8.643494270763135,.5345111359507916,1.111140466039205,-.36174739330527045,41.04429910497807,277.5463268268618,195.6386023135583,13169.43812144731,1697.6433561479398,367.40983966190305,30.557037410382826,2.531473372857427,20.070154905927314,481.50208566532336,4464.970341588308,-9065.36882077239,-1373.62841526722,-166.1660487028118,-9.58289321133207,.4729647758913199,1.268786568327291,-.36970682634889585,41.393213350082036,261.2935935556502,12.935476055240873,13336.131683328815,1772.508612059496,369.76534388639965,29.751323653701338,2.4023193045459172,13.304795348228817,430.5615775526625,4237.0568611071185,-9581.931701634761,-1461.6913552409758,-183.12733958476446,-10.718010163869403,.41421356237309503,1.414213562373095,-.37677560326535325,41.619486213528496,241.05423794991074,-187.94665032361226,13450.063605744153,1836.153896465782,369.4908799925761,29.001847876923147,2.0714759319987186,6.779591200894186,377.7767837205709,3990.386575512536,-10081.709459700915,-1545.947424837898,-200.3762958015653,-11.864482073055006,.3578057213145241,1.546020906725474,-.3829366947518991,41.1516456456653,216.47684307105183,-406.1569483347166,13511.136535077321,1887.8076599260432,367.3025214564151,28.136213436723654,1.913880671464418,.3829366947518991,323.85365704338597,3728.1472257487526,-10561.233882199509,-1625.2025997821418,-217.62525175416,-13.015432208941645,.3033466836073424,1.66293922460509,-.5822628872992417,40.35639251440489,188.20071124269245,-640.2706748618148,13519.21490106562,1927.6022433578062,362.8197642637487,26.968821921868447,1.7463817695935329,-5.62650678237171,269.3016715297017,3453.386536448852,-11016.145278780888,-1698.6569643425091,-234.7658734267683,-14.16351421663124,.2504869601913055,1.76384252869671,-.5887180101749253,39.23429103868072,155.76096234403798,-889.2492977967378,13475.470561874661,1955.0535223723712,356.4450994756727,25.894952980042156,1.5695032905781554,-11.181939564328772,214.80884394039484,3169.1640829158237,-11443.321309975563,-1765.1588461316153,-251.68908574481912,-15.49755935939164,.198912367379658,1.847759065022573,-.7912582233652842,37.39369355329111,119.699486012458,-1151.0956593239027,13380.446257078214,1970.3952110853447,348.01959814116185,24.731487364283044,1.3850130831637748,-16.421408865300393,161.05030052864092,2878.3322807850063,-11838.991423510031,-1823.985884688674,-268.2854986386903,-16.81724543849939,.1483359875383474,1.913880671464418,-.7960642926861912,35.2322109610459,80.01928065061526,-1424.0212633405113,13235.794061869668,1973.804052543835,337.9908651258184,23.289159354463873,1.3934255946442087,-21.099669467133474,108.48348407242611,2583.700758091299,-12199.726194855148,-1874.2780658979746,-284.2467154529415,-18.11369784385905,.09849140335716425,1.961570560806461,-.998795456205172,32.56307803611191,36.958364584370486,-1706.075448829146,13043.287458812016,1965.3831106103316,326.43182772364605,22.175018750622293,1.198638339011324,-25.371248002043963,57.53505923036915,2288.41886619975,-12522.674544337233,-1914.8400385312243,-299.26241273417224,-19.37805630698734,.04912684976946725,1.990369453344394,.035780907*t.SQRT2*.5/2384e-9,.017876148*t.SQRT2*.5/2384e-9,.003134727*t.SQRT2*.5/2384e-9,.002457142*t.SQRT2*.5/2384e-9,971317e-9*t.SQRT2*.5/2384e-9,218868e-9*t.SQRT2*.5/2384e-9,101566e-9*t.SQRT2*.5/2384e-9,13828e-9*t.SQRT2*.5/2384e-9,12804.797818791945,1945.5515939597317,313.4244966442953,20.801593959731544,1995.1556208053692,9.000838926174497,-29.20218120805369],l=12,c=36,u=[[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,940084909404969e-27,6423305872147839e-28,2382191739347918e-28,5456116108943412e-27,4878985199565852e-27,4240448995017367e-27,3559909094758252e-27,2858043359288075e-27,2156177623817898e-27,1475637723558783e-27,8371015190102974e-28,2599706096327376e-28,-5456116108943412e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758252e-27,-2858043359288076e-27,-2156177623817898e-27,-1475637723558783e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347923e-28,-6423305872147843e-28,-9400849094049696e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049694e-28,-642330587214784e-27,-2382191739347918e-28],[2382191739347913e-28,6423305872147834e-28,9400849094049688e-28,1122435026096556e-27,1183840321267481e-27,1122435026096556e-27,9400849094049688e-28,6423305872147841e-28,2382191739347918e-28,5456116108943413e-27,4878985199565852e-27,4240448995017367e-27,3559909094758253e-27,2858043359288075e-27,2156177623817898e-27,1475637723558782e-27,8371015190102975e-28,2599706096327376e-28,-5461314069809755e-27,-4921085770524055e-27,-4343405037091838e-27,-3732668368707687e-27,-3093523840190885e-27,-2430835727329465e-27,-1734679010007751e-27,-974825365660928e-27,-2797435120168326e-28,0,0,0,0,0,0,-2283748241799531e-28,-4037858874020686e-28,-2146547464825323e-28],[.1316524975873958,.414213562373095,.7673269879789602,1.091308501069271,1.303225372841206,1.56968557711749,1.920982126971166,2.414213562373094,3.171594802363212,4.510708503662055,7.595754112725146,22.90376554843115,.984807753012208,.6427876096865394,.3420201433256688,.9396926207859084,-.1736481776669303,-.7660444431189779,.8660254037844387,.5,-.5144957554275265,-.4717319685649723,-.3133774542039019,-.1819131996109812,-.09457419252642064,-.04096558288530405,-.01419856857247115,-.003699974673760037,.8574929257125442,.8817419973177052,.9496286491027329,.9833145924917901,.9955178160675857,.9991605581781475,.999899195244447,.9999931550702802],[0,0,0,0,0,0,2283748241799531e-28,4037858874020686e-28,2146547464825323e-28,5461314069809755e-27,4921085770524055e-27,4343405037091838e-27,3732668368707687e-27,3093523840190885e-27,2430835727329466e-27,1734679010007751e-27,974825365660928e-27,2797435120168326e-28,-5456116108943413e-27,-4878985199565852e-27,-4240448995017367e-27,-3559909094758253e-27,-2858043359288075e-27,-2156177623817898e-27,-1475637723558782e-27,-8371015190102975e-28,-2599706096327376e-28,-2382191739347913e-28,-6423305872147834e-28,-9400849094049688e-28,-1122435026096556e-27,-1183840321267481e-27,-1122435026096556e-27,-9400849094049688e-28,-6423305872147841e-28,-2382191739347918e-28]],f=u[i.SHORT_TYPE],d=u[i.SHORT_TYPE],m=u[i.SHORT_TYPE],_=u[i.SHORT_TYPE],D=[0,1,16,17,8,9,24,25,4,5,20,21,12,13,28,29,2,3,18,19,10,11,26,27,6,7,22,23,14,15,30,31];function O(N,V,p){for(var k=10,S=V+238-14-286,b=-15;b<0;b++){var E,T,M;E=a[k+-10],T=N[S+-224]*E,M=N[V+224]*E,E=a[k+-9],T+=N[S+-160]*E,M+=N[V+160]*E,E=a[k+-8],T+=N[S+-96]*E,M+=N[V+96]*E,E=a[k+-7],T+=N[S+-32]*E,M+=N[V+32]*E,E=a[k+-6],T+=N[S+32]*E,M+=N[V+-32]*E,E=a[k+-5],T+=N[S+96]*E,M+=N[V+-96]*E,E=a[k+-4],T+=N[S+160]*E,M+=N[V+-160]*E,E=a[k+-3],T+=N[S+224]*E,M+=N[V+-224]*E,E=a[k+-2],T+=N[V+-256]*E,M-=N[S+256]*E,E=a[k+-1],T+=N[V+-192]*E,M-=N[S+192]*E,E=a[k+0],T+=N[V+-128]*E,M-=N[S+128]*E,E=a[k+1],T+=N[V+-64]*E,M-=N[S+64]*E,E=a[k+2],T+=N[V+0]*E,M-=N[S+0]*E,E=a[k+3],T+=N[V+64]*E,M-=N[S+-64]*E,E=a[k+4],T+=N[V+128]*E,M-=N[S+-128]*E,E=a[k+5],T+=N[V+192]*E,M-=N[S+-192]*E,T*=a[k+6],E=M-T,p[30+b*2]=M+T,p[31+b*2]=a[k+7]*E,k+=18,V--,S++}{var T,M,H,y;M=N[V+-16]*a[k+-10],T=N[V+-32]*a[k+-2],M+=(N[V+-48]-N[V+16])*a[k+-9],T+=N[V+-96]*a[k+-1],M+=(N[V+-80]+N[V+48])*a[k+-8],T+=N[V+-160]*a[k+0],M+=(N[V+-112]-N[V+80])*a[k+-7],T+=N[V+-224]*a[k+1],M+=(N[V+-144]+N[V+112])*a[k+-6],T-=N[V+32]*a[k+2],M+=(N[V+-176]-N[V+144])*a[k+-5],T-=N[V+96]*a[k+3],M+=(N[V+-208]+N[V+176])*a[k+-4],T-=N[V+160]*a[k+4],M+=(N[V+-240]-N[V+208])*a[k+-3],T-=N[V+224],H=T-M,y=T+M,M=p[14],T=p[15]-M,p[31]=y+M,p[30]=H+T,p[15]=H-T,p[14]=y-M}{var A;A=p[28]-p[0],p[0]+=p[28],p[28]=A*a[k+-2*18+7],A=p[29]-p[1],p[1]+=p[29],p[29]=A*a[k+-2*18+7],A=p[26]-p[2],p[2]+=p[26],p[26]=A*a[k+-4*18+7],A=p[27]-p[3],p[3]+=p[27],p[27]=A*a[k+-4*18+7],A=p[24]-p[4],p[4]+=p[24],p[24]=A*a[k+-6*18+7],A=p[25]-p[5],p[5]+=p[25],p[25]=A*a[k+-6*18+7],A=p[22]-p[6],p[6]+=p[22],p[22]=A*t.SQRT2,A=p[23]-p[7],p[7]+=p[23],p[23]=A*t.SQRT2-p[7],p[7]-=p[6],p[22]-=p[7],p[23]-=p[22],A=p[6],p[6]=p[31]-A,p[31]=p[31]+A,A=p[7],p[7]=p[30]-A,p[30]=p[30]+A,A=p[22],p[22]=p[15]-A,p[15]=p[15]+A,A=p[23],p[23]=p[14]-A,p[14]=p[14]+A,A=p[20]-p[8],p[8]+=p[20],p[20]=A*a[k+-10*18+7],A=p[21]-p[9],p[9]+=p[21],p[21]=A*a[k+-10*18+7],A=p[18]-p[10],p[10]+=p[18],p[18]=A*a[k+-12*18+7],A=p[19]-p[11],p[11]+=p[19],p[19]=A*a[k+-12*18+7],A=p[16]-p[12],p[12]+=p[16],p[16]=A*a[k+-14*18+7],A=p[17]-p[13],p[13]+=p[17],p[17]=A*a[k+-14*18+7],A=-p[20]+p[24],p[20]+=p[24],p[24]=A*a[k+-12*18+7],A=-p[21]+p[25],p[21]+=p[25],p[25]=A*a[k+-12*18+7],A=p[4]-p[8],p[4]+=p[8],p[8]=A*a[k+-12*18+7],A=p[5]-p[9],p[5]+=p[9],p[9]=A*a[k+-12*18+7],A=p[0]-p[12],p[0]+=p[12],p[12]=A*a[k+-4*18+7],A=p[1]-p[13],p[1]+=p[13],p[13]=A*a[k+-4*18+7],A=p[16]-p[28],p[16]+=p[28],p[28]=A*a[k+-4*18+7],A=-p[17]+p[29],p[17]+=p[29],p[29]=A*a[k+-4*18+7],A=t.SQRT2*(p[2]-p[10]),p[2]+=p[10],p[10]=A,A=t.SQRT2*(p[3]-p[11]),p[3]+=p[11],p[11]=A,A=t.SQRT2*(-p[18]+p[26]),p[18]+=p[26],p[26]=A-p[18],A=t.SQRT2*(-p[19]+p[27]),p[19]+=p[27],p[27]=A-p[19],A=p[2],p[19]-=p[3],p[3]-=A,p[2]=p[31]-A,p[31]+=A,A=p[3],p[11]-=p[19],p[18]-=A,p[3]=p[30]-A,p[30]+=A,A=p[18],p[27]-=p[11],p[19]-=A,p[18]=p[15]-A,p[15]+=A,A=p[19],p[10]-=A,p[19]=p[14]-A,p[14]+=A,A=p[10],p[11]-=A,p[10]=p[23]-A,p[23]+=A,A=p[11],p[26]-=A,p[11]=p[22]-A,p[22]+=A,A=p[26],p[27]-=A,p[26]=p[7]-A,p[7]+=A,A=p[27],p[27]=p[6]-A,p[6]+=A,A=t.SQRT2*(p[0]-p[4]),p[0]+=p[4],p[4]=A,A=t.SQRT2*(p[1]-p[5]),p[1]+=p[5],p[5]=A,A=t.SQRT2*(p[16]-p[20]),p[16]+=p[20],p[20]=A,A=t.SQRT2*(p[17]-p[21]),p[17]+=p[21],p[21]=A,A=-t.SQRT2*(p[8]-p[12]),p[8]+=p[12],p[12]=A-p[8],A=-t.SQRT2*(p[9]-p[13]),p[9]+=p[13],p[13]=A-p[9],A=-t.SQRT2*(p[25]-p[29]),p[25]+=p[29],p[29]=A-p[25],A=-t.SQRT2*(p[24]+p[28]),p[24]-=p[28],p[28]=A-p[24],A=p[24]-p[16],p[24]=A,A=p[20]-A,p[20]=A,A=p[28]-A,p[28]=A,A=p[25]-p[17],p[25]=A,A=p[21]-A,p[21]=A,A=p[29]-A,p[29]=A,A=p[17]-p[1],p[17]=A,A=p[9]-A,p[9]=A,A=p[25]-A,p[25]=A,A=p[5]-A,p[5]=A,A=p[21]-A,p[21]=A,A=p[13]-A,p[13]=A,A=p[29]-A,p[29]=A,A=p[1]-p[0],p[1]=A,A=p[16]-A,p[16]=A,A=p[17]-A,p[17]=A,A=p[8]-A,p[8]=A,A=p[9]-A,p[9]=A,A=p[24]-A,p[24]=A,A=p[25]-A,p[25]=A,A=p[4]-A,p[4]=A,A=p[5]-A,p[5]=A,A=p[20]-A,p[20]=A,A=p[21]-A,p[21]=A,A=p[12]-A,p[12]=A,A=p[13]-A,p[13]=A,A=p[28]-A,p[28]=A,A=p[29]-A,p[29]=A,A=p[0],p[0]+=p[31],p[31]-=A,A=p[1],p[1]+=p[30],p[30]-=A,A=p[16],p[16]+=p[15],p[15]-=A,A=p[17],p[17]+=p[14],p[14]-=A,A=p[8],p[8]+=p[23],p[23]-=A,A=p[9],p[9]+=p[22],p[22]-=A,A=p[24],p[24]+=p[7],p[7]-=A,A=p[25],p[25]+=p[6],p[6]-=A,A=p[4],p[4]+=p[27],p[27]-=A,A=p[5],p[5]+=p[26],p[26]-=A,A=p[20],p[20]+=p[11],p[11]-=A,A=p[21],p[21]+=p[10],p[10]-=A,A=p[12],p[12]+=p[19],p[19]-=A,A=p[13],p[13]+=p[18],p[18]-=A,A=p[28],p[28]+=p[3],p[3]-=A,A=p[29],p[29]+=p[2],p[2]-=A}}function x(N,V){for(var p=0;p<3;p++){var k,S,b,E,T,M;E=N[V+2*3]*u[i.SHORT_TYPE][0]-N[V+5*3],k=N[V+0*3]*u[i.SHORT_TYPE][2]-N[V+3*3],S=E+k,b=E-k,E=N[V+5*3]*u[i.SHORT_TYPE][0]+N[V+2*3],k=N[V+3*3]*u[i.SHORT_TYPE][2]+N[V+0*3],T=E+k,M=-E+k,k=(N[V+1*3]*u[i.SHORT_TYPE][1]-N[V+4*3])*2069978111953089e-26,E=(N[V+4*3]*u[i.SHORT_TYPE][1]+N[V+1*3])*2069978111953089e-26,N[V+3*0]=S*190752519173728e-25+k,N[V+3*5]=-T*190752519173728e-25+E,b=b*.8660254037844387*1907525191737281e-26,T=T*.5*1907525191737281e-26+E,N[V+3*1]=b-T,N[V+3*2]=b+T,S=S*.5*1907525191737281e-26-k,M=M*.8660254037844387*1907525191737281e-26,N[V+3*3]=S+M,N[V+3*4]=S-M,V++}}function w(N,V,p){var k,S;{var b,E,T,M,H,y,A,W;b=p[17]-p[9],T=p[15]-p[11],M=p[14]-p[12],H=p[0]+p[8],y=p[1]+p[7],A=p[2]+p[6],W=p[3]+p[5],N[V+17]=H+A-W-(y-p[4]),S=(H+A-W)*d[19]+(y-p[4]),k=(b-T-M)*d[18],N[V+5]=k+S,N[V+6]=k-S,E=(p[16]-p[10])*d[18],y=y*d[19]+p[4],k=b*d[12]+E+T*d[13]+M*d[14],S=-H*d[16]+y-A*d[17]+W*d[15],N[V+1]=k+S,N[V+2]=k-S,k=b*d[13]-E-T*d[14]+M*d[12],S=-H*d[17]+y-A*d[15]+W*d[16],N[V+9]=k+S,N[V+10]=k-S,k=b*d[14]-E+T*d[12]-M*d[13],S=H*d[15]-y+A*d[16]-W*d[17],N[V+13]=k+S,N[V+14]=k-S}{var X,ne,Q,ce,J,L,C,I;X=p[8]-p[0],Q=p[6]-p[2],ce=p[5]-p[3],J=p[17]+p[9],L=p[16]+p[10],C=p[15]+p[11],I=p[14]+p[12],N[V+0]=J+C+I+(L+p[13]),k=(J+C+I)*d[19]-(L+p[13]),S=(X-Q+ce)*d[18],N[V+11]=k+S,N[V+12]=k-S,ne=(p[7]-p[1])*d[18],L=p[13]-L*d[19],k=J*d[15]-L+C*d[16]+I*d[17],S=X*d[14]+ne+Q*d[12]+ce*d[13],N[V+3]=k+S,N[V+4]=k-S,k=-J*d[17]+L-C*d[15]-I*d[16],S=X*d[13]+ne-Q*d[14]-ce*d[12],N[V+7]=k+S,N[V+8]=k-S,k=-J*d[16]+L-C*d[17]-I*d[15],S=X*d[12]-ne+Q*d[13]-ce*d[14],N[V+15]=k+S,N[V+16]=k-S}}this.mdct_sub48=function(N,V,p){for(var k=V,S=286,b=0;b<N.channels_out;b++){for(var E=0;E<N.mode_gr;E++){for(var T,M=N.l3_side.tt[E][b],H=M.xr,y=0,A=N.sb_sample[b][1-E],W=0,X=0;X<18/2;X++)for(O(k,S,A[W]),O(k,S+32,A[W+1]),W+=2,S+=64,T=1;T<32;T+=2)A[W-1][T]*=-1;for(T=0;T<32;T++,y+=18){var ne=M.block_type,Q=N.sb_sample[b][E],ce=N.sb_sample[b][1-E];if(M.mixed_block_flag!=0&&T<2&&(ne=0),N.amp_filter[T]<1e-12)r.fill(H,y+0,y+18,0);else{if(N.amp_filter[T]<1)for(var X=0;X<18;X++)ce[X][D[T]]*=N.amp_filter[T];if(ne==i.SHORT_TYPE){for(var X=-l/4;X<0;X++){var J=u[i.SHORT_TYPE][X+3];H[y+X*3+9]=Q[9+X][D[T]]*J-Q[8-X][D[T]],H[y+X*3+18]=Q[14-X][D[T]]*J+Q[15+X][D[T]],H[y+X*3+10]=Q[15+X][D[T]]*J-Q[14-X][D[T]],H[y+X*3+19]=ce[2-X][D[T]]*J+ce[3+X][D[T]],H[y+X*3+11]=ce[3+X][D[T]]*J-ce[2-X][D[T]],H[y+X*3+20]=ce[8-X][D[T]]*J+ce[9+X][D[T]]}x(H,y)}else{for(var L=s(18),X=-c/4;X<0;X++){var C,I;C=u[ne][X+27]*ce[X+9][D[T]]+u[ne][X+36]*ce[8-X][D[T]],I=u[ne][X+9]*Q[X+9][D[T]]-u[ne][X+18]*Q[8-X][D[T]],L[X+9]=C-I*f[3+X+9],L[X+18]=C*f[3+X+9]+I}w(H,y,L)}}if(ne!=i.SHORT_TYPE&&T!=0)for(var X=7;X>=0;--X){var B,z;B=H[y+X]*m[20+X]+H[y+-1-X]*_[28+X],z=H[y+X]*_[28+X]-H[y+-1-X]*m[20+X],H[y+-1-X]=B,H[y+X]=z}}}if(k=p,S=286,N.mode_gr==1)for(var ie=0;ie<18;ie++)e.arraycopy(N.sb_sample[b][1][ie],0,N.sb_sample[b][0][ie],0,32)}}}return kd=o,kd}var Cd,Zy;function bT(){if(Zy)return Cd;Zy=1;var n=Hn(),e=Bt,t=e.System,r=e.new_float,s=e.new_float_n;function i(){this.l=r(n.SBMAX_l),this.s=s([n.SBMAX_s,3]);var o=this;this.assign=function(a){t.arraycopy(a.l,0,o.l,0,n.SBMAX_l);for(var l=0;l<n.SBMAX_s;l++)for(var c=0;c<3;c++)o.s[l][c]=a.s[l][c]}}return Cd=i,Cd}var xd,e2;function UL(){if(e2)return xd;e2=1;var n=bT();function e(){this.thm=new n,this.en=new n}return xd=e,xd}function Br(n){var e=n;this.ordinal=function(){return e}}Br.STEREO=new Br(0);Br.JOINT_STEREO=new Br(1);Br.DUAL_CHANNEL=new Br(2);Br.MONO=new Br(3);Br.NOT_SET=new Br(4);var Bc=Br,Md,t2;function Hn(){if(t2)return Md;t2=1;var n=Bt,e=n.System,t=n.VbrMode,r=n.new_array_n,s=n.new_float,i=n.new_float_n,o=n.new_int,a=n.assert;l.ENCDELAY=576,l.POSTDELAY=1152,l.MDCTDELAY=48,l.FFTOFFSET=224+l.MDCTDELAY,l.DECDELAY=528,l.SBLIMIT=32,l.CBANDS=64,l.SBPSY_l=21,l.SBPSY_s=12,l.SBMAX_l=22,l.SBMAX_s=13,l.PSFB21=6,l.PSFB12=6,l.BLKSIZE=1024,l.HBLKSIZE=l.BLKSIZE/2+1,l.BLKSIZE_s=256,l.HBLKSIZE_s=l.BLKSIZE_s/2+1,l.NORM_TYPE=0,l.START_TYPE=1,l.SHORT_TYPE=2,l.STOP_TYPE=3,l.MPG_MD_LR_LR=0,l.MPG_MD_LR_I=1,l.MPG_MD_MS_LR=2,l.MPG_MD_MS_I=3,l.fircoef=[-.0207887*5,-.0378413*5,-.0432472*5,-.031183*5,779609e-23*5,.0467745*5,.10091*5,.151365*5,.187098*5];function l(){var c=FL(),u=UL(),f=Bc,d=l.FFTOFFSET,m=l.MPG_MD_MS_LR,_=null;this.psy=null;var D=null,O=null,x=null;this.setModules=function(k,S,b,E){_=k,this.psy=S,D=S,O=E,x=b};var w=new c;function N(k){var S,b;if(k.ATH.useAdjust==0){k.ATH.adjust=1;return}if(b=k.loudness_sq[0][0],S=k.loudness_sq[1][0],k.channels_out==2?(b+=k.loudness_sq[0][1],S+=k.loudness_sq[1][1]):(b+=b,S+=S),k.mode_gr==2&&(b=Math.max(b,S)),b*=.5,b*=k.ATH.aaSensitivityP,b>.03125)k.ATH.adjust>=1?k.ATH.adjust=1:k.ATH.adjust<k.ATH.adjustLimit&&(k.ATH.adjust=k.ATH.adjustLimit),k.ATH.adjustLimit=1;else{var E=31.98*b+625e-6;k.ATH.adjust>=E?(k.ATH.adjust*=E*.075+.925,k.ATH.adjust<E&&(k.ATH.adjust=E)):k.ATH.adjustLimit>=E?k.ATH.adjust=E:k.ATH.adjust<k.ATH.adjustLimit&&(k.ATH.adjust=k.ATH.adjustLimit),k.ATH.adjustLimit=E}}function V(k){var S,b;for(a(0<=k.bitrate_index&&k.bitrate_index<16),a(0<=k.mode_ext&&k.mode_ext<4),k.bitrate_stereoMode_Hist[k.bitrate_index][4]++,k.bitrate_stereoMode_Hist[15][4]++,k.channels_out==2&&(k.bitrate_stereoMode_Hist[k.bitrate_index][k.mode_ext]++,k.bitrate_stereoMode_Hist[15][k.mode_ext]++),S=0;S<k.mode_gr;++S)for(b=0;b<k.channels_out;++b){var E=k.l3_side.tt[S][b].block_type|0;k.l3_side.tt[S][b].mixed_block_flag!=0&&(E=4),k.bitrate_blockType_Hist[k.bitrate_index][E]++,k.bitrate_blockType_Hist[k.bitrate_index][5]++,k.bitrate_blockType_Hist[15][E]++,k.bitrate_blockType_Hist[15][5]++}}function p(k,S){var b=k.internal_flags,E,T;if(b.lame_encode_frame_init==0){var M,H,y=s(2014),A=s(2014);for(b.lame_encode_frame_init=1,M=0,H=0;M<286+576*(1+b.mode_gr);++M)M<576*b.mode_gr?(y[M]=0,b.channels_out==2&&(A[M]=0)):(y[M]=S[0][H],b.channels_out==2&&(A[M]=S[1][H]),++H);for(T=0;T<b.mode_gr;T++)for(E=0;E<b.channels_out;E++)b.l3_side.tt[T][E].block_type=l.SHORT_TYPE;w.mdct_sub48(b,y,A),a(576>=l.FFTOFFSET),a(b.mf_size>=l.BLKSIZE+k.framesize-l.FFTOFFSET),a(b.mf_size>=512+k.framesize-32)}}this.lame_encode_mp3_frame=function(k,S,b,E,T,M){var H,y=r([2,2]);y[0][0]=new u,y[0][1]=new u,y[1][0]=new u,y[1][1]=new u;var A=r([2,2]);A[0][0]=new u,A[0][1]=new u,A[1][0]=new u,A[1][1]=new u;var W,X=[null,null],ne=k.internal_flags,Q=i([2,4]),ce=[.5,.5],J=[[0,0],[0,0]],L=[[0,0],[0,0]],C,I,B;if(X[0]=S,X[1]=b,ne.lame_encode_frame_init==0&&p(k,X),ne.padding=0,(ne.slot_lag-=ne.frac_SpF)<0&&(ne.slot_lag+=k.out_samplerate,ne.padding=1),ne.psymodel!=0){var z,ie=[null,null],Z=0,q=o(2);for(B=0;B<ne.mode_gr;B++){for(I=0;I<ne.channels_out;I++)ie[I]=X[I],Z=576+B*576-l.FFTOFFSET;if(k.VBR==t.vbr_mtrh||k.VBR==t.vbr_mt?z=D.L3psycho_anal_vbr(k,ie,Z,B,y,A,J[B],L[B],Q[B],q):z=D.L3psycho_anal_ns(k,ie,Z,B,y,A,J[B],L[B],Q[B],q),z!=0)return-4;for(k.mode==f.JOINT_STEREO&&(ce[B]=Q[B][2]+Q[B][3],ce[B]>0&&(ce[B]=Q[B][3]/ce[B])),I=0;I<ne.channels_out;I++){var ee=ne.l3_side.tt[B][I];ee.block_type=q[I],ee.mixed_block_flag=0}}}else for(B=0;B<ne.mode_gr;B++)for(I=0;I<ne.channels_out;I++)ne.l3_side.tt[B][I].block_type=l.NORM_TYPE,ne.l3_side.tt[B][I].mixed_block_flag=0,L[B][I]=J[B][I]=700;if(N(ne),w.mdct_sub48(ne,X[0],X[1]),ne.mode_ext=l.MPG_MD_LR_LR,k.force_ms)ne.mode_ext=l.MPG_MD_MS_LR;else if(k.mode==f.JOINT_STEREO){var le=0,Ee=0;for(B=0;B<ne.mode_gr;B++)for(I=0;I<ne.channels_out;I++)le+=L[B][I],Ee+=J[B][I];if(le<=1*Ee){var Oe=ne.l3_side.tt[0],j=ne.l3_side.tt[ne.mode_gr-1];Oe[0].block_type==Oe[1].block_type&&j[0].block_type==j[1].block_type&&(ne.mode_ext=l.MPG_MD_MS_LR)}}if(ne.mode_ext==m?(W=A,C=L):(W=y,C=J),k.analysis&&ne.pinfo!=null)for(B=0;B<ne.mode_gr;B++)for(I=0;I<ne.channels_out;I++)ne.pinfo.ms_ratio[B]=ne.ms_ratio[B],ne.pinfo.ms_ener_ratio[B]=ce[B],ne.pinfo.blocktype[B][I]=ne.l3_side.tt[B][I].block_type,ne.pinfo.pe[B][I]=C[B][I],e.arraycopy(ne.l3_side.tt[B][I].xr,0,ne.pinfo.xr[B][I],0,576),ne.mode_ext==m&&(ne.pinfo.ers[B][I]=ne.pinfo.ers[B][I+2],e.arraycopy(ne.pinfo.energy[B][I+2],0,ne.pinfo.energy[B][I],0,ne.pinfo.energy[B][I].length));if(k.VBR==t.vbr_off||k.VBR==t.vbr_abr){var K,re;for(K=0;K<18;K++)ne.nsPsy.pefirbuf[K]=ne.nsPsy.pefirbuf[K+1];for(re=0,B=0;B<ne.mode_gr;B++)for(I=0;I<ne.channels_out;I++)re+=C[B][I];for(ne.nsPsy.pefirbuf[18]=re,re=ne.nsPsy.pefirbuf[9],K=0;K<9;K++)re+=(ne.nsPsy.pefirbuf[K]+ne.nsPsy.pefirbuf[18-K])*l.fircoef[K];for(re=670*5*ne.mode_gr*ne.channels_out/re,B=0;B<ne.mode_gr;B++)for(I=0;I<ne.channels_out;I++)C[B][I]*=re}if(ne.iteration_loop.iteration_loop(k,C,ce,W),_.format_bitstream(k),H=_.copy_buffer(ne,E,T,M,1),k.bWriteVbrTag&&O.addVbrFrame(k),k.analysis&&ne.pinfo!=null){for(I=0;I<ne.channels_out;I++){var he;for(he=0;he<d;he++)ne.pinfo.pcmdata[I][he]=ne.pinfo.pcmdata[I][he+k.framesize];for(he=d;he<1600;he++)ne.pinfo.pcmdata[I][he]=X[I][he-d]}x.set_frame_pinfo(k,W)}return V(ne),H}}return Md=l,Md}var vT=Bt,n2=vT.Util,r2=vT.new_float,Qt=Hn();function HL(){var n=r2(Qt.BLKSIZE),e=r2(Qt.BLKSIZE_s/2),t=[.9238795325112867,.3826834323650898,.9951847266721969,.0980171403295606,.9996988186962042,.02454122852291229,.9999811752826011,.006135884649154475];function r(i,o,a){var l=0,c,u,f;a<<=1;var d=o+a;c=4;do{var m,_,D,O,x,w,N;N=c>>1,O=c,x=c<<1,w=x+O,c=x<<1,u=o,f=u+N;do{var V,p,k,S;p=i[u+0]-i[u+O],V=i[u+0]+i[u+O],S=i[u+x]-i[u+w],k=i[u+x]+i[u+w],i[u+x]=V-k,i[u+0]=V+k,i[u+w]=p-S,i[u+O]=p+S,p=i[f+0]-i[f+O],V=i[f+0]+i[f+O],S=n2.SQRT2*i[f+w],k=n2.SQRT2*i[f+x],i[f+x]=V-k,i[f+0]=V+k,i[f+w]=p-S,i[f+O]=p+S,f+=c,u+=c}while(u<d);for(_=t[l+0],m=t[l+1],D=1;D<N;D++){var b,E;b=1-2*m*m,E=2*m*_,u=o+D,f=o+O-D;do{var T,M,H,V,p,y,k,A,S,W;M=E*i[u+O]-b*i[f+O],T=b*i[u+O]+E*i[f+O],p=i[u+0]-T,V=i[u+0]+T,y=i[f+0]-M,H=i[f+0]+M,M=E*i[u+w]-b*i[f+w],T=b*i[u+w]+E*i[f+w],S=i[u+x]-T,k=i[u+x]+T,W=i[f+x]-M,A=i[f+x]+M,M=m*k-_*W,T=_*k+m*W,i[u+x]=V-T,i[u+0]=V+T,i[f+w]=y-M,i[f+O]=y+M,M=_*A-m*S,T=m*A+_*S,i[f+x]=H-T,i[f+0]=H+T,i[u+w]=p-M,i[u+O]=p+M,f+=c,u+=c}while(u<d);b=_,_=b*t[l+0]-m*t[l+1],m=b*t[l+1]+m*t[l+0]}l+=2}while(c<a)}var s=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254];this.fft_short=function(i,o,a,l,c){for(var u=0;u<3;u++){var f=Qt.BLKSIZE_s/2,d=65535&576/3*(u+1),m=Qt.BLKSIZE_s/8-1;do{var _,D,O,x,w,N=s[m<<2]&255;_=e[N]*l[a][c+N+d],w=e[127-N]*l[a][c+N+d+128],D=_-w,_=_+w,O=e[N+64]*l[a][c+N+d+64],w=e[63-N]*l[a][c+N+d+192],x=O-w,O=O+w,f-=4,o[u][f+0]=_+O,o[u][f+2]=_-O,o[u][f+1]=D+x,o[u][f+3]=D-x,_=e[N+1]*l[a][c+N+d+1],w=e[126-N]*l[a][c+N+d+129],D=_-w,_=_+w,O=e[N+65]*l[a][c+N+d+65],w=e[62-N]*l[a][c+N+d+193],x=O-w,O=O+w,o[u][f+Qt.BLKSIZE_s/2+0]=_+O,o[u][f+Qt.BLKSIZE_s/2+2]=_-O,o[u][f+Qt.BLKSIZE_s/2+1]=D+x,o[u][f+Qt.BLKSIZE_s/2+3]=D-x}while(--m>=0);r(o[u],f,Qt.BLKSIZE_s/2)}},this.fft_long=function(i,o,a,l,c){var u=Qt.BLKSIZE/8-1,f=Qt.BLKSIZE/2;do{var d,m,_,D,O,x=s[u]&255;d=n[x]*l[a][c+x],O=n[x+512]*l[a][c+x+512],m=d-O,d=d+O,_=n[x+256]*l[a][c+x+256],O=n[x+768]*l[a][c+x+768],D=_-O,_=_+O,f-=4,o[f+0]=d+_,o[f+2]=d-_,o[f+1]=m+D,o[f+3]=m-D,d=n[x+1]*l[a][c+x+1],O=n[x+513]*l[a][c+x+513],m=d-O,d=d+O,_=n[x+257]*l[a][c+x+257],O=n[x+769]*l[a][c+x+769],D=_-O,_=_+O,o[f+Qt.BLKSIZE/2+0]=d+_,o[f+Qt.BLKSIZE/2+2]=d-_,o[f+Qt.BLKSIZE/2+1]=m+D,o[f+Qt.BLKSIZE/2+3]=m-D}while(--u>=0);r(o,f,Qt.BLKSIZE/2)},this.init_fft=function(i){for(var o=0;o<Qt.BLKSIZE;o++)n[o]=.42-.5*Math.cos(2*Math.PI*(o+.5)/Qt.BLKSIZE)+.08*Math.cos(4*Math.PI*(o+.5)/Qt.BLKSIZE);for(var o=0;o<Qt.BLKSIZE_s/2;o++)e[o]=.5*(1-Math.cos(2*Math.PI*(o+.5)/Qt.BLKSIZE_s))}}var jL=HL,Ms=Bt,Ko=Ms.VbrMode,s2=Ms.Float,Wo=Ms.ShortBlock,Xn=Ms.Util,zL=Ms.Arrays,Jt=Ms.new_float,_r=Ms.new_float_n,qi=Ms.new_int,it=Ms.assert,$L=jL,ve=Hn();function qL(){var n=Bc,e=new $L,t=2.302585092994046,r=2,s=16,i=2,o=16,a=.34,l=1/(14752*14752)/(ve.BLKSIZE/2),c=.01,u=.8,f=.6,d=.3,m=3.5,_=21,D=.2302585093;function O(F,U){for(var Y=0,te=0;te<ve.BLKSIZE/2;++te)Y+=F[te]*U.ATH.eql_w[te];return Y*=l,Y}function x(F,U,Y,te,se,G,ae,ue,oe,ye,de){var be=F.internal_flags;if(oe<2)e.fft_long(be,te[se],oe,ye,de),e.fft_short(be,G[ae],oe,ye,de);else if(oe==2){for(var Le=ve.BLKSIZE-1;Le>=0;--Le){var We=te[se+0][Le],Ce=te[se+1][Le];te[se+0][Le]=(We+Ce)*Xn.SQRT2*.5,te[se+1][Le]=(We-Ce)*Xn.SQRT2*.5}for(var Ke=2;Ke>=0;--Ke)for(var Le=ve.BLKSIZE_s-1;Le>=0;--Le){var We=G[ae+0][Ke][Le],Ce=G[ae+1][Ke][Le];G[ae+0][Ke][Le]=(We+Ce)*Xn.SQRT2*.5,G[ae+1][Ke][Le]=(We-Ce)*Xn.SQRT2*.5}}U[0]=te[se+0][0],U[0]*=U[0];for(var Le=ve.BLKSIZE/2-1;Le>=0;--Le){var ge=te[se+0][ve.BLKSIZE/2-Le],ze=te[se+0][ve.BLKSIZE/2+Le];U[ve.BLKSIZE/2-Le]=(ge*ge+ze*ze)*.5}for(var Ke=2;Ke>=0;--Ke){Y[Ke][0]=G[ae+0][Ke][0],Y[Ke][0]*=Y[Ke][0];for(var Le=ve.BLKSIZE_s/2-1;Le>=0;--Le){var ge=G[ae+0][Ke][ve.BLKSIZE_s/2-Le],ze=G[ae+0][Ke][ve.BLKSIZE_s/2+Le];Y[Ke][ve.BLKSIZE_s/2-Le]=(ge*ge+ze*ze)*.5}}{for(var Xe=0,Le=11;Le<ve.HBLKSIZE;Le++)Xe+=U[Le];be.tot_ener[oe]=Xe}if(F.analysis){for(var Le=0;Le<ve.HBLKSIZE;Le++)be.pinfo.energy[ue][oe][Le]=be.pinfo.energy_save[oe][Le],be.pinfo.energy_save[oe][Le]=U[Le];be.pinfo.pe[ue][oe]=be.pe[oe]}F.athaa_loudapprox==2&&oe<2&&(be.loudness_sq[ue][oe]=be.loudness_sq_save[oe],be.loudness_sq_save[oe]=O(U,be))}var w=8,N=23,V=15,p,k,S,b=[1,.79433,.63096,.63096,.63096,.63096,.63096,.25119,.11749];function E(){p=Math.pow(10,(w+1)/16),k=Math.pow(10,(N+1)/16),S=Math.pow(10,V/10)}var T=[3.3246*3.3246,3.23837*3.23837,3.15437*3.15437,3.00412*3.00412,2.86103*2.86103,2.65407*2.65407,2.46209*2.46209,2.284*2.284,2.11879*2.11879,1.96552*1.96552,1.82335*1.82335,1.69146*1.69146,1.56911*1.56911,1.46658*1.46658,1.37074*1.37074,1.31036*1.31036,1.25264*1.25264,1.20648*1.20648,1.16203*1.16203,1.12765*1.12765,1.09428*1.09428,1.0659*1.0659,1.03826*1.03826,1.01895*1.01895,1],M=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1],H=[2.35364*2.35364,2.29259*2.29259,2.23313*2.23313,2.12675*2.12675,2.02545*2.02545,1.87894*1.87894,1.74303*1.74303,1.61695*1.61695,1.49999*1.49999,1.39148*1.39148,1.29083*1.29083,1.19746*1.19746,1.11084*1.11084,1.03826*1.03826];function y(F,U,Y,te,se,G){var ae;if(U>F)if(U<F*k)ae=U/F;else return F+U;else{if(F>=U*k)return F+U;ae=F/U}if(F+=U,te+3<=6){if(ae>=p)return F;var ue=0|Xn.FAST_LOG10_X(ae,16);return F*M[ue]}var ue=0|Xn.FAST_LOG10_X(ae,16);if(U=se.ATH.cb_l[Y]*se.ATH.adjust,F<S*U){if(F>U){var oe,ye;return oe=1,ue<=13&&(oe=H[ue]),ye=Xn.FAST_LOG10_X(F/U,10/15),F*((T[ue]-oe)*ye+oe)}return ue>13?F:F*H[ue]}return F*T[ue]}var A=[1.33352*1.33352,1.35879*1.35879,1.38454*1.38454,1.39497*1.39497,1.40548*1.40548,1.3537*1.3537,1.30382*1.30382,1.22321*1.22321,1.14758*1.14758,1];function W(F,U,Y){var te;if(F<0&&(F=0),U<0&&(U=0),F<=0)return U;if(U<=0)return F;if(U>F?te=U/F:te=F/U,-2<=Y&&Y<=2){if(te>=p)return F+U;var se=0|Xn.FAST_LOG10_X(te,16);return(F+U)*A[se]}return te<k?F+U:(F<U&&(F=U),F)}function X(F,U){var Y=F.internal_flags;if(Y.channels_out>1){for(var te=0;te<ve.SBMAX_l;te++){var se=Y.thm[0].l[te],G=Y.thm[1].l[te];Y.thm[0].l[te]+=G*U,Y.thm[1].l[te]+=se*U}for(var te=0;te<ve.SBMAX_s;te++)for(var ae=0;ae<3;ae++){var se=Y.thm[0].s[te][ae],G=Y.thm[1].s[te][ae];Y.thm[0].s[te][ae]+=G*U,Y.thm[1].s[te][ae]+=se*U}}}function ne(F){for(var U=0;U<ve.SBMAX_l;U++)if(!(F.thm[0].l[U]>1.58*F.thm[1].l[U]||F.thm[1].l[U]>1.58*F.thm[0].l[U])){var Y=F.mld_l[U]*F.en[3].l[U],te=Math.max(F.thm[2].l[U],Math.min(F.thm[3].l[U],Y));Y=F.mld_l[U]*F.en[2].l[U];var se=Math.max(F.thm[3].l[U],Math.min(F.thm[2].l[U],Y));F.thm[2].l[U]=te,F.thm[3].l[U]=se}for(var U=0;U<ve.SBMAX_s;U++)for(var G=0;G<3;G++)if(!(F.thm[0].s[U][G]>1.58*F.thm[1].s[U][G]||F.thm[1].s[U][G]>1.58*F.thm[0].s[U][G])){var Y=F.mld_s[U]*F.en[3].s[U][G],te=Math.max(F.thm[2].s[U][G],Math.min(F.thm[3].s[U][G],Y));Y=F.mld_s[U]*F.en[2].s[U][G];var se=Math.max(F.thm[3].s[U][G],Math.min(F.thm[2].s[U][G],Y));F.thm[2].s[U][G]=te,F.thm[3].s[U][G]=se}}function Q(F,U,Y){var te=U,se=Math.pow(10,Y);U*=2,te*=2;for(var G=0;G<ve.SBMAX_l;G++){var ae,ue,oe,ye;if(ye=F.ATH.cb_l[F.bm_l[G]]*se,ae=Math.min(Math.max(F.thm[0].l[G],ye),Math.max(F.thm[1].l[G],ye)),ue=Math.max(F.thm[2].l[G],ye),oe=Math.max(F.thm[3].l[G],ye),ae*U<ue+oe){var de=ae*te/(ue+oe);ue*=de,oe*=de}F.thm[2].l[G]=Math.min(ue,F.thm[2].l[G]),F.thm[3].l[G]=Math.min(oe,F.thm[3].l[G])}se*=ve.BLKSIZE_s/ve.BLKSIZE;for(var G=0;G<ve.SBMAX_s;G++)for(var be=0;be<3;be++){var ae,ue,oe,ye;if(ye=F.ATH.cb_s[F.bm_s[G]]*se,ae=Math.min(Math.max(F.thm[0].s[G][be],ye),Math.max(F.thm[1].s[G][be],ye)),ue=Math.max(F.thm[2].s[G][be],ye),oe=Math.max(F.thm[3].s[G][be],ye),ae*U<ue+oe){var de=ae*U/(ue+oe);ue*=de,oe*=de}F.thm[2].s[G][be]=Math.min(F.thm[2].s[G][be],ue),F.thm[3].s[G][be]=Math.min(F.thm[3].s[G][be],oe)}}function ce(F,U,Y,te,se){var G,ae,ue=0,oe=0;for(G=ae=0;G<ve.SBMAX_s;++ae,++G){for(var ye=F.bo_s[G],de=F.npart_s,be=ye<de?ye:de;ae<be;)it(U[ae]>=0),it(Y[ae]>=0),ue+=U[ae],oe+=Y[ae],ae++;if(F.en[te].s[G][se]=ue,F.thm[te].s[G][se]=oe,ae>=de){++G;break}it(U[ae]>=0),it(Y[ae]>=0);{var Le=F.PSY.bo_s_weight[G],We=1-Le;ue=Le*U[ae],oe=Le*Y[ae],F.en[te].s[G][se]+=ue,F.thm[te].s[G][se]+=oe,ue=We*U[ae],oe=We*Y[ae]}}for(;G<ve.SBMAX_s;++G)F.en[te].s[G][se]=0,F.thm[te].s[G][se]=0}function J(F,U,Y,te){var se,G,ae=0,ue=0;for(se=G=0;se<ve.SBMAX_l;++G,++se){for(var oe=F.bo_l[se],ye=F.npart_l,de=oe<ye?oe:ye;G<de;)it(U[G]>=0),it(Y[G]>=0),ae+=U[G],ue+=Y[G],G++;if(F.en[te].l[se]=ae,F.thm[te].l[se]=ue,G>=ye){++se;break}it(U[G]>=0),it(Y[G]>=0);{var be=F.PSY.bo_l_weight[se],Le=1-be;ae=be*U[G],ue=be*Y[G],F.en[te].l[se]+=ae,F.thm[te].l[se]+=ue,ae=Le*U[G],ue=Le*Y[G]}}for(;se<ve.SBMAX_l;++se)F.en[te].l[se]=0,F.thm[te].l[se]=0}function L(F,U,Y,te,se,G){var ae=F.internal_flags,ue,oe;for(oe=ue=0;oe<ae.npart_s;++oe){for(var ye=0,de=ae.numlines_s[oe],be=0;be<de;++be,++ue){var Le=U[G][ue];ye+=Le}Y[oe]=ye}for(it(oe==ae.npart_s),ue=oe=0;oe<ae.npart_s;oe++){var We=ae.s3ind_s[oe][0],Ce=ae.s3_ss[ue++]*Y[We];for(++We;We<=ae.s3ind_s[oe][1];)Ce+=ae.s3_ss[ue]*Y[We],++ue,++We;{var Ke=i*ae.nb_s1[se][oe];te[oe]=Math.min(Ce,Ke)}if(ae.blocktype_old[se&1]==ve.SHORT_TYPE){var Ke=o*ae.nb_s2[se][oe],ge=te[oe];te[oe]=Math.min(Ke,ge)}ae.nb_s2[se][oe]=ae.nb_s1[se][oe],ae.nb_s1[se][oe]=Ce,it(te[oe]>=0)}for(;oe<=ve.CBANDS;++oe)Y[oe]=0,te[oe]=0}function C(F,U,Y,te){var se=F.internal_flags;F.short_blocks==Wo.short_block_coupled&&!(U[0]!=0&&U[1]!=0)&&(U[0]=U[1]=0);for(var G=0;G<se.channels_out;G++)te[G]=ve.NORM_TYPE,F.short_blocks==Wo.short_block_dispensed&&(U[G]=1),F.short_blocks==Wo.short_block_forced&&(U[G]=0),U[G]!=0?(it(se.blocktype_old[G]!=ve.START_TYPE),se.blocktype_old[G]==ve.SHORT_TYPE&&(te[G]=ve.STOP_TYPE)):(te[G]=ve.SHORT_TYPE,se.blocktype_old[G]==ve.NORM_TYPE&&(se.blocktype_old[G]=ve.START_TYPE),se.blocktype_old[G]==ve.STOP_TYPE&&(se.blocktype_old[G]=ve.SHORT_TYPE)),Y[G]=se.blocktype_old[G],se.blocktype_old[G]=te[G]}function I(F,U,Y){return Y>=1?F:Y<=0?U:U>0?Math.pow(F/U,Y)*U:0}var B=[11.8,13.6,17.2,32,46.5,51.3,57.5,67.1,71.5,84.6,97.6,130];function z(F,U){for(var Y=309.07,te=0;te<ve.SBMAX_s-1;te++)for(var se=0;se<3;se++){var G=F.thm.s[te][se];if(G>0){var ae=G*U,ue=F.en.s[te][se];ue>ae&&(ue>ae*1e10?Y+=B[te]*(10*t):Y+=B[te]*Xn.FAST_LOG10(ue/ae))}}return Y}var ie=[6.8,5.8,5.8,6.4,6.5,9.9,12.1,14.4,15,18.9,21.6,26.9,34.2,40.2,46.8,56.5,60.7,73.9,85.7,93.4,126.1];function Z(F,U){for(var Y=281.0575,te=0;te<ve.SBMAX_l-1;te++){var se=F.thm.l[te];if(se>0){var G=se*U,ae=F.en.l[te];ae>G&&(ae>G*1e10?Y+=ie[te]*(10*t):Y+=ie[te]*Xn.FAST_LOG10(ae/G))}}return Y}function q(F,U,Y,te,se){var G,ae;for(G=ae=0;G<F.npart_l;++G){var ue=0,oe=0,ye;for(ye=0;ye<F.numlines_l[G];++ye,++ae){var de=U[ae];ue+=de,oe<de&&(oe=de)}Y[G]=ue,te[G]=oe,se[G]=ue*F.rnumlines_l[G],it(F.rnumlines_l[G]>=0),it(Y[G]>=0),it(te[G]>=0),it(se[G]>=0)}}function ee(F,U,Y,te){var se=b.length-1,G=0,ae=Y[G]+Y[G+1];if(ae>0){var ue=U[G];ue<U[G+1]&&(ue=U[G+1]),it(F.numlines_l[G]+F.numlines_l[G+1]-1>0),ae=20*(ue*2-ae)/(ae*(F.numlines_l[G]+F.numlines_l[G+1]-1));var oe=0|ae;oe>se&&(oe=se),te[G]=oe}else te[G]=0;for(G=1;G<F.npart_l-1;G++)if(ae=Y[G-1]+Y[G]+Y[G+1],ae>0){var ue=U[G-1];ue<U[G]&&(ue=U[G]),ue<U[G+1]&&(ue=U[G+1]),it(F.numlines_l[G-1]+F.numlines_l[G]+F.numlines_l[G+1]-1>0),ae=20*(ue*3-ae)/(ae*(F.numlines_l[G-1]+F.numlines_l[G]+F.numlines_l[G+1]-1));var oe=0|ae;oe>se&&(oe=se),te[G]=oe}else te[G]=0;if(it(G==F.npart_l-1),ae=Y[G-1]+Y[G],ae>0){var ue=U[G-1];ue<U[G]&&(ue=U[G]),it(F.numlines_l[G-1]+F.numlines_l[G]-1>0),ae=20*(ue*2-ae)/(ae*(F.numlines_l[G-1]+F.numlines_l[G]-1));var oe=0|ae;oe>se&&(oe=se),te[G]=oe}else te[G]=0;it(G==F.npart_l-1)}var le=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];this.L3psycho_anal_ns=function(F,U,Y,te,se,G,ae,ue,oe,ye){var de=F.internal_flags,be=_r([2,ve.BLKSIZE]),Le=_r([2,3,ve.BLKSIZE_s]),We=Jt(ve.CBANDS+1),Ce=Jt(ve.CBANDS+1),Ke=Jt(ve.CBANDS+2),ge=qi(2),ze=qi(2),Xe,xe,je,ke,Qe,xt,Fe,nt,ot=_r([2,576]),Rt,Rn=qi(ve.CBANDS+2),Dt=qi(ve.CBANDS+2);for(zL.fill(Dt,0),Xe=de.channels_out,F.mode==n.JOINT_STEREO&&(Xe=4),F.VBR==Ko.vbr_off?Rt=de.ResvMax==0?0:de.ResvSize/de.ResvMax*.5:F.VBR==Ko.vbr_rh||F.VBR==Ko.vbr_mtrh||F.VBR==Ko.vbr_mt?Rt=.6:Rt=1,xe=0;xe<de.channels_out;xe++){var kt=U[xe],Ft=Y+576-350-_+192;for(ke=0;ke<576;ke++){var kn,Cn;for(kn=kt[Ft+ke+10],Cn=0,Qe=0;Qe<(_-1)/2-1;Qe+=2)kn+=le[Qe]*(kt[Ft+ke+Qe]+kt[Ft+ke+_-Qe]),Cn+=le[Qe+1]*(kt[Ft+ke+Qe+1]+kt[Ft+ke+_-Qe-1]);ot[xe][ke]=kn+Cn}se[te][xe].en.assign(de.en[xe]),se[te][xe].thm.assign(de.thm[xe]),Xe>2&&(G[te][xe].en.assign(de.en[xe+2]),G[te][xe].thm.assign(de.thm[xe+2]))}for(xe=0;xe<Xe;xe++){var jn,zn,on=Jt(12),ar=[0,0,0,0],Ps=Jt(12),Os=1,Ga,Do=Jt(ve.CBANDS),Ns=Jt(ve.CBANDS),Tt=[0,0,0,0],Lo=Jt(ve.HBLKSIZE),Fc=_r([3,ve.HBLKSIZE_s]);for(it(de.npart_s<=ve.CBANDS),it(de.npart_l<=ve.CBANDS),ke=0;ke<3;ke++)on[ke]=de.nsPsy.last_en_subshort[xe][ke+6],it(de.nsPsy.last_en_subshort[xe][ke+4]>0),Ps[ke]=on[ke]/de.nsPsy.last_en_subshort[xe][ke+4],ar[0]+=on[ke];if(xe==2)for(ke=0;ke<576;ke++){var Vo,Bo;Vo=ot[0][ke],Bo=ot[1][ke],ot[0][ke]=Vo+Bo,ot[1][ke]=Vo-Bo}{var Ya=ot[xe&1],ls=0;for(ke=0;ke<9;ke++){for(var Xa=ls+64,Xt=1;ls<Xa;ls++)Xt<Math.abs(Ya[ls])&&(Xt=Math.abs(Ya[ls]));de.nsPsy.last_en_subshort[xe][ke]=on[ke+3]=Xt,ar[1+ke/3]+=Xt,Xt>on[ke+3-2]?(it(on[ke+3-2]>0),Xt=Xt/on[ke+3-2]):on[ke+3-2]>Xt*10?Xt=on[ke+3-2]/(Xt*10):Xt=0,Ps[ke+3]=Xt}}if(F.analysis){var Fo=Ps[0];for(ke=1;ke<12;ke++)Fo<Ps[ke]&&(Fo=Ps[ke]);de.pinfo.ers[te][xe]=de.pinfo.ers_save[xe],de.pinfo.ers_save[xe]=Fo}for(Ga=xe==3?de.nsPsy.attackthre_s:de.nsPsy.attackthre,ke=0;ke<12;ke++)Tt[ke/3]==0&&Ps[ke]>Ga&&(Tt[ke/3]=ke%3+1);for(ke=1;ke<4;ke++){var Qa;ar[ke-1]>ar[ke]?(it(ar[ke]>0),Qa=ar[ke-1]/ar[ke]):(it(ar[ke-1]>0),Qa=ar[ke]/ar[ke-1]),Qa<1.7&&(Tt[ke]=0,ke==1&&(Tt[0]=0))}for(Tt[0]!=0&&de.nsPsy.lastAttacks[xe]!=0&&(Tt[0]=0),(de.nsPsy.lastAttacks[xe]==3||Tt[0]+Tt[1]+Tt[2]+Tt[3]!=0)&&(Os=0,Tt[1]!=0&&Tt[0]!=0&&(Tt[1]=0),Tt[2]!=0&&Tt[1]!=0&&(Tt[2]=0),Tt[3]!=0&&Tt[2]!=0&&(Tt[3]=0)),xe<2?ze[xe]=Os:Os==0&&(ze[0]=ze[1]=0),oe[xe]=de.tot_ener[xe],zn=Le,jn=be,x(F,Lo,Fc,jn,xe&1,zn,xe&1,te,xe,U,Y),q(de,Lo,We,Do,Ns),ee(de,Do,Ns,Rn),nt=0;nt<3;nt++){var Ja,_n;for(L(F,Fc,Ce,Ke,xe,nt),ce(de,Ce,Ke,xe,nt),Fe=0;Fe<ve.SBMAX_s;Fe++){if(_n=de.thm[xe].s[Fe][nt],_n*=u,Tt[nt]>=2||Tt[nt+1]==1){var Ds=nt!=0?nt-1:2,Xt=I(de.thm[xe].s[Fe][Ds],_n,f*Rt);_n=Math.min(_n,Xt)}if(Tt[nt]==1){var Ds=nt!=0?nt-1:2,Xt=I(de.thm[xe].s[Fe][Ds],_n,d*Rt);_n=Math.min(_n,Xt)}else if(nt!=0&&Tt[nt-1]==3||nt==0&&de.nsPsy.lastAttacks[xe]==3){var Ds=nt!=2?nt+1:0,Xt=I(de.thm[xe].s[Fe][Ds],_n,d*Rt);_n=Math.min(_n,Xt)}Ja=on[nt*3+3]+on[nt*3+4]+on[nt*3+5],on[nt*3+5]*6<Ja&&(_n*=.5,on[nt*3+4]*6<Ja&&(_n*=.5)),de.thm[xe].s[Fe][nt]=_n}}for(de.nsPsy.lastAttacks[xe]=Tt[2],xt=0,je=0;je<de.npart_l;je++){for(var cs=de.s3ind[je][0],Ir=We[cs]*b[Rn[cs]],yn=de.s3_ll[xt++]*Ir;++cs<=de.s3ind[je][1];)Ir=We[cs]*b[Rn[cs]],yn=y(yn,de.s3_ll[xt++]*Ir,cs,cs-je,de);yn*=.158489319246111,de.blocktype_old[xe&1]==ve.SHORT_TYPE?Ke[je]=yn:Ke[je]=I(Math.min(yn,Math.min(r*de.nb_1[xe][je],s*de.nb_2[xe][je])),yn,Rt),de.nb_2[xe][je]=de.nb_1[xe][je],de.nb_1[xe][je]=yn}for(;je<=ve.CBANDS;++je)We[je]=0,Ke[je]=0;J(de,We,Ke,xe)}if((F.mode==n.STEREO||F.mode==n.JOINT_STEREO)&&F.interChRatio>0&&X(F,F.interChRatio),F.mode==n.JOINT_STEREO){var Ls;ne(de),Ls=F.msfix,Math.abs(Ls)>0&&Q(de,Ls,F.ATHlower*de.ATH.adjust)}for(C(F,ze,ye,ge),xe=0;xe<Xe;xe++){var Fr,Vs=0,It,us;xe>1?(Fr=ue,Vs=-2,It=ve.NORM_TYPE,(ye[0]==ve.SHORT_TYPE||ye[1]==ve.SHORT_TYPE)&&(It=ve.SHORT_TYPE),us=G[te][xe-2]):(Fr=ae,Vs=0,It=ye[xe],us=se[te][xe]),It==ve.SHORT_TYPE?Fr[Vs+xe]=z(us,de.masking_lower):Fr[Vs+xe]=Z(us,de.masking_lower),F.analysis&&(de.pinfo.pe[te][xe]=Fr[Vs+xe])}return 0};function Ee(F,U,Y,te,se,G,ae,ue){var oe=F.internal_flags;if(te<2)e.fft_long(oe,ae[ue],te,U,Y);else if(te==2)for(var ye=ve.BLKSIZE-1;ye>=0;--ye){var de=ae[ue+0][ye],be=ae[ue+1][ye];ae[ue+0][ye]=(de+be)*Xn.SQRT2*.5,ae[ue+1][ye]=(de-be)*Xn.SQRT2*.5}G[0]=ae[ue+0][0],G[0]*=G[0];for(var ye=ve.BLKSIZE/2-1;ye>=0;--ye){var Le=ae[ue+0][ve.BLKSIZE/2-ye],We=ae[ue+0][ve.BLKSIZE/2+ye];G[ve.BLKSIZE/2-ye]=(Le*Le+We*We)*.5}{for(var Ce=0,ye=11;ye<ve.HBLKSIZE;ye++)Ce+=G[ye];oe.tot_ener[te]=Ce}if(F.analysis){for(var ye=0;ye<ve.HBLKSIZE;ye++)oe.pinfo.energy[se][te][ye]=oe.pinfo.energy_save[te][ye],oe.pinfo.energy_save[te][ye]=G[ye];oe.pinfo.pe[se][te]=oe.pe[te]}}function Oe(F,U,Y,te,se,G,ae,ue){var oe=F.internal_flags;if(se==0&&te<2&&e.fft_short(oe,ae[ue],te,U,Y),te==2)for(var ye=ve.BLKSIZE_s-1;ye>=0;--ye){var de=ae[ue+0][se][ye],be=ae[ue+1][se][ye];ae[ue+0][se][ye]=(de+be)*Xn.SQRT2*.5,ae[ue+1][se][ye]=(de-be)*Xn.SQRT2*.5}G[se][0]=ae[ue+0][se][0],G[se][0]*=G[se][0];for(var ye=ve.BLKSIZE_s/2-1;ye>=0;--ye){var Le=ae[ue+0][se][ve.BLKSIZE_s/2-ye],We=ae[ue+0][se][ve.BLKSIZE_s/2+ye];G[se][ve.BLKSIZE_s/2-ye]=(Le*Le+We*We)*.5}}function j(F,U,Y,te){var se=F.internal_flags;F.athaa_loudapprox==2&&Y<2&&(se.loudness_sq[U][Y]=se.loudness_sq_save[Y],se.loudness_sq_save[Y]=O(te,se))}var K=[-865163e-23*2,-.00851586*2,-674764e-23*2,.0209036*2,-336639e-22*2,-.0438162*2,-154175e-22*2,.0931738*2,-552212e-22*2,-.313819*2];function re(F,U,Y,te,se,G,ae,ue,oe,ye){for(var de=_r([2,576]),be=F.internal_flags,Le=be.channels_out,We=F.mode==n.JOINT_STEREO?4:Le,Ce=0;Ce<Le;Ce++){firbuf=U[Ce];for(var Ke=Y+576-350-_+192,ge=0;ge<576;ge++){var ze,Xe;ze=firbuf[Ke+ge+10],Xe=0;for(var xe=0;xe<(_-1)/2-1;xe+=2)ze+=K[xe]*(firbuf[Ke+ge+xe]+firbuf[Ke+ge+_-xe]),Xe+=K[xe+1]*(firbuf[Ke+ge+xe+1]+firbuf[Ke+ge+_-xe-1]);de[Ce][ge]=ze+Xe}se[te][Ce].en.assign(be.en[Ce]),se[te][Ce].thm.assign(be.thm[Ce]),We>2&&(G[te][Ce].en.assign(be.en[Ce+2]),G[te][Ce].thm.assign(be.thm[Ce+2]))}for(var Ce=0;Ce<We;Ce++){var je=Jt(12),ke=Jt(12),Qe=[0,0,0,0],xt=de[Ce&1],Fe=0,nt=Ce==3?be.nsPsy.attackthre_s:be.nsPsy.attackthre,ot=1;if(Ce==2)for(var ge=0,xe=576;xe>0;++ge,--xe){var Rt=de[0][ge],Rn=de[1][ge];de[0][ge]=Rt+Rn,de[1][ge]=Rt-Rn}for(var ge=0;ge<3;ge++)ke[ge]=be.nsPsy.last_en_subshort[Ce][ge+6],it(be.nsPsy.last_en_subshort[Ce][ge+4]>0),je[ge]=ke[ge]/be.nsPsy.last_en_subshort[Ce][ge+4],Qe[0]+=ke[ge];for(var ge=0;ge<9;ge++){for(var Dt=Fe+64,kt=1;Fe<Dt;Fe++)kt<Math.abs(xt[Fe])&&(kt=Math.abs(xt[Fe]));be.nsPsy.last_en_subshort[Ce][ge]=ke[ge+3]=kt,Qe[1+ge/3]+=kt,kt>ke[ge+3-2]?(it(ke[ge+3-2]>0),kt=kt/ke[ge+3-2]):ke[ge+3-2]>kt*10?kt=ke[ge+3-2]/(kt*10):kt=0,je[ge+3]=kt}for(var ge=0;ge<3;++ge){var Ft=ke[ge*3+3]+ke[ge*3+4]+ke[ge*3+5],kn=1;ke[ge*3+5]*6<Ft&&(kn*=.5,ke[ge*3+4]*6<Ft&&(kn*=.5)),ue[Ce][ge]=kn}if(F.analysis){for(var Cn=je[0],ge=1;ge<12;ge++)Cn<je[ge]&&(Cn=je[ge]);be.pinfo.ers[te][Ce]=be.pinfo.ers_save[Ce],be.pinfo.ers_save[Ce]=Cn}for(var ge=0;ge<12;ge++)oe[Ce][ge/3]==0&&je[ge]>nt&&(oe[Ce][ge/3]=ge%3+1);for(var ge=1;ge<4;ge++){var jn=Qe[ge-1],zn=Qe[ge],on=Math.max(jn,zn);on<4e4&&jn<1.7*zn&&zn<1.7*jn&&(ge==1&&oe[Ce][0]<=oe[Ce][ge]&&(oe[Ce][0]=0),oe[Ce][ge]=0)}oe[Ce][0]<=be.nsPsy.lastAttacks[Ce]&&(oe[Ce][0]=0),(be.nsPsy.lastAttacks[Ce]==3||oe[Ce][0]+oe[Ce][1]+oe[Ce][2]+oe[Ce][3]!=0)&&(ot=0,oe[Ce][1]!=0&&oe[Ce][0]!=0&&(oe[Ce][1]=0),oe[Ce][2]!=0&&oe[Ce][1]!=0&&(oe[Ce][2]=0),oe[Ce][3]!=0&&oe[Ce][2]!=0&&(oe[Ce][3]=0)),Ce<2?ye[Ce]=ot:ot==0&&(ye[0]=ye[1]=0),ae[Ce]=be.tot_ener[Ce]}}function he(F,U,Y){if(Y==0)for(var te=0;te<F.npart_s;te++)F.nb_s2[U][te]=F.nb_s1[U][te],F.nb_s1[U][te]=0}function _e(F,U){for(var Y=0;Y<F.npart_l;Y++)F.nb_2[U][Y]=F.nb_1[U][Y],F.nb_1[U][Y]=0}function De(F,U,Y,te){var se=b.length-1,G=0,ae=Y[G]+Y[G+1];if(ae>0){var ue=U[G];ue<U[G+1]&&(ue=U[G+1]),it(F.numlines_s[G]+F.numlines_s[G+1]-1>0),ae=20*(ue*2-ae)/(ae*(F.numlines_s[G]+F.numlines_s[G+1]-1));var oe=0|ae;oe>se&&(oe=se),te[G]=oe}else te[G]=0;for(G=1;G<F.npart_s-1;G++)if(ae=Y[G-1]+Y[G]+Y[G+1],it(G+1<F.npart_s),ae>0){var ue=U[G-1];ue<U[G]&&(ue=U[G]),ue<U[G+1]&&(ue=U[G+1]),it(F.numlines_s[G-1]+F.numlines_s[G]+F.numlines_s[G+1]-1>0),ae=20*(ue*3-ae)/(ae*(F.numlines_s[G-1]+F.numlines_s[G]+F.numlines_s[G+1]-1));var oe=0|ae;oe>se&&(oe=se),te[G]=oe}else te[G]=0;if(it(G==F.npart_s-1),ae=Y[G-1]+Y[G],ae>0){var ue=U[G-1];ue<U[G]&&(ue=U[G]),it(F.numlines_s[G-1]+F.numlines_s[G]-1>0),ae=20*(ue*2-ae)/(ae*(F.numlines_s[G-1]+F.numlines_s[G]-1));var oe=0|ae;oe>se&&(oe=se),te[G]=oe}else te[G]=0;it(G==F.npart_s-1)}function v(F,U,Y,te,se,G){var ae=F.internal_flags,ue=new float[ve.CBANDS],oe=Jt(ve.CBANDS),ye,de,be,Le=new int[ve.CBANDS];for(be=de=0;be<ae.npart_s;++be){var We=0,Ce=0,Ke=ae.numlines_s[be];for(ye=0;ye<Ke;++ye,++de){var ge=U[G][de];We+=ge,Ce<ge&&(Ce=ge)}Y[be]=We,ue[be]=Ce,oe[be]=We/Ke,it(oe[be]>=0)}for(it(be==ae.npart_s);be<ve.CBANDS;++be)ue[be]=0,oe[be]=0;for(De(ae,ue,oe,Le),de=be=0;be<ae.npart_s;be++){var ze=ae.s3ind_s[be][0],Xe=ae.s3ind_s[be][1],xe,je,ke,Qe,xt;for(xe=Le[ze],je=1,Qe=ae.s3_ss[de]*Y[ze]*b[Le[ze]],++de,++ze;ze<=Xe;)xe+=Le[ze],je+=1,ke=ae.s3_ss[de]*Y[ze]*b[Le[ze]],Qe=W(Qe,ke,ze-be),++de,++ze;xe=(1+2*xe)/(2*je),xt=b[xe]*.5,Qe*=xt,te[be]=Qe,ae.nb_s2[se][be]=ae.nb_s1[se][be],ae.nb_s1[se][be]=Qe,ke=ue[be],ke*=ae.minval_s[be],ke*=xt,te[be]>ke&&(te[be]=ke),ae.masking_lower>1&&(te[be]*=ae.masking_lower),te[be]>Y[be]&&(te[be]=Y[be]),ae.masking_lower<1&&(te[be]*=ae.masking_lower),it(te[be]>=0)}for(;be<ve.CBANDS;++be)Y[be]=0,te[be]=0}function P(F,U,Y,te,se){var G=Jt(ve.CBANDS),ae=Jt(ve.CBANDS),ue=qi(ve.CBANDS+2),oe;q(F,U,Y,G,ae),ee(F,G,ae,ue);var ye=0;for(oe=0;oe<F.npart_l;oe++){var de,be,Le,We,Ce=F.s3ind[oe][0],Ke=F.s3ind[oe][1],ge=0,ze=0;for(ge=ue[Ce],ze+=1,be=F.s3_ll[ye]*Y[Ce]*b[ue[Ce]],++ye,++Ce;Ce<=Ke;)ge+=ue[Ce],ze+=1,de=F.s3_ll[ye]*Y[Ce]*b[ue[Ce]],We=W(be,de,Ce-oe),be=We,++ye,++Ce;if(ge=(1+2*ge)/(2*ze),Le=b[ge]*.5,be*=Le,F.blocktype_old[se&1]==ve.SHORT_TYPE){var Xe=r*F.nb_1[se][oe];Xe>0?te[oe]=Math.min(be,Xe):te[oe]=Math.min(be,Y[oe]*d)}else{var xe=s*F.nb_2[se][oe],je=r*F.nb_1[se][oe],Xe;xe<=0&&(xe=be),je<=0&&(je=be),F.blocktype_old[se&1]==ve.NORM_TYPE?Xe=Math.min(je,xe):Xe=je,te[oe]=Math.min(be,Xe)}F.nb_2[se][oe]=F.nb_1[se][oe],F.nb_1[se][oe]=be,de=G[oe],de*=F.minval_l[oe],de*=Le,te[oe]>de&&(te[oe]=de),F.masking_lower>1&&(te[oe]*=F.masking_lower),te[oe]>Y[oe]&&(te[oe]=Y[oe]),F.masking_lower<1&&(te[oe]*=F.masking_lower),it(te[oe]>=0)}for(;oe<ve.CBANDS;++oe)Y[oe]=0,te[oe]=0}function me(F,U){var Y=F.internal_flags;F.short_blocks==Wo.short_block_coupled&&!(U[0]!=0&&U[1]!=0)&&(U[0]=U[1]=0);for(var te=0;te<Y.channels_out;te++)F.short_blocks==Wo.short_block_dispensed&&(U[te]=1),F.short_blocks==Wo.short_block_forced&&(U[te]=0)}function fe(F,U,Y){for(var te=F.internal_flags,se=0;se<te.channels_out;se++){var G=ve.NORM_TYPE;U[se]!=0?(it(te.blocktype_old[se]!=ve.START_TYPE),te.blocktype_old[se]==ve.SHORT_TYPE&&(G=ve.STOP_TYPE)):(G=ve.SHORT_TYPE,te.blocktype_old[se]==ve.NORM_TYPE&&(te.blocktype_old[se]=ve.START_TYPE),te.blocktype_old[se]==ve.STOP_TYPE&&(te.blocktype_old[se]=ve.SHORT_TYPE)),Y[se]=te.blocktype_old[se],te.blocktype_old[se]=G}}function Se(F,U,Y,te,se,G,ae){for(var ue=G*2,oe=G>0?Math.pow(10,se):1,ye,de,be=0;be<ae;++be){var Le=F[2][be],We=F[3][be],Ce=U[0][be],Ke=U[1][be],ge=U[2][be],ze=U[3][be];if(Ce<=1.58*Ke&&Ke<=1.58*Ce){var Xe=Y[be]*We,xe=Y[be]*Le;de=Math.max(ge,Math.min(ze,Xe)),ye=Math.max(ze,Math.min(ge,xe))}else de=ge,ye=ze;if(G>0){var je,ke,Qe=te[be]*oe;if(je=Math.min(Math.max(Ce,Qe),Math.max(Ke,Qe)),ge=Math.max(de,Qe),ze=Math.max(ye,Qe),ke=ge+ze,ke>0&&je*ue<ke){var xt=je*ue/ke;ge*=xt,ze*=xt}de=Math.min(ge,de),ye=Math.min(ze,ye)}de>Le&&(de=Le),ye>We&&(ye=We),U[2][be]=de,U[3][be]=ye}}this.L3psycho_anal_vbr=function(F,U,Y,te,se,G,ae,ue,oe,ye){var de=F.internal_flags,be,Le,We=Jt(ve.HBLKSIZE),Ce=_r([3,ve.HBLKSIZE_s]),Ke=_r([2,ve.BLKSIZE]),ge=_r([2,3,ve.BLKSIZE_s]),ze=_r([4,ve.CBANDS]),Xe=_r([4,ve.CBANDS]),xe=_r([4,3]),je=.6,ke=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],Qe=qi(2),xt=F.mode==n.JOINT_STEREO?4:de.channels_out;re(F,U,Y,te,se,G,oe,xe,ke,Qe),me(F,Qe);{for(var Fe=0;Fe<xt;Fe++){var nt=Fe&1;be=Ke,Ee(F,U,Y,Fe,te,We,be,nt),j(F,te,Fe,We),Qe[nt]!=0?P(de,We,ze[Fe],Xe[Fe],Fe):_e(de,Fe)}Qe[0]+Qe[1]==2&&F.mode==n.JOINT_STEREO&&Se(ze,Xe,de.mld_cb_l,de.ATH.cb_l,F.ATHlower*de.ATH.adjust,F.msfix,de.npart_l);for(var Fe=0;Fe<xt;Fe++){var nt=Fe&1;Qe[nt]!=0&&J(de,ze[Fe],Xe[Fe],Fe)}}{for(var ot=0;ot<3;ot++){for(var Fe=0;Fe<xt;++Fe){var nt=Fe&1;Qe[nt]!=0?he(de,Fe,ot):(Le=ge,Oe(F,U,Y,Fe,ot,Ce,Le,nt),v(F,Ce,ze[Fe],Xe[Fe],Fe,ot))}Qe[0]+Qe[1]==0&&F.mode==n.JOINT_STEREO&&Se(ze,Xe,de.mld_cb_s,de.ATH.cb_s,F.ATHlower*de.ATH.adjust,F.msfix,de.npart_s);for(var Fe=0;Fe<xt;++Fe){var nt=Fe&1;Qe[nt]==0&&ce(de,ze[Fe],Xe[Fe],Fe,ot)}}for(var Fe=0;Fe<xt;Fe++){var nt=Fe&1;if(Qe[nt]==0)for(var Rt=0;Rt<ve.SBMAX_s;Rt++){for(var Rn=Jt(3),ot=0;ot<3;ot++){var Dt=de.thm[Fe].s[Rt][ot];if(Dt*=u,ke[Fe][ot]>=2||ke[Fe][ot+1]==1){var kt=ot!=0?ot-1:2,Ft=I(de.thm[Fe].s[Rt][kt],Dt,f*je);Dt=Math.min(Dt,Ft)}else if(ke[Fe][ot]==1){var kt=ot!=0?ot-1:2,Ft=I(de.thm[Fe].s[Rt][kt],Dt,d*je);Dt=Math.min(Dt,Ft)}else if(ot!=0&&ke[Fe][ot-1]==3||ot==0&&de.nsPsy.lastAttacks[Fe]==3){var kt=ot!=2?ot+1:0,Ft=I(de.thm[Fe].s[Rt][kt],Dt,d*je);Dt=Math.min(Dt,Ft)}Dt*=xe[Fe][ot],Rn[ot]=Dt}for(var ot=0;ot<3;ot++)de.thm[Fe].s[Rt][ot]=Rn[ot]}}}for(var Fe=0;Fe<xt;Fe++)de.nsPsy.lastAttacks[Fe]=ke[Fe][2];fe(F,Qe,ye);for(var Fe=0;Fe<xt;Fe++){var kn,Cn,jn,zn;Fe>1?(kn=ue,Cn=-2,jn=ve.NORM_TYPE,(ye[0]==ve.SHORT_TYPE||ye[1]==ve.SHORT_TYPE)&&(jn=ve.SHORT_TYPE),zn=G[te][Fe-2]):(kn=ae,Cn=0,jn=ye[Fe],zn=se[te][Fe]),jn==ve.SHORT_TYPE?kn[Cn+Fe]=z(zn,de.masking_lower):kn[Cn+Fe]=Z(zn,de.masking_lower),F.analysis&&(de.pinfo.pe[te][Fe]=kn[Cn+Fe])}return 0};function Re(F,U){var Y=F,te;return Y>=0?te=-Y*27:te=Y*U,te<=-72?0:Math.exp(te*D)}function Ae(F){var U=0,Y=0;{var te=0,se,G;for(te=0;Re(te,F)>1e-20;te-=1);for(se=te,G=0;Math.abs(G-se)>1e-12;)te=(G+se)/2,Re(te,F)>0?G=te:se=te;U=se}{var te=0,se,G;for(te=0;Re(te,F)>1e-20;te+=1);for(se=0,G=te;Math.abs(G-se)>1e-12;)te=(G+se)/2,Re(te,F)>0?se=te:G=te;Y=G}{var ae=0,ue=1e3,oe;for(oe=0;oe<=ue;++oe){var te=U+oe*(Y-U)/ue,ye=Re(te,F);ae+=ye}{var de=(ue+1)/(ae*(Y-U));return de}}}function Te(F){var U,Y,te,se;return U=F,U>=0?U*=3:U*=1.5,U>=.5&&U<=2.5?(se=U-.5,Y=8*(se*se-2*se)):Y=0,U+=.474,te=15.811389+7.5*U-17.5*Math.sqrt(1+U*U),te<=-60?0:(U=Math.exp((Y+te)*D),U/=.6609193,U)}function Ne(F){return F<0&&(F=0),F=F*.001,13*Math.atan(.76*F)+3.5*Math.atan(F*F/(7.5*7.5))}function Ue(F,U,Y,te,se,G,ae,ue,oe,ye,de,be){var Le=Jt(ve.CBANDS+1),We=ue/(be>15?2*576:2*192),Ce=qi(ve.HBLKSIZE),Ke;ue/=oe;var ge=0,ze=0;for(Ke=0;Ke<ve.CBANDS;Ke++){var Xe,xe;for(Xe=Ne(ue*ge),Le[Ke]=ue*ge,xe=ge;Ne(ue*xe)-Xe<a&&xe<=oe/2;xe++);for(F[Ke]=xe-ge,ze=Ke+1;ge<xe;)it(ge<ve.HBLKSIZE),Ce[ge++]=Ke;if(ge>oe/2){ge=oe/2,++Ke;break}}it(Ke<ve.CBANDS),Le[Ke]=ue*ge;for(var je=0;je<be;je++){var ke,Qe,xt,Fe,nt;xt=ye[je],Fe=ye[je+1],ke=0|Math.floor(.5+de*(xt-.5)),ke<0&&(ke=0),Qe=0|Math.floor(.5+de*(Fe-.5)),Qe>oe/2&&(Qe=oe/2),Y[je]=(Ce[ke]+Ce[Qe])/2,U[je]=Ce[Qe];var ot=We*Fe;ae[je]=(ot-Le[U[je]])/(Le[U[je]+1]-Le[U[je]]),ae[je]<0?ae[je]=0:ae[je]>1&&(ae[je]=1),nt=Ne(ue*ye[je]*de),nt=Math.min(nt,15.5)/15.5,G[je]=Math.pow(10,1.25*(1-Math.cos(Math.PI*nt))-2.5)}ge=0;for(var Rt=0;Rt<ze;Rt++){var Rn=F[Rt],Xe,Dt;Xe=Ne(ue*ge),Dt=Ne(ue*(ge+Rn-1)),te[Rt]=.5*(Xe+Dt),Xe=Ne(ue*(ge-.5)),Dt=Ne(ue*(ge+Rn-.5)),se[Rt]=Dt-Xe,ge+=Rn}return ze}function Ie(F,U,Y,te,se,G){var ae=_r([ve.CBANDS,ve.CBANDS]),ue,oe=0;if(G)for(var ye=0;ye<U;ye++)for(ue=0;ue<U;ue++){var de=Te(Y[ye]-Y[ue])*te[ue];ae[ye][ue]=de*se[ye]}else for(ue=0;ue<U;ue++)for(var be=15+Math.min(21/Y[ue],12),Le=Ae(be),ye=0;ye<U;ye++){var de=Le*Re(Y[ye]-Y[ue],be)*te[ue];ae[ye][ue]=de*se[ye]}for(var ye=0;ye<U;ye++){for(ue=0;ue<U&&!(ae[ye][ue]>0);ue++);for(F[ye][0]=ue,ue=U-1;ue>0&&!(ae[ye][ue]>0);ue--);F[ye][1]=ue,oe+=F[ye][1]-F[ye][0]+1}for(var We=Jt(oe),Ce=0,ye=0;ye<U;ye++)for(ue=F[ye][0];ue<=F[ye][1];ue++)We[Ce++]=ae[ye][ue];return We}function Je(F){var U=Ne(F);return U=Math.min(U,15.5)/15.5,Math.pow(10,1.25*(1-Math.cos(Math.PI*U))-2.5)}this.psymodel_init=function(F){var U=F.internal_flags,Y,te=!0,se=13,G=24,ae=0,ue=0,oe=-8.25,ye=-4.5,de=Jt(ve.CBANDS),be=Jt(ve.CBANDS),Le=Jt(ve.CBANDS),We=F.out_samplerate;switch(F.experimentalZ){default:case 0:te=!0;break;case 1:te=!(F.VBR==Ko.vbr_mtrh||F.VBR==Ko.vbr_mt);break;case 2:te=!1;break;case 3:se=8,ae=-1.75,ue=-.0125,oe=-8.25,ye=-2.25;break}for(U.ms_ener_ratio_old=.25,U.blocktype_old[0]=U.blocktype_old[1]=ve.NORM_TYPE,Y=0;Y<4;++Y){for(var ge=0;ge<ve.CBANDS;++ge)U.nb_1[Y][ge]=1e20,U.nb_2[Y][ge]=1e20,U.nb_s1[Y][ge]=U.nb_s2[Y][ge]=1;for(var Ce=0;Ce<ve.SBMAX_l;Ce++)U.en[Y].l[Ce]=1e20,U.thm[Y].l[Ce]=1e20;for(var ge=0;ge<3;++ge){for(var Ce=0;Ce<ve.SBMAX_s;Ce++)U.en[Y].s[Ce][ge]=1e20,U.thm[Y].s[Ce][ge]=1e20;U.nsPsy.lastAttacks[Y]=0}for(var ge=0;ge<9;ge++)U.nsPsy.last_en_subshort[Y][ge]=10}for(U.loudness_sq_save[0]=U.loudness_sq_save[1]=0,U.npart_l=Ue(U.numlines_l,U.bo_l,U.bm_l,de,be,U.mld_l,U.PSY.bo_l_weight,We,ve.BLKSIZE,U.scalefac_band.l,ve.BLKSIZE/(2*576),ve.SBMAX_l),it(U.npart_l<ve.CBANDS),Y=0;Y<U.npart_l;Y++){var Ke=ae;de[Y]>=se&&(Ke=ue*(de[Y]-se)/(G-se)+ae*(G-de[Y])/(G-se)),Le[Y]=Math.pow(10,Ke/10),U.numlines_l[Y]>0?U.rnumlines_l[Y]=1/U.numlines_l[Y]:U.rnumlines_l[Y]=0}U.s3_ll=Ie(U.s3ind,U.npart_l,de,be,Le,te);var ge=0;for(Y=0;Y<U.npart_l;Y++){var ze;ze=s2.MAX_VALUE;for(var Xe=0;Xe<U.numlines_l[Y];Xe++,ge++){var xe=We*ge/(1e3*ve.BLKSIZE),je;je=this.ATHformula(xe*1e3,F)-20,je=Math.pow(10,.1*je),je*=U.numlines_l[Y],ze>je&&(ze=je)}U.ATH.cb_l[Y]=ze,ze=-20+de[Y]*20/10,ze>6&&(ze=100),ze<-15&&(ze=-15),ze-=8,U.minval_l[Y]=Math.pow(10,ze/10)*U.numlines_l[Y]}for(U.npart_s=Ue(U.numlines_s,U.bo_s,U.bm_s,de,be,U.mld_s,U.PSY.bo_s_weight,We,ve.BLKSIZE_s,U.scalefac_band.s,ve.BLKSIZE_s/(2*192),ve.SBMAX_s),it(U.npart_s<ve.CBANDS),ge=0,Y=0;Y<U.npart_s;Y++){var ze,Ke=oe;de[Y]>=se&&(Ke=ye*(de[Y]-se)/(G-se)+oe*(G-de[Y])/(G-se)),Le[Y]=Math.pow(10,Ke/10),ze=s2.MAX_VALUE;for(var Xe=0;Xe<U.numlines_s[Y];Xe++,ge++){var xe=We*ge/(1e3*ve.BLKSIZE_s),je;je=this.ATHformula(xe*1e3,F)-20,je=Math.pow(10,.1*je),je*=U.numlines_s[Y],ze>je&&(ze=je)}U.ATH.cb_s[Y]=ze,ze=-7+de[Y]*7/12,de[Y]>12&&(ze*=1+Math.log(1+ze)*3.1),de[Y]<12&&(ze*=1+Math.log(1-ze)*2.3),ze<-15&&(ze=-15),ze-=8,U.minval_s[Y]=Math.pow(10,ze/10)*U.numlines_s[Y]}U.s3_ss=Ie(U.s3ind_s,U.npart_s,de,be,Le,te),E(),e.init_fft(U),U.decay=Math.exp(-1*t/(c*We/192));{var ke;ke=m,F.exp_nspsytune&2&&(ke=1),Math.abs(F.msfix)>0&&(ke=F.msfix),F.msfix=ke;for(var Qe=0;Qe<U.npart_l;Qe++)U.s3ind[Qe][1]>U.npart_l-1&&(U.s3ind[Qe][1]=U.npart_l-1)}var xt=576*U.mode_gr/We;if(U.ATH.decay=Math.pow(10,-12/10*xt),U.ATH.adjust=.01,U.ATH.adjustLimit=1,it(U.bo_l[ve.SBMAX_l-1]<=U.npart_l),it(U.bo_s[ve.SBMAX_s-1]<=U.npart_s),F.ATHtype!=-1){var xe,Fe=F.out_samplerate/ve.BLKSIZE,nt=0;for(xe=0,Y=0;Y<ve.BLKSIZE/2;++Y)xe+=Fe,U.ATH.eql_w[Y]=1/Math.pow(10,this.ATHformula(xe,F)/10),nt+=U.ATH.eql_w[Y];for(nt=1/nt,Y=ve.BLKSIZE/2;--Y>=0;)U.ATH.eql_w[Y]*=nt}{for(var Qe=ge=0;Qe<U.npart_s;++Qe)for(Y=0;Y<U.numlines_s[Qe];++Y)++ge;for(var Qe=ge=0;Qe<U.npart_l;++Qe)for(Y=0;Y<U.numlines_l[Qe];++Y)++ge}for(ge=0,Y=0;Y<U.npart_l;Y++){var xe=We*(ge+U.numlines_l[Y]/2)/(1*ve.BLKSIZE);U.mld_cb_l[Y]=Je(xe),ge+=U.numlines_l[Y]}for(;Y<ve.CBANDS;++Y)U.mld_cb_l[Y]=1;for(ge=0,Y=0;Y<U.npart_s;Y++){var xe=We*(ge+U.numlines_s[Y]/2)/(1*ve.BLKSIZE_s);U.mld_cb_s[Y]=Je(xe),ge+=U.numlines_s[Y]}for(;Y<ve.CBANDS;++Y)U.mld_cb_s[Y]=1;return 0};function dt(F,U){F<-.3&&(F=3410),F/=1e3,F=Math.max(.1,F);var Y=3.64*Math.pow(F,-.8)-6.8*Math.exp(-.6*Math.pow(F-3.4,2))+6*Math.exp(-.15*Math.pow(F-8.7,2))+(.6+.04*U)*.001*Math.pow(F,4);return Y}this.ATHformula=function(F,U){var Y;switch(U.ATHtype){case 0:Y=dt(F,9);break;case 1:Y=dt(F,-1);break;case 2:Y=dt(F,0);break;case 3:Y=dt(F,1)+6;break;case 4:Y=dt(F,U.ATHcurve);break;default:Y=dt(F,0);break}return Y}}var KL=qL,WL=Bc;function GL(){this.class_id=0,this.num_samples=0,this.num_channels=0,this.in_samplerate=0,this.out_samplerate=0,this.scale=0,this.scale_left=0,this.scale_right=0,this.analysis=!1,this.bWriteVbrTag=!1,this.decode_only=!1,this.quality=0,this.mode=WL.STEREO,this.force_ms=!1,this.free_format=!1,this.findReplayGain=!1,this.decode_on_the_fly=!1,this.write_id3tag_automatic=!1,this.brate=0,this.compression_ratio=0,this.copyright=0,this.original=0,this.extension=0,this.emphasis=0,this.error_protection=0,this.strict_ISO=!1,this.disable_reservoir=!1,this.quant_comp=0,this.quant_comp_short=0,this.experimentalY=!1,this.experimentalZ=0,this.exp_nspsytune=0,this.preset=0,this.VBR=null,this.VBR_q_frac=0,this.VBR_q=0,this.VBR_mean_bitrate_kbps=0,this.VBR_min_bitrate_kbps=0,this.VBR_max_bitrate_kbps=0,this.VBR_hard_min=0,this.lowpassfreq=0,this.highpassfreq=0,this.lowpasswidth=0,this.highpasswidth=0,this.maskingadjust=0,this.maskingadjust_short=0,this.ATHonly=!1,this.ATHshort=!1,this.noATH=!1,this.ATHtype=0,this.ATHcurve=0,this.ATHlower=0,this.athaa_type=0,this.athaa_loudapprox=0,this.athaa_sensitivity=0,this.short_blocks=null,this.useTemporal=!1,this.interChRatio=0,this.msfix=0,this.tune=!1,this.tune_value_a=0,this.version=0,this.encoder_delay=0,this.encoder_padding=0,this.framesize=0,this.frameNum=0,this.lame_allocated_gfp=0,this.internal_flags=null}var YL=GL,XL=Hn(),ET={};ET.SFBMAX=XL.SBMAX_s*3;var Rf=ET,wT=Bt,QL=wT.new_float,Ki=wT.new_int,Pd=Rf;function JL(){this.xr=QL(576),this.l3_enc=Ki(576),this.scalefac=Ki(Pd.SFBMAX),this.xrpow_max=0,this.part2_3_length=0,this.big_values=0,this.count1=0,this.global_gain=0,this.scalefac_compress=0,this.block_type=0,this.mixed_block_flag=0,this.table_select=Ki(3),this.subblock_gain=Ki(4),this.region0_count=0,this.region1_count=0,this.preflag=0,this.scalefac_scale=0,this.count1table_select=0,this.part2_length=0,this.sfb_lmax=0,this.sfb_smin=0,this.psy_lmax=0,this.sfbmax=0,this.psymax=0,this.sfbdivide=0,this.width=Ki(Pd.SFBMAX),this.window=Ki(Pd.SFBMAX),this.count1bits=0,this.sfb_partition_table=null,this.slen=Ki(4),this.max_nonzero_coeff=0;var n=this;function e(r){return new Int32Array(r)}function t(r){return new Float32Array(r)}this.assign=function(r){n.xr=t(r.xr),n.l3_enc=e(r.l3_enc),n.scalefac=e(r.scalefac),n.xrpow_max=r.xrpow_max,n.part2_3_length=r.part2_3_length,n.big_values=r.big_values,n.count1=r.count1,n.global_gain=r.global_gain,n.scalefac_compress=r.scalefac_compress,n.block_type=r.block_type,n.mixed_block_flag=r.mixed_block_flag,n.table_select=e(r.table_select),n.subblock_gain=e(r.subblock_gain),n.region0_count=r.region0_count,n.region1_count=r.region1_count,n.preflag=r.preflag,n.scalefac_scale=r.scalefac_scale,n.count1table_select=r.count1table_select,n.part2_length=r.part2_length,n.sfb_lmax=r.sfb_lmax,n.sfb_smin=r.sfb_smin,n.psy_lmax=r.psy_lmax,n.sfbmax=r.sfbmax,n.psymax=r.psymax,n.sfbdivide=r.sfbdivide,n.width=e(r.width),n.window=e(r.window),n.count1bits=r.count1bits,n.sfb_partition_table=r.sfb_partition_table.slice(0),n.slen=e(r.slen),n.max_nonzero_coeff=r.max_nonzero_coeff}}var V0=JL,ZL=Bt,i2=ZL.new_int,eV=V0;function tV(){this.tt=[[null,null],[null,null]],this.main_data_begin=0,this.private_bits=0,this.resvDrain_pre=0,this.resvDrain_post=0,this.scfsi=[i2(4),i2(4)];for(var n=0;n<2;n++)for(var e=0;e<2;e++)this.tt[n][e]=new eV}var nV=tV,TT=Bt,du=TT.System,pu=TT.new_int,mu=Hn();function rV(n,e,t,r){this.l=pu(1+mu.SBMAX_l),this.s=pu(1+mu.SBMAX_s),this.psfb21=pu(1+mu.PSFB21),this.psfb12=pu(1+mu.PSFB12);var s=this.l,i=this.s;arguments.length==4&&(this.arrL=arguments[0],this.arrS=arguments[1],this.arr21=arguments[2],this.arr12=arguments[3],du.arraycopy(this.arrL,0,s,0,Math.min(this.arrL.length,this.l.length)),du.arraycopy(this.arrS,0,i,0,Math.min(this.arrS.length,this.s.length)),du.arraycopy(this.arr21,0,this.psfb21,0,Math.min(this.arr21.length,this.psfb21.length)),du.arraycopy(this.arr12,0,this.psfb12,0,Math.min(this.arr12.length,this.psfb12.length)))}var ST=rV,B0=Bt,Od=B0.new_float,sV=B0.new_float_n,iV=B0.new_int,o2=Hn();function oV(){this.last_en_subshort=sV([4,9]),this.lastAttacks=iV(4),this.pefirbuf=Od(19),this.longfact=Od(o2.SBMAX_l),this.shortfact=Od(o2.SBMAX_s),this.attackthre=0,this.attackthre_s=0}var aV=oV;function lV(){this.sum=0,this.seen=0,this.want=0,this.pos=0,this.size=0,this.bag=null,this.nVbrNumFrames=0,this.nBytesWritten=0,this.TotalFrameSize=0}var cV=lV,qa=Bt,uV=qa.new_byte,hV=qa.new_double,yr=qa.new_float,Wi=qa.new_float_n,kr=qa.new_int,gu=qa.new_int_n,fV=nV,dV=ST,pV=aV,mV=cV,a2=bT(),zt=Hn(),gV=Rf;Ts.MFSIZE=3*1152+zt.ENCDELAY-zt.MDCTDELAY;Ts.MAX_HEADER_BUF=256;Ts.MAX_BITS_PER_CHANNEL=4095;Ts.MAX_BITS_PER_GRANULE=7680;Ts.BPC=320;function Ts(){var n=40;this.Class_ID=0,this.lame_encode_frame_init=0,this.iteration_init_init=0,this.fill_buffer_resample_init=0,this.mfbuf=Wi([2,Ts.MFSIZE]),this.mode_gr=0,this.channels_in=0,this.channels_out=0,this.resample_ratio=0,this.mf_samples_to_encode=0,this.mf_size=0,this.VBR_min_bitrate=0,this.VBR_max_bitrate=0,this.bitrate_index=0,this.samplerate_index=0,this.mode_ext=0,this.lowpass1=0,this.lowpass2=0,this.highpass1=0,this.highpass2=0,this.noise_shaping=0,this.noise_shaping_amp=0,this.substep_shaping=0,this.psymodel=0,this.noise_shaping_stop=0,this.subblock_gain=0,this.use_best_huffman=0,this.full_outer_loop=0,this.l3_side=new fV,this.ms_ratio=yr(2),this.padding=0,this.frac_SpF=0,this.slot_lag=0,this.tag_spec=null,this.nMusicCRC=0,this.OldValue=kr(2),this.CurrentStep=kr(2),this.masking_lower=0,this.bv_scf=kr(576),this.pseudohalf=kr(gV.SFBMAX),this.sfb21_extra=!1,this.inbuf_old=new Array(2),this.blackfilt=new Array(2*Ts.BPC+1),this.itime=hV(2),this.sideinfo_len=0,this.sb_sample=Wi([2,2,18,zt.SBLIMIT]),this.amp_filter=yr(32);function e(){this.write_timing=0,this.ptr=0,this.buf=uV(n)}this.header=new Array(Ts.MAX_HEADER_BUF),this.h_ptr=0,this.w_ptr=0,this.ancillary_flag=0,this.ResvSize=0,this.ResvMax=0,this.scalefac_band=new dV,this.minval_l=yr(zt.CBANDS),this.minval_s=yr(zt.CBANDS),this.nb_1=Wi([4,zt.CBANDS]),this.nb_2=Wi([4,zt.CBANDS]),this.nb_s1=Wi([4,zt.CBANDS]),this.nb_s2=Wi([4,zt.CBANDS]),this.s3_ss=null,this.s3_ll=null,this.decay=0,this.thm=new Array(4),this.en=new Array(4),this.tot_ener=yr(4),this.loudness_sq=Wi([2,2]),this.loudness_sq_save=yr(2),this.mld_l=yr(zt.SBMAX_l),this.mld_s=yr(zt.SBMAX_s),this.bm_l=kr(zt.SBMAX_l),this.bo_l=kr(zt.SBMAX_l),this.bm_s=kr(zt.SBMAX_s),this.bo_s=kr(zt.SBMAX_s),this.npart_l=0,this.npart_s=0,this.s3ind=gu([zt.CBANDS,2]),this.s3ind_s=gu([zt.CBANDS,2]),this.numlines_s=kr(zt.CBANDS),this.numlines_l=kr(zt.CBANDS),this.rnumlines_l=yr(zt.CBANDS),this.mld_cb_l=yr(zt.CBANDS),this.mld_cb_s=yr(zt.CBANDS),this.numlines_s_num1=0,this.numlines_l_num1=0,this.pe=yr(4),this.ms_ratio_s_old=0,this.ms_ratio_l_old=0,this.ms_ener_ratio_old=0,this.blocktype_old=kr(2),this.nsPsy=new pV,this.VBR_seek_table=new mV,this.ATH=null,this.PSY=null,this.nogap_total=0,this.nogap_current=0,this.decode_on_the_fly=!0,this.findReplayGain=!0,this.findPeakSample=!0,this.PeakSample=0,this.RadioGain=0,this.AudiophileGain=0,this.rgdata=null,this.noclipGainChange=0,this.noclipScale=0,this.bitrate_stereoMode_Hist=gu([16,5]),this.bitrate_blockType_Hist=gu([16,6]),this.pinfo=null,this.hip=null,this.in_buffer_nsamples=0,this.in_buffer_0=null,this.in_buffer_1=null,this.iteration_loop=null;for(var t=0;t<this.en.length;t++)this.en[t]=new a2;for(var t=0;t<this.thm.length;t++)this.thm[t]=new a2;for(var t=0;t<this.header.length;t++)this.header[t]=new e}var kf=Ts,_V=Bt,Gi=_V.new_float,Yi=Hn();function yV(){this.useAdjust=0,this.aaSensitivityP=0,this.adjust=0,this.adjustLimit=0,this.decay=0,this.floor=0,this.l=Gi(Yi.SBMAX_l),this.s=Gi(Yi.SBMAX_s),this.psfb21=Gi(Yi.PSFB21),this.psfb12=Gi(Yi.PSFB12),this.cb_l=Gi(Yi.CBANDS),this.cb_s=Gi(Yi.CBANDS),this.eql_w=Gi(Yi.BLKSIZE/2)}var bV=yV,AT=Bt,Qn=AT.System,l2=AT.Arrays;Kt.STEPS_per_dB=100;Kt.MAX_dB=120;Kt.GAIN_NOT_ENOUGH_SAMPLES=-24601;Kt.GAIN_ANALYSIS_ERROR=0;Kt.GAIN_ANALYSIS_OK=1;Kt.INIT_GAIN_ANALYSIS_ERROR=0;Kt.INIT_GAIN_ANALYSIS_OK=1;Kt.YULE_ORDER=10;Kt.MAX_ORDER=Kt.YULE_ORDER;Kt.MAX_SAMP_FREQ=48e3;Kt.RMS_WINDOW_TIME_NUMERATOR=1;Kt.RMS_WINDOW_TIME_DENOMINATOR=20;Kt.MAX_SAMPLES_PER_WINDOW=Kt.MAX_SAMP_FREQ*Kt.RMS_WINDOW_TIME_NUMERATOR/Kt.RMS_WINDOW_TIME_DENOMINATOR+1;function Kt(){var n=64.82,e=.95,t=Kt.RMS_WINDOW_TIME_NUMERATOR,r=Kt.RMS_WINDOW_TIME_DENOMINATOR,s=[[.038575994352,-3.84664617118067,-.02160367184185,7.81501653005538,-.00123395316851,-11.34170355132042,-9291677959e-14,13.05504219327545,-.01655260341619,-12.28759895145294,.02161526843274,9.4829380631979,-.02074045215285,-5.87257861775999,.00594298065125,2.75465861874613,.00306428023191,-.86984376593551,.00012025322027,.13919314567432,.00288463683916],[.0541865640643,-3.47845948550071,-.02911007808948,6.36317777566148,-.00848709379851,-8.54751527471874,-.00851165645469,9.4769360780128,-.00834990904936,-8.81498681370155,.02245293253339,6.85401540936998,-.02596338512915,-4.39470996079559,.01624864962975,2.19611684890774,-.00240879051584,-.75104302451432,.00674613682247,.13149317958808,-.00187763777362],[.15457299681924,-2.37898834973084,-.09331049056315,2.84868151156327,-.06247880153653,-2.64577170229825,.02163541888798,2.23697657451713,-.05588393329856,-1.67148153367602,.04781476674921,1.00595954808547,.00222312597743,-.45953458054983,.03174092540049,.16378164858596,-.01390589421898,-.05032077717131,.00651420667831,.0234789740702,-.00881362733839],[.30296907319327,-1.61273165137247,-.22613988682123,1.0797749225997,-.08587323730772,-.2565625775407,.03282930172664,-.1627671912044,-.00915702933434,-.22638893773906,-.02364141202522,.39120800788284,-.00584456039913,-.22138138954925,.06276101321749,.04500235387352,-828086748e-14,.02005851806501,.00205861885564,.00302439095741,-.02950134983287],[.33642304856132,-1.49858979367799,-.2557224142557,.87350271418188,-.11828570177555,.12205022308084,.11921148675203,-.80774944671438,-.07834489609479,.47854794562326,-.0046997791438,-.12453458140019,-.0058950022444,-.04067510197014,.05724228140351,.08333755284107,.00832043980773,-.04237348025746,-.0163538138454,.02977207319925,-.0176017656815],[.4491525660845,-.62820619233671,-.14351757464547,.29661783706366,-.22784394429749,-.372563729424,-.01419140100551,.00213767857124,.04078262797139,-.42029820170918,-.12398163381748,.22199650564824,.04097565135648,.00613424350682,.10478503600251,.06747620744683,-.01863887810927,.05784820375801,-.03193428438915,.03222754072173,.00541907748707],[.56619470757641,-1.04800335126349,-.75464456939302,.29156311971249,.1624213774223,-.26806001042947,.16744243493672,.00819999645858,-.18901604199609,.45054734505008,.3093178284183,-.33032403314006,-.27562961986224,.0673936833311,.00647310677246,-.04784254229033,.08647503780351,.01639907836189,-.0378898455484,.01807364323573,-.00588215443421],[.58100494960553,-.51035327095184,-.53174909058578,-.31863563325245,-.14289799034253,-.20256413484477,.17520704835522,.1472815413433,.02377945217615,.38952639978999,.15558449135573,-.23313271880868,-.25344790059353,-.05246019024463,.01628462406333,-.02505961724053,.06920467763959,.02442357316099,-.03721611395801,.01818801111503,-.00749618797172],[.53648789255105,-.2504987195602,-.42163034350696,-.43193942311114,-.00275953611929,-.03424681017675,.04267842219415,-.04678328784242,-.10214864179676,.26408300200955,.14590772289388,.15113130533216,-.02459864859345,-.17556493366449,-.11202315195388,-.18823009262115,-.04060034127,.05477720428674,.0478866554818,.0470440968812,-.02217936801134]],i=[[.98621192462708,-1.97223372919527,-1.97242384925416,.97261396931306,.98621192462708],[.98500175787242,-1.96977855582618,-1.97000351574484,.9702284756635,.98500175787242],[.97938932735214,-1.95835380975398,-1.95877865470428,.95920349965459,.97938932735214],[.97531843204928,-1.95002759149878,-1.95063686409857,.95124613669835,.97531843204928],[.97316523498161,-1.94561023566527,-1.94633046996323,.94705070426118,.97316523498161],[.96454515552826,-1.92783286977036,-1.92909031105652,.93034775234268,.96454515552826],[.96009142950541,-1.91858953033784,-1.92018285901082,.92177618768381,.96009142950541],[.95856916599601,-1.9154210807478,-1.91713833199203,.91885558323625,.95856916599601],[.94597685600279,-1.88903307939452,-1.89195371200558,.89487434461664,.94597685600279]];function o(f,d,m,_,D,O){for(;D--!=0;)m[_]=1e-10+f[d+0]*O[0]-m[_-1]*O[1]+f[d-1]*O[2]-m[_-2]*O[3]+f[d-2]*O[4]-m[_-3]*O[5]+f[d-3]*O[6]-m[_-4]*O[7]+f[d-4]*O[8]-m[_-5]*O[9]+f[d-5]*O[10]-m[_-6]*O[11]+f[d-6]*O[12]-m[_-7]*O[13]+f[d-7]*O[14]-m[_-8]*O[15]+f[d-8]*O[16]-m[_-9]*O[17]+f[d-9]*O[18]-m[_-10]*O[19]+f[d-10]*O[20],++_,++d}function a(f,d,m,_,D,O){for(;D--!=0;)m[_]=f[d+0]*O[0]-m[_-1]*O[1]+f[d-1]*O[2]-m[_-2]*O[3]+f[d-2]*O[4],++_,++d}function l(f,d){for(var m=0;m<MAX_ORDER;m++)f.linprebuf[m]=f.lstepbuf[m]=f.loutbuf[m]=f.rinprebuf[m]=f.rstepbuf[m]=f.routbuf[m]=0;switch(0|d){case 48e3:f.reqindex=0;break;case 44100:f.reqindex=1;break;case 32e3:f.reqindex=2;break;case 24e3:f.reqindex=3;break;case 22050:f.reqindex=4;break;case 16e3:f.reqindex=5;break;case 12e3:f.reqindex=6;break;case 11025:f.reqindex=7;break;case 8e3:f.reqindex=8;break;default:return INIT_GAIN_ANALYSIS_ERROR}return f.sampleWindow=0|(d*t+r-1)/r,f.lsum=0,f.rsum=0,f.totsamp=0,l2.ill(f.A,0),INIT_GAIN_ANALYSIS_OK}this.InitGainAnalysis=function(f,d){return l(f,d)!=INIT_GAIN_ANALYSIS_OK?INIT_GAIN_ANALYSIS_ERROR:(f.linpre=MAX_ORDER,f.rinpre=MAX_ORDER,f.lstep=MAX_ORDER,f.rstep=MAX_ORDER,f.lout=MAX_ORDER,f.rout=MAX_ORDER,l2.fill(f.B,0),INIT_GAIN_ANALYSIS_OK)};function c(f){return f*f}this.AnalyzeSamples=function(f,d,m,_,D,O,x){var w,N,V,p,k,S,b;if(O==0)return GAIN_ANALYSIS_OK;switch(b=0,k=O,x){case 1:_=d,D=m;break;case 2:break;default:return GAIN_ANALYSIS_ERROR}for(O<MAX_ORDER?(Qn.arraycopy(d,m,f.linprebuf,MAX_ORDER,O),Qn.arraycopy(_,D,f.rinprebuf,MAX_ORDER,O)):(Qn.arraycopy(d,m,f.linprebuf,MAX_ORDER,MAX_ORDER),Qn.arraycopy(_,D,f.rinprebuf,MAX_ORDER,MAX_ORDER));k>0;){S=k>f.sampleWindow-f.totsamp?f.sampleWindow-f.totsamp:k,b<MAX_ORDER?(w=f.linpre+b,N=f.linprebuf,V=f.rinpre+b,p=f.rinprebuf,S>MAX_ORDER-b&&(S=MAX_ORDER-b)):(w=m+b,N=d,V=D+b,p=_),o(N,w,f.lstepbuf,f.lstep+f.totsamp,S,s[f.reqindex]),o(p,V,f.rstepbuf,f.rstep+f.totsamp,S,s[f.reqindex]),a(f.lstepbuf,f.lstep+f.totsamp,f.loutbuf,f.lout+f.totsamp,S,i[f.reqindex]),a(f.rstepbuf,f.rstep+f.totsamp,f.routbuf,f.rout+f.totsamp,S,i[f.reqindex]),w=f.lout+f.totsamp,N=f.loutbuf,V=f.rout+f.totsamp,p=f.routbuf;for(var E=S%8;E--!=0;)f.lsum+=c(N[w++]),f.rsum+=c(p[V++]);for(E=S/8;E--!=0;)f.lsum+=c(N[w+0])+c(N[w+1])+c(N[w+2])+c(N[w+3])+c(N[w+4])+c(N[w+5])+c(N[w+6])+c(N[w+7]),w+=8,f.rsum+=c(p[V+0])+c(p[V+1])+c(p[V+2])+c(p[V+3])+c(p[V+4])+c(p[V+5])+c(p[V+6])+c(p[V+7]),V+=8;if(k-=S,b+=S,f.totsamp+=S,f.totsamp==f.sampleWindow){var T=Kt.STEPS_per_dB*10*Math.log10((f.lsum+f.rsum)/f.totsamp*.5+1e-37),M=T<=0?0:0|T;M>=f.A.length&&(M=f.A.length-1),f.A[M]++,f.lsum=f.rsum=0,Qn.arraycopy(f.loutbuf,f.totsamp,f.loutbuf,0,MAX_ORDER),Qn.arraycopy(f.routbuf,f.totsamp,f.routbuf,0,MAX_ORDER),Qn.arraycopy(f.lstepbuf,f.totsamp,f.lstepbuf,0,MAX_ORDER),Qn.arraycopy(f.rstepbuf,f.totsamp,f.rstepbuf,0,MAX_ORDER),f.totsamp=0}if(f.totsamp>f.sampleWindow)return GAIN_ANALYSIS_ERROR}return O<MAX_ORDER?(Qn.arraycopy(f.linprebuf,O,f.linprebuf,0,MAX_ORDER-O),Qn.arraycopy(f.rinprebuf,O,f.rinprebuf,0,MAX_ORDER-O),Qn.arraycopy(d,m,f.linprebuf,MAX_ORDER-O,O),Qn.arraycopy(_,D,f.rinprebuf,MAX_ORDER-O,O)):(Qn.arraycopy(d,m+O-MAX_ORDER,f.linprebuf,0,MAX_ORDER),Qn.arraycopy(_,D+O-MAX_ORDER,f.rinprebuf,0,MAX_ORDER)),GAIN_ANALYSIS_OK};function u(f,d){var m,_=0;for(m=0;m<d;m++)_+=f[m];if(_==0)return GAIN_NOT_ENOUGH_SAMPLES;var D=0|Math.ceil(_*(1-e));for(m=d;m-- >0&&!((D-=f[m])<=0););return n-m/Kt.STEPS_per_dB}this.GetTitleGain=function(f){for(var d=u(f.A,f.A.length),m=0;m<f.A.length;m++)f.B[m]+=f.A[m],f.A[m]=0;for(var m=0;m<MAX_ORDER;m++)f.linprebuf[m]=f.lstepbuf[m]=f.loutbuf[m]=f.rinprebuf[m]=f.rstepbuf[m]=f.routbuf[m]=0;return f.totsamp=0,f.lsum=f.rsum=0,d}}var IT=Kt,RT=Bt,Go=RT.new_float,c2=RT.new_int,Jn=IT;function vV(){this.linprebuf=Go(Jn.MAX_ORDER*2),this.linpre=0,this.lstepbuf=Go(Jn.MAX_SAMPLES_PER_WINDOW+Jn.MAX_ORDER),this.lstep=0,this.loutbuf=Go(Jn.MAX_SAMPLES_PER_WINDOW+Jn.MAX_ORDER),this.lout=0,this.rinprebuf=Go(Jn.MAX_ORDER*2),this.rinpre=0,this.rstepbuf=Go(Jn.MAX_SAMPLES_PER_WINDOW+Jn.MAX_ORDER),this.rstep=0,this.routbuf=Go(Jn.MAX_SAMPLES_PER_WINDOW+Jn.MAX_ORDER),this.rout=0,this.sampleWindow=0,this.totsamp=0,this.lsum=0,this.rsum=0,this.freqindex=0,this.first=0,this.A=c2(0|Jn.STEPS_per_dB*Jn.MAX_dB),this.B=c2(0|Jn.STEPS_per_dB*Jn.MAX_dB)}var EV=vV;function wV(n){this.bits=n}var kT=wV,F0=Bt,u2=F0.new_float,TV=F0.new_int,h2=F0.assert,SV=kT,f2=Hn(),AV=Rf,IV=kf;function RV(n){var e=n;this.quantize=e,this.iteration_loop=function(t,r,s,i){var o=t.internal_flags,a=u2(AV.SFBMAX),l=u2(576),c=TV(2),u=0,f,d=o.l3_side,m=new SV(u);this.quantize.rv.ResvFrameBegin(t,m),u=m.bits;for(var _=0;_<o.mode_gr;_++){f=this.quantize.qupvt.on_pe(t,r,c,u,_,_),o.mode_ext==f2.MPG_MD_MS_LR&&(this.quantize.ms_convert(o.l3_side,_),this.quantize.qupvt.reduce_side(c,s[_],u,f));for(var D=0;D<o.channels_out;D++){var O,x,w=d.tt[_][D];w.block_type!=f2.SHORT_TYPE?(O=0,x=o.PSY.mask_adjust-O):(O=0,x=o.PSY.mask_adjust_short-O),o.masking_lower=Math.pow(10,x*.1),this.quantize.init_outer_loop(o,w),this.quantize.init_xrpow(o,w,l)&&(this.quantize.qupvt.calc_xmin(t,i[_][D],w,a),this.quantize.outer_loop(t,w,a,l,D,c[D])),this.quantize.iteration_finish_one(o,_,D),h2(w.part2_3_length<=IV.MAX_BITS_PER_CHANNEL),h2(w.part2_3_length<=c[D])}}this.quantize.rv.ResvFrameEnd(o,u)}}var kV=RV;function yt(n,e,t,r){this.xlen=n,this.linmax=e,this.table=t,this.hlen=r}var Pe={};Pe.t1HB=[1,1,1,0];Pe.t2HB=[1,2,1,3,1,1,3,2,0];Pe.t3HB=[3,2,1,1,1,1,3,2,0];Pe.t5HB=[1,2,6,5,3,1,4,4,7,5,7,1,6,1,1,0];Pe.t6HB=[7,3,5,1,6,2,3,2,5,4,4,1,3,3,2,0];Pe.t7HB=[1,2,10,19,16,10,3,3,7,10,5,3,11,4,13,17,8,4,12,11,18,15,11,2,7,6,9,14,3,1,6,4,5,3,2,0];Pe.t8HB=[3,4,6,18,12,5,5,1,2,16,9,3,7,3,5,14,7,3,19,17,15,13,10,4,13,5,8,11,5,1,12,4,4,1,1,0];Pe.t9HB=[7,5,9,14,15,7,6,4,5,5,6,7,7,6,8,8,8,5,15,6,9,10,5,1,11,7,9,6,4,1,14,4,6,2,6,0];Pe.t10HB=[1,2,10,23,35,30,12,17,3,3,8,12,18,21,12,7,11,9,15,21,32,40,19,6,14,13,22,34,46,23,18,7,20,19,33,47,27,22,9,3,31,22,41,26,21,20,5,3,14,13,10,11,16,6,5,1,9,8,7,8,4,4,2,0];Pe.t11HB=[3,4,10,24,34,33,21,15,5,3,4,10,32,17,11,10,11,7,13,18,30,31,20,5,25,11,19,59,27,18,12,5,35,33,31,58,30,16,7,5,28,26,32,19,17,15,8,14,14,12,9,13,14,9,4,1,11,4,6,6,6,3,2,0];Pe.t12HB=[9,6,16,33,41,39,38,26,7,5,6,9,23,16,26,11,17,7,11,14,21,30,10,7,17,10,15,12,18,28,14,5,32,13,22,19,18,16,9,5,40,17,31,29,17,13,4,2,27,12,11,15,10,7,4,1,27,12,8,12,6,3,1,0];Pe.t13HB=[1,5,14,21,34,51,46,71,42,52,68,52,67,44,43,19,3,4,12,19,31,26,44,33,31,24,32,24,31,35,22,14,15,13,23,36,59,49,77,65,29,40,30,40,27,33,42,16,22,20,37,61,56,79,73,64,43,76,56,37,26,31,25,14,35,16,60,57,97,75,114,91,54,73,55,41,48,53,23,24,58,27,50,96,76,70,93,84,77,58,79,29,74,49,41,17,47,45,78,74,115,94,90,79,69,83,71,50,59,38,36,15,72,34,56,95,92,85,91,90,86,73,77,65,51,44,43,42,43,20,30,44,55,78,72,87,78,61,46,54,37,30,20,16,53,25,41,37,44,59,54,81,66,76,57,54,37,18,39,11,35,33,31,57,42,82,72,80,47,58,55,21,22,26,38,22,53,25,23,38,70,60,51,36,55,26,34,23,27,14,9,7,34,32,28,39,49,75,30,52,48,40,52,28,18,17,9,5,45,21,34,64,56,50,49,45,31,19,12,15,10,7,6,3,48,23,20,39,36,35,53,21,16,23,13,10,6,1,4,2,16,15,17,27,25,20,29,11,17,12,16,8,1,1,0,1];Pe.t15HB=[7,12,18,53,47,76,124,108,89,123,108,119,107,81,122,63,13,5,16,27,46,36,61,51,42,70,52,83,65,41,59,36,19,17,15,24,41,34,59,48,40,64,50,78,62,80,56,33,29,28,25,43,39,63,55,93,76,59,93,72,54,75,50,29,52,22,42,40,67,57,95,79,72,57,89,69,49,66,46,27,77,37,35,66,58,52,91,74,62,48,79,63,90,62,40,38,125,32,60,56,50,92,78,65,55,87,71,51,73,51,70,30,109,53,49,94,88,75,66,122,91,73,56,42,64,44,21,25,90,43,41,77,73,63,56,92,77,66,47,67,48,53,36,20,71,34,67,60,58,49,88,76,67,106,71,54,38,39,23,15,109,53,51,47,90,82,58,57,48,72,57,41,23,27,62,9,86,42,40,37,70,64,52,43,70,55,42,25,29,18,11,11,118,68,30,55,50,46,74,65,49,39,24,16,22,13,14,7,91,44,39,38,34,63,52,45,31,52,28,19,14,8,9,3,123,60,58,53,47,43,32,22,37,24,17,12,15,10,2,1,71,37,34,30,28,20,17,26,21,16,10,6,8,6,2,0];Pe.t16HB=[1,5,14,44,74,63,110,93,172,149,138,242,225,195,376,17,3,4,12,20,35,62,53,47,83,75,68,119,201,107,207,9,15,13,23,38,67,58,103,90,161,72,127,117,110,209,206,16,45,21,39,69,64,114,99,87,158,140,252,212,199,387,365,26,75,36,68,65,115,101,179,164,155,264,246,226,395,382,362,9,66,30,59,56,102,185,173,265,142,253,232,400,388,378,445,16,111,54,52,100,184,178,160,133,257,244,228,217,385,366,715,10,98,48,91,88,165,157,148,261,248,407,397,372,380,889,884,8,85,84,81,159,156,143,260,249,427,401,392,383,727,713,708,7,154,76,73,141,131,256,245,426,406,394,384,735,359,710,352,11,139,129,67,125,247,233,229,219,393,743,737,720,885,882,439,4,243,120,118,115,227,223,396,746,742,736,721,712,706,223,436,6,202,224,222,218,216,389,386,381,364,888,443,707,440,437,1728,4,747,211,210,208,370,379,734,723,714,1735,883,877,876,3459,865,2,377,369,102,187,726,722,358,711,709,866,1734,871,3458,870,434,0,12,10,7,11,10,17,11,9,13,12,10,7,5,3,1,3];Pe.t24HB=[15,13,46,80,146,262,248,434,426,669,653,649,621,517,1032,88,14,12,21,38,71,130,122,216,209,198,327,345,319,297,279,42,47,22,41,74,68,128,120,221,207,194,182,340,315,295,541,18,81,39,75,70,134,125,116,220,204,190,178,325,311,293,271,16,147,72,69,135,127,118,112,210,200,188,352,323,306,285,540,14,263,66,129,126,119,114,214,202,192,180,341,317,301,281,262,12,249,123,121,117,113,215,206,195,185,347,330,308,291,272,520,10,435,115,111,109,211,203,196,187,353,332,313,298,283,531,381,17,427,212,208,205,201,193,186,177,169,320,303,286,268,514,377,16,335,199,197,191,189,181,174,333,321,305,289,275,521,379,371,11,668,184,183,179,175,344,331,314,304,290,277,530,383,373,366,10,652,346,171,168,164,318,309,299,287,276,263,513,375,368,362,6,648,322,316,312,307,302,292,284,269,261,512,376,370,364,359,4,620,300,296,294,288,282,273,266,515,380,374,369,365,361,357,2,1033,280,278,274,267,264,259,382,378,372,367,363,360,358,356,0,43,20,19,17,15,13,11,9,7,6,4,7,5,3,1,3];Pe.t32HB=[1,10,8,20,12,20,16,32,14,12,24,0,28,16,24,16];Pe.t33HB=[15,28,26,48,22,40,36,64,14,24,20,32,12,16,8,0];Pe.t1l=[1,4,3,5];Pe.t2l=[1,4,7,4,5,7,6,7,8];Pe.t3l=[2,3,7,4,4,7,6,7,8];Pe.t5l=[1,4,7,8,4,5,8,9,7,8,9,10,8,8,9,10];Pe.t6l=[3,4,6,8,4,4,6,7,5,6,7,8,7,7,8,9];Pe.t7l=[1,4,7,9,9,10,4,6,8,9,9,10,7,7,9,10,10,11,8,9,10,11,11,11,8,9,10,11,11,12,9,10,11,12,12,12];Pe.t8l=[2,4,7,9,9,10,4,4,6,10,10,10,7,6,8,10,10,11,9,10,10,11,11,12,9,9,10,11,12,12,10,10,11,11,13,13];Pe.t9l=[3,4,6,7,9,10,4,5,6,7,8,10,5,6,7,8,9,10,7,7,8,9,9,10,8,8,9,9,10,11,9,9,10,10,11,11];Pe.t10l=[1,4,7,9,10,10,10,11,4,6,8,9,10,11,10,10,7,8,9,10,11,12,11,11,8,9,10,11,12,12,11,12,9,10,11,12,12,12,12,12,10,11,12,12,13,13,12,13,9,10,11,12,12,12,13,13,10,10,11,12,12,13,13,13];Pe.t11l=[2,4,6,8,9,10,9,10,4,5,6,8,10,10,9,10,6,7,8,9,10,11,10,10,8,8,9,11,10,12,10,11,9,10,10,11,11,12,11,12,9,10,11,12,12,13,12,13,9,9,9,10,11,12,12,12,9,9,10,11,12,12,12,12];Pe.t12l=[4,4,6,8,9,10,10,10,4,5,6,7,9,9,10,10,6,6,7,8,9,10,9,10,7,7,8,8,9,10,10,10,8,8,9,9,10,10,10,11,9,9,10,10,10,11,10,11,9,9,9,10,10,11,11,12,10,10,10,11,11,11,11,12];Pe.t13l=[1,5,7,8,9,10,10,11,10,11,12,12,13,13,14,14,4,6,8,9,10,10,11,11,11,11,12,12,13,14,14,14,7,8,9,10,11,11,12,12,11,12,12,13,13,14,15,15,8,9,10,11,11,12,12,12,12,13,13,13,13,14,15,15,9,9,11,11,12,12,13,13,12,13,13,14,14,15,15,16,10,10,11,12,12,12,13,13,13,13,14,13,15,15,16,16,10,11,12,12,13,13,13,13,13,14,14,14,15,15,16,16,11,11,12,13,13,13,14,14,14,14,15,15,15,16,18,18,10,10,11,12,12,13,13,14,14,14,14,15,15,16,17,17,11,11,12,12,13,13,13,15,14,15,15,16,16,16,18,17,11,12,12,13,13,14,14,15,14,15,16,15,16,17,18,19,12,12,12,13,14,14,14,14,15,15,15,16,17,17,17,18,12,13,13,14,14,15,14,15,16,16,17,17,17,18,18,18,13,13,14,15,15,15,16,16,16,16,16,17,18,17,18,18,14,14,14,15,15,15,17,16,16,19,17,17,17,19,18,18,13,14,15,16,16,16,17,16,17,17,18,18,21,20,21,18];Pe.t15l=[3,5,6,8,8,9,10,10,10,11,11,12,12,12,13,14,5,5,7,8,9,9,10,10,10,11,11,12,12,12,13,13,6,7,7,8,9,9,10,10,10,11,11,12,12,13,13,13,7,8,8,9,9,10,10,11,11,11,12,12,12,13,13,13,8,8,9,9,10,10,11,11,11,11,12,12,12,13,13,13,9,9,9,10,10,10,11,11,11,11,12,12,13,13,13,14,10,9,10,10,10,11,11,11,11,12,12,12,13,13,14,14,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,14,10,10,10,11,11,11,11,12,12,12,12,13,13,14,14,14,10,10,11,11,11,11,12,12,12,13,13,13,13,14,14,14,11,11,11,11,12,12,12,12,12,13,13,13,13,14,15,14,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,15,12,12,11,12,12,12,13,13,13,13,13,13,14,14,15,15,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,13,13,13,13,13,13,13,13,14,14,14,14,15,15,14,15,13,13,13,13,13,13,13,14,14,14,14,14,15,15,15,15];Pe.t16_5l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,11,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,11,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,12,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,13,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,12,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,13,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,13,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,13,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,13,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,14,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,13,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,14,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,14,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,14,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,14,11,11,11,12,12,13,13,13,14,14,14,14,14,14,14,12];Pe.t16l=[1,5,7,9,10,10,11,11,12,12,12,13,13,13,14,10,4,6,8,9,10,11,11,11,12,12,12,13,14,13,14,10,7,8,9,10,11,11,12,12,13,12,13,13,13,14,14,11,9,9,10,11,11,12,12,12,13,13,14,14,14,15,15,12,10,10,11,11,12,12,13,13,13,14,14,14,15,15,15,11,10,10,11,11,12,13,13,14,13,14,14,15,15,15,16,12,11,11,11,12,13,13,13,13,14,14,14,14,15,15,16,12,11,11,12,12,13,13,13,14,14,15,15,15,15,17,17,12,11,12,12,13,13,13,14,14,15,15,15,15,16,16,16,12,12,12,12,13,13,14,14,15,15,15,15,16,15,16,15,13,12,13,12,13,14,14,14,14,15,16,16,16,17,17,16,12,13,13,13,13,14,14,15,16,16,16,16,16,16,15,16,13,13,14,14,14,14,15,15,15,15,17,16,16,16,16,18,13,15,14,14,14,15,15,16,16,16,18,17,17,17,19,17,13,14,15,13,14,16,16,15,16,16,17,18,17,19,17,16,13,10,10,10,11,11,12,12,12,13,13,13,13,13,13,13,10];Pe.t24l=[4,5,7,8,9,10,10,11,11,12,12,12,12,12,13,10,5,6,7,8,9,10,10,11,11,11,12,12,12,12,12,10,7,7,8,9,9,10,10,11,11,11,11,12,12,12,13,9,8,8,9,9,10,10,10,11,11,11,11,12,12,12,12,9,9,9,9,10,10,10,10,11,11,11,12,12,12,12,13,9,10,9,10,10,10,10,11,11,11,11,12,12,12,12,12,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,9,11,10,10,10,11,11,11,11,12,12,12,12,12,13,13,10,11,11,11,11,11,11,11,11,11,12,12,12,12,13,13,10,11,11,11,11,11,11,11,12,12,12,12,12,13,13,13,10,12,11,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,11,11,11,12,12,12,12,12,12,13,13,13,13,10,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,10,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,10,13,12,12,12,12,12,12,13,13,13,13,13,13,13,13,10,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,6];Pe.t32l=[1,5,5,7,5,8,7,9,5,7,7,9,7,9,9,10];Pe.t33l=[4,5,5,6,5,6,6,7,5,6,6,7,6,7,7,8];Pe.ht=[new yt(0,0,null,null),new yt(2,0,Pe.t1HB,Pe.t1l),new yt(3,0,Pe.t2HB,Pe.t2l),new yt(3,0,Pe.t3HB,Pe.t3l),new yt(0,0,null,null),new yt(4,0,Pe.t5HB,Pe.t5l),new yt(4,0,Pe.t6HB,Pe.t6l),new yt(6,0,Pe.t7HB,Pe.t7l),new yt(6,0,Pe.t8HB,Pe.t8l),new yt(6,0,Pe.t9HB,Pe.t9l),new yt(8,0,Pe.t10HB,Pe.t10l),new yt(8,0,Pe.t11HB,Pe.t11l),new yt(8,0,Pe.t12HB,Pe.t12l),new yt(16,0,Pe.t13HB,Pe.t13l),new yt(0,0,null,Pe.t16_5l),new yt(16,0,Pe.t15HB,Pe.t15l),new yt(1,1,Pe.t16HB,Pe.t16l),new yt(2,3,Pe.t16HB,Pe.t16l),new yt(3,7,Pe.t16HB,Pe.t16l),new yt(4,15,Pe.t16HB,Pe.t16l),new yt(6,63,Pe.t16HB,Pe.t16l),new yt(8,255,Pe.t16HB,Pe.t16l),new yt(10,1023,Pe.t16HB,Pe.t16l),new yt(13,8191,Pe.t16HB,Pe.t16l),new yt(4,15,Pe.t24HB,Pe.t24l),new yt(5,31,Pe.t24HB,Pe.t24l),new yt(6,63,Pe.t24HB,Pe.t24l),new yt(7,127,Pe.t24HB,Pe.t24l),new yt(8,255,Pe.t24HB,Pe.t24l),new yt(9,511,Pe.t24HB,Pe.t24l),new yt(11,2047,Pe.t24HB,Pe.t24l),new yt(13,8191,Pe.t24HB,Pe.t24l),new yt(0,0,Pe.t32HB,Pe.t32l),new yt(0,0,Pe.t33HB,Pe.t33l)];Pe.largetbl=[65540,327685,458759,589832,655369,655370,720906,720907,786443,786444,786444,851980,851980,851980,917517,655370,262149,393222,524295,589832,655369,720906,720906,720907,786443,786443,786444,851980,917516,851980,917516,655370,458759,524295,589832,655369,720905,720906,786442,786443,851979,786443,851979,851980,851980,917516,917517,720905,589832,589832,655369,720905,720906,786442,786442,786443,851979,851979,917515,917516,917516,983052,983052,786441,655369,655369,720905,720906,786442,786442,851978,851979,851979,917515,917516,917516,983052,983052,983053,720905,655370,655369,720906,720906,786442,851978,851979,917515,851979,917515,917516,983052,983052,983052,1048588,786441,720906,720906,720906,786442,851978,851979,851979,851979,917515,917516,917516,917516,983052,983052,1048589,786441,720907,720906,786442,786442,851979,851979,851979,917515,917516,983052,983052,983052,983052,1114125,1114125,786442,720907,786443,786443,851979,851979,851979,917515,917515,983051,983052,983052,983052,1048588,1048589,1048589,786442,786443,786443,786443,851979,851979,917515,917515,983052,983052,983052,983052,1048588,983053,1048589,983053,851978,786444,851979,786443,851979,917515,917516,917516,917516,983052,1048588,1048588,1048589,1114125,1114125,1048589,786442,851980,851980,851979,851979,917515,917516,983052,1048588,1048588,1048588,1048588,1048589,1048589,983053,1048589,851978,851980,917516,917516,917516,917516,983052,983052,983052,983052,1114124,1048589,1048589,1048589,1048589,1179661,851978,983052,917516,917516,917516,983052,983052,1048588,1048588,1048589,1179661,1114125,1114125,1114125,1245197,1114125,851978,917517,983052,851980,917516,1048588,1048588,983052,1048589,1048589,1114125,1179661,1114125,1245197,1114125,1048589,851978,655369,655369,655369,720905,720905,786441,786441,786441,851977,851977,851977,851978,851978,851978,851978,655366];Pe.table23=[65538,262147,458759,262148,327684,458759,393222,458759,524296];Pe.table56=[65539,262148,458758,524296,262148,327684,524294,589831,458757,524294,589831,655368,524295,524295,589832,655369];Pe.bitrate_table=[[0,8,16,24,32,40,48,56,64,80,96,112,128,144,160,-1],[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],[0,8,16,24,32,40,48,56,64,-1,-1,-1,-1,-1,-1,-1]];Pe.samplerate_table=[[22050,24e3,16e3,-1],[44100,48e3,32e3,-1],[11025,12e3,8e3,-1]];Pe.scfsi_band=[0,6,11,16,21];var U0=Pe,Nd,d2;function CT(){if(d2)return Nd;d2=1;var n=ST,e=Bt,t=e.VbrMode,r=e.Float,s=e.Util,i=e.new_float,o=e.new_int,a=e.assert,l=Hn(),c=kT,u=kf;f.Q_MAX=257,f.Q_MAX2=116,f.LARGE_BITS=1e5,f.IXMAX_VAL=8206;function f(){var d=H0(),m=null,_=null,D=null;this.setModules=function(W,X,ne){m=W,_=X,D=ne};function O(W){return a(0<=W+f.Q_MAX2&&W<f.Q_MAX),b[W+f.Q_MAX2]}this.IPOW20=function(W){return a(0<=W&&W<f.Q_MAX),E[W]};var x=2220446049250313e-31,w=f.IXMAX_VAL,N=w+2,V=f.Q_MAX,p=f.Q_MAX2;f.LARGE_BITS;var k=100;this.nr_of_sfb_block=[[[6,5,5,5],[9,9,9,9],[6,9,9,9]],[[6,5,7,3],[9,9,12,6],[6,9,12,6]],[[11,10,0,0],[18,18,0,0],[15,18,0,0]],[[7,7,7,0],[12,12,12,0],[6,15,12,0]],[[6,6,6,3],[12,9,9,6],[6,12,9,6]],[[8,8,5,0],[15,12,9,0],[6,18,9,0]]];var S=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,3,3,3,2,0];this.pretab=S,this.sfBandIndex=[new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,24,32,42,56,74,100,132,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,114,136,162,194,232,278,332,394,464,540,576],[0,4,8,12,18,26,36,48,62,80,104,136,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0,4,8,12,18,26,36,48,62,80,104,134,174,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,52,62,74,90,110,134,162,196,238,288,342,418,576],[0,4,8,12,16,22,30,40,52,66,84,106,136,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,42,50,60,72,88,106,128,156,190,230,276,330,384,576],[0,4,8,12,16,22,28,38,50,64,80,100,126,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,4,8,12,16,20,24,30,36,44,54,66,82,102,126,156,194,240,296,364,448,550,576],[0,4,8,12,16,22,30,42,58,78,104,138,180,192],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,6,12,18,24,30,36,44,54,66,80,96,116,140,168,200,238,284,336,396,464,522,576],[0/3,12/3,24/3,36/3,54/3,78/3,108/3,144/3,186/3,240/3,312/3,402/3,522/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0]),new n([0,12,24,36,48,60,72,88,108,132,160,192,232,280,336,400,476,566,568,570,572,574,576],[0/3,24/3,48/3,72/3,108/3,156/3,216/3,288/3,372/3,480/3,486/3,492/3,498/3,576/3],[0,0,0,0,0,0,0],[0,0,0,0,0,0,0])];var b=i(V+p+1),E=i(V),T=i(N),M=i(N);this.adj43=M;function H(W,X){var ne=D.ATHformula(X,W);return ne-=k,ne=Math.pow(10,ne/10+W.ATHlower),ne}function y(W){for(var X=W.internal_flags.ATH.l,ne=W.internal_flags.ATH.psfb21,Q=W.internal_flags.ATH.s,ce=W.internal_flags.ATH.psfb12,J=W.internal_flags,L=W.out_samplerate,C=0;C<l.SBMAX_l;C++){var I=J.scalefac_band.l[C],B=J.scalefac_band.l[C+1];X[C]=r.MAX_VALUE;for(var z=I;z<B;z++){var ie=z*L/1152,Z=H(W,ie);X[C]=Math.min(X[C],Z)}}for(var C=0;C<l.PSFB21;C++){var I=J.scalefac_band.psfb21[C],B=J.scalefac_band.psfb21[C+1];ne[C]=r.MAX_VALUE;for(var z=I;z<B;z++){var ie=z*L/1152,Z=H(W,ie);ne[C]=Math.min(ne[C],Z)}}for(var C=0;C<l.SBMAX_s;C++){var I=J.scalefac_band.s[C],B=J.scalefac_band.s[C+1];Q[C]=r.MAX_VALUE;for(var z=I;z<B;z++){var ie=z*L/384,Z=H(W,ie);Q[C]=Math.min(Q[C],Z)}Q[C]*=J.scalefac_band.s[C+1]-J.scalefac_band.s[C]}for(var C=0;C<l.PSFB12;C++){var I=J.scalefac_band.psfb12[C],B=J.scalefac_band.psfb12[C+1];ce[C]=r.MAX_VALUE;for(var z=I;z<B;z++){var ie=z*L/384,Z=H(W,ie);ce[C]=Math.min(ce[C],Z)}ce[C]*=J.scalefac_band.s[13]-J.scalefac_band.s[12]}if(W.noATH){for(var C=0;C<l.SBMAX_l;C++)X[C]=1e-20;for(var C=0;C<l.PSFB21;C++)ne[C]=1e-20;for(var C=0;C<l.SBMAX_s;C++)Q[C]=1e-20;for(var C=0;C<l.PSFB12;C++)ce[C]=1e-20}J.ATH.floor=10*Math.log10(H(W,-1))}this.iteration_init=function(W){var X=W.internal_flags,ne=X.l3_side,Q;if(X.iteration_init_init==0){for(X.iteration_init_init=1,ne.main_data_begin=0,y(W),T[0]=0,Q=1;Q<N;Q++)T[Q]=Math.pow(Q,4/3);for(Q=0;Q<N-1;Q++)M[Q]=Q+1-Math.pow(.5*(T[Q]+T[Q+1]),.75);for(M[Q]=.5,Q=0;Q<V;Q++)E[Q]=Math.pow(2,(Q-210)*-.1875);for(Q=0;Q<=V+p;Q++)b[Q]=Math.pow(2,(Q-210-p)*.25);m.huffman_init(X);{var ce,J,L,C;for(Q=W.exp_nspsytune>>2&63,Q>=32&&(Q-=64),ce=Math.pow(10,Q/4/10),Q=W.exp_nspsytune>>8&63,Q>=32&&(Q-=64),J=Math.pow(10,Q/4/10),Q=W.exp_nspsytune>>14&63,Q>=32&&(Q-=64),L=Math.pow(10,Q/4/10),Q=W.exp_nspsytune>>20&63,Q>=32&&(Q-=64),C=L*Math.pow(10,Q/4/10),Q=0;Q<l.SBMAX_l;Q++){var I;Q<=6?I=ce:Q<=13?I=J:Q<=20?I=L:I=C,X.nsPsy.longfact[Q]=I}for(Q=0;Q<l.SBMAX_s;Q++){var I;Q<=5?I=ce:Q<=10?I=J:Q<=11?I=L:I=C,X.nsPsy.shortfact[Q]=I}}}},this.on_pe=function(W,X,ne,Q,ce,J){var L=W.internal_flags,C=0,I,B=o(2),z,ie=new c(C),Z=_.ResvMaxBits(W,Q,ie,J);C=ie.bits;var q=C+Z;for(q>u.MAX_BITS_PER_GRANULE&&(q=u.MAX_BITS_PER_GRANULE),I=0,z=0;z<L.channels_out;++z)ne[z]=Math.min(u.MAX_BITS_PER_CHANNEL,C/L.channels_out),B[z]=0|ne[z]*X[ce][z]/700-ne[z],B[z]>Q*3/4&&(B[z]=Q*3/4),B[z]<0&&(B[z]=0),B[z]+ne[z]>u.MAX_BITS_PER_CHANNEL&&(B[z]=Math.max(0,u.MAX_BITS_PER_CHANNEL-ne[z])),I+=B[z];if(I>Z)for(z=0;z<L.channels_out;++z)B[z]=Z*B[z]/I;for(z=0;z<L.channels_out;++z)ne[z]+=B[z],Z-=B[z];for(I=0,z=0;z<L.channels_out;++z)I+=ne[z];if(I>u.MAX_BITS_PER_GRANULE){var ee=0;for(z=0;z<L.channels_out;++z)ne[z]*=u.MAX_BITS_PER_GRANULE,ne[z]/=I,ee+=ne[z]}return q},this.reduce_side=function(W,X,ne,Q){a(W[0]+W[1]<=u.MAX_BITS_PER_GRANULE);var ce=.33*(.5-X)/.5;ce<0&&(ce=0),ce>.5&&(ce=.5);var J=0|ce*.5*(W[0]+W[1]);J>u.MAX_BITS_PER_CHANNEL-W[0]&&(J=u.MAX_BITS_PER_CHANNEL-W[0]),J<0&&(J=0),W[1]>=125&&(W[1]-J>125?(W[0]<ne&&(W[0]+=J),W[1]-=J):(W[0]+=W[1]-125,W[1]=125)),J=W[0]+W[1],J>Q&&(W[0]=Q*W[0]/J,W[1]=Q*W[1]/J),a(W[0]<=u.MAX_BITS_PER_CHANNEL),a(W[1]<=u.MAX_BITS_PER_CHANNEL),a(W[0]+W[1]<=u.MAX_BITS_PER_GRANULE)},this.athAdjust=function(W,X,ne){var Q=90.30873362,ce=94.82444863,J=s.FAST_LOG10_X(X,10),L=W*W,C=0;return J-=ne,L>1e-20&&(C=1+s.FAST_LOG10_X(L,10/Q)),C<0&&(C=0),J*=C,J+=ne+Q-ce,Math.pow(10,.1*J)},this.calc_xmin=function(W,X,ne,Q){var ce=0,J=W.internal_flags,L,C=0,I=0,B=J.ATH,z=ne.xr,ie=W.VBR==t.vbr_mtrh?1:0,Z=J.masking_lower;for((W.VBR==t.vbr_mtrh||W.VBR==t.vbr_mt)&&(Z=1),L=0;L<ne.psy_lmax;L++){var q,ee,le,Ee,Oe,j;W.VBR==t.vbr_rh||W.VBR==t.vbr_mtrh?ee=athAdjust(B.adjust,B.l[L],B.floor):ee=B.adjust*B.l[L],Oe=ne.width[L],le=ee/Oe,Ee=x,j=Oe>>1,q=0;do{var K,re;K=z[C]*z[C],q+=K,Ee+=K<le?K:le,C++,re=z[C]*z[C],q+=re,Ee+=re<le?re:le,C++}while(--j>0);if(q>ee&&I++,L==l.SBPSY_l){var he=ee*J.nsPsy.longfact[L];Ee<he&&(Ee=he)}if(ie!=0&&(ee=Ee),!W.ATHonly){var _e=X.en.l[L];if(_e>0){var he;he=q*X.thm.l[L]*Z/_e,ie!=0&&(he*=J.nsPsy.longfact[L]),ee<he&&(ee=he)}}ie!=0?Q[ce++]=ee:Q[ce++]=ee*J.nsPsy.longfact[L]}var De=575;if(ne.block_type!=l.SHORT_TYPE)for(var v=576;v--!=0&&d.EQ(z[v],0);)De=v;ne.max_nonzero_coeff=De;for(var P=ne.sfb_smin;L<ne.psymax;P++,L+=3){var Oe,me,fe;for(W.VBR==t.vbr_rh||W.VBR==t.vbr_mtrh?fe=athAdjust(B.adjust,B.s[P],B.floor):fe=B.adjust*B.s[P],Oe=ne.width[L],me=0;me<3;me++){var q=0,ee,le,Ee,j=Oe>>1;le=fe/Oe,Ee=x;do{var K,re;K=z[C]*z[C],q+=K,Ee+=K<le?K:le,C++,re=z[C]*z[C],q+=re,Ee+=re<le?re:le,C++}while(--j>0);if(q>fe&&I++,P==l.SBPSY_s){var he=fe*J.nsPsy.shortfact[P];Ee<he&&(Ee=he)}if(ie!=0?ee=Ee:ee=fe,!W.ATHonly&&!W.ATHshort){var _e=X.en.s[P][me];if(_e>0){var he;he=q*X.thm.s[P][me]*Z/_e,ie!=0&&(he*=J.nsPsy.shortfact[P]),ee<he&&(ee=he)}}ie!=0?Q[ce++]=ee:Q[ce++]=ee*J.nsPsy.shortfact[P]}W.useTemporal&&(Q[ce-3]>Q[ce-3+1]&&(Q[ce-3+1]+=(Q[ce-3]-Q[ce-3+1])*J.decay),Q[ce-3+1]>Q[ce-3+2]&&(Q[ce-3+2]+=(Q[ce-3+1]-Q[ce-3+2])*J.decay))}return I};function A(W){this.s=W}this.calc_noise_core=function(W,X,ne,Q){var ce=0,J=X.s,L=W.l3_enc;if(J>W.count1)for(;ne--!=0;){var C;C=W.xr[J],J++,ce+=C*C,C=W.xr[J],J++,ce+=C*C}else if(J>W.big_values){var I=i(2);for(I[0]=0,I[1]=Q;ne--!=0;){var C;C=Math.abs(W.xr[J])-I[L[J]],J++,ce+=C*C,C=Math.abs(W.xr[J])-I[L[J]],J++,ce+=C*C}}else for(;ne--!=0;){var C;C=Math.abs(W.xr[J])-T[L[J]]*Q,J++,ce+=C*C,C=Math.abs(W.xr[J])-T[L[J]]*Q,J++,ce+=C*C}return X.s=J,ce},this.calc_noise=function(W,X,ne,Q,ce){var J=0,L=0,C,I,B=0,z=0,ie=0,Z=-20,q=0,ee=W.scalefac,le=0;for(Q.over_SSD=0,C=0;C<W.psymax;C++){var Ee=W.global_gain-(ee[le++]+(W.preflag!=0?S[C]:0)<<W.scalefac_scale+1)-W.subblock_gain[W.window[C]]*8,Oe=0;if(ce!=null&&ce.step[C]==Ee)Oe=ce.noise[C],q+=W.width[C],ne[J++]=Oe/X[L++],Oe=ce.noise_log[C];else{var j=O(Ee);if(I=W.width[C]>>1,q+W.width[C]>W.max_nonzero_coeff){var K;K=W.max_nonzero_coeff-q+1,K>0?I=K>>1:I=0}var re=new A(q);Oe=this.calc_noise_core(W,re,I,j),q=re.s,ce!=null&&(ce.step[C]=Ee,ce.noise[C]=Oe),Oe=ne[J++]=Oe/X[L++],Oe=s.FAST_LOG10(Math.max(Oe,1e-20)),ce!=null&&(ce.noise_log[C]=Oe)}if(ce!=null&&(ce.global_gain=W.global_gain),ie+=Oe,Oe>0){var he;he=Math.max(0|Oe*10+.5,1),Q.over_SSD+=he*he,B++,z+=Oe}Z=Math.max(Z,Oe)}return Q.over_count=B,Q.tot_noise=ie,Q.over_noise=z,Q.max_noise=Z,B},this.set_pinfo=function(W,X,ne,Q,ce){var J=W.internal_flags,L,C,I,B,z,ie=X.scalefac_scale==0?.5:1,Z=X.scalefac,q=i(L3Side.SFBMAX),ee=i(L3Side.SFBMAX),le=new CalcNoiseResult;calc_xmin(W,ne,X,q),calc_noise(X,q,ee,le,null);var Ee=0;for(C=X.sfb_lmax,X.block_type!=l.SHORT_TYPE&&X.mixed_block_flag==0&&(C=22),L=0;L<C;L++){var Oe=J.scalefac_band.l[L],j=J.scalefac_band.l[L+1],K=j-Oe;for(B=0;Ee<j;Ee++)B+=X.xr[Ee]*X.xr[Ee];B/=K,z=1e15,J.pinfo.en[Q][ce][L]=z*B,J.pinfo.xfsf[Q][ce][L]=z*q[L]*ee[L]/K,ne.en.l[L]>0&&!W.ATHonly?B=B/ne.en.l[L]:B=0,J.pinfo.thr[Q][ce][L]=z*Math.max(B*ne.thm.l[L],J.ATH.l[L]),J.pinfo.LAMEsfb[Q][ce][L]=0,X.preflag!=0&&L>=11&&(J.pinfo.LAMEsfb[Q][ce][L]=-ie*S[L]),L<l.SBPSY_l&&(a(Z[L]>=0),J.pinfo.LAMEsfb[Q][ce][L]-=ie*Z[L])}if(X.block_type==l.SHORT_TYPE)for(C=L,L=X.sfb_smin;L<l.SBMAX_s;L++)for(var Oe=J.scalefac_band.s[L],j=J.scalefac_band.s[L+1],K=j-Oe,re=0;re<3;re++){for(B=0,I=Oe;I<j;I++)B+=X.xr[Ee]*X.xr[Ee],Ee++;B=Math.max(B/K,1e-20),z=1e15,J.pinfo.en_s[Q][ce][3*L+re]=z*B,J.pinfo.xfsf_s[Q][ce][3*L+re]=z*q[C]*ee[C]/K,ne.en.s[L][re]>0?B=B/ne.en.s[L][re]:B=0,(W.ATHonly||W.ATHshort)&&(B=0),J.pinfo.thr_s[Q][ce][3*L+re]=z*Math.max(B*ne.thm.s[L][re],J.ATH.s[L]),J.pinfo.LAMEsfb_s[Q][ce][3*L+re]=-2*X.subblock_gain[re],L<l.SBPSY_s&&(J.pinfo.LAMEsfb_s[Q][ce][3*L+re]-=ie*Z[C]),C++}J.pinfo.LAMEqss[Q][ce]=X.global_gain,J.pinfo.LAMEmainbits[Q][ce]=X.part2_3_length+X.part2_length,J.pinfo.LAMEsfbits[Q][ce]=X.part2_length,J.pinfo.over[Q][ce]=le.over_count,J.pinfo.max_noise[Q][ce]=le.max_noise*10,J.pinfo.over_noise[Q][ce]=le.over_noise*10,J.pinfo.tot_noise[Q][ce]=le.tot_noise*10,J.pinfo.over_SSD[Q][ce]=le.over_SSD}}return Nd=f,Nd}var Dd,p2;function xT(){if(p2)return Dd;p2=1;var n=Bt,e=n.System,t=n.Arrays,r=n.new_int,s=n.assert,i=Hn(),o=U0,a=V0,l=CT();function c(){var u=null;this.qupvt=null,this.setModules=function(J){this.qupvt=J,u=J};function f(J){this.bits=0|J}var d=[[0,0],[0,0],[0,0],[0,0],[0,0],[0,1],[1,1],[1,1],[1,2],[2,2],[2,3],[2,3],[3,4],[3,4],[3,4],[4,5],[4,5],[4,6],[5,6],[5,6],[5,7],[6,7],[6,7]];function m(J,L,C,I,B,z){var ie=.5946/L;for(J=J>>1;J--!=0;)B[z++]=ie>C[I++]?0:1,B[z++]=ie>C[I++]?0:1}function _(J,L,C,I,B,z){J=J>>1;var ie=J%2;for(J=J>>1;J--!=0;){var Z,q,ee,le,Ee,Oe,j,K;Z=C[I++]*L,q=C[I++]*L,Ee=0|Z,ee=C[I++]*L,Oe=0|q,le=C[I++]*L,j=0|ee,Z+=u.adj43[Ee],K=0|le,q+=u.adj43[Oe],B[z++]=0|Z,ee+=u.adj43[j],B[z++]=0|q,le+=u.adj43[K],B[z++]=0|ee,B[z++]=0|le}if(ie!=0){var Z,q,Ee,Oe;Z=C[I++]*L,q=C[I++]*L,Ee=0|Z,Oe=0|q,Z+=u.adj43[Ee],q+=u.adj43[Oe],B[z++]=0|Z,B[z++]=0|q}}function D(J,L,C,I,B){var z,ie,Z=0,q,ee=0,le=0,Ee=0,Oe=L,j=0,K=Oe,re=0,he=J,_e=0;for(q=B!=null&&I.global_gain==B.global_gain,I.block_type==i.SHORT_TYPE?ie=38:ie=21,z=0;z<=ie;z++){var De=-1;if((q||I.block_type==i.NORM_TYPE)&&(De=I.global_gain-(I.scalefac[z]+(I.preflag!=0?u.pretab[z]:0)<<I.scalefac_scale+1)-I.subblock_gain[I.window[z]]*8),s(I.width[z]>=0),q&&B.step[z]==De)ee!=0&&(_(ee,C,he,_e,K,re),ee=0),le!=0&&(m(le,C,he,_e,K,re),le=0);else{var v=I.width[z];if(Z+I.width[z]>I.max_nonzero_coeff){var P;P=I.max_nonzero_coeff-Z+1,t.fill(L,I.max_nonzero_coeff,576,0),v=P,v<0&&(v=0),z=ie+1}if(ee==0&&le==0&&(K=Oe,re=j,he=J,_e=Ee),B!=null&&B.sfb_count1>0&&z>=B.sfb_count1&&B.step[z]>0&&De>=B.step[z]?(ee!=0&&(_(ee,C,he,_e,K,re),ee=0,K=Oe,re=j,he=J,_e=Ee),le+=v):(le!=0&&(m(le,C,he,_e,K,re),le=0,K=Oe,re=j,he=J,_e=Ee),ee+=v),v<=0){le!=0&&(m(le,C,he,_e,K,re),le=0),ee!=0&&(_(ee,C,he,_e,K,re),ee=0);break}}z<=ie&&(j+=I.width[z],Ee+=I.width[z],Z+=I.width[z])}ee!=0&&(_(ee,C,he,_e,K,re),ee=0),le!=0&&(m(le,C,he,_e,K,re),le=0)}function O(J,L,C){var I=0,B=0;do{var z=J[L++],ie=J[L++];I<z&&(I=z),B<ie&&(B=ie)}while(L<C);return I<B&&(I=B),I}function x(J,L,C,I,B,z){var ie=o.ht[I].xlen*65536+o.ht[B].xlen,Z=0,q;do{var ee=J[L++],le=J[L++];ee!=0&&(ee>14&&(ee=15,Z+=ie),ee*=16),le!=0&&(le>14&&(le=15,Z+=ie),ee+=le),Z+=o.largetbl[ee]}while(L<C);return q=Z&65535,Z>>=16,Z>q&&(Z=q,I=B),z.bits+=Z,I}function w(J,L,C,I){var B=0,z=o.ht[1].hlen;do{var ie=J[L+0]*2+J[L+1];L+=2,B+=z[ie]}while(L<C);return I.bits+=B,1}function N(J,L,C,I,B){var z=0,ie,Z=o.ht[I].xlen,q;I==2?q=o.table23:q=o.table56;do{var ee=J[L+0]*Z+J[L+1];L+=2,z+=q[ee]}while(L<C);return ie=z&65535,z>>=16,z>ie&&(z=ie,I++),B.bits+=z,I}function V(J,L,C,I,B){var z=0,ie=0,Z=0,q=o.ht[I].xlen,ee=o.ht[I].hlen,le=o.ht[I+1].hlen,Ee=o.ht[I+2].hlen;do{var Oe=J[L+0]*q+J[L+1];L+=2,z+=ee[Oe],ie+=le[Oe],Z+=Ee[Oe]}while(L<C);var j=I;return z>ie&&(z=ie,j++),z>Z&&(z=Z,j=I+2),B.bits+=z,j}var p=[1,2,5,7,7,10,10,13,13,13,13,13,13,13,13];function k(J,L,C,I){var B=O(J,L,C);switch(B){case 0:return B;case 1:return w(J,L,C,I);case 2:case 3:return N(J,L,C,p[B-1],I);case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:return V(J,L,C,p[B-1],I);default:if(B>l.IXMAX_VAL)return I.bits=l.LARGE_BITS,-1;B-=15;var z;for(z=24;z<32&&!(o.ht[z].linmax>=B);z++);var ie;for(ie=z-8;ie<24&&!(o.ht[ie].linmax>=B);ie++);return x(J,L,C,ie,z,I)}}this.noquant_count_bits=function(J,L,C){var I=L.l3_enc,B=Math.min(576,L.max_nonzero_coeff+2>>1<<1);for(C!=null&&(C.sfb_count1=0);B>1&&!(I[B-1]|I[B-2]);B-=2);L.count1=B;for(var z=0,ie=0;B>3;B-=4){var Z;if(((I[B-1]|I[B-2]|I[B-3]|I[B-4])&2147483647)>1)break;Z=((I[B-4]*2+I[B-3])*2+I[B-2])*2+I[B-1],z+=o.t32l[Z],ie+=o.t33l[Z]}var q=z;if(L.count1table_select=0,z>ie&&(q=ie,L.count1table_select=1),L.count1bits=q,L.big_values=B,B==0)return q;if(L.block_type==i.SHORT_TYPE)z=3*J.scalefac_band.s[3],z>L.big_values&&(z=L.big_values),ie=L.big_values;else if(L.block_type==i.NORM_TYPE){if(z=L.region0_count=J.bv_scf[B-2],ie=L.region1_count=J.bv_scf[B-1],s(z+ie+2<i.SBPSY_l),ie=J.scalefac_band.l[z+ie+2],z=J.scalefac_band.l[z+1],ie<B){var ee=new f(q);L.table_select[2]=k(I,ie,B,ee),q=ee.bits}}else L.region0_count=7,L.region1_count=i.SBMAX_l-1-7-1,z=J.scalefac_band.l[8],ie=B,z>ie&&(z=ie);if(z=Math.min(z,B),ie=Math.min(ie,B),0<z){var ee=new f(q);L.table_select[0]=k(I,0,z,ee),q=ee.bits}if(z<ie){var ee=new f(q);L.table_select[1]=k(I,z,ie,ee),q=ee.bits}if(J.use_best_huffman==2&&(L.part2_3_length=q,best_huffman_divide(J,L),q=L.part2_3_length),C!=null&&L.block_type==i.NORM_TYPE){for(var le=0;J.scalefac_band.l[le]<L.big_values;)le++;C.sfb_count1=le}return q},this.count_bits=function(J,L,C,I){var B=C.l3_enc,z=l.IXMAX_VAL/u.IPOW20(C.global_gain);if(C.xrpow_max>z)return l.LARGE_BITS;if(D(L,B,u.IPOW20(C.global_gain),C,I),J.substep_shaping&2)for(var ie=0,Z=C.global_gain+C.scalefac_scale,q=.634521682242439/u.IPOW20(Z),ee=0;ee<C.sfbmax;ee++){var le=C.width[ee];if(J.pseudohalf[ee]==0)ie+=le;else{var Ee;for(Ee=ie,ie+=le;Ee<ie;++Ee)B[Ee]=L[Ee]>=q?B[Ee]:0}}return this.noquant_count_bits(J,C,I)};function S(J,L,C,I,B,z,ie){for(var Z=L.big_values,q=0;q<=22;q++)I[q]=l.LARGE_BITS;for(var q=0;q<16;q++){var ee=J.scalefac_band.l[q+1];if(ee>=Z)break;var le=0,Ee=new f(le),Oe=k(C,0,ee,Ee);le=Ee.bits;for(var j=0;j<8;j++){var K=J.scalefac_band.l[q+j+2];if(K>=Z)break;var re=le;Ee=new f(re);var he=k(C,ee,K,Ee);re=Ee.bits,I[q+j]>re&&(I[q+j]=re,B[q+j]=q,z[q+j]=Oe,ie[q+j]=he)}}}function b(J,L,C,I,B,z,ie,Z){for(var q=L.big_values,ee=2;ee<i.SBMAX_l+1;ee++){var le=J.scalefac_band.l[ee];if(le>=q)break;var Ee=B[ee-2]+L.count1bits;if(C.part2_3_length<=Ee)break;var Oe=new f(Ee),j=k(I,le,q,Oe);Ee=Oe.bits,!(C.part2_3_length<=Ee)&&(C.assign(L),C.part2_3_length=Ee,C.region0_count=z[ee-2],C.region1_count=ee-2-z[ee-2],C.table_select[0]=ie[ee-2],C.table_select[1]=Z[ee-2],C.table_select[2]=j)}}this.best_huffman_divide=function(J,L){var C=new a,I=L.l3_enc,B=r(23),z=r(23),ie=r(23),Z=r(23);if(!(L.block_type==i.SHORT_TYPE&&J.mode_gr==1)){C.assign(L),L.block_type==i.NORM_TYPE&&(S(J,L,I,B,z,ie,Z),b(J,C,L,I,B,z,ie,Z));var q=C.big_values;if(!(q==0||(I[q-2]|I[q-1])>1)&&(q=L.count1+2,!(q>576))){C.assign(L),C.count1=q;for(var ee=0,le=0;q>C.big_values;q-=4){var Ee=((I[q-4]*2+I[q-3])*2+I[q-2])*2+I[q-1];ee+=o.t32l[Ee],le+=o.t33l[Ee]}if(C.big_values=q,C.count1table_select=0,ee>le&&(ee=le,C.count1table_select=1),C.count1bits=ee,C.block_type==i.NORM_TYPE)b(J,C,L,I,B,z,ie,Z);else{if(C.part2_3_length=ee,ee=J.scalefac_band.l[8],ee>q&&(ee=q),ee>0){var Oe=new f(C.part2_3_length);C.table_select[0]=k(I,0,ee,Oe),C.part2_3_length=Oe.bits}if(q>ee){var Oe=new f(C.part2_3_length);C.table_select[1]=k(I,ee,q,Oe),C.part2_3_length=Oe.bits}L.part2_3_length>C.part2_3_length&&L.assign(C)}}}};var E=[1,1,1,1,8,2,2,2,4,4,4,8,8,8,16,16],T=[1,2,4,8,1,2,4,8,2,4,8,2,4,8,4,8],M=[0,0,0,0,3,1,1,1,2,2,2,3,3,3,4,4],H=[0,1,2,3,0,1,2,3,1,2,3,1,2,3,2,3];c.slen1_tab=M,c.slen2_tab=H;function y(J,L){for(var C,I=L.tt[1][J],B=L.tt[0][J],z=0;z<o.scfsi_band.length-1;z++){for(C=o.scfsi_band[z];C<o.scfsi_band[z+1]&&!(B.scalefac[C]!=I.scalefac[C]&&I.scalefac[C]>=0);C++);if(C==o.scfsi_band[z+1]){for(C=o.scfsi_band[z];C<o.scfsi_band[z+1];C++)I.scalefac[C]=-1;L.scfsi[J][z]=1}}var ie=0,Z=0;for(C=0;C<11;C++)I.scalefac[C]!=-1&&(Z++,ie<I.scalefac[C]&&(ie=I.scalefac[C]));for(var q=0,ee=0;C<i.SBPSY_l;C++)I.scalefac[C]!=-1&&(ee++,q<I.scalefac[C]&&(q=I.scalefac[C]));for(var z=0;z<16;z++)if(ie<E[z]&&q<T[z]){var le=M[z]*Z+H[z]*ee;I.part2_length>le&&(I.part2_length=le,I.scalefac_compress=z)}}this.best_scalefac_store=function(J,L,C,I){var B=I.tt[L][C],z,ie,Z,q,ee=0;for(Z=0,z=0;z<B.sfbmax;z++){var le=B.width[z];for(Z+=le,q=-le;q<0&&B.l3_enc[q+Z]==0;q++);q==0&&(B.scalefac[z]=ee=-2)}if(B.scalefac_scale==0&&B.preflag==0){var Ee=0;for(z=0;z<B.sfbmax;z++)B.scalefac[z]>0&&(Ee|=B.scalefac[z]);if(!(Ee&1)&&Ee!=0){for(z=0;z<B.sfbmax;z++)B.scalefac[z]>0&&(B.scalefac[z]>>=1);B.scalefac_scale=ee=1}}if(B.preflag==0&&B.block_type!=i.SHORT_TYPE&&J.mode_gr==2){for(z=11;z<i.SBPSY_l&&!(B.scalefac[z]<u.pretab[z]&&B.scalefac[z]!=-2);z++);if(z==i.SBPSY_l){for(z=11;z<i.SBPSY_l;z++)B.scalefac[z]>0&&(B.scalefac[z]-=u.pretab[z]);B.preflag=ee=1}}for(ie=0;ie<4;ie++)I.scfsi[C][ie]=0;for(J.mode_gr==2&&L==1&&I.tt[0][C].block_type!=i.SHORT_TYPE&&I.tt[1][C].block_type!=i.SHORT_TYPE&&(y(C,I),ee=0),z=0;z<B.sfbmax;z++)B.scalefac[z]==-2&&(B.scalefac[z]=0);ee!=0&&(J.mode_gr==2?this.scale_bitcount(B):this.scale_bitcount_lsf(J,B))};function A(J,L){for(var C=0;C<L;++C)if(J[C]<0)return!1;return!0}var W=[0,18,36,54,54,36,54,72,54,72,90,72,90,108,108,126],X=[0,18,36,54,51,35,53,71,52,70,88,69,87,105,104,122],ne=[0,10,20,30,33,21,31,41,32,42,52,43,53,63,64,74];this.scale_bitcount=function(J){var L,C,I=0,B=0,z,ie=J.scalefac;if(s(A(ie,J.sfbmax)),J.block_type==i.SHORT_TYPE)z=W,J.mixed_block_flag!=0&&(z=X);else if(z=ne,J.preflag==0){for(C=11;C<i.SBPSY_l&&!(ie[C]<u.pretab[C]);C++);if(C==i.SBPSY_l)for(J.preflag=1,C=11;C<i.SBPSY_l;C++)ie[C]-=u.pretab[C]}for(C=0;C<J.sfbdivide;C++)I<ie[C]&&(I=ie[C]);for(;C<J.sfbmax;C++)B<ie[C]&&(B=ie[C]);for(J.part2_length=l.LARGE_BITS,L=0;L<16;L++)I<E[L]&&B<T[L]&&J.part2_length>z[L]&&(J.part2_length=z[L],J.scalefac_compress=L);return J.part2_length==l.LARGE_BITS};var Q=[[15,15,7,7],[15,15,7,0],[7,3,0,0],[15,31,31,0],[7,7,7,0],[3,3,0,0]];this.scale_bitcount_lsf=function(J,L){var C,I,B,z,ie,Z,q,ee,le=r(4),Ee=L.scalefac;for(L.preflag!=0?C=2:C=0,q=0;q<4;q++)le[q]=0;if(L.block_type==i.SHORT_TYPE){I=1;var Oe=u.nr_of_sfb_block[C][I];for(ee=0,B=0;B<4;B++)for(z=Oe[B]/3,q=0;q<z;q++,ee++)for(ie=0;ie<3;ie++)Ee[ee*3+ie]>le[B]&&(le[B]=Ee[ee*3+ie])}else{I=0;var Oe=u.nr_of_sfb_block[C][I];for(ee=0,B=0;B<4;B++)for(z=Oe[B],q=0;q<z;q++,ee++)Ee[ee]>le[B]&&(le[B]=Ee[ee])}for(Z=!1,B=0;B<4;B++)le[B]>Q[C][B]&&(Z=!0);if(!Z){var j,K,re,he;for(L.sfb_partition_table=u.nr_of_sfb_block[C][I],B=0;B<4;B++)L.slen[B]=ce[le[B]];switch(j=L.slen[0],K=L.slen[1],re=L.slen[2],he=L.slen[3],C){case 0:L.scalefac_compress=(j*5+K<<4)+(re<<2)+he;break;case 1:L.scalefac_compress=400+(j*5+K<<2)+re;break;case 2:L.scalefac_compress=500+j*3+K;break;default:e.err.printf(`intensity stereo not implemented yet
`);break}}if(!Z)for(s(L.sfb_partition_table!=null),L.part2_length=0,B=0;B<4;B++)L.part2_length+=L.slen[B]*L.sfb_partition_table[B];return Z};var ce=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4];this.huffman_init=function(J){for(var L=2;L<=576;L+=2){for(var C=0,I;J.scalefac_band.l[++C]<L;);for(I=d[C][0];J.scalefac_band.l[I+1]>L;)I--;for(I<0&&(I=d[C][0]),J.bv_scf[L-2]=I,I=d[C][1];J.scalefac_band.l[I+J.bv_scf[L-2]+2]>L;)I--;I<0&&(I=d[C][1]),J.bv_scf[L-1]=I}}}return Dd=c,Dd}var Ld,m2;function H0(){if(m2)return Ld;m2=1;var n=Bt,e=n.System,t=n.Arrays,r=n.new_byte,s=n.new_float_n,i=n.new_int,o=n.assert,a=xT(),l=U0,c=Hn(),u=kf;f.EQ=function(d,m){return Math.abs(d)>Math.abs(m)?Math.abs(d-m)<=Math.abs(d)*1e-6:Math.abs(d-m)<=Math.abs(m)*1e-6},f.NEQ=function(d,m){return!f.EQ(d,m)};function f(){var d=j0(),m=this,_=32773,D=null,O=null,x=null,w=null;this.setModules=function(L,C,I,B){D=L,O=C,x=I,w=B};var N=null,V=0,p=0,k=0;this.getframebits=function(L){var C=L.internal_flags,I;C.bitrate_index!=0?I=l.bitrate_table[L.version][C.bitrate_index]:I=L.brate;var B=0|(L.version+1)*72e3*I/L.out_samplerate+C.padding;return 8*B};function S(L){e.arraycopy(L.header[L.w_ptr].buf,0,N,p,L.sideinfo_len),p+=L.sideinfo_len,V+=L.sideinfo_len*8,L.w_ptr=L.w_ptr+1&u.MAX_HEADER_BUF-1}function b(L,C,I){for(;I>0;){var B;k==0&&(k=8,p++,o(p<d.LAME_MAXMP3BUFFER),o(L.header[L.w_ptr].write_timing>=V),L.header[L.w_ptr].write_timing==V&&S(L),N[p]=0),B=Math.min(I,k),I-=B,k-=B,N[p]|=C>>I<<k,V+=B}}function E(L,C,I){for(;I>0;){var B;k==0&&(k=8,p++,o(p<d.LAME_MAXMP3BUFFER),N[p]=0),B=Math.min(I,k),I-=B,k-=B,N[p]|=C>>I<<k,V+=B}}function T(L,C){var I=L.internal_flags,B;if(C>=8&&(b(I,76,8),C-=8),C>=8&&(b(I,65,8),C-=8),C>=8&&(b(I,77,8),C-=8),C>=8&&(b(I,69,8),C-=8),C>=32){var z=x.getLameShortVersion();if(C>=32)for(B=0;B<z.length&&C>=8;++B)C-=8,b(I,z.charAt(B),8)}for(;C>=1;C-=1)b(I,I.ancillary_flag,1),I.ancillary_flag^=L.disable_reservoir?0:1}function M(L,C,I){for(var B=L.header[L.h_ptr].ptr;I>0;){var z=Math.min(I,8-(B&7));I-=z,L.header[L.h_ptr].buf[B>>3]|=C>>I<<8-(B&7)-z,B+=z}L.header[L.h_ptr].ptr=B}function H(L,C){L<<=8;for(var I=0;I<8;I++)L<<=1,C<<=1,(C^L)&65536&&(C^=_);return C}this.CRC_writeheader=function(L,C){var I=65535;I=H(C[2]&255,I),I=H(C[3]&255,I);for(var B=6;B<L.sideinfo_len;B++)I=H(C[B]&255,I);C[4]=byte(I>>8),C[5]=byte(I&255)};function y(L,C){var I=L.internal_flags,B,z,ie;if(B=I.l3_side,I.header[I.h_ptr].ptr=0,t.fill(I.header[I.h_ptr].buf,0,I.sideinfo_len,0),L.out_samplerate<16e3?M(I,4094,12):M(I,4095,12),M(I,L.version,1),M(I,1,2),M(I,L.error_protection?0:1,1),M(I,I.bitrate_index,4),M(I,I.samplerate_index,2),M(I,I.padding,1),M(I,L.extension,1),M(I,L.mode.ordinal(),2),M(I,I.mode_ext,2),M(I,L.copyright,1),M(I,L.original,1),M(I,L.emphasis,2),L.error_protection&&M(I,0,16),L.version==1){for(o(B.main_data_begin>=0),M(I,B.main_data_begin,9),I.channels_out==2?M(I,B.private_bits,3):M(I,B.private_bits,5),ie=0;ie<I.channels_out;ie++){var Z;for(Z=0;Z<4;Z++)M(I,B.scfsi[ie][Z],1)}for(z=0;z<2;z++)for(ie=0;ie<I.channels_out;ie++){var q=B.tt[z][ie];M(I,q.part2_3_length+q.part2_length,12),M(I,q.big_values/2,9),M(I,q.global_gain,8),M(I,q.scalefac_compress,4),q.block_type!=c.NORM_TYPE?(M(I,1,1),M(I,q.block_type,2),M(I,q.mixed_block_flag,1),q.table_select[0]==14&&(q.table_select[0]=16),M(I,q.table_select[0],5),q.table_select[1]==14&&(q.table_select[1]=16),M(I,q.table_select[1],5),M(I,q.subblock_gain[0],3),M(I,q.subblock_gain[1],3),M(I,q.subblock_gain[2],3)):(M(I,0,1),q.table_select[0]==14&&(q.table_select[0]=16),M(I,q.table_select[0],5),q.table_select[1]==14&&(q.table_select[1]=16),M(I,q.table_select[1],5),q.table_select[2]==14&&(q.table_select[2]=16),M(I,q.table_select[2],5),o(0<=q.region0_count&&q.region0_count<16),o(0<=q.region1_count&&q.region1_count<8),M(I,q.region0_count,4),M(I,q.region1_count,3)),M(I,q.preflag,1),M(I,q.scalefac_scale,1),M(I,q.count1table_select,1)}}else for(o(B.main_data_begin>=0),M(I,B.main_data_begin,8),M(I,B.private_bits,I.channels_out),z=0,ie=0;ie<I.channels_out;ie++){var q=B.tt[z][ie];M(I,q.part2_3_length+q.part2_length,12),M(I,q.big_values/2,9),M(I,q.global_gain,8),M(I,q.scalefac_compress,9),q.block_type!=c.NORM_TYPE?(M(I,1,1),M(I,q.block_type,2),M(I,q.mixed_block_flag,1),q.table_select[0]==14&&(q.table_select[0]=16),M(I,q.table_select[0],5),q.table_select[1]==14&&(q.table_select[1]=16),M(I,q.table_select[1],5),M(I,q.subblock_gain[0],3),M(I,q.subblock_gain[1],3),M(I,q.subblock_gain[2],3)):(M(I,0,1),q.table_select[0]==14&&(q.table_select[0]=16),M(I,q.table_select[0],5),q.table_select[1]==14&&(q.table_select[1]=16),M(I,q.table_select[1],5),q.table_select[2]==14&&(q.table_select[2]=16),M(I,q.table_select[2],5),o(0<=q.region0_count&&q.region0_count<16),o(0<=q.region1_count&&q.region1_count<8),M(I,q.region0_count,4),M(I,q.region1_count,3)),M(I,q.scalefac_scale,1),M(I,q.count1table_select,1)}L.error_protection&&CRC_writeheader(I,I.header[I.h_ptr].buf);{var ee=I.h_ptr;o(I.header[ee].ptr==I.sideinfo_len*8),I.h_ptr=ee+1&u.MAX_HEADER_BUF-1,I.header[I.h_ptr].write_timing=I.header[ee].write_timing+C,I.h_ptr==I.w_ptr&&e.err.println(`Error: MAX_HEADER_BUF too small in bitstream.c 
`)}}function A(L,C){var I=l.ht[C.count1table_select+32],B,z=0,ie=C.big_values,Z=C.big_values;for(o(C.count1table_select<2),B=(C.count1-C.big_values)/4;B>0;--B){var q=0,ee=0,le;le=C.l3_enc[ie+0],le!=0&&(ee+=8,C.xr[Z+0]<0&&q++),le=C.l3_enc[ie+1],le!=0&&(ee+=4,q*=2,C.xr[Z+1]<0&&q++),le=C.l3_enc[ie+2],le!=0&&(ee+=2,q*=2,C.xr[Z+2]<0&&q++),le=C.l3_enc[ie+3],le!=0&&(ee++,q*=2,C.xr[Z+3]<0&&q++),ie+=4,Z+=4,b(L,q+I.table[ee],I.hlen[ee]),z+=I.hlen[ee]}return z}function W(L,C,I,B,z){var ie=l.ht[C],Z=0;if(C==0)return Z;for(var q=I;q<B;q+=2){var ee=0,le=0,Ee=ie.xlen,Oe=ie.xlen,j=0,K=z.l3_enc[q],re=z.l3_enc[q+1];if(K!=0&&(z.xr[q]<0&&j++,ee--),C>15){if(K>14){var he=K-15;o(he<=ie.linmax),j|=he<<1,le=Ee,K=15}if(re>14){var _e=re-15;o(_e<=ie.linmax),j<<=Ee,j|=_e,le+=Ee,re=15}Oe=16}re!=0&&(j<<=1,z.xr[q+1]<0&&j++,ee--),K=K*Oe+re,le-=ee,ee+=ie.hlen[K],b(L,ie.table[K],ee),b(L,j,le),Z+=ee+le}return Z}function X(L,C){var I=3*L.scalefac_band.s[3];I>C.big_values&&(I=C.big_values);var B=W(L,C.table_select[0],0,I,C);return B+=W(L,C.table_select[1],I,C.big_values,C),B}function ne(L,C){var I,B,z,ie;I=C.big_values;var Z=C.region0_count+1;return o(Z<L.scalefac_band.l.length),z=L.scalefac_band.l[Z],Z+=C.region1_count+1,o(Z<L.scalefac_band.l.length),ie=L.scalefac_band.l[Z],z>I&&(z=I),ie>I&&(ie=I),B=W(L,C.table_select[0],0,z,C),B+=W(L,C.table_select[1],z,ie,C),B+=W(L,C.table_select[2],ie,I,C),B}function Q(L){var C,I,B,z,ie=0,Z=L.internal_flags,q=Z.l3_side;if(L.version==1)for(C=0;C<2;C++)for(I=0;I<Z.channels_out;I++){var ee=q.tt[C][I],le=a.slen1_tab[ee.scalefac_compress],Ee=a.slen2_tab[ee.scalefac_compress];for(z=0,B=0;B<ee.sfbdivide;B++)ee.scalefac[B]!=-1&&(b(Z,ee.scalefac[B],le),z+=le);for(;B<ee.sfbmax;B++)ee.scalefac[B]!=-1&&(b(Z,ee.scalefac[B],Ee),z+=Ee);o(z==ee.part2_length),ee.block_type==c.SHORT_TYPE?z+=X(Z,ee):z+=ne(Z,ee),z+=A(Z,ee),o(z==ee.part2_3_length+ee.part2_length),ie+=z}else for(C=0,I=0;I<Z.channels_out;I++){var ee=q.tt[C][I],Oe,j,K=0;if(o(ee.sfb_partition_table!=null),z=0,B=0,j=0,ee.block_type==c.SHORT_TYPE){for(;j<4;j++){var re=ee.sfb_partition_table[j]/3,he=ee.slen[j];for(Oe=0;Oe<re;Oe++,B++)b(Z,Math.max(ee.scalefac[B*3+0],0),he),b(Z,Math.max(ee.scalefac[B*3+1],0),he),b(Z,Math.max(ee.scalefac[B*3+2],0),he),K+=3*he}z+=X(Z,ee)}else{for(;j<4;j++){var re=ee.sfb_partition_table[j],he=ee.slen[j];for(Oe=0;Oe<re;Oe++,B++)b(Z,Math.max(ee.scalefac[B],0),he),K+=he}z+=ne(Z,ee)}z+=A(Z,ee),o(z==ee.part2_3_length),o(K==ee.part2_length),ie+=K+z}return ie}function ce(){this.total=0}function J(L,C){var I=L.internal_flags,B,z,ie,Z,q;return q=I.w_ptr,Z=I.h_ptr-1,Z==-1&&(Z=u.MAX_HEADER_BUF-1),B=I.header[Z].write_timing-V,C.total=B,B>=0&&(z=1+Z-q,Z<q&&(z=1+Z-q+u.MAX_HEADER_BUF),B-=z*8*I.sideinfo_len),ie=m.getframebits(L),B+=ie,C.total+=ie,C.total%8!=0?C.total=1+C.total/8:C.total=C.total/8,C.total+=p+1,B<0&&e.err.println(`strange error flushing buffer ... 
`),B}this.flush_bitstream=function(L){var C=L.internal_flags,I,B,z=C.h_ptr-1;if(z==-1&&(z=u.MAX_HEADER_BUF-1),I=C.l3_side,!((B=J(L,new ce))<0)){if(T(L,B),o(C.header[z].write_timing+this.getframebits(L)==V),C.ResvSize=0,I.main_data_begin=0,C.findReplayGain){var ie=D.GetTitleGain(C.rgdata);o(NEQ(ie,GainAnalysis.GAIN_NOT_ENOUGH_SAMPLES)),C.RadioGain=Math.floor(ie*10+.5)|0}C.findPeakSample&&(C.noclipGainChange=Math.ceil(Math.log10(C.PeakSample/32767)*20*10)|0,C.noclipGainChange>0&&(EQ(L.scale,1)||EQ(L.scale,0))?C.noclipScale=Math.floor(32767/C.PeakSample*100)/100:C.noclipScale=-1)}},this.add_dummy_byte=function(L,C,I){for(var B=L.internal_flags,z;I-- >0;)for(E(B,C,8),z=0;z<u.MAX_HEADER_BUF;++z)B.header[z].write_timing+=8},this.format_bitstream=function(L){var C=L.internal_flags,I;I=C.l3_side;var B=this.getframebits(L);T(L,I.resvDrain_pre),y(L,B);var z=8*C.sideinfo_len;if(z+=Q(L),T(L,I.resvDrain_post),z+=I.resvDrain_post,I.main_data_begin+=(B-z)/8,J(L,new ce)!=C.ResvSize&&e.err.println("Internal buffer inconsistency. flushbits <> ResvSize"),I.main_data_begin*8!=C.ResvSize&&(e.err.printf(`bit reservoir error: 
l3_side.main_data_begin: %d 
Resvoir size:             %d 
resv drain (post)         %d 
resv drain (pre)          %d 
header and sideinfo:      %d 
data bits:                %d 
total bits:               %d (remainder: %d) 
bitsperframe:             %d 
`,8*I.main_data_begin,C.ResvSize,I.resvDrain_post,I.resvDrain_pre,8*C.sideinfo_len,z-I.resvDrain_post-8*C.sideinfo_len,z,z%8,B),e.err.println("This is a fatal error.  It has several possible causes:"),e.err.println("90%%  LAME compiled with buggy version of gcc using advanced optimizations"),e.err.println(" 9%%  Your system is overclocked"),e.err.println(" 1%%  bug in LAME encoding library"),C.ResvSize=I.main_data_begin*8),V>1e9){var ie;for(ie=0;ie<u.MAX_HEADER_BUF;++ie)C.header[ie].write_timing-=V;V=0}return 0},this.copy_buffer=function(L,C,I,B,z){var ie=p+1;if(ie<=0)return 0;if(B!=0&&ie>B)return-1;if(e.arraycopy(N,0,C,I,ie),p=-1,k=0,z!=0){var Z=i(1);if(Z[0]=L.nMusicCRC,w.updateMusicCRC(Z,C,I,ie),L.nMusicCRC=Z[0],ie>0&&(L.VBR_seek_table.nBytesWritten+=ie),L.decode_on_the_fly){for(var q=s([2,1152]),ee=ie,le=-1,Ee;le!=0;)if(le=O.hip_decode1_unclipped(L.hip,C,I,ee,q[0],q[1]),ee=0,le==-1&&(le=0),le>0){if(L.findPeakSample){for(Ee=0;Ee<le;Ee++)q[0][Ee]>L.PeakSample?L.PeakSample=q[0][Ee]:-q[0][Ee]>L.PeakSample&&(L.PeakSample=-q[0][Ee]);if(L.channels_out>1)for(Ee=0;Ee<le;Ee++)q[1][Ee]>L.PeakSample?L.PeakSample=q[1][Ee]:-q[1][Ee]>L.PeakSample&&(L.PeakSample=-q[1][Ee])}if(L.findReplayGain&&D.AnalyzeSamples(L.rgdata,q[0],0,q[1],0,le,L.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6}}}return ie},this.init_bit_stream_w=function(L){N=r(d.LAME_MAXMP3BUFFER),L.h_ptr=L.w_ptr=0,L.header[L.h_ptr].write_timing=0,p=-1,k=0,V=0}}return Ld=f,Ld}var Vd,g2;function j0(){if(g2)return Vd;g2=1;var n=Bt,e=n.System,t=n.VbrMode,r=n.ShortBlock,s=n.new_float,i=n.new_int_n,o=n.new_short_n,a=n.assert,l=KL,c=YL,u=kf,f=bV,d=EV,m=kV,_=H0(),D=U0,O=Hn();function x(){var w=Bc,N=this,V=128*1024;x.V9=410,x.V8=420,x.V7=430,x.V6=440,x.V5=450,x.V4=460,x.V3=470,x.V2=480,x.V1=490,x.V0=500,x.R3MIX=1e3,x.STANDARD=1001,x.EXTREME=1002,x.INSANE=1003,x.STANDARD_FAST=1004,x.EXTREME_FAST=1005,x.MEDIUM=1006,x.MEDIUM_FAST=1007;var p=16384+V;x.LAME_MAXMP3BUFFER=p;var k,S,b,E,T,M=new l,H,y,A;this.enc=new O,this.setModules=function(v,P,me,fe,Se,Re,Ae,Te,Ne){k=v,S=P,b=me,E=fe,T=Se,H=Re,y=Te,A=Ne,this.enc.setModules(S,M,E,H)};function W(){this.mask_adjust=0,this.mask_adjust_short=0,this.bo_l_weight=s(O.SBMAX_l),this.bo_s_weight=s(O.SBMAX_s)}function X(){this.lowerlimit=0}function ne(v,P){this.lowpass=P}var Q=4294479419;function ce(v){var P;return v.class_id=Q,P=v.internal_flags=new u,v.mode=w.NOT_SET,v.original=1,v.in_samplerate=44100,v.num_channels=2,v.num_samples=-1,v.bWriteVbrTag=!0,v.quality=-1,v.short_blocks=null,P.subblock_gain=-1,v.lowpassfreq=0,v.highpassfreq=0,v.lowpasswidth=-1,v.highpasswidth=-1,v.VBR=t.vbr_off,v.VBR_q=4,v.ATHcurve=-1,v.VBR_mean_bitrate_kbps=128,v.VBR_min_bitrate_kbps=0,v.VBR_max_bitrate_kbps=0,v.VBR_hard_min=0,P.VBR_min_bitrate=1,P.VBR_max_bitrate=13,v.quant_comp=-1,v.quant_comp_short=-1,v.msfix=-1,P.resample_ratio=1,P.OldValue[0]=180,P.OldValue[1]=180,P.CurrentStep[0]=4,P.CurrentStep[1]=4,P.masking_lower=1,P.nsPsy.attackthre=-1,P.nsPsy.attackthre_s=-1,v.scale=-1,v.athaa_type=-1,v.ATHtype=-1,v.athaa_loudapprox=-1,v.athaa_sensitivity=0,v.useTemporal=null,v.interChRatio=-1,P.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY,v.encoder_padding=0,P.mf_size=O.ENCDELAY-O.MDCTDELAY,v.findReplayGain=!1,v.decode_on_the_fly=!1,P.decode_on_the_fly=!1,P.findReplayGain=!1,P.findPeakSample=!1,P.RadioGain=0,P.AudiophileGain=0,P.noclipGainChange=0,P.noclipScale=-1,v.preset=0,v.write_id3tag_automatic=!0,0}this.lame_init=function(){var v=new c;return ce(v),v.lame_allocated_gfp=1,v};function J(v){return v>1?0:v<=0?1:Math.cos(Math.PI/2*v)}this.nearestBitrateFullIndex=function(v){var P=[8,16,24,32,40,48,56,64,80,96,112,128,160,192,224,256,320],me=0,fe=0,Se=0,Re=0;Re=P[16],Se=16,fe=P[16],me=16;for(var Ae=0;Ae<16;Ae++)if(Math.max(v,P[Ae+1])!=v){Re=P[Ae+1],Se=Ae+1,fe=P[Ae],me=Ae;break}return Re-v>v-fe?me:Se};function L(v,P){var me=44100;return P>=48e3?me=48e3:P>=44100?me=44100:P>=32e3?me=32e3:P>=24e3?me=24e3:P>=22050?me=22050:P>=16e3?me=16e3:P>=12e3?me=12e3:P>=11025?me=11025:P>=8e3&&(me=8e3),v==-1?me:(v<=15960&&(me=44100),v<=15250&&(me=32e3),v<=11220&&(me=24e3),v<=9970&&(me=22050),v<=7230&&(me=16e3),v<=5420&&(me=12e3),v<=4510&&(me=11025),v<=3970&&(me=8e3),P<me?P>44100?48e3:P>32e3?44100:P>24e3?32e3:P>22050?24e3:P>16e3?22050:P>12e3?16e3:P>11025?12e3:P>8e3?11025:8e3:me)}function C(v,P){switch(v){case 44100:return P.version=1,0;case 48e3:return P.version=1,1;case 32e3:return P.version=1,2;case 22050:return P.version=0,0;case 24e3:return P.version=0,1;case 16e3:return P.version=0,2;case 11025:return P.version=0,0;case 12e3:return P.version=0,1;case 8e3:return P.version=0,2;default:return P.version=0,-1}}function I(v,P,me){me<16e3&&(P=2);for(var fe=D.bitrate_table[P][1],Se=2;Se<=14;Se++)D.bitrate_table[P][Se]>0&&Math.abs(D.bitrate_table[P][Se]-v)<Math.abs(fe-v)&&(fe=D.bitrate_table[P][Se]);return fe}function B(v,P,me){me<16e3&&(P=2);for(var fe=0;fe<=14;fe++)if(D.bitrate_table[P][fe]>0&&D.bitrate_table[P][fe]==v)return fe;return-1}function z(v,P){var me=[new ne(8,2e3),new ne(16,3700),new ne(24,3900),new ne(32,5500),new ne(40,7e3),new ne(48,7500),new ne(56,1e4),new ne(64,11e3),new ne(80,13500),new ne(96,15100),new ne(112,15600),new ne(128,17e3),new ne(160,17500),new ne(192,18600),new ne(224,19400),new ne(256,19700),new ne(320,20500)],fe=N.nearestBitrateFullIndex(P);v.lowerlimit=me[fe].lowpass}function ie(v){var P=v.internal_flags,me=32,fe=-1;if(P.lowpass1>0){for(var Se=999,Re=0;Re<=31;Re++){var Ae=Re/31;Ae>=P.lowpass2&&(me=Math.min(me,Re)),P.lowpass1<Ae&&Ae<P.lowpass2&&(Se=Math.min(Se,Re))}Se==999?P.lowpass1=(me-.75)/31:P.lowpass1=(Se-.75)/31,P.lowpass2=me/31}if(P.highpass2>0&&P.highpass2<.9*(.75/31)&&(P.highpass1=0,P.highpass2=0,e.err.println(`Warning: highpass filter disabled.  highpass frequency too small
`)),P.highpass2>0){for(var Te=-1,Re=0;Re<=31;Re++){var Ae=Re/31;Ae<=P.highpass1&&(fe=Math.max(fe,Re)),P.highpass1<Ae&&Ae<P.highpass2&&(Te=Math.max(Te,Re))}P.highpass1=fe/31,Te==-1?P.highpass2=(fe+.75)/31:P.highpass2=(Te+.75)/31}for(var Re=0;Re<32;Re++){var Ne,Ue,Ae=Re/31;P.highpass2>P.highpass1?Ne=J((P.highpass2-Ae)/(P.highpass2-P.highpass1+1e-20)):Ne=1,P.lowpass2>P.lowpass1?Ue=J((Ae-P.lowpass1)/(P.lowpass2-P.lowpass1+1e-20)):Ue=1,P.amp_filter[Re]=Ne*Ue}}function Z(v){var P=v.internal_flags;switch(v.quality){default:case 9:P.psymodel=0,P.noise_shaping=0,P.noise_shaping_amp=0,P.noise_shaping_stop=0,P.use_best_huffman=0,P.full_outer_loop=0;break;case 8:v.quality=7;case 7:P.psymodel=1,P.noise_shaping=0,P.noise_shaping_amp=0,P.noise_shaping_stop=0,P.use_best_huffman=0,P.full_outer_loop=0;break;case 6:P.psymodel=1,P.noise_shaping==0&&(P.noise_shaping=1),P.noise_shaping_amp=0,P.noise_shaping_stop=0,P.subblock_gain==-1&&(P.subblock_gain=1),P.use_best_huffman=0,P.full_outer_loop=0;break;case 5:P.psymodel=1,P.noise_shaping==0&&(P.noise_shaping=1),P.noise_shaping_amp=0,P.noise_shaping_stop=0,P.subblock_gain==-1&&(P.subblock_gain=1),P.use_best_huffman=0,P.full_outer_loop=0;break;case 4:P.psymodel=1,P.noise_shaping==0&&(P.noise_shaping=1),P.noise_shaping_amp=0,P.noise_shaping_stop=0,P.subblock_gain==-1&&(P.subblock_gain=1),P.use_best_huffman=1,P.full_outer_loop=0;break;case 3:P.psymodel=1,P.noise_shaping==0&&(P.noise_shaping=1),P.noise_shaping_amp=1,P.noise_shaping_stop=1,P.subblock_gain==-1&&(P.subblock_gain=1),P.use_best_huffman=1,P.full_outer_loop=0;break;case 2:P.psymodel=1,P.noise_shaping==0&&(P.noise_shaping=1),P.substep_shaping==0&&(P.substep_shaping=2),P.noise_shaping_amp=1,P.noise_shaping_stop=1,P.subblock_gain==-1&&(P.subblock_gain=1),P.use_best_huffman=1,P.full_outer_loop=0;break;case 1:P.psymodel=1,P.noise_shaping==0&&(P.noise_shaping=1),P.substep_shaping==0&&(P.substep_shaping=2),P.noise_shaping_amp=2,P.noise_shaping_stop=1,P.subblock_gain==-1&&(P.subblock_gain=1),P.use_best_huffman=1,P.full_outer_loop=0;break;case 0:P.psymodel=1,P.noise_shaping==0&&(P.noise_shaping=1),P.substep_shaping==0&&(P.substep_shaping=2),P.noise_shaping_amp=2,P.noise_shaping_stop=1,P.subblock_gain==-1&&(P.subblock_gain=1),P.use_best_huffman=1,P.full_outer_loop=0;break}}function q(v){var P=v.internal_flags;v.frameNum=0,v.write_id3tag_automatic&&y.id3tag_write_v2(v),P.bitrate_stereoMode_Hist=i([16,5]),P.bitrate_blockType_Hist=i([16,6]),P.PeakSample=0,v.bWriteVbrTag&&H.InitVbrTag(v)}this.lame_init_params=function(v){var P=v.internal_flags;if(P.Class_ID=0,P.ATH==null&&(P.ATH=new f),P.PSY==null&&(P.PSY=new W),P.rgdata==null&&(P.rgdata=new d),P.channels_in=v.num_channels,P.channels_in==1&&(v.mode=w.MONO),P.channels_out=v.mode==w.MONO?1:2,P.mode_ext=O.MPG_MD_MS_LR,v.mode==w.MONO&&(v.force_ms=!1),v.VBR==t.vbr_off&&v.VBR_mean_bitrate_kbps!=128&&v.brate==0&&(v.brate=v.VBR_mean_bitrate_kbps),v.VBR==t.vbr_off||v.VBR==t.vbr_mtrh||v.VBR==t.vbr_mt||(v.free_format=!1),v.VBR==t.vbr_off&&v.brate==0&&_.EQ(v.compression_ratio,0)&&(v.compression_ratio=11.025),v.VBR==t.vbr_off&&v.compression_ratio>0&&(v.out_samplerate==0&&(v.out_samplerate=map2MP3Frequency(int(.97*v.in_samplerate))),v.brate=0|v.out_samplerate*16*P.channels_out/(1e3*v.compression_ratio),P.samplerate_index=C(v.out_samplerate,v),v.free_format||(v.brate=I(v.brate,v.version,v.out_samplerate))),v.out_samplerate!=0&&(v.out_samplerate<16e3?(v.VBR_mean_bitrate_kbps=Math.max(v.VBR_mean_bitrate_kbps,8),v.VBR_mean_bitrate_kbps=Math.min(v.VBR_mean_bitrate_kbps,64)):v.out_samplerate<32e3?(v.VBR_mean_bitrate_kbps=Math.max(v.VBR_mean_bitrate_kbps,8),v.VBR_mean_bitrate_kbps=Math.min(v.VBR_mean_bitrate_kbps,160)):(v.VBR_mean_bitrate_kbps=Math.max(v.VBR_mean_bitrate_kbps,32),v.VBR_mean_bitrate_kbps=Math.min(v.VBR_mean_bitrate_kbps,320))),v.lowpassfreq==0){var me=16e3;switch(v.VBR){case t.vbr_off:{var fe=new X;z(fe,v.brate),me=fe.lowerlimit;break}case t.vbr_abr:{var fe=new X;z(fe,v.VBR_mean_bitrate_kbps),me=fe.lowerlimit;break}case t.vbr_rh:{var Se=[19500,19e3,18600,18e3,17500,16e3,15600,14900,12500,1e4,3950];if(0<=v.VBR_q&&v.VBR_q<=9){var Re=Se[v.VBR_q],Ae=Se[v.VBR_q+1],Te=v.VBR_q_frac;me=linear_int(Re,Ae,Te)}else me=19500;break}default:{var Se=[19500,19e3,18500,18e3,17500,16500,15500,14500,12500,9500,3950];if(0<=v.VBR_q&&v.VBR_q<=9){var Re=Se[v.VBR_q],Ae=Se[v.VBR_q+1],Te=v.VBR_q_frac;me=linear_int(Re,Ae,Te)}else me=19500}}v.mode==w.MONO&&(v.VBR==t.vbr_off||v.VBR==t.vbr_abr)&&(me*=1.5),v.lowpassfreq=me|0}if(v.out_samplerate==0&&(2*v.lowpassfreq>v.in_samplerate&&(v.lowpassfreq=v.in_samplerate/2),v.out_samplerate=L(v.lowpassfreq|0,v.in_samplerate)),v.lowpassfreq=Math.min(20500,v.lowpassfreq),v.lowpassfreq=Math.min(v.out_samplerate/2,v.lowpassfreq),v.VBR==t.vbr_off&&(v.compression_ratio=v.out_samplerate*16*P.channels_out/(1e3*v.brate)),v.VBR==t.vbr_abr&&(v.compression_ratio=v.out_samplerate*16*P.channels_out/(1e3*v.VBR_mean_bitrate_kbps)),v.bWriteVbrTag||(v.findReplayGain=!1,v.decode_on_the_fly=!1,P.findPeakSample=!1),P.findReplayGain=v.findReplayGain,P.decode_on_the_fly=v.decode_on_the_fly,P.decode_on_the_fly&&(P.findPeakSample=!0),P.findReplayGain&&k.InitGainAnalysis(P.rgdata,v.out_samplerate)==GainAnalysis.INIT_GAIN_ANALYSIS_ERROR)return v.internal_flags=null,-6;switch(P.decode_on_the_fly&&!v.decode_only&&(P.hip!=null&&A.hip_decode_exit(P.hip),P.hip=A.hip_decode_init()),P.mode_gr=v.out_samplerate<=24e3?1:2,v.framesize=576*P.mode_gr,v.encoder_delay=O.ENCDELAY,P.resample_ratio=v.in_samplerate/v.out_samplerate,v.VBR){case t.vbr_mt:case t.vbr_rh:case t.vbr_mtrh:{var Ne=[5.7,6.5,7.3,8.2,10,11.9,13,14,15,16.5];v.compression_ratio=Ne[v.VBR_q]}break;case t.vbr_abr:v.compression_ratio=v.out_samplerate*16*P.channels_out/(1e3*v.VBR_mean_bitrate_kbps);break;default:v.compression_ratio=v.out_samplerate*16*P.channels_out/(1e3*v.brate);break}if(v.mode==w.NOT_SET&&(v.mode=w.JOINT_STEREO),v.highpassfreq>0?(P.highpass1=2*v.highpassfreq,v.highpasswidth>=0?P.highpass2=2*(v.highpassfreq+v.highpasswidth):P.highpass2=1*2*v.highpassfreq,P.highpass1/=v.out_samplerate,P.highpass2/=v.out_samplerate):(P.highpass1=0,P.highpass2=0),v.lowpassfreq>0?(P.lowpass2=2*v.lowpassfreq,v.lowpasswidth>=0?(P.lowpass1=2*(v.lowpassfreq-v.lowpasswidth),P.lowpass1<0&&(P.lowpass1=0)):P.lowpass1=1*2*v.lowpassfreq,P.lowpass1/=v.out_samplerate,P.lowpass2/=v.out_samplerate):(P.lowpass1=0,P.lowpass2=0),ie(v),P.samplerate_index=C(v.out_samplerate,v),P.samplerate_index<0)return v.internal_flags=null,-1;if(v.VBR==t.vbr_off){if(v.free_format)P.bitrate_index=0;else if(v.brate=I(v.brate,v.version,v.out_samplerate),P.bitrate_index=B(v.brate,v.version,v.out_samplerate),P.bitrate_index<=0)return v.internal_flags=null,-1}else P.bitrate_index=1;v.analysis&&(v.bWriteVbrTag=!1),P.pinfo!=null&&(v.bWriteVbrTag=!1),S.init_bit_stream_w(P);for(var Ue=P.samplerate_index+3*v.version+6*(v.out_samplerate<16e3?1:0),Ie=0;Ie<O.SBMAX_l+1;Ie++)P.scalefac_band.l[Ie]=E.sfBandIndex[Ue].l[Ie];for(var Ie=0;Ie<O.PSFB21+1;Ie++){var Je=(P.scalefac_band.l[22]-P.scalefac_band.l[21])/O.PSFB21,dt=P.scalefac_band.l[21]+Ie*Je;P.scalefac_band.psfb21[Ie]=dt}P.scalefac_band.psfb21[O.PSFB21]=576;for(var Ie=0;Ie<O.SBMAX_s+1;Ie++)P.scalefac_band.s[Ie]=E.sfBandIndex[Ue].s[Ie];for(var Ie=0;Ie<O.PSFB12+1;Ie++){var Je=(P.scalefac_band.s[13]-P.scalefac_band.s[12])/O.PSFB12,dt=P.scalefac_band.s[12]+Ie*Je;P.scalefac_band.psfb12[Ie]=dt}P.scalefac_band.psfb12[O.PSFB12]=192,v.version==1?P.sideinfo_len=P.channels_out==1?21:36:P.sideinfo_len=P.channels_out==1?13:21,v.error_protection&&(P.sideinfo_len+=2),q(v),P.Class_ID=Q;{var F;for(F=0;F<19;F++)P.nsPsy.pefirbuf[F]=700*P.mode_gr*P.channels_out;v.ATHtype==-1&&(v.ATHtype=4)}switch(a(v.VBR_q<=9),a(v.VBR_q>=0),v.VBR){case t.vbr_mt:v.VBR=t.vbr_mtrh;case t.vbr_mtrh:{v.useTemporal==null&&(v.useTemporal=!1),b.apply_preset(v,500-v.VBR_q*10,0),v.quality<0&&(v.quality=LAME_DEFAULT_QUALITY),v.quality<5&&(v.quality=0),v.quality>5&&(v.quality=5),P.PSY.mask_adjust=v.maskingadjust,P.PSY.mask_adjust_short=v.maskingadjust_short,v.experimentalY?P.sfb21_extra=!1:P.sfb21_extra=v.out_samplerate>44e3,P.iteration_loop=new VBRNewIterationLoop(T);break}case t.vbr_rh:{b.apply_preset(v,500-v.VBR_q*10,0),P.PSY.mask_adjust=v.maskingadjust,P.PSY.mask_adjust_short=v.maskingadjust_short,v.experimentalY?P.sfb21_extra=!1:P.sfb21_extra=v.out_samplerate>44e3,v.quality>6&&(v.quality=6),v.quality<0&&(v.quality=LAME_DEFAULT_QUALITY),P.iteration_loop=new VBROldIterationLoop(T);break}default:{var U;P.sfb21_extra=!1,v.quality<0&&(v.quality=LAME_DEFAULT_QUALITY),U=v.VBR,U==t.vbr_off&&(v.VBR_mean_bitrate_kbps=v.brate),b.apply_preset(v,v.VBR_mean_bitrate_kbps,0),v.VBR=U,P.PSY.mask_adjust=v.maskingadjust,P.PSY.mask_adjust_short=v.maskingadjust_short,U==t.vbr_off?P.iteration_loop=new m(T):P.iteration_loop=new ABRIterationLoop(T);break}}if(a(v.scale>=0),v.VBR!=t.vbr_off){if(P.VBR_min_bitrate=1,P.VBR_max_bitrate=14,v.out_samplerate<16e3&&(P.VBR_max_bitrate=8),v.VBR_min_bitrate_kbps!=0&&(v.VBR_min_bitrate_kbps=I(v.VBR_min_bitrate_kbps,v.version,v.out_samplerate),P.VBR_min_bitrate=B(v.VBR_min_bitrate_kbps,v.version,v.out_samplerate),P.VBR_min_bitrate<0)||v.VBR_max_bitrate_kbps!=0&&(v.VBR_max_bitrate_kbps=I(v.VBR_max_bitrate_kbps,v.version,v.out_samplerate),P.VBR_max_bitrate=B(v.VBR_max_bitrate_kbps,v.version,v.out_samplerate),P.VBR_max_bitrate<0))return-1;v.VBR_min_bitrate_kbps=D.bitrate_table[v.version][P.VBR_min_bitrate],v.VBR_max_bitrate_kbps=D.bitrate_table[v.version][P.VBR_max_bitrate],v.VBR_mean_bitrate_kbps=Math.min(D.bitrate_table[v.version][P.VBR_max_bitrate],v.VBR_mean_bitrate_kbps),v.VBR_mean_bitrate_kbps=Math.max(D.bitrate_table[v.version][P.VBR_min_bitrate],v.VBR_mean_bitrate_kbps)}return v.tune&&(P.PSY.mask_adjust+=v.tune_value_a,P.PSY.mask_adjust_short+=v.tune_value_a),Z(v),a(v.scale>=0),v.athaa_type<0?P.ATH.useAdjust=3:P.ATH.useAdjust=v.athaa_type,P.ATH.aaSensitivityP=Math.pow(10,v.athaa_sensitivity/-10),v.short_blocks==null&&(v.short_blocks=r.short_block_allowed),v.short_blocks==r.short_block_allowed&&(v.mode==w.JOINT_STEREO||v.mode==w.STEREO)&&(v.short_blocks=r.short_block_coupled),v.quant_comp<0&&(v.quant_comp=1),v.quant_comp_short<0&&(v.quant_comp_short=0),v.msfix<0&&(v.msfix=0),v.exp_nspsytune=v.exp_nspsytune|1,v.internal_flags.nsPsy.attackthre<0&&(v.internal_flags.nsPsy.attackthre=l.NSATTACKTHRE),v.internal_flags.nsPsy.attackthre_s<0&&(v.internal_flags.nsPsy.attackthre_s=l.NSATTACKTHRE_S),a(v.scale>=0),v.scale<0&&(v.scale=1),v.ATHtype<0&&(v.ATHtype=4),v.ATHcurve<0&&(v.ATHcurve=4),v.athaa_loudapprox<0&&(v.athaa_loudapprox=2),v.interChRatio<0&&(v.interChRatio=0),v.useTemporal==null&&(v.useTemporal=!0),P.slot_lag=P.frac_SpF=0,v.VBR==t.vbr_off&&(P.slot_lag=P.frac_SpF=(v.version+1)*72e3*v.brate%v.out_samplerate|0),E.iteration_init(v),M.psymodel_init(v),a(v.scale>=0),0};function ee(v,P){(v.in_buffer_0==null||v.in_buffer_nsamples<P)&&(v.in_buffer_0=s(P),v.in_buffer_1=s(P),v.in_buffer_nsamples=P)}this.lame_encode_flush=function(v,P,me,fe){var Se=v.internal_flags,Re=o([2,1152]),Ae=0,Te,Ne,Ue,Ie,Je=Se.mf_samples_to_encode-O.POSTDELAY,dt=le(v);if(Se.mf_samples_to_encode<1)return 0;for(Te=0,v.in_samplerate!=v.out_samplerate&&(Je+=16*v.out_samplerate/v.in_samplerate),Ue=v.framesize-Je%v.framesize,Ue<576&&(Ue+=v.framesize),v.encoder_padding=Ue,Ie=(Je+Ue)/v.framesize;Ie>0&&Ae>=0;){var F=dt-Se.mf_size,U=v.frameNum;F*=v.in_samplerate,F/=v.out_samplerate,F>1152&&(F=1152),F<1&&(F=1),Ne=fe-Te,fe==0&&(Ne=0),Ae=this.lame_encode_buffer(v,Re[0],Re[1],F,P,me,Ne),me+=Ae,Te+=Ae,Ie-=U!=v.frameNum?1:0}if(Se.mf_samples_to_encode=0,Ae<0||(Ne=fe-Te,fe==0&&(Ne=0),S.flush_bitstream(v),Ae=S.copy_buffer(Se,P,me,Ne,1),Ae<0))return Ae;if(me+=Ae,Te+=Ae,Ne=fe-Te,fe==0&&(Ne=0),v.write_id3tag_automatic){if(y.id3tag_write_v1(v),Ae=S.copy_buffer(Se,P,me,Ne,0),Ae<0)return Ae;Te+=Ae}return Te},this.lame_encode_buffer=function(v,P,me,fe,Se,Re,Ae){var Te=v.internal_flags,Ne=[null,null];if(Te.Class_ID!=Q)return-3;if(fe==0)return 0;ee(Te,fe),Ne[0]=Te.in_buffer_0,Ne[1]=Te.in_buffer_1;for(var Ue=0;Ue<fe;Ue++)Ne[0][Ue]=P[Ue],Te.channels_in>1&&(Ne[1][Ue]=me[Ue]);return Ee(v,Ne[0],Ne[1],fe,Se,Re,Ae)};function le(v){var P=O.BLKSIZE+v.framesize-O.FFTOFFSET;return P=Math.max(P,512+v.framesize-32),P}function Ee(v,P,me,fe,Se,Re,Ae){var Te=v.internal_flags,Ne=0,Ue,Ie,Je,dt,F,U=[null,null],Y=[null,null];if(Te.Class_ID!=Q)return-3;if(fe==0)return 0;if(F=S.copy_buffer(Te,Se,Re,Ae,0),F<0)return F;if(Re+=F,Ne+=F,Y[0]=P,Y[1]=me,_.NEQ(v.scale,0)&&_.NEQ(v.scale,1))for(Ie=0;Ie<fe;++Ie)Y[0][Ie]*=v.scale,Te.channels_out==2&&(Y[1][Ie]*=v.scale);if(_.NEQ(v.scale_left,0)&&_.NEQ(v.scale_left,1))for(Ie=0;Ie<fe;++Ie)Y[0][Ie]*=v.scale_left;if(_.NEQ(v.scale_right,0)&&_.NEQ(v.scale_right,1))for(Ie=0;Ie<fe;++Ie)Y[1][Ie]*=v.scale_right;if(v.num_channels==2&&Te.channels_out==1)for(Ie=0;Ie<fe;++Ie)Y[0][Ie]=.5*(Y[0][Ie]+Y[1][Ie]),Y[1][Ie]=0;dt=le(v),U[0]=Te.mfbuf[0],U[1]=Te.mfbuf[1];for(var te=0;fe>0;){var se=[null,null],G=0,ae=0;se[0]=Y[0],se[1]=Y[1];var ue=new j;if(De(v,U,se,te,fe,ue),G=ue.n_in,ae=ue.n_out,Te.findReplayGain&&!Te.decode_on_the_fly&&k.AnalyzeSamples(Te.rgdata,U[0],Te.mf_size,U[1],Te.mf_size,ae,Te.channels_out)==GainAnalysis.GAIN_ANALYSIS_ERROR)return-6;if(fe-=G,te+=G,Te.channels_out==2,Te.mf_size+=ae,a(Te.mf_size<=u.MFSIZE),Te.mf_samples_to_encode<1&&(Te.mf_samples_to_encode=O.ENCDELAY+O.POSTDELAY),Te.mf_samples_to_encode+=ae,Te.mf_size>=dt){var oe=Ae-Ne;if(Ae==0&&(oe=0),Ue=Oe(v,U[0],U[1],Se,Re,oe),Ue<0)return Ue;for(Re+=Ue,Ne+=Ue,Te.mf_size-=v.framesize,Te.mf_samples_to_encode-=v.framesize,Je=0;Je<Te.channels_out;Je++)for(Ie=0;Ie<Te.mf_size;Ie++)U[Je][Ie]=U[Je][Ie+v.framesize]}}return Ne}function Oe(v,P,me,fe,Se,Re){var Ae=N.enc.lame_encode_mp3_frame(v,P,me,fe,Se,Re);return v.frameNum++,Ae}function j(){this.n_in=0,this.n_out=0}function K(){this.num_used=0}function re(v,P){return P!=0?re(P,v%P):v}function he(v,P,me){var fe=Math.PI*P;v/=me,v<0&&(v=0),v>1&&(v=1);var Se=v-.5,Re=.42-.5*Math.cos(2*v*Math.PI)+.08*Math.cos(4*v*Math.PI);return Math.abs(Se)<1e-9?fe/Math.PI:Re*Math.sin(me*fe*Se)/(Math.PI*me*Se)}function _e(v,P,me,fe,Se,Re,Ae,Te,Ne){var Ue=v.internal_flags,Ie,Je=0,dt,F=v.out_samplerate/re(v.out_samplerate,v.in_samplerate);F>u.BPC&&(F=u.BPC);var U=Math.abs(Ue.resample_ratio-Math.floor(.5+Ue.resample_ratio))<1e-4?1:0,Y=1/Ue.resample_ratio;Y>1&&(Y=1);var te=31;te%2==0&&--te,te+=U;var se=te+1;if(Ue.fill_buffer_resample_init==0){for(Ue.inbuf_old[0]=s(se),Ue.inbuf_old[1]=s(se),Ie=0;Ie<=2*F;++Ie)Ue.blackfilt[Ie]=s(se);for(Ue.itime[0]=0,Ue.itime[1]=0,Je=0;Je<=2*F;Je++){var G=0,ae=(Je-F)/(2*F);for(Ie=0;Ie<=te;Ie++)G+=Ue.blackfilt[Je][Ie]=he(Ie-ae,Y,te);for(Ie=0;Ie<=te;Ie++)Ue.blackfilt[Je][Ie]/=G}Ue.fill_buffer_resample_init=1}var ue=Ue.inbuf_old[Ne];for(dt=0;dt<fe;dt++){var oe,ye;if(oe=dt*Ue.resample_ratio,Je=0|Math.floor(oe-Ue.itime[Ne]),te+Je-te/2>=Ae)break;var ae=oe-Ue.itime[Ne]-(Je+.5*(te%2));ye=0|Math.floor(ae*2*F+F+.5);var de=0;for(Ie=0;Ie<=te;++Ie){var be=0|Ie+Je-te/2,Le;Le=be<0?ue[se+be]:Se[Re+be],de+=Le*Ue.blackfilt[ye][Ie]}P[me+dt]=de}if(Te.num_used=Math.min(Ae,te+Je-te/2),Ue.itime[Ne]+=Te.num_used-dt*Ue.resample_ratio,Te.num_used>=se)for(Ie=0;Ie<se;Ie++)ue[Ie]=Se[Re+Te.num_used+Ie-se];else{var We=se-Te.num_used;for(Ie=0;Ie<We;++Ie)ue[Ie]=ue[Ie+Te.num_used];for(Je=0;Ie<se;++Ie,++Je)ue[Ie]=Se[Re+Je];a(Je==Te.num_used)}return dt}function De(v,P,me,fe,Se,Re){var Ae=v.internal_flags;if(Ae.resample_ratio<.9999||Ae.resample_ratio>1.0001)for(var Te=0;Te<Ae.channels_out;Te++){var Ne=new K;Re.n_out=_e(v,P[Te],Ae.mf_size,v.framesize,me[Te],fe,Se,Ne,Te),Re.n_in=Ne.num_used}else{Re.n_out=Math.min(v.framesize,Se),Re.n_in=Re.n_out;for(var Ue=0;Ue<Re.n_out;++Ue)P[0][Ae.mf_size+Ue]=me[0][fe+Ue],Ae.channels_out==2&&(P[1][Ae.mf_size+Ue]=me[1][fe+Ue])}}}return Vd=x,Vd}var CV=Bt,jr=CV.VbrMode;function xV(){var n=j0();function e(u,f,d,m,_,D,O,x,w,N,V,p,k,S,b){this.vbr_q=u,this.quant_comp=f,this.quant_comp_s=d,this.expY=m,this.st_lrm=_,this.st_s=D,this.masking_adj=O,this.masking_adj_short=x,this.ath_lower=w,this.ath_curve=N,this.ath_sensitivity=V,this.interch=p,this.safejoint=k,this.sfb21mod=S,this.msfix=b}function t(u,f,d,m,_,D,O,x,w,N,V,p,k,S){this.quant_comp=f,this.quant_comp_s=d,this.safejoint=m,this.nsmsfix=_,this.st_lrm=D,this.st_s=O,this.nsbass=x,this.scale=w,this.masking_adj=N,this.ath_lower=V,this.ath_curve=p,this.interch=k,this.sfscale=S}var r;this.setModules=function(u){r=u};var s=[new e(0,9,9,0,5.2,125,-4.2,-6.3,4.8,1,0,0,2,21,.97),new e(1,9,9,0,5.3,125,-3.6,-5.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,5.6,125,-2.2,-3.5,2.8,2,0,0,2,21,1.49),new e(3,9,9,1,5.8,130,-1.8,-2.8,2.6,3,-4,0,2,20,1.64),new e(4,9,9,1,6,135,-.7,-1.1,1.1,3.5,-8,0,2,0,1.79),new e(5,9,9,1,6.4,140,.5,.4,-7.5,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,6.6,145,.67,.65,-14.7,6.5,-19,4e-4,0,0,2.3),new e(7,9,9,1,6.6,145,.8,.75,-19.7,8,-22,6e-4,0,0,2.7),new e(8,9,9,1,6.6,145,1.2,1.15,-27.5,10,-23,7e-4,0,0,0),new e(9,9,9,1,6.6,145,1.6,1.6,-36,11,-25,8e-4,0,0,0),new e(10,9,9,1,6.6,145,2,2,-36,12,-25,8e-4,0,0,0)],i=[new e(0,9,9,0,4.2,25,-7,-4,7.5,1,0,0,2,26,.97),new e(1,9,9,0,4.2,25,-5.6,-3.6,4.5,1.5,0,0,2,21,1.35),new e(2,9,9,0,4.2,25,-4.4,-1.8,2,2,0,0,2,18,1.49),new e(3,9,9,1,4.2,25,-3.4,-1.25,1.1,3,-4,0,2,15,1.64),new e(4,9,9,1,4.2,25,-2.2,.1,0,3.5,-8,0,2,0,1.79),new e(5,9,9,1,4.2,25,-1,1.65,-7.7,4,-12,2e-4,0,0,1.95),new e(6,9,9,1,4.2,25,-0,2.47,-7.7,6.5,-19,4e-4,0,0,2),new e(7,9,9,1,4.2,25,.5,2,-14.5,8,-22,6e-4,0,0,2),new e(8,9,9,1,4.2,25,1,2.4,-22,10,-23,7e-4,0,0,2),new e(9,9,9,1,4.2,25,1.5,2.95,-30,11,-25,8e-4,0,0,2),new e(10,9,9,1,4.2,25,2,2.95,-36,12,-30,8e-4,0,0,2)];function o(u,f,d){var m=u.VBR==jr.vbr_rh?s:i,_=u.VBR_q_frac,D=m[f],O=m[f+1],x=D;D.st_lrm=D.st_lrm+_*(O.st_lrm-D.st_lrm),D.st_s=D.st_s+_*(O.st_s-D.st_s),D.masking_adj=D.masking_adj+_*(O.masking_adj-D.masking_adj),D.masking_adj_short=D.masking_adj_short+_*(O.masking_adj_short-D.masking_adj_short),D.ath_lower=D.ath_lower+_*(O.ath_lower-D.ath_lower),D.ath_curve=D.ath_curve+_*(O.ath_curve-D.ath_curve),D.ath_sensitivity=D.ath_sensitivity+_*(O.ath_sensitivity-D.ath_sensitivity),D.interch=D.interch+_*(O.interch-D.interch),D.msfix=D.msfix+_*(O.msfix-D.msfix),c(u,x.vbr_q),d!=0?u.quant_comp=x.quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=x.quant_comp),d!=0?u.quant_comp_short=x.quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=x.quant_comp_s),x.expY!=0&&(u.experimentalY=x.expY!=0),d!=0?u.internal_flags.nsPsy.attackthre=x.st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=x.st_lrm),d!=0?u.internal_flags.nsPsy.attackthre_s=x.st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=x.st_s),d!=0?u.maskingadjust=x.masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=x.masking_adj),d!=0?u.maskingadjust_short=x.masking_adj_short:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=x.masking_adj_short),d!=0?u.ATHlower=-x.ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-x.ath_lower/10),d!=0?u.ATHcurve=x.ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=x.ath_curve),d!=0?u.athaa_sensitivity=x.ath_sensitivity:Math.abs(u.athaa_sensitivity- -1)>0||(u.athaa_sensitivity=x.ath_sensitivity),x.interch>0&&(d!=0?u.interChRatio=x.interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=x.interch)),x.safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|x.safejoint),x.sfb21mod>0&&(u.exp_nspsytune=u.exp_nspsytune|x.sfb21mod<<20),d!=0?u.msfix=x.msfix:Math.abs(u.msfix- -1)>0||(u.msfix=x.msfix),d==0&&(u.VBR_q=f,u.VBR_q_frac=_)}var a=[new t(8,9,9,0,0,6.6,145,0,.95,0,-30,11,.0012,1),new t(16,9,9,0,0,6.6,145,0,.95,0,-25,11,.001,1),new t(24,9,9,0,0,6.6,145,0,.95,0,-20,11,.001,1),new t(32,9,9,0,0,6.6,145,0,.95,0,-15,11,.001,1),new t(40,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(48,9,9,0,0,6.6,145,0,.95,0,-10,11,9e-4,1),new t(56,9,9,0,0,6.6,145,0,.95,0,-6,11,8e-4,1),new t(64,9,9,0,0,6.6,145,0,.95,0,-2,11,8e-4,1),new t(80,9,9,0,0,6.6,145,0,.95,0,0,8,7e-4,1),new t(96,9,9,0,2.5,6.6,145,0,.95,0,1,5.5,6e-4,1),new t(112,9,9,0,2.25,6.6,145,0,.95,0,2,4.5,5e-4,1),new t(128,9,9,0,1.95,6.4,140,0,.95,0,3,4,2e-4,1),new t(160,9,9,1,1.79,6,135,0,.95,-2,5,3.5,0,1),new t(192,9,9,1,1.49,5.6,125,0,.97,-4,7,3,0,0),new t(224,9,9,1,1.25,5.2,125,0,.98,-6,9,2,0,0),new t(256,9,9,1,.97,5.2,125,0,1,-8,10,1,0,0),new t(320,9,9,1,.9,5.2,125,0,1,-10,12,0,0,0)];function l(u,f,d){var m=f,_=r.nearestBitrateFullIndex(f);if(u.VBR=jr.vbr_abr,u.VBR_mean_bitrate_kbps=m,u.VBR_mean_bitrate_kbps=Math.min(u.VBR_mean_bitrate_kbps,320),u.VBR_mean_bitrate_kbps=Math.max(u.VBR_mean_bitrate_kbps,8),u.brate=u.VBR_mean_bitrate_kbps,u.VBR_mean_bitrate_kbps>320&&(u.disable_reservoir=!0),a[_].safejoint>0&&(u.exp_nspsytune=u.exp_nspsytune|2),a[_].sfscale>0&&(u.internal_flags.noise_shaping=2),Math.abs(a[_].nsbass)>0){var D=int(a[_].nsbass*4);D<0&&(D+=64),u.exp_nspsytune=u.exp_nspsytune|D<<2}return d!=0?u.quant_comp=a[_].quant_comp:Math.abs(u.quant_comp- -1)>0||(u.quant_comp=a[_].quant_comp),d!=0?u.quant_comp_short=a[_].quant_comp_s:Math.abs(u.quant_comp_short- -1)>0||(u.quant_comp_short=a[_].quant_comp_s),d!=0?u.msfix=a[_].nsmsfix:Math.abs(u.msfix- -1)>0||(u.msfix=a[_].nsmsfix),d!=0?u.internal_flags.nsPsy.attackthre=a[_].st_lrm:Math.abs(u.internal_flags.nsPsy.attackthre- -1)>0||(u.internal_flags.nsPsy.attackthre=a[_].st_lrm),d!=0?u.internal_flags.nsPsy.attackthre_s=a[_].st_s:Math.abs(u.internal_flags.nsPsy.attackthre_s- -1)>0||(u.internal_flags.nsPsy.attackthre_s=a[_].st_s),d!=0?u.scale=a[_].scale:Math.abs(u.scale- -1)>0||(u.scale=a[_].scale),d!=0?u.maskingadjust=a[_].masking_adj:Math.abs(u.maskingadjust-0)>0||(u.maskingadjust=a[_].masking_adj),a[_].masking_adj>0?d!=0?u.maskingadjust_short=a[_].masking_adj*.9:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=a[_].masking_adj*.9):d!=0?u.maskingadjust_short=a[_].masking_adj*1.1:Math.abs(u.maskingadjust_short-0)>0||(u.maskingadjust_short=a[_].masking_adj*1.1),d!=0?u.ATHlower=-a[_].ath_lower/10:Math.abs(-u.ATHlower*10-0)>0||(u.ATHlower=-a[_].ath_lower/10),d!=0?u.ATHcurve=a[_].ath_curve:Math.abs(u.ATHcurve- -1)>0||(u.ATHcurve=a[_].ath_curve),d!=0?u.interChRatio=a[_].interch:Math.abs(u.interChRatio- -1)>0||(u.interChRatio=a[_].interch),f}this.apply_preset=function(u,f,d){switch(f){case n.R3MIX:{f=n.V3,u.VBR=jr.vbr_mtrh;break}case n.MEDIUM:{f=n.V4,u.VBR=jr.vbr_rh;break}case n.MEDIUM_FAST:{f=n.V4,u.VBR=jr.vbr_mtrh;break}case n.STANDARD:{f=n.V2,u.VBR=jr.vbr_rh;break}case n.STANDARD_FAST:{f=n.V2,u.VBR=jr.vbr_mtrh;break}case n.EXTREME:{f=n.V0,u.VBR=jr.vbr_rh;break}case n.EXTREME_FAST:{f=n.V0,u.VBR=jr.vbr_mtrh;break}case n.INSANE:return f=320,u.preset=f,l(u,f,d),u.VBR=jr.vbr_off,f}switch(u.preset=f,f){case n.V9:return o(u,9,d),f;case n.V8:return o(u,8,d),f;case n.V7:return o(u,7,d),f;case n.V6:return o(u,6,d),f;case n.V5:return o(u,5,d),f;case n.V4:return o(u,4,d),f;case n.V3:return o(u,3,d),f;case n.V2:return o(u,2,d),f;case n.V1:return o(u,1,d),f;case n.V0:return o(u,0,d),f}return 8<=f&&f<=320?l(u,f,d):(u.preset=0,f)};function c(u,f){var d=0;return 0>f&&(d=-1,f=0),9<f&&(d=-1,f=9),u.VBR_q=f,u.VBR_q_frac=0,d}}var MV=xV;function PV(){this.setModules=function(n,e){}}var OV=PV;function NV(){this.over_noise=0,this.tot_noise=0,this.max_noise=0,this.over_count=0,this.over_SSD=0,this.bits=0}var DV=NV,MT=Bt,_2=MT.new_float,LV=MT.new_int;function VV(){this.global_gain=0,this.sfb_count1=0,this.step=LV(39),this.noise=_2(39),this.noise_log=_2(39)}var BV=VV,Ka=Bt,qs=Ka.System,y2=Ka.VbrMode,Bd=Ka.Util,Yo=Ka.Arrays,fl=Ka.new_float,dl=Ka.assert,FV=OV,Fd=DV,UV=BV,bt=Hn(),b2=V0,v2=Rf;function HV(){var n;this.rv=null;var e;this.qupvt=null;var t,r=new FV,s;this.setModules=function(x,w,N,V){n=x,e=w,this.rv=w,t=N,this.qupvt=N,s=V,r.setModules(t,s)},this.ms_convert=function(x,w){for(var N=0;N<576;++N){var V=x.tt[w][0].xr[N],p=x.tt[w][1].xr[N];x.tt[w][0].xr[N]=(V+p)*(Bd.SQRT2*.5),x.tt[w][1].xr[N]=(V-p)*(Bd.SQRT2*.5)}};function i(x,w,N,V){V=0;for(var p=0;p<=N;++p){var k=Math.abs(x.xr[p]);V+=k,w[p]=Math.sqrt(k*Math.sqrt(k)),w[p]>x.xrpow_max&&(x.xrpow_max=w[p])}return V}this.init_xrpow=function(x,w,N){var V=0,p=0|w.max_nonzero_coeff;if(w.xrpow_max=0,Yo.fill(N,p,576,0),V=i(w,N,p,V),V>1e-20){var k=0;x.substep_shaping&2&&(k=1);for(var S=0;S<w.psymax;S++)x.pseudohalf[S]=k;return!0}return Yo.fill(w.l3_enc,0,576,0),!1};function o(x,w){var N=x.ATH,V=w.xr;if(w.block_type!=bt.SHORT_TYPE)for(var p=!1,k=bt.PSFB21-1;k>=0&&!p;k--){var S=x.scalefac_band.psfb21[k],b=x.scalefac_band.psfb21[k+1],E=t.athAdjust(N.adjust,N.psfb21[k],N.floor);x.nsPsy.longfact[21]>1e-12&&(E*=x.nsPsy.longfact[21]);for(var T=b-1;T>=S;T--)if(Math.abs(V[T])<E)V[T]=0;else{p=!0;break}}else for(var M=0;M<3;M++)for(var p=!1,k=bt.PSFB12-1;k>=0&&!p;k--){var S=x.scalefac_band.s[12]*3+(x.scalefac_band.s[13]-x.scalefac_band.s[12])*M+(x.scalefac_band.psfb12[k]-x.scalefac_band.psfb12[0]),b=S+(x.scalefac_band.psfb12[k+1]-x.scalefac_band.psfb12[k]),H=t.athAdjust(N.adjust,N.psfb12[k],N.floor);x.nsPsy.shortfact[12]>1e-12&&(H*=x.nsPsy.shortfact[12]);for(var T=b-1;T>=S;T--)if(Math.abs(V[T])<H)V[T]=0;else{p=!0;break}}}this.init_outer_loop=function(x,w){w.part2_3_length=0,w.big_values=0,w.count1=0,w.global_gain=210,w.scalefac_compress=0,w.table_select[0]=0,w.table_select[1]=0,w.table_select[2]=0,w.subblock_gain[0]=0,w.subblock_gain[1]=0,w.subblock_gain[2]=0,w.subblock_gain[3]=0,w.region0_count=0,w.region1_count=0,w.preflag=0,w.scalefac_scale=0,w.count1table_select=0,w.part2_length=0,w.sfb_lmax=bt.SBPSY_l,w.sfb_smin=bt.SBPSY_s,w.psy_lmax=x.sfb21_extra?bt.SBMAX_l:bt.SBPSY_l,w.psymax=w.psy_lmax,w.sfbmax=w.sfb_lmax,w.sfbdivide=11;for(var N=0;N<bt.SBMAX_l;N++)w.width[N]=x.scalefac_band.l[N+1]-x.scalefac_band.l[N],w.window[N]=3;if(w.block_type==bt.SHORT_TYPE){var V=fl(576);w.sfb_smin=0,w.sfb_lmax=0,w.mixed_block_flag!=0&&(w.sfb_smin=3,w.sfb_lmax=x.mode_gr*2+4),w.psymax=w.sfb_lmax+3*((x.sfb21_extra?bt.SBMAX_s:bt.SBPSY_s)-w.sfb_smin),w.sfbmax=w.sfb_lmax+3*(bt.SBPSY_s-w.sfb_smin),w.sfbdivide=w.sfbmax-18,w.psy_lmax=w.sfb_lmax;var p=x.scalefac_band.l[w.sfb_lmax];qs.arraycopy(w.xr,0,V,0,576);for(var N=w.sfb_smin;N<bt.SBMAX_s;N++)for(var k=x.scalefac_band.s[N],S=x.scalefac_band.s[N+1],b=0;b<3;b++)for(var E=k;E<S;E++)w.xr[p++]=V[3*E+b];for(var T=w.sfb_lmax,N=w.sfb_smin;N<bt.SBMAX_s;N++)w.width[T]=w.width[T+1]=w.width[T+2]=x.scalefac_band.s[N+1]-x.scalefac_band.s[N],w.window[T]=0,w.window[T+1]=1,w.window[T+2]=2,T+=3}w.count1bits=0,w.sfb_partition_table=t.nr_of_sfb_block[0][0],w.slen[0]=0,w.slen[1]=0,w.slen[2]=0,w.slen[3]=0,w.max_nonzero_coeff=575,Yo.fill(w.scalefac,0),o(x,w)};function a(x){this.ordinal=x}a.BINSEARCH_NONE=new a(0),a.BINSEARCH_UP=new a(1),a.BINSEARCH_DOWN=new a(2);function l(x,w,N,V,p){var k,S=x.CurrentStep[V],b=!1,E=x.OldValue[V],T=a.BINSEARCH_NONE;for(w.global_gain=E,N-=w.part2_length;;){var M;if(k=s.count_bits(x,p,w,null),S==1||k==N)break;k>N?(T==a.BINSEARCH_DOWN&&(b=!0),b&&(S/=2),T=a.BINSEARCH_UP,M=S):(T==a.BINSEARCH_UP&&(b=!0),b&&(S/=2),T=a.BINSEARCH_DOWN,M=-S),w.global_gain+=M,w.global_gain<0&&(w.global_gain=0,b=!0),w.global_gain>255&&(w.global_gain=255,b=!0)}for(dl(w.global_gain>=0),dl(w.global_gain<256);k>N&&w.global_gain<255;)w.global_gain++,k=s.count_bits(x,p,w,null);return x.CurrentStep[V]=E-w.global_gain>=4?4:2,x.OldValue[V]=w.global_gain,w.part2_3_length=k,k}this.trancate_smallspectrums=function(x,w,N,V){var p=fl(v2.SFBMAX);if(!(!(x.substep_shaping&4)&&w.block_type==bt.SHORT_TYPE||x.substep_shaping&128)){t.calc_noise(w,N,p,new Fd,null);for(var S=0;S<576;S++){var k=0;w.l3_enc[S]!=0&&(k=Math.abs(w.xr[S])),V[S]=k}var S=0,b=8;w.block_type==bt.SHORT_TYPE&&(b=6);do{var E,T,M,H,y=w.width[b];if(S+=y,!(p[b]>=1)&&(Yo.sort(V,S-y,y),!BitStream.EQ(V[S-1],0))){E=(1-p[b])*N[b],T=0,H=0;do{var A;for(M=1;H+M<y&&!BitStream.NEQ(V[H+S-y],V[H+S+M-y]);M++);if(A=V[H+S-y]*V[H+S-y]*M,E<A){H!=0&&(T=V[H+S-y-1]);break}E-=A,H+=M}while(H<y);if(!BitStream.EQ(T,0))do Math.abs(w.xr[S-y])<=T&&(w.l3_enc[S-y]=0);while(--y>0)}}while(++b<w.psymax);w.part2_3_length=s.noquant_count_bits(x,w,null)}};function c(x){for(var w=0;w<x.sfbmax;w++)if(x.scalefac[w]+x.subblock_gain[x.window[w]]==0)return!1;return!0}function u(x){return Bd.FAST_LOG10(.368+.632*x*x*x)}function f(x,w){for(var N=1e-37,V=0;V<w.psymax;V++)N+=u(x[V]);return Math.max(1e-20,N)}function d(x,w,N,V,p){var k;switch(x){default:case 9:{w.over_count>0?(k=N.over_SSD<=w.over_SSD,N.over_SSD==w.over_SSD&&(k=N.bits<w.bits)):k=N.max_noise<0&&N.max_noise*10+N.bits<=w.max_noise*10+w.bits;break}case 0:k=N.over_count<w.over_count||N.over_count==w.over_count&&N.over_noise<w.over_noise||N.over_count==w.over_count&&BitStream.EQ(N.over_noise,w.over_noise)&&N.tot_noise<w.tot_noise;break;case 8:N.max_noise=f(p,V);case 1:k=N.max_noise<w.max_noise;break;case 2:k=N.tot_noise<w.tot_noise;break;case 3:k=N.tot_noise<w.tot_noise&&N.max_noise<w.max_noise;break;case 4:k=N.max_noise<=0&&w.max_noise>.2||N.max_noise<=0&&w.max_noise<0&&w.max_noise>N.max_noise-.2&&N.tot_noise<w.tot_noise||N.max_noise<=0&&w.max_noise>0&&w.max_noise>N.max_noise-.2&&N.tot_noise<w.tot_noise+w.over_noise||N.max_noise>0&&w.max_noise>-.05&&w.max_noise>N.max_noise-.1&&N.tot_noise+N.over_noise<w.tot_noise+w.over_noise||N.max_noise>0&&w.max_noise>-.1&&w.max_noise>N.max_noise-.15&&N.tot_noise+N.over_noise+N.over_noise<w.tot_noise+w.over_noise+w.over_noise;break;case 5:k=N.over_noise<w.over_noise||BitStream.EQ(N.over_noise,w.over_noise)&&N.tot_noise<w.tot_noise;break;case 6:k=N.over_noise<w.over_noise||BitStream.EQ(N.over_noise,w.over_noise)&&(N.max_noise<w.max_noise||BitStream.EQ(N.max_noise,w.max_noise)&&N.tot_noise<=w.tot_noise);break;case 7:k=N.over_count<w.over_count||N.over_noise<w.over_noise;break}return w.over_count==0&&(k=k&&N.bits<w.bits),k}function m(x,w,N,V,p){var k=x.internal_flags,S;w.scalefac_scale==0?S=1.2968395546510096:S=1.6817928305074292;for(var b=0,E=0;E<w.sfbmax;E++)b<N[E]&&(b=N[E]);var T=k.noise_shaping_amp;switch(T==3&&(p?T=2:T=1),T){case 2:break;case 1:b>1?b=Math.pow(b,.5):b*=.95;break;case 0:default:b>1?b=1:b*=.95;break}for(var M=0,E=0;E<w.sfbmax;E++){var H=w.width[E],y;if(M+=H,!(N[E]<b)){if(k.substep_shaping&2&&(k.pseudohalf[E]=k.pseudohalf[E]==0?1:0,k.pseudohalf[E]==0&&k.noise_shaping_amp==2))return;for(w.scalefac[E]++,y=-H;y<0;y++)V[M+y]*=S,V[M+y]>w.xrpow_max&&(w.xrpow_max=V[M+y]);if(k.noise_shaping_amp==2)return}}}function _(x,w){for(var N=1.2968395546510096,V=0,p=0;p<x.sfbmax;p++){var k=x.width[p],S=x.scalefac[p];if(x.preflag!=0&&(S+=t.pretab[p]),V+=k,S&1){S++;for(var b=-k;b<0;b++)w[V+b]*=N,w[V+b]>x.xrpow_max&&(x.xrpow_max=w[V+b])}x.scalefac[p]=S>>1}x.preflag=0,x.scalefac_scale=1}function D(x,w,N){var V,p=w.scalefac;for(V=0;V<w.sfb_lmax;V++)if(p[V]>=16)return!0;for(var k=0;k<3;k++){var S=0,b=0;for(V=w.sfb_lmax+k;V<w.sfbdivide;V+=3)S<p[V]&&(S=p[V]);for(;V<w.sfbmax;V+=3)b<p[V]&&(b=p[V]);if(!(S<16&&b<8)){if(w.subblock_gain[k]>=7)return!0;w.subblock_gain[k]++;var E=x.scalefac_band.l[w.sfb_lmax];for(V=w.sfb_lmax+k;V<w.sfbmax;V+=3){var T,M=w.width[V],H=p[V];if(H=H-(4>>w.scalefac_scale),H>=0){p[V]=H,E+=M*3;continue}p[V]=0;{var y=210+(H<<w.scalefac_scale+1);T=t.IPOW20(y)}E+=M*(k+1);for(var A=-M;A<0;A++)N[E+A]*=T,N[E+A]>w.xrpow_max&&(w.xrpow_max=N[E+A]);E+=M*(3-k-1)}{var T=t.IPOW20(202);E+=w.width[V]*(k+1);for(var A=-w.width[V];A<0;A++)N[E+A]*=T,N[E+A]>w.xrpow_max&&(w.xrpow_max=N[E+A])}}}return!1}function O(x,w,N,V,p){var k=x.internal_flags;m(x,w,N,V,p);var S=c(w);return S?!1:(k.mode_gr==2?S=s.scale_bitcount(w):S=s.scale_bitcount_lsf(k,w),S?(k.noise_shaping>1&&(Yo.fill(k.pseudohalf,0),w.scalefac_scale==0?(_(w,V),S=!1):w.block_type==bt.SHORT_TYPE&&k.subblock_gain>0&&(S=D(k,w,V)||c(w))),S||(k.mode_gr==2?S=s.scale_bitcount(w):S=s.scale_bitcount_lsf(k,w)),!S):!0)}this.outer_loop=function(x,w,N,V,p,k){var S=x.internal_flags,b=new b2,E=fl(576),T=fl(v2.SFBMAX),M=new Fd,H,y=new UV,A=9999999,W=!1,X=!1,ne=0;if(l(S,w,k,p,V),S.noise_shaping==0)return 100;t.calc_noise(w,N,T,M,y),M.bits=w.part2_3_length,b.assign(w);var Q=0;for(qs.arraycopy(V,0,E,0,576);!W;){do{var ce=new Fd,J,L=255;if(S.substep_shaping&2?J=20:J=3,S.sfb21_extra&&(T[b.sfbmax]>1||b.block_type==bt.SHORT_TYPE&&(T[b.sfbmax+1]>1||T[b.sfbmax+2]>1))||!O(x,b,T,V,X))break;b.scalefac_scale!=0&&(L=254);var C=k-b.part2_length;if(C<=0)break;for(;(b.part2_3_length=s.count_bits(S,V,b,y))>C&&b.global_gain<=L;)b.global_gain++;if(b.global_gain>L)break;if(M.over_count==0){for(;(b.part2_3_length=s.count_bits(S,V,b,y))>A&&b.global_gain<=L;)b.global_gain++;if(b.global_gain>L)break}if(t.calc_noise(b,N,T,ce,y),ce.bits=b.part2_3_length,w.block_type!=bt.SHORT_TYPE?H=x.quant_comp:H=x.quant_comp_short,H=d(H,M,ce,b,T)?1:0,H!=0)A=w.part2_3_length,M=ce,w.assign(b),Q=0,qs.arraycopy(V,0,E,0,576);else if(S.full_outer_loop==0&&(++Q>J&&M.over_count==0||S.noise_shaping_amp==3&&X&&Q>30||S.noise_shaping_amp==3&&X&&b.global_gain-ne>15))break}while(b.global_gain+b.scalefac_scale<255);S.noise_shaping_amp==3?X?W=!0:(b.assign(w),qs.arraycopy(E,0,V,0,576),Q=0,ne=b.global_gain,X=!0):W=!0}return dl(w.global_gain+w.scalefac_scale<=255),x.VBR==y2.vbr_rh||x.VBR==y2.vbr_mtrh?qs.arraycopy(E,0,V,0,576):S.substep_shaping&1&&trancate_smallspectrums(S,w,N,V),M.over_count},this.iteration_finish_one=function(x,w,N){var V=x.l3_side,p=V.tt[w][N];s.best_scalefac_store(x,w,N,V),x.use_best_huffman==1&&s.best_huffman_divide(x,p),e.ResvAdjust(x,p)},this.VBR_encode_granule=function(x,w,N,V,p,k,S){var b=x.internal_flags,E=new b2,T=fl(576),M=S,H=S+1,y=(S+k)/2,A,W,X=0,ne=b.sfb21_extra;dl(M<=LameInternalFlags.MAX_BITS_PER_CHANNEL),Yo.fill(E.l3_enc,0);do y>M-42?b.sfb21_extra=!1:b.sfb21_extra=ne,W=outer_loop(x,w,N,V,p,y),W<=0?(X=1,H=w.part2_3_length,E.assign(w),qs.arraycopy(V,0,T,0,576),S=H-32,A=S-k,y=(S+k)/2):(k=y+32,A=S-k,y=(S+k)/2,X!=0&&(X=2,w.assign(E),qs.arraycopy(T,0,V,0,576)));while(A>12);b.sfb21_extra=ne,X==2&&qs.arraycopy(E.l3_enc,0,w.l3_enc,0,576),dl(w.part2_3_length<=M)},this.get_framebits=function(x,w){var N=x.internal_flags;N.bitrate_index=N.VBR_min_bitrate;var V=n.getframebits(x);N.bitrate_index=1,V=n.getframebits(x);for(var p=1;p<=N.VBR_max_bitrate;p++){N.bitrate_index=p;var k=new MeanBits(V);w[p]=e.ResvFrameBegin(x,k),V=k.bits}},this.VBR_old_prepare=function(x,w,N,V,p,k,S,b,E){var T=x.internal_flags,M,H=0,y=1,A=0;T.bitrate_index=T.VBR_max_bitrate;var W=e.ResvFrameBegin(x,new MeanBits(0))/T.mode_gr;get_framebits(x,k);for(var X=0;X<T.mode_gr;X++){var ne=t.on_pe(x,w,b[X],W,X,0);T.mode_ext==bt.MPG_MD_MS_LR&&(ms_convert(T.l3_side,X),t.reduce_side(b[X],N[X],W,ne));for(var Q=0;Q<T.channels_out;++Q){var ce=T.l3_side.tt[X][Q];ce.block_type!=bt.SHORT_TYPE?(H=1.28/(1+Math.exp(3.5-w[X][Q]/300))-.05,M=T.PSY.mask_adjust-H):(H=2.56/(1+Math.exp(3.5-w[X][Q]/300))-.14,M=T.PSY.mask_adjust_short-H),T.masking_lower=Math.pow(10,M*.1),init_outer_loop(T,ce),E[X][Q]=t.calc_xmin(x,V[X][Q],ce,p[X][Q]),E[X][Q]!=0&&(y=0),S[X][Q]=126,A+=b[X][Q]}}for(var X=0;X<T.mode_gr;X++)for(var Q=0;Q<T.channels_out;Q++)A>k[T.VBR_max_bitrate]&&(b[X][Q]*=k[T.VBR_max_bitrate],b[X][Q]/=A),S[X][Q]>b[X][Q]&&(S[X][Q]=b[X][Q]);return y},this.bitpressure_strategy=function(x,w,N,V){for(var p=0;p<x.mode_gr;p++)for(var k=0;k<x.channels_out;k++){for(var S=x.l3_side.tt[p][k],b=w[p][k],E=0,T=0;T<S.psy_lmax;T++)b[E++]*=1+.029*T*T/bt.SBMAX_l/bt.SBMAX_l;if(S.block_type==bt.SHORT_TYPE)for(var T=S.sfb_smin;T<bt.SBMAX_s;T++)b[E++]*=1+.029*T*T/bt.SBMAX_s/bt.SBMAX_s,b[E++]*=1+.029*T*T/bt.SBMAX_s/bt.SBMAX_s,b[E++]*=1+.029*T*T/bt.SBMAX_s/bt.SBMAX_s;V[p][k]=0|Math.max(N[p][k],.9*V[p][k])}},this.VBR_new_prepare=function(x,w,N,V,p,k){var S=x.internal_flags,b=1,E=0,T=0,M;if(x.free_format){S.bitrate_index=0;var H=new MeanBits(E);M=e.ResvFrameBegin(x,H),E=H.bits,p[0]=M}else{S.bitrate_index=S.VBR_max_bitrate;var H=new MeanBits(E);e.ResvFrameBegin(x,H),E=H.bits,get_framebits(x,p),M=p[S.VBR_max_bitrate]}for(var y=0;y<S.mode_gr;y++){t.on_pe(x,w,k[y],E,y,0),S.mode_ext==bt.MPG_MD_MS_LR&&ms_convert(S.l3_side,y);for(var A=0;A<S.channels_out;++A){var W=S.l3_side.tt[y][A];S.masking_lower=Math.pow(10,S.PSY.mask_adjust*.1),init_outer_loop(S,W),t.calc_xmin(x,N[y][A],W,V[y][A])!=0&&(b=0),T+=k[y][A]}}for(var y=0;y<S.mode_gr;y++)for(var A=0;A<S.channels_out;A++)T>M&&(k[y][A]*=M,k[y][A]/=T);return b},this.calc_target_bits=function(x,w,N,V,p,k){var S=x.internal_flags,b=S.l3_side,E,T,M,H,y=0;S.bitrate_index=S.VBR_max_bitrate;var A=new MeanBits(y);for(k[0]=e.ResvFrameBegin(x,A),y=A.bits,S.bitrate_index=1,y=n.getframebits(x)-S.sideinfo_len*8,p[0]=y/(S.mode_gr*S.channels_out),y=x.VBR_mean_bitrate_kbps*x.framesize*1e3,S.substep_shaping&1&&(y*=1.09),y/=x.out_samplerate,y-=S.sideinfo_len*8,y/=S.mode_gr*S.channels_out,E=.93+.07*(11-x.compression_ratio)/(11-5.5),E<.9&&(E=.9),E>1&&(E=1),T=0;T<S.mode_gr;T++){var W=0;for(M=0;M<S.channels_out;M++){if(V[T][M]=int(E*y),w[T][M]>700){var X=int((w[T][M]-700)/1.4),ne=b.tt[T][M];V[T][M]=int(E*y),ne.block_type==bt.SHORT_TYPE&&X<y/2&&(X=y/2),X>y*3/2?X=y*3/2:X<0&&(X=0),V[T][M]+=X}V[T][M]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(V[T][M]=LameInternalFlags.MAX_BITS_PER_CHANNEL),W+=V[T][M]}if(W>LameInternalFlags.MAX_BITS_PER_GRANULE)for(M=0;M<S.channels_out;++M)V[T][M]*=LameInternalFlags.MAX_BITS_PER_GRANULE,V[T][M]/=W}if(S.mode_ext==bt.MPG_MD_MS_LR)for(T=0;T<S.mode_gr;T++)t.reduce_side(V[T],N[T],y*S.channels_out,LameInternalFlags.MAX_BITS_PER_GRANULE);for(H=0,T=0;T<S.mode_gr;T++)for(M=0;M<S.channels_out;M++)V[T][M]>LameInternalFlags.MAX_BITS_PER_CHANNEL&&(V[T][M]=LameInternalFlags.MAX_BITS_PER_CHANNEL),H+=V[T][M];if(H>k[0])for(T=0;T<S.mode_gr;T++)for(M=0;M<S.channels_out;M++)V[T][M]*=k[0],V[T][M]/=H}}var jV=HV,zV=Bt,E2=zV.assert;function $V(){var n;this.setModules=function(e){n=e},this.ResvFrameBegin=function(e,t){var r=e.internal_flags,s,i=r.l3_side,o=n.getframebits(e);t.bits=(o-r.sideinfo_len*8)/r.mode_gr;var a=8*256*r.mode_gr-8;e.brate>320?s=8*int(e.brate*1e3/(e.out_samplerate/1152)/8+.5):(s=8*1440,e.strict_ISO&&(s=8*int(32e4/(e.out_samplerate/1152)/8+.5))),r.ResvMax=s-o,r.ResvMax>a&&(r.ResvMax=a),(r.ResvMax<0||e.disable_reservoir)&&(r.ResvMax=0);var l=t.bits*r.mode_gr+Math.min(r.ResvSize,r.ResvMax);return l>s&&(l=s),E2(r.ResvMax%8==0),E2(r.ResvMax>=0),i.resvDrain_pre=0,r.pinfo!=null&&(r.pinfo.mean_bits=t.bits/2,r.pinfo.resvsize=r.ResvSize),l},this.ResvMaxBits=function(e,t,r,s){var i=e.internal_flags,o,a=i.ResvSize,l=i.ResvMax;s!=0&&(a+=t),i.substep_shaping&1&&(l*=.9),r.bits=t,a*10>l*9?(o=a-l*9/10,r.bits+=o,i.substep_shaping|=128):(o=0,i.substep_shaping&=127,!e.disable_reservoir&&!(i.substep_shaping&1)&&(r.bits-=.1*t));var c=a<i.ResvMax*6/10?a:i.ResvMax*6/10;return c-=o,c<0&&(c=0),c},this.ResvAdjust=function(e,t){e.ResvSize-=t.part2_3_length+t.part2_length},this.ResvFrameEnd=function(e,t){var r,s=e.l3_side;e.ResvSize+=t*e.mode_gr;var i=0;s.resvDrain_post=0,s.resvDrain_pre=0,(r=e.ResvSize%8)!=0&&(i+=r),r=e.ResvSize-i-e.ResvMax,r>0&&(i+=r);{var o=Math.min(s.main_data_begin*8,i)/8;s.resvDrain_pre+=8*o,i-=8*o,e.ResvSize-=8*o,s.main_data_begin-=o}s.resvDrain_post+=i,e.ResvSize-=i}}var qV=$V;function KV(){var n="http://www.mp3dev.org/",e=3,t=98,r=4,s=0,i=93;this.getLameVersion=function(){return e+"."+t+"."+r},this.getLameShortVersion=function(){return e+"."+t+"."+r},this.getLameVeryShortVersion=function(){return"LAME"+e+"."+t+"r"},this.getPsyVersion=function(){return s+"."+i},this.getLameUrl=function(){return n},this.getLameOsBitness=function(){return"32bits"}}var WV=KV,Wa=Bt,GV=Wa.System,Ud=Wa.VbrMode,w2=Wa.ShortBlock,YV=Wa.Arrays,_u=Wa.new_byte,XV=Wa.assert;mc.NUMTOCENTRIES=100;mc.MAXFRAMESIZE=2880;function mc(){var n,e,t;this.setModules=function(y,A,W){n=y,e=A,t=W};var r=1,s=2,i=4,o=8,a=mc.NUMTOCENTRIES,l=mc.MAXFRAMESIZE,c=a+4+4+4+4+4,u=c+9+1+1+8+1+1+3+1+1+2+4+2+2,f=128,d=64,m=32,_=null,D="Xing",O="Info",x=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];function w(y,A){if(y.nVbrNumFrames++,y.sum+=A,y.seen++,!(y.seen<y.want)&&(y.pos<y.size&&(y.bag[y.pos]=y.sum,y.pos++,y.seen=0),y.pos==y.size)){for(var W=1;W<y.size;W+=2)y.bag[W/2]=y.bag[W];y.want*=2,y.pos/=2}}function N(y,A){if(!(y.pos<=0))for(var W=1;W<a;++W){var X=W/a,ne,Q,ce=0|Math.floor(X*y.pos);ce>y.pos-1&&(ce=y.pos-1),ne=y.bag[ce],Q=y.sum;var J=0|256*ne/Q;J>255&&(J=255),A[W]=255&J}}this.addVbrFrame=function(y){var A=y.internal_flags,W=Tables.bitrate_table[y.version][A.bitrate_index];XV(A.VBR_seek_table.bag!=null),w(A.VBR_seek_table,W)};function V(y,A){var W=y[A+0]&255;return W<<=8,W|=y[A+1]&255,W<<=8,W|=y[A+2]&255,W<<=8,W|=y[A+3]&255,W}function p(y,A,W){y[A+0]=255&(W>>24&255),y[A+1]=255&(W>>16&255),y[A+2]=255&(W>>8&255),y[A+3]=255&(W&255)}function k(y,A,W){y[A+0]=255&(W>>8&255),y[A+1]=255&(W&255)}function S(y,A){return new String(y,A,D.length(),_).equals(D)||new String(y,A,O.length(),_).equals(O)}function b(y,A,W){return 255&(y<<A|W&~(-1<<A))}function E(y,A){var W=y.internal_flags;A[0]=b(A[0],8,255),A[1]=b(A[1],3,7),A[1]=b(A[1],1,y.out_samplerate<16e3?0:1),A[1]=b(A[1],1,y.version),A[1]=b(A[1],2,1),A[1]=b(A[1],1,y.error_protection?0:1),A[2]=b(A[2],4,W.bitrate_index),A[2]=b(A[2],2,W.samplerate_index),A[2]=b(A[2],1,0),A[2]=b(A[2],1,y.extension),A[3]=b(A[3],2,y.mode.ordinal()),A[3]=b(A[3],2,W.mode_ext),A[3]=b(A[3],1,y.copyright),A[3]=b(A[3],1,y.original),A[3]=b(A[3],2,y.emphasis),A[0]=255;var X=255&(A[1]&241),ne;y.version==1?ne=f:y.out_samplerate<16e3?ne=m:ne=d,y.VBR==Ud.vbr_off&&(ne=y.brate);var Q;y.free_format?Q=0:Q=255&16*n.BitrateIndex(ne,y.version,y.out_samplerate),y.version==1?(A[1]=255&(X|10),X=255&(A[2]&13),A[2]=255&(Q|X)):(A[1]=255&(X|2),X=255&(A[2]&13),A[2]=255&(Q|X))}this.getVbrTag=function(y){var A=new VBRTagData,W=0;A.flags=0;var X=y[W+1]>>3&1,ne=y[W+2]>>2&3,Q=y[W+3]>>6&3,ce=y[W+2]>>4&15;if(ce=Tables.bitrate_table[X][ce],y[W+1]>>4==14?A.samprate=Tables.samplerate_table[2][ne]:A.samprate=Tables.samplerate_table[X][ne],X!=0?Q!=3?W+=36:W+=21:Q!=3?W+=21:W+=13,!S(y,W))return null;W+=4,A.hId=X;var J=A.flags=V(y,W);if(W+=4,J&r&&(A.frames=V(y,W),W+=4),J&s&&(A.bytes=V(y,W),W+=4),J&i){if(A.toc!=null)for(var L=0;L<a;L++)A.toc[L]=y[W+L];W+=a}A.vbrScale=-1,J&o&&(A.vbrScale=V(y,W),W+=4),A.headersize=(X+1)*72e3*ce/A.samprate,W+=21;var C=y[W+0]<<4;C+=y[W+1]>>4;var I=(y[W+1]&15)<<8;return I+=y[W+2]&255,(C<0||C>3e3)&&(C=-1),(I<0||I>3e3)&&(I=-1),A.encDelay=C,A.encPadding=I,A},this.InitVbrTag=function(y){var A=y.internal_flags,W;y.version==1?W=f:y.out_samplerate<16e3?W=m:W=d,y.VBR==Ud.vbr_off&&(W=y.brate);var X=(y.version+1)*72e3*W/y.out_samplerate,ne=A.sideinfo_len+u;if(A.VBR_seek_table.TotalFrameSize=X,X<ne||X>l){y.bWriteVbrTag=!1;return}A.VBR_seek_table.nVbrNumFrames=0,A.VBR_seek_table.nBytesWritten=0,A.VBR_seek_table.sum=0,A.VBR_seek_table.seen=0,A.VBR_seek_table.want=1,A.VBR_seek_table.pos=0,A.VBR_seek_table.bag==null&&(A.VBR_seek_table.bag=new int[400],A.VBR_seek_table.size=400);var Q=_u(l);E(y,Q);for(var ce=A.VBR_seek_table.TotalFrameSize,J=0;J<ce;++J)e.add_dummy_byte(y,Q[J]&255,1)};function T(y,A){var W=A^y;return A=A>>8^x[W&255],A}this.updateMusicCRC=function(y,A,W,X){for(var ne=0;ne<X;++ne)y[0]=T(A[W+ne],y[0])};function M(y,A,W,X,ne){var Q=y.internal_flags,ce=0,J=y.encoder_delay,L=y.encoder_padding,C=100-10*y.VBR_q-y.quality,I=t.getLameVeryShortVersion(),B,z=0,ie,Z=[1,5,3,2,4,0,3],q=0|(y.lowpassfreq/100+.5>255?255:y.lowpassfreq/100+.5),ee=0,le=0,Ee=0,Oe=y.internal_flags.noise_shaping,j=0,K=0,re=0,he=0,_e=0,De=(y.exp_nspsytune&1)!=0,v=(y.exp_nspsytune&2)!=0,P=!1,me=!1,fe=y.internal_flags.nogap_total,Se=y.internal_flags.nogap_current,Re=y.ATHtype,Ae=0,Te;switch(y.VBR){case vbr_abr:Te=y.VBR_mean_bitrate_kbps;break;case vbr_off:Te=y.brate;break;default:Te=y.VBR_min_bitrate_kbps}switch(y.VBR.ordinal()<Z.length?B=Z[y.VBR.ordinal()]:B=0,ie=16*z+B,Q.findReplayGain&&(Q.RadioGain>510&&(Q.RadioGain=510),Q.RadioGain<-510&&(Q.RadioGain=-510),le=8192,le|=3072,Q.RadioGain>=0?le|=Q.RadioGain:(le|=512,le|=-Q.RadioGain)),Q.findPeakSample&&(ee=Math.abs(0|Q.PeakSample/32767*Math.pow(2,23)+.5)),fe!=-1&&(Se>0&&(me=!0),Se<fe-1&&(P=!0)),Ae=Re+((De?1:0)<<4)+((v?1:0)<<5)+((P?1:0)<<6)+((me?1:0)<<7),C<0&&(C=0),y.mode){case MONO:j=0;break;case STEREO:j=1;break;case DUAL_CHANNEL:j=2;break;case JOINT_STEREO:y.force_ms?j=4:j=3;break;case NOT_SET:default:j=7;break}y.in_samplerate<=32e3?re=0:y.in_samplerate==48e3?re=2:y.in_samplerate>48e3?re=3:re=1,(y.short_blocks==w2.short_block_forced||y.short_blocks==w2.short_block_dispensed||y.lowpassfreq==-1&&y.highpassfreq==-1||y.scale_left<y.scale_right||y.scale_left>y.scale_right||y.disable_reservoir&&y.brate<320||y.noATH||y.ATHonly||Re==0||y.in_samplerate<=32e3)&&(K=1),he=Oe+(j<<2)+(K<<5)+(re<<6),_e=Q.nMusicCRC,p(W,X+ce,C),ce+=4;for(var Ne=0;Ne<9;Ne++)W[X+ce+Ne]=255&I.charAt(Ne);ce+=9,W[X+ce]=255&ie,ce++,W[X+ce]=255&q,ce++,p(W,X+ce,ee),ce+=4,k(W,X+ce,le),ce+=2,k(W,X+ce,Ee),ce+=2,W[X+ce]=255&Ae,ce++,Te>=255?W[X+ce]=255:W[X+ce]=255&Te,ce++,W[X+ce]=255&J>>4,W[X+ce+1]=255&(J<<4)+(L>>8),W[X+ce+2]=255&L,ce+=3,W[X+ce]=255&he,ce++,W[X+ce++]=0,k(W,X+ce,y.preset),ce+=2,p(W,X+ce,A),ce+=4,k(W,X+ce,_e),ce+=2;for(var Ue=0;Ue<ce;Ue++)ne=T(W[X+Ue],ne);return k(W,X+ce,ne),ce+=2,ce}function H(y){y.seek(0);var A=_u(10);y.readFully(A);var W;return new String(A,"ISO-8859-1").startsWith("ID3")?W=0:W=((A[6]&127)<<21|(A[7]&127)<<14|(A[8]&127)<<7|A[9]&127)+A.length,W}this.getLameTagFrame=function(y,A){var W=y.internal_flags;if(!y.bWriteVbrTag||W.Class_ID!=Lame.LAME_ID||W.VBR_seek_table.pos<=0)return 0;if(A.length<W.VBR_seek_table.TotalFrameSize)return W.VBR_seek_table.TotalFrameSize;YV.fill(A,0,W.VBR_seek_table.TotalFrameSize,0),E(y,A);var X=_u(a);if(y.free_format)for(var ne=1;ne<a;++ne)X[ne]=255&255*ne/100;else N(W.VBR_seek_table,X);var Q=W.sideinfo_len;y.error_protection&&(Q-=2),y.VBR==Ud.vbr_off?(A[Q++]=255&O.charAt(0),A[Q++]=255&O.charAt(1),A[Q++]=255&O.charAt(2),A[Q++]=255&O.charAt(3)):(A[Q++]=255&D.charAt(0),A[Q++]=255&D.charAt(1),A[Q++]=255&D.charAt(2),A[Q++]=255&D.charAt(3)),p(A,Q,r+s+i+o),Q+=4,p(A,Q,W.VBR_seek_table.nVbrNumFrames),Q+=4;var ce=W.VBR_seek_table.nBytesWritten+W.VBR_seek_table.TotalFrameSize;p(A,Q,0|ce),Q+=4,GV.arraycopy(X,0,A,Q,X.length),Q+=X.length,y.error_protection&&e.CRC_writeheader(W,A);for(var J=0,ne=0;ne<Q;ne++)J=T(A[ne],J);return Q+=M(y,ce,A,Q,J),W.VBR_seek_table.TotalFrameSize},this.putVbrTag=function(y,A){var W=y.internal_flags;if(W.VBR_seek_table.pos<=0||(A.seek(A.length()),A.length()==0))return-1;var X=H(A);A.seek(X);var ne=_u(l),Q=getLameTagFrame(y,ne);return Q>ne.length?-1:(Q<1||A.write(ne,0,Q),0)}}var QV=mc,PT=Bt,T2=PT.new_byte,JV=PT.assert,ZV=j0(),eB=MV,tB=IT,nB=CT(),rB=jV,sB=xT(),iB=qV,oB=Bc,aB=H0();Hn();var lB=WV,cB=QV;function uB(){this.setModules=function(n,e){}}function hB(){this.setModules=function(n,e,t){}}function fB(){}function dB(){this.setModules=function(n,e){}}function pB(n,e,t){arguments.length!=3&&(console.error("WARN: Mp3Encoder(channels, samplerate, kbps) not specified"),n=1,e=44100,t=128);var r=new ZV,s=new uB,i=new tB,o=new aB,a=new eB,l=new nB,c=new rB,u=new cB,f=new lB,d=new dB,m=new iB,_=new sB,D=new hB,O=new fB;r.setModules(i,o,a,l,c,u,f,d,O),o.setModules(i,O,f,u),d.setModules(o,f),a.setModules(r),c.setModules(o,m,l,_),l.setModules(_,m,r.enc.psy),m.setModules(o),_.setModules(l),u.setModules(r,o,f),s.setModules(D,O),D.setModules(f,d,a);var x=r.lame_init();x.num_channels=n,x.in_samplerate=e,x.brate=t,x.mode=oB.STEREO,x.quality=3,x.bWriteVbrTag=!1,x.disable_reservoir=!0,x.write_id3tag_automatic=!1,r.lame_init_params(x);var w=1152,N=0|1.25*w+7200,V=T2(N);this.encodeBuffer=function(p,k){n==1&&(k=p),JV(p.length==k.length),p.length>w&&(w=p.length,N=0|1.25*w+7200,V=T2(N));var S=r.lame_encode_buffer(x,p,k,p.length,V,0,N);return new Int8Array(V.subarray(0,S))},this.flush=function(){var p=r.lame_encode_flush(x,V,0,N);return new Int8Array(V.subarray(0,p))}}function Cf(n){return n.charCodeAt(0)<<24|n.charCodeAt(1)<<16|n.charCodeAt(2)<<8|n.charCodeAt(3)}Cf("RIFF");Cf("WAVE");Cf("fmt ");Cf("data");var mB=pB;class gB{constructor(e){this.bitRate=e.bitRate,this.sampleRate=e.sampleRate,this.dataBuffer=[],this.encoder=new mB(1,this.sampleRate,this.bitRate)}encode(e){const t=this._convertBuffer(e);let r=t.length;for(let s=0;r>=0;s+=1152){const i=t.subarray(s,s+1152),o=this.encoder.encodeBuffer(i);this.dataBuffer.push(new Int8Array(o)),r-=1152}}finish(){this.dataBuffer.push(this.encoder.flush());const e=new Blob(this.dataBuffer,{type:"audio/mp3"});return this.dataBuffer=[],{id:Date.now(),blob:e,url:URL.createObjectURL(e)}}_floatTo16BitPCM(e,t){for(let r=0;r<e.length;r++){const s=Math.max(-1,Math.min(1,e[r]));t[r]=s<0?s*32768:s*32767}}_convertBuffer(e){const t=new Float32Array(e),r=new Int16Array(e.length);return this._floatTo16BitPCM(t,r),r}}class _B{constructor(e){this.bufferSize=e.bufferSize||4096,this.sampleRate=e.sampleRate,this.samples=e.samples}finish(){this._joinSamples();let e=new ArrayBuffer(44+this.samples.length*2),t=new DataView(e);this._writeString(t,0,"RIFF"),t.setUint32(4,36+this.samples.length*2,!0),this._writeString(t,8,"WAVE"),this._writeString(t,12,"fmt "),t.setUint32(16,16,!0),t.setUint16(20,1,!0),t.setUint16(22,1,!0),t.setUint32(24,this.sampleRate,!0),t.setUint32(28,this.sampleRate*4,!0),t.setUint16(32,4,!0),t.setUint16(34,16,!0),this._writeString(t,36,"data"),t.setUint32(40,this.samples.length*2,!0),this._floatTo16BitPCM(t,44,this.samples);const r=new Blob([t],{type:"audio/wav"});return{id:Date.now(),blob:r,url:URL.createObjectURL(r)}}_floatTo16BitPCM(e,t,r){for(let s=0;s<r.length;s++,t+=2){let i=Math.max(-1,Math.min(1,r[s]));e.setInt16(t,i<0?i*32768:i*32767,!0)}}_joinSamples(){let e=this.samples.length*this.bufferSize,t=new Float64Array(e),r=0;for(let s=0;s<this.samples.length;s++){let i=this.samples[s];t.set(i,r),r+=i.length}this.samples=t}_writeString(e,t,r){for(let s=0;s<r.length;s++)e.setUint8(t+s,r.charCodeAt(s))}}class yB{constructor(e={}){this.beforeRecording=e.beforeRecording,this.pauseRecording=e.pauseRecording,this.afterRecording=e.afterRecording,this.micFailed=e.micFailed,this.format=e.format,this.encoderOptions={bitRate:e.bitRate,sampleRate:e.sampleRate},this.bufferSize=4096,this.records=[],this.isPause=!1,this.isRecording=!1,this.duration=0,this.volume=0,this.wavSamples=[],this._duration=0}start(){const e={video:!1,audio:{channelCount:1,echoCancellation:!1}};this.beforeRecording&&this.beforeRecording("start recording"),navigator.mediaDevices.getUserMedia(e).then(this._micCaptured.bind(this)).catch(this._micError.bind(this)),this.isPause=!1,this.isRecording=!0,this._isMp3()&&!this.lameEncoder&&(this.lameEncoder=new gB(this.encoderOptions))}stop(){this.stream.getTracks().forEach(t=>t.stop()),this.input.disconnect(),this.processor.disconnect(),this.context.close();let e=null;this._isMp3()?e=this.lameEncoder.finish():(e=new _B({bufferSize:this.bufferSize,sampleRate:this.encoderOptions.sampleRate,samples:this.wavSamples}).finish(),this.wavSamples=[]),e.duration=ni(this.duration),this.records.push(e),this._duration=0,this.duration=0,this.isPause=!1,this.isRecording=!1,this.afterRecording&&this.afterRecording(e)}pause(){this.stream.getTracks().forEach(e=>e.stop()),this.input.disconnect(),this.processor.disconnect(),this._duration=this.duration,this.isPause=!0,this.pauseRecording&&this.pauseRecording("pause recording")}recordList(){return this.records}lastRecord(){return this.records.slice(-1).pop()}_micCaptured(e){this.context=new(window.AudioContext||window.webkitAudioContext),this.duration=this._duration,this.input=this.context.createMediaStreamSource(e),this.processor=this.context.createScriptProcessor(this.bufferSize,1,1),this.stream=e,this.processor.onaudioprocess=t=>{const r=t.inputBuffer.getChannelData(0);let s=0;this._isMp3()?this.lameEncoder.encode(r):this.wavSamples.push(new Float32Array(r));for(let i=0;i<r.length;++i)s+=r[i]*r[i];this.duration=parseFloat(this._duration)+parseFloat(this.context.currentTime.toFixed(2)),this.volume=Math.sqrt(s/r.length).toFixed(2)},this.input.connect(this.processor),this.processor.connect(this.context.destination)}_micError(e){this.micFailed&&this.micFailed(e)}_isMp3(){return this.format.toLowerCase()==="mp3"}}const bB={name:"AudioRecorder",mixins:[cT],props:{attempts:{type:Number},time:{type:Number},bitRate:{type:Number,default:128},sampleRate:{type:Number,default:44100},showDownloadButton:{type:Boolean,default:!0},showUploadButton:{type:Boolean,default:!0},micFailed:{type:Function},beforeRecording:{type:Function},pauseRecording:{type:Function},afterRecording:{type:Function},failedUpload:{type:Function},beforeUpload:{type:Function},successfulUpload:{type:Function},selectRecord:{type:Function}},data(){return{isUploading:!1,recorder:this._initRecorder(),recordList:[],selected:{},uploadStatus:null}},components:{AudioPlayer:Gp,Downloader:PL,IconButton:Lc,Uploader:DL},beforeUnmount(){this.stopRecorder()},methods:{onStartUpload(){this.isUploading=!0,this.beforeUpload&&this.beforeUpload("before upload")},onEndUpload(n){this.isUploading=!1,n.status==="success"?this.successfulUpload&&this.successfulUpload(n.response):this.failedUpload&&this.failedUpload(n.response)},toggleRecorder(){this.attempts&&this.recorder.records.length>=this.attempts||(!this.isRecording||this.isRecording&&this.isPause?this.recorder.start():this.recorder.pause())},stopRecorder(){this.isRecording&&(this.recorder.stop(),this.recordList=this.recorder.recordList())},removeRecord(n){this.recordList.splice(n,1),this.selected.url=null,this.$refs.player._resetProgress()},choiceRecord(n){this.selected!==n&&(this.selected=n,this.selectRecord&&this.selectRecord(n))},_initRecorder(){return new yB({beforeRecording:this.beforeRecording,afterRecording:this.afterRecording,pauseRecording:this.pauseRecording,micFailed:this.micFailed,bitRate:this.bitRate,sampleRate:this.sampleRate,format:this.format})}},computed:{attemptsLeft(){return this.attempts-this.recordList.length},iconButtonType(){return this.isRecording&&this.isPause?"mic":this.isRecording?"pause":"mic"},isPause(){return this.recorder.isPause},isRecording(){return this.recorder.isRecording},recordedTime(){return this.time&&this.recorder.duration>=this.time*60&&this.stopRecorder(),ni(this.recorder.duration)},volume(){return parseFloat(this.recorder.volume)}}},vB={class:"ar"},EB={key:0,class:"ar__overlay"},wB={key:1,class:"ar-spinner"},TB=pt("div",{class:"ar-spinner__dot"},null,-1),SB=pt("div",{class:"ar-spinner__dot"},null,-1),AB=pt("div",{class:"ar-spinner__dot"},null,-1),IB=[TB,SB,AB],RB={class:"ar-recorder"},kB={key:0,class:"ar-recorder__records-limit"},CB={class:"ar-recorder__duration"},xB={key:1,class:"ar-recorder__time-limit"},MB={class:"ar-records"},PB=["onClick"],OB=["onClick"],NB={class:"ar__text"},DB={class:"ar__text"};function LB(n,e,t,r,s,i){const o=nr("icon-button"),a=nr("downloader"),l=nr("uploader"),c=nr("audio-player");return $t(),Nn("div",vB,[s.isUploading?($t(),Nn("div",EB)):Ks("",!0),s.isUploading?($t(),Nn("div",wB,IB)):Ks("",!0),pt("div",{class:mi(["ar-content",{ar__blur:s.isUploading}])},[pt("div",RB,[vt(o,{class:mi(["ar-icon ar-icon__lg",{"ar-icon--rec":i.isRecording,"ar-icon--pulse":i.isRecording&&i.volume>.02}]),name:i.iconButtonType,onClick:i.toggleRecorder},null,8,["name","class","onClick"]),vt(o,{class:"ar-icon ar-icon__sm ar-recorder__stop",name:"stop",onClick:i.stopRecorder},null,8,["onClick"])]),t.attempts?($t(),Nn("div",kB,"Attempts: "+Ys(i.attemptsLeft)+"/"+Ys(t.attempts),1)):Ks("",!0),pt("div",CB,Ys(i.recordedTime),1),t.time?($t(),Nn("div",xB,"Record duration is limited: "+Ys(t.time)+"m",1)):Ks("",!0),pt("div",MB,[($t(!0),Nn(ur,null,r4(s.recordList,(u,f)=>($t(),Nn("div",{class:mi(["ar-records__record",{"ar-records__record--selected":u.id===s.selected.id}]),key:u.id,onClick:d=>i.choiceRecord(u)},[u.id===s.selected.id?($t(),Nn("div",{key:0,class:"ar__rm",onClick:d=>i.removeRecord(f)},"",8,OB)):Ks("",!0),pt("div",NB,"Record "+Ys(f+1),1),pt("div",DB,Ys(u.duration),1),u.id===s.selected.id&&t.showDownloadButton?($t(),ba(a,{key:1,class:"ar__downloader",record:u,filename:n.filename},null,8,["record","filename"])):Ks("",!0),u.id===s.selected.id&&t.showUploadButton?($t(),ba(l,{key:2,class:"ar__uploader",record:u,filename:n.filename,headers:n.headers,"upload-url":n.uploadUrl,onStartUpload:i.onStartUpload,onEndUpload:i.onEndUpload},null,8,["record","filename","headers","upload-url","onStartUpload","onEndUpload"])):Ks("",!0)],10,PB))),128))]),vt(c,{ref:"player",record:s.selected},null,8,["record"])],2)])}const S2=No(bB,[["render",LB]]),bF={install(n){n.component(S2.name,S2),n.component(Gp.name,Gp)}},Sh=Ok({history:ak("/"),routes:[{path:"/",name:"home",component:_M},{path:"/OmHaven",name:"omhaven",component:()=>Hr(()=>import("./AboutGarden-BL6GR5sE.js"),__vite__mapDeps([0,1,2]))},{path:"/map",name:"map",component:()=>Hr(()=>import("./MapView-qkKO5SCB.js"),__vite__mapDeps([3,1,4]))},{path:"/calender",name:"calender",component:()=>Hr(()=>import("./CalenderView-GuxHBmbT.js"),__vite__mapDeps([5,6]))},{path:"/:pathMatch(.*)*",name:"404",component:()=>Hr(()=>import("./404View-CMNVDfyR.js"),__vite__mapDeps([7,1,8]))},{path:"/plant/:id",name:"PlantPage",component:()=>Hr(()=>import("./PlantPage-MlLtCwq-.js"),__vite__mapDeps([9,10])),props:!0},{path:"/event/:id",name:"event-detail",component:()=>Hr(()=>import("./SingleEventPage-DmEq6x_M.js"),__vite__mapDeps([11,1,12])),props:!0},{path:"/areas/:id",name:"countryView",component:()=>Hr(()=>import("./CountryView-DnN8cFEr.js"),__vite__mapDeps([13,1,14])),props:!0},{path:"/plants/:origin",name:"plantoverview",component:()=>Hr(()=>import("./PlantOverview-Cmnb5Dk-.js"),__vite__mapDeps([15,16])),props:!0},{path:"/admin",name:"admin",component:()=>Hr(()=>import("./AdminDashboard-CYyEXQCk.js"),__vite__mapDeps([17,1])),meta:{requiresAuth:!0}},{path:"/login",name:"login",component:()=>Hr(()=>import("./LoginView-Dhvqv6r5.js"),__vite__mapDeps([18,19]))}]});Sh.beforeEach((n,e,t)=>{const r=eh(),s=n.matched.some(o=>o.meta.requiresAuth),i=r.currentUser;s&&!i?t("/login"):t()});const z0=IA(nM);z0.use(xA());z0.use(Sh);z0.mount("#app");export{iF as $,ub as A,zB as B,VB as C,L4 as D,B4 as E,ur as F,Oh as G,FB as H,vu as I,mi as J,ui as K,Ks as L,UB as M,Tr as N,sn as O,cb as P,NS as Q,_c as R,XB as S,Nb as T,qB as U,QB as V,jB as W,HB as X,$B as Y,w8 as Z,Hb as _,vt as a,GB as a0,Gx as a1,dF as a2,fF as a3,rF as a4,sF as a5,xS as a6,lb as a7,pF as a8,im as a9,_m as aa,KB as ab,BB as ac,j4 as ad,gF as ae,_F as af,YB as ag,hF as ah,cF as ai,aF as aj,lF as ak,bF as al,yF as am,eh as an,WB as b,Nn as c,Ub as d,oF as e,nF as f,S8 as g,ab as h,pt as i,ib as j,V4 as k,Dk as l,JB as m,M3 as n,$t as o,sb as p,aa as q,Mh as r,r4 as s,Ys as t,ym as u,ba as v,kl as w,nr as x,yc as y,hr as z};
