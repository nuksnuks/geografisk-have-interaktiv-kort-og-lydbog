const __vite__fileDeps=["assets/AboutGarden-D--KqRoi.js","assets/TopNav-Bp2iwgNm.js","assets/AboutGarden-Bc1Lx8TL.css","assets/MapView-BJ2bbAiJ.js","assets/MapView-DHjs10w9.css","assets/CalenderView-gYIenJST.js","assets/CalenderView-BFbSI-GV.css","assets/404View-I9Oa_NXT.js","assets/404View-CnqEGJVp.css","assets/PlantPage-DBzmp3X9.js","assets/PlantPage-lvU3t2DN.css","assets/SingleEventPage-B7xQKkfm.js","assets/SingleEventPage-DaQfUv29.css","assets/CountryView-CvkPUqNH.js","assets/CountryView-i28PuTMO.css","assets/PlantOverview-BKiY7zB_.js","assets/PlantOverview-uiVe4LBw.css","assets/AdminDashboard-7_m3iW_h.js","assets/LoginView-DkKH3amv.js","assets/LoginView-DtlMmYLn.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();/**
* @vue/shared v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function af(n,e){const t=new Set(n.split(","));return r=>t.has(r)}const $e={},Ci=[],dn=()=>{},_S=()=>!1,zc=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),lf=n=>n.startsWith("onUpdate:"),ut=Object.assign,cf=(n,e)=>{const t=n.indexOf(e);t>-1&&n.splice(t,1)},ES=Object.prototype.hasOwnProperty,Re=(n,e)=>ES.call(n,e),ue=Array.isArray,ki=n=>Na(n)==="[object Map]",jc=n=>Na(n)==="[object Set]",$m=n=>Na(n)==="[object Date]",me=n=>typeof n=="function",We=n=>typeof n=="string",ts=n=>typeof n=="symbol",Ne=n=>n!==null&&typeof n=="object",wE=n=>(Ne(n)||me(n))&&me(n.then)&&me(n.catch),bE=Object.prototype.toString,Na=n=>bE.call(n),vS=n=>Na(n).slice(8,-1),SE=n=>Na(n)==="[object Object]",uf=n=>We(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,jo=af(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Hc=n=>{const e=Object.create(null);return t=>e[t]||(e[t]=n(t))},TS=/-(\w)/g,qn=Hc(n=>n.replace(TS,(e,t)=>t?t.toUpperCase():"")),wS=/\B([A-Z])/g,ti=Hc(n=>n.replace(wS,"-$1").toLowerCase()),qc=Hc(n=>n.charAt(0).toUpperCase()+n.slice(1)),Nl=Hc(n=>n?`on${qc(n)}`:""),ns=(n,e)=>!Object.is(n,e),Dl=(n,e)=>{for(let t=0;t<n.length;t++)n[t](e)},Xl=(n,e,t)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:t})},ca=n=>{const e=parseFloat(n);return isNaN(e)?n:e},bS=n=>{const e=We(n)?Number(n):NaN;return isNaN(e)?n:e};let zm;const IE=()=>zm||(zm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Wc(n){if(ue(n)){const e={};for(let t=0;t<n.length;t++){const r=n[t],s=We(r)?CS(r):Wc(r);if(s)for(const i in s)e[i]=s[i]}return e}else if(We(n)||Ne(n))return n}const SS=/;(?![^(]*\))/g,IS=/:([^]+)/,AS=/\/\*[^]*?\*\//g;function CS(n){const e={};return n.replace(AS,"").split(SS).forEach(t=>{if(t){const r=t.split(IS);r.length>1&&(e[r[0].trim()]=r[1].trim())}}),e}function Kc(n){let e="";if(We(n))e=n;else if(ue(n))for(let t=0;t<n.length;t++){const r=Kc(n[t]);r&&(e+=r+" ")}else if(Ne(n))for(const t in n)n[t]&&(e+=t+" ");return e.trim()}function UU(n){if(!n)return null;let{class:e,style:t}=n;return e&&!We(e)&&(n.class=Kc(e)),t&&(n.style=Wc(t)),n}const kS="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",RS=af(kS);function AE(n){return!!n||n===""}function PS(n,e){if(n.length!==e.length)return!1;let t=!0;for(let r=0;t&&r<n.length;r++)t=Gc(n[r],e[r]);return t}function Gc(n,e){if(n===e)return!0;let t=$m(n),r=$m(e);if(t||r)return t&&r?n.getTime()===e.getTime():!1;if(t=ts(n),r=ts(e),t||r)return n===e;if(t=ue(n),r=ue(e),t||r)return t&&r?PS(n,e):!1;if(t=Ne(n),r=Ne(e),t||r){if(!t||!r)return!1;const s=Object.keys(n).length,i=Object.keys(e).length;if(s!==i)return!1;for(const o in n){const a=n.hasOwnProperty(o),l=e.hasOwnProperty(o);if(a&&!l||!a&&l||!Gc(n[o],e[o]))return!1}}return String(n)===String(e)}function xS(n,e){return n.findIndex(t=>Gc(t,e))}const $U=n=>We(n)?n:n==null?"":ue(n)||Ne(n)&&(n.toString===bE||!me(n.toString))?JSON.stringify(n,CE,2):String(n),CE=(n,e)=>e&&e.__v_isRef?CE(n,e.value):ki(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((t,[r,s],i)=>(t[oh(r,i)+" =>"]=s,t),{})}:jc(e)?{[`Set(${e.size})`]:[...e.values()].map(t=>oh(t))}:ts(e)?oh(e):Ne(e)&&!ue(e)&&!SE(e)?String(e):e,oh=(n,e="")=>{var t;return ts(n)?`Symbol(${(t=n.description)!=null?t:e})`:n};/**
* @vue/reactivity v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let tn;class kE{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=tn,!e&&tn&&(this.index=(tn.scopes||(tn.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const t=tn;try{return tn=this,e()}finally{tn=t}}}on(){tn=this}off(){tn=this.parent}stop(e){if(this._active){let t,r;for(t=0,r=this.effects.length;t<r;t++)this.effects[t].stop();for(t=0,r=this.cleanups.length;t<r;t++)this.cleanups[t]();if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].stop(!0);if(!this.detached&&this.parent&&!e){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0,this._active=!1}}}function RE(n){return new kE(n)}function OS(n,e=tn){e&&e.active&&e.effects.push(n)}function PE(){return tn}function MS(n){tn&&tn.cleanups.push(n)}let Ds;class hf{constructor(e,t,r,s){this.fn=e,this.trigger=t,this.scheduler=r,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,OS(this,s)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,ni();for(let e=0;e<this._depsLength;e++){const t=this.deps[e];if(t.computed&&(NS(t.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),ri()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=Hr,t=Ds;try{return Hr=!0,Ds=this,this._runnings++,jm(this),this.fn()}finally{Hm(this),this._runnings--,Ds=t,Hr=e}}stop(){var e;this.active&&(jm(this),Hm(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function NS(n){return n.value}function jm(n){n._trackId++,n._depsLength=0}function Hm(n){if(n.deps.length>n._depsLength){for(let e=n._depsLength;e<n.deps.length;e++)xE(n.deps[e],n);n.deps.length=n._depsLength}}function xE(n,e){const t=n.get(e);t!==void 0&&e._trackId!==t&&(n.delete(e),n.size===0&&n.cleanup())}let Hr=!0,Xh=0;const OE=[];function ni(){OE.push(Hr),Hr=!1}function ri(){const n=OE.pop();Hr=n===void 0?!0:n}function df(){Xh++}function ff(){for(Xh--;!Xh&&Zh.length;)Zh.shift()()}function ME(n,e,t){if(e.get(n)!==n._trackId){e.set(n,n._trackId);const r=n.deps[n._depsLength];r!==e?(r&&xE(r,n),n.deps[n._depsLength++]=e):n._depsLength++}}const Zh=[];function NE(n,e,t){df();for(const r of n.keys()){let s;r._dirtyLevel<e&&(s??(s=n.get(r)===r._trackId))&&(r._shouldSchedule||(r._shouldSchedule=r._dirtyLevel===0),r._dirtyLevel=e),r._shouldSchedule&&(s??(s=n.get(r)===r._trackId))&&(r.trigger(),(!r._runnings||r.allowRecurse)&&r._dirtyLevel!==2&&(r._shouldSchedule=!1,r.scheduler&&Zh.push(r.scheduler)))}ff()}const DE=(n,e)=>{const t=new Map;return t.cleanup=n,t.computed=e,t},Zl=new WeakMap,Ls=Symbol(""),ed=Symbol("");function Qt(n,e,t){if(Hr&&Ds){let r=Zl.get(n);r||Zl.set(n,r=new Map);let s=r.get(t);s||r.set(t,s=DE(()=>r.delete(t))),ME(Ds,s)}}function or(n,e,t,r,s,i){const o=Zl.get(n);if(!o)return;let a=[];if(e==="clear")a=[...o.values()];else if(t==="length"&&ue(n)){const l=Number(r);o.forEach((c,h)=>{(h==="length"||!ts(h)&&h>=l)&&a.push(c)})}else switch(t!==void 0&&a.push(o.get(t)),e){case"add":ue(n)?uf(t)&&a.push(o.get("length")):(a.push(o.get(Ls)),ki(n)&&a.push(o.get(ed)));break;case"delete":ue(n)||(a.push(o.get(Ls)),ki(n)&&a.push(o.get(ed)));break;case"set":ki(n)&&a.push(o.get(Ls));break}df();for(const l of a)l&&NE(l,4);ff()}function DS(n,e){var t;return(t=Zl.get(n))==null?void 0:t.get(e)}const LS=af("__proto__,__v_isRef,__isVue"),LE=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(ts)),qm=VS();function VS(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...t){const r=Ce(this);for(let i=0,o=this.length;i<o;i++)Qt(r,"get",i+"");const s=r[e](...t);return s===-1||s===!1?r[e](...t.map(Ce)):s}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...t){ni(),df();const r=Ce(this)[e].apply(this,t);return ff(),ri(),r}}),n}function FS(n){const e=Ce(this);return Qt(e,"has",n),e.hasOwnProperty(n)}class VE{constructor(e=!1,t=!1){this._isReadonly=e,this._isShallow=t}get(e,t,r){const s=this._isReadonly,i=this._isShallow;if(t==="__v_isReactive")return!s;if(t==="__v_isReadonly")return s;if(t==="__v_isShallow")return i;if(t==="__v_raw")return r===(s?i?YS:$E:i?UE:BE).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(r)?e:void 0;const o=ue(e);if(!s){if(o&&Re(qm,t))return Reflect.get(qm,t,r);if(t==="hasOwnProperty")return FS}const a=Reflect.get(e,t,r);return(ts(t)?LE.has(t):LS(t))||(s||Qt(e,"get",t),i)?a:at(a)?o&&uf(t)?a:a.value:Ne(a)?s?jE(a):Da(a):a}}class FE extends VE{constructor(e=!1){super(!1,e)}set(e,t,r,s){let i=e[t];if(!this._isShallow){const l=$i(i);if(!ec(r)&&!$i(r)&&(i=Ce(i),r=Ce(r)),!ue(e)&&at(i)&&!at(r))return l?!1:(i.value=r,!0)}const o=ue(e)&&uf(t)?Number(t)<e.length:Re(e,t),a=Reflect.set(e,t,r,s);return e===Ce(s)&&(o?ns(r,i)&&or(e,"set",t,r):or(e,"add",t,r)),a}deleteProperty(e,t){const r=Re(e,t);e[t];const s=Reflect.deleteProperty(e,t);return s&&r&&or(e,"delete",t,void 0),s}has(e,t){const r=Reflect.has(e,t);return(!ts(t)||!LE.has(t))&&Qt(e,"has",t),r}ownKeys(e){return Qt(e,"iterate",ue(e)?"length":Ls),Reflect.ownKeys(e)}}class BS extends VE{constructor(e=!1){super(!0,e)}set(e,t){return!0}deleteProperty(e,t){return!0}}const US=new FE,$S=new BS,zS=new FE(!0),pf=n=>n,Jc=n=>Reflect.getPrototypeOf(n);function pl(n,e,t=!1,r=!1){n=n.__v_raw;const s=Ce(n),i=Ce(e);t||(ns(e,i)&&Qt(s,"get",e),Qt(s,"get",i));const{has:o}=Jc(s),a=r?pf:t?yf:ua;if(o.call(s,e))return a(n.get(e));if(o.call(s,i))return a(n.get(i));n!==s&&n.get(e)}function ml(n,e=!1){const t=this.__v_raw,r=Ce(t),s=Ce(n);return e||(ns(n,s)&&Qt(r,"has",n),Qt(r,"has",s)),n===s?t.has(n):t.has(n)||t.has(s)}function gl(n,e=!1){return n=n.__v_raw,!e&&Qt(Ce(n),"iterate",Ls),Reflect.get(n,"size",n)}function Wm(n){n=Ce(n);const e=Ce(this);return Jc(e).has.call(e,n)||(e.add(n),or(e,"add",n,n)),this}function Km(n,e){e=Ce(e);const t=Ce(this),{has:r,get:s}=Jc(t);let i=r.call(t,n);i||(n=Ce(n),i=r.call(t,n));const o=s.call(t,n);return t.set(n,e),i?ns(e,o)&&or(t,"set",n,e):or(t,"add",n,e),this}function Gm(n){const e=Ce(this),{has:t,get:r}=Jc(e);let s=t.call(e,n);s||(n=Ce(n),s=t.call(e,n)),r&&r.call(e,n);const i=e.delete(n);return s&&or(e,"delete",n,void 0),i}function Jm(){const n=Ce(this),e=n.size!==0,t=n.clear();return e&&or(n,"clear",void 0,void 0),t}function yl(n,e){return function(r,s){const i=this,o=i.__v_raw,a=Ce(o),l=e?pf:n?yf:ua;return!n&&Qt(a,"iterate",Ls),o.forEach((c,h)=>r.call(s,l(c),l(h),i))}}function _l(n,e,t){return function(...r){const s=this.__v_raw,i=Ce(s),o=ki(i),a=n==="entries"||n===Symbol.iterator&&o,l=n==="keys"&&o,c=s[n](...r),h=t?pf:e?yf:ua;return!e&&Qt(i,"iterate",l?ed:Ls),{next(){const{value:d,done:f}=c.next();return f?{value:d,done:f}:{value:a?[h(d[0]),h(d[1])]:h(d),done:f}},[Symbol.iterator](){return this}}}}function Er(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function jS(){const n={get(i){return pl(this,i)},get size(){return gl(this)},has:ml,add:Wm,set:Km,delete:Gm,clear:Jm,forEach:yl(!1,!1)},e={get(i){return pl(this,i,!1,!0)},get size(){return gl(this)},has:ml,add:Wm,set:Km,delete:Gm,clear:Jm,forEach:yl(!1,!0)},t={get(i){return pl(this,i,!0)},get size(){return gl(this,!0)},has(i){return ml.call(this,i,!0)},add:Er("add"),set:Er("set"),delete:Er("delete"),clear:Er("clear"),forEach:yl(!0,!1)},r={get(i){return pl(this,i,!0,!0)},get size(){return gl(this,!0)},has(i){return ml.call(this,i,!0)},add:Er("add"),set:Er("set"),delete:Er("delete"),clear:Er("clear"),forEach:yl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{n[i]=_l(i,!1,!1),t[i]=_l(i,!0,!1),e[i]=_l(i,!1,!0),r[i]=_l(i,!0,!0)}),[n,t,e,r]}const[HS,qS,WS,KS]=jS();function mf(n,e){const t=e?n?KS:WS:n?qS:HS;return(r,s,i)=>s==="__v_isReactive"?!n:s==="__v_isReadonly"?n:s==="__v_raw"?r:Reflect.get(Re(t,s)&&s in r?t:r,s,i)}const GS={get:mf(!1,!1)},JS={get:mf(!1,!0)},QS={get:mf(!0,!1)},BE=new WeakMap,UE=new WeakMap,$E=new WeakMap,YS=new WeakMap;function XS(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ZS(n){return n.__v_skip||!Object.isExtensible(n)?0:XS(vS(n))}function Da(n){return $i(n)?n:gf(n,!1,US,GS,BE)}function zE(n){return gf(n,!1,zS,JS,UE)}function jE(n){return gf(n,!0,$S,QS,$E)}function gf(n,e,t,r,s){if(!Ne(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const i=s.get(n);if(i)return i;const o=ZS(n);if(o===0)return n;const a=new Proxy(n,o===2?r:t);return s.set(n,a),a}function qr(n){return $i(n)?qr(n.__v_raw):!!(n&&n.__v_isReactive)}function $i(n){return!!(n&&n.__v_isReadonly)}function ec(n){return!!(n&&n.__v_isShallow)}function HE(n){return qr(n)||$i(n)}function Ce(n){const e=n&&n.__v_raw;return e?Ce(e):n}function Qc(n){return Object.isExtensible(n)&&Xl(n,"__v_skip",!0),n}const ua=n=>Ne(n)?Da(n):n,yf=n=>Ne(n)?jE(n):n;class qE{constructor(e,t,r,s){this.getter=e,this._setter=t,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new hf(()=>e(this._value),()=>Ho(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!s,this.__v_isReadonly=r}get value(){const e=Ce(this);return(!e._cacheable||e.effect.dirty)&&ns(e._value,e._value=e.effect.run())&&Ho(e,4),_f(e),e.effect._dirtyLevel>=2&&Ho(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function eI(n,e,t=!1){let r,s;const i=me(n);return i?(r=n,s=dn):(r=n.get,s=n.set),new qE(r,s,i||!s,t)}function _f(n){var e;Hr&&Ds&&(n=Ce(n),ME(Ds,(e=n.dep)!=null?e:n.dep=DE(()=>n.dep=void 0,n instanceof qE?n:void 0)))}function Ho(n,e=4,t){n=Ce(n);const r=n.dep;r&&NE(r,e)}function at(n){return!!(n&&n.__v_isRef===!0)}function La(n){return WE(n,!1)}function tI(n){return WE(n,!0)}function WE(n,e){return at(n)?n:new nI(n,e)}class nI{constructor(e,t){this.__v_isShallow=t,this.dep=void 0,this.__v_isRef=!0,this._rawValue=t?e:Ce(e),this._value=t?e:ua(e)}get value(){return _f(this),this._value}set value(e){const t=this.__v_isShallow||ec(e)||$i(e);e=t?e:Ce(e),ns(e,this._rawValue)&&(this._rawValue=e,this._value=t?e:ua(e),Ho(this,4))}}function Ri(n){return at(n)?n.value:n}const rI={get:(n,e,t)=>Ri(Reflect.get(n,e,t)),set:(n,e,t,r)=>{const s=n[e];return at(s)&&!at(t)?(s.value=t,!0):Reflect.set(n,e,t,r)}};function KE(n){return qr(n)?n:new Proxy(n,rI)}class sI{constructor(e){this.dep=void 0,this.__v_isRef=!0;const{get:t,set:r}=e(()=>_f(this),()=>Ho(this));this._get=t,this._set=r}get value(){return this._get()}set value(e){this._set(e)}}function zU(n){return new sI(n)}function iI(n){const e=ue(n)?new Array(n.length):{};for(const t in n)e[t]=GE(n,t);return e}class oI{constructor(e,t,r){this._object=e,this._key=t,this._defaultValue=r,this.__v_isRef=!0}get value(){const e=this._object[this._key];return e===void 0?this._defaultValue:e}set value(e){this._object[this._key]=e}get dep(){return DS(Ce(this._object),this._key)}}class aI{constructor(e){this._getter=e,this.__v_isRef=!0,this.__v_isReadonly=!0}get value(){return this._getter()}}function jU(n,e,t){return at(n)?n:me(n)?new aI(n):Ne(n)&&arguments.length>1?GE(n,e,t):La(n)}function GE(n,e,t){const r=n[e];return at(r)?r:new oI(n,e,t)}/**
* @vue/runtime-core v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Wr(n,e,t,r){try{return r?n(...r):n()}catch(s){Yc(s,e,t)}}function pn(n,e,t,r){if(me(n)){const i=Wr(n,e,t,r);return i&&wE(i)&&i.catch(o=>{Yc(o,e,t)}),i}const s=[];for(let i=0;i<n.length;i++)s.push(pn(n[i],e,t,r));return s}function Yc(n,e,t,r=!0){const s=e?e.vnode:null;if(e){let i=e.parent;const o=e.proxy,a=`https://vuejs.org/error-reference/#runtime-${t}`;for(;i;){const c=i.ec;if(c){for(let h=0;h<c.length;h++)if(c[h](n,o,a)===!1)return}i=i.parent}const l=e.appContext.config.errorHandler;if(l){Wr(l,null,10,[n,o,a]);return}}lI(n,t,s,r)}function lI(n,e,t,r=!0){console.error(n)}let ha=!1,td=!1;const Mt=[];let Dn=0;const Pi=[];let Ar=null,Is=0;const JE=Promise.resolve();let Ef=null;function Xc(n){const e=Ef||JE;return n?e.then(this?n.bind(this):n):e}function cI(n){let e=Dn+1,t=Mt.length;for(;e<t;){const r=e+t>>>1,s=Mt[r],i=da(s);i<n||i===n&&s.pre?e=r+1:t=r}return e}function vf(n){(!Mt.length||!Mt.includes(n,ha&&n.allowRecurse?Dn+1:Dn))&&(n.id==null?Mt.push(n):Mt.splice(cI(n.id),0,n),QE())}function QE(){!ha&&!td&&(td=!0,Ef=JE.then(XE))}function uI(n){const e=Mt.indexOf(n);e>Dn&&Mt.splice(e,1)}function hI(n){ue(n)?Pi.push(...n):(!Ar||!Ar.includes(n,n.allowRecurse?Is+1:Is))&&Pi.push(n),QE()}function Qm(n,e,t=ha?Dn+1:0){for(;t<Mt.length;t++){const r=Mt[t];if(r&&r.pre){if(n&&r.id!==n.uid)continue;Mt.splice(t,1),t--,r()}}}function YE(n){if(Pi.length){const e=[...new Set(Pi)].sort((t,r)=>da(t)-da(r));if(Pi.length=0,Ar){Ar.push(...e);return}for(Ar=e,Is=0;Is<Ar.length;Is++)Ar[Is]();Ar=null,Is=0}}const da=n=>n.id==null?1/0:n.id,dI=(n,e)=>{const t=da(n)-da(e);if(t===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return t};function XE(n){td=!1,ha=!0,Mt.sort(dI);try{for(Dn=0;Dn<Mt.length;Dn++){const e=Mt[Dn];e&&e.active!==!1&&Wr(e,null,14)}}finally{Dn=0,Mt.length=0,YE(),ha=!1,Ef=null,(Mt.length||Pi.length)&&XE()}}function fI(n,e,...t){if(n.isUnmounted)return;const r=n.vnode.props||$e;let s=t;const i=e.startsWith("update:"),o=i&&e.slice(7);if(o&&o in r){const h=`${o==="modelValue"?"model":o}Modifiers`,{number:d,trim:f}=r[h]||$e;f&&(s=t.map(m=>We(m)?m.trim():m)),d&&(s=t.map(ca))}let a,l=r[a=Nl(e)]||r[a=Nl(qn(e))];!l&&i&&(l=r[a=Nl(ti(e))]),l&&pn(l,n,6,s);const c=r[a+"Once"];if(c){if(!n.emitted)n.emitted={};else if(n.emitted[a])return;n.emitted[a]=!0,pn(c,n,6,s)}}function ZE(n,e,t=!1){const r=e.emitsCache,s=r.get(n);if(s!==void 0)return s;const i=n.emits;let o={},a=!1;if(!me(n)){const l=c=>{const h=ZE(c,e,!0);h&&(a=!0,ut(o,h))};!t&&e.mixins.length&&e.mixins.forEach(l),n.extends&&l(n.extends),n.mixins&&n.mixins.forEach(l)}return!i&&!a?(Ne(n)&&r.set(n,null),null):(ue(i)?i.forEach(l=>o[l]=null):ut(o,i),Ne(n)&&r.set(n,o),o)}function Zc(n,e){return!n||!zc(e)?!1:(e=e.slice(2).replace(/Once$/,""),Re(n,e[0].toLowerCase()+e.slice(1))||Re(n,ti(e))||Re(n,e))}let it=null,eu=null;function tc(n){const e=it;return it=n,eu=n&&n.type.__scopeId||null,e}function ev(n){eu=n}function tv(){eu=null}function Br(n,e=it,t){if(!e||n._n)return n;const r=(...s)=>{r._d&&ug(-1);const i=tc(e);let o;try{o=n(...s)}finally{tc(i),r._d&&ug(1)}return o};return r._n=!0,r._c=!0,r._d=!0,r}function ah(n){const{type:e,vnode:t,proxy:r,withProxy:s,props:i,propsOptions:[o],slots:a,attrs:l,emit:c,render:h,renderCache:d,data:f,setupState:m,ctx:y,inheritAttrs:T}=n;let w,P;const O=tc(n);try{if(t.shapeFlag&4){const $=s||r,q=$;w=Nn(h.call(q,$,d,i,m,f,y)),P=l}else{const $=e;w=Nn($.length>1?$(i,{attrs:l,slots:a,emit:c}):$(i,null)),P=e.props?l:pI(l)}}catch($){Jo.length=0,Yc($,n,1),w=je(gn)}let D=w;if(P&&T!==!1){const $=Object.keys(P),{shapeFlag:q}=D;$.length&&q&7&&(o&&$.some(lf)&&(P=mI(P,o)),D=rs(D,P))}return t.dirs&&(D=rs(D),D.dirs=D.dirs?D.dirs.concat(t.dirs):t.dirs),t.transition&&(D.transition=t.transition),w=D,tc(O),w}const pI=n=>{let e;for(const t in n)(t==="class"||t==="style"||zc(t))&&((e||(e={}))[t]=n[t]);return e},mI=(n,e)=>{const t={};for(const r in n)(!lf(r)||!(r.slice(9)in e))&&(t[r]=n[r]);return t};function gI(n,e,t){const{props:r,children:s,component:i}=n,{props:o,children:a,patchFlag:l}=e,c=i.emitsOptions;if(e.dirs||e.transition)return!0;if(t&&l>=0){if(l&1024)return!0;if(l&16)return r?Ym(r,o,c):!!o;if(l&8){const h=e.dynamicProps;for(let d=0;d<h.length;d++){const f=h[d];if(o[f]!==r[f]&&!Zc(c,f))return!0}}}else return(s||a)&&(!a||!a.$stable)?!0:r===o?!1:r?o?Ym(r,o,c):!0:!!o;return!1}function Ym(n,e,t){const r=Object.keys(e);if(r.length!==Object.keys(n).length)return!0;for(let s=0;s<r.length;s++){const i=r[s];if(e[i]!==n[i]&&!Zc(t,i))return!0}return!1}function yI({vnode:n,parent:e},t){for(;e;){const r=e.subTree;if(r.suspense&&r.suspense.activeBranch===n&&(r.el=n.el),r===n)(n=e.vnode).el=t,e=e.parent;else break}}const Tf="components",_I="directives";function nc(n,e){return wf(Tf,n,!0,e)||n}const nv=Symbol.for("v-ndc");function HU(n){return We(n)?wf(Tf,n,!1)||n:n||nv}function qU(n){return wf(_I,n)}function wf(n,e,t=!0,r=!1){const s=it||mt;if(s){const i=s.type;if(n===Tf){const a=_A(i,!1);if(a&&(a===e||a===qn(e)||a===qc(qn(e))))return i}const o=Xm(s[n]||i[n],e)||Xm(s.appContext[n],e);return!o&&r?i:o}}function Xm(n,e){return n&&(n[e]||n[qn(e)]||n[qc(qn(e))])}const EI=n=>n.__isSuspense;function vI(n,e){e&&e.pendingBranch?ue(n)?e.effects.push(...n):e.effects.push(n):hI(n)}const TI=Symbol.for("v-scx"),wI=()=>mn(TI);function WU(n,e){return bf(n,null,e)}const El={};function qo(n,e,t){return bf(n,e,t)}function bf(n,e,{immediate:t,deep:r,flush:s,once:i,onTrack:o,onTrigger:a}=$e){if(e&&i){const F=e;e=(...A)=>{F(...A),q()}}const l=mt,c=F=>r===!0?F:Ps(F,r===!1?1:void 0);let h,d=!1,f=!1;if(at(n)?(h=()=>n.value,d=ec(n)):qr(n)?(h=()=>c(n),d=!0):ue(n)?(f=!0,d=n.some(F=>qr(F)||ec(F)),h=()=>n.map(F=>{if(at(F))return F.value;if(qr(F))return c(F);if(me(F))return Wr(F,l,2)})):me(n)?e?h=()=>Wr(n,l,2):h=()=>(m&&m(),pn(n,l,3,[y])):h=dn,e&&r){const F=h;h=()=>Ps(F())}let m,y=F=>{m=D.onStop=()=>{Wr(F,l,4),m=D.onStop=void 0}},T;if(ou)if(y=dn,e?t&&pn(e,l,3,[h(),f?[]:void 0,y]):h(),s==="sync"){const F=wI();T=F.__watcherHandles||(F.__watcherHandles=[])}else return dn;let w=f?new Array(n.length).fill(El):El;const P=()=>{if(!(!D.active||!D.dirty))if(e){const F=D.run();(r||d||(f?F.some((A,_)=>ns(A,w[_])):ns(F,w)))&&(m&&m(),pn(e,l,3,[F,w===El?void 0:f&&w[0]===El?[]:w,y]),w=F)}else D.run()};P.allowRecurse=!!e;let O;s==="sync"?O=P:s==="post"?O=()=>qt(P,l&&l.suspense):(P.pre=!0,l&&(P.id=l.uid),O=()=>vf(P));const D=new hf(h,dn,O),$=PE(),q=()=>{D.stop(),$&&cf($.effects,D)};return e?t?P():w=D.run():s==="post"?qt(D.run.bind(D),l&&l.suspense):D.run(),T&&T.push(q),q}function bI(n,e,t){const r=this.proxy,s=We(n)?n.includes(".")?rv(r,n):()=>r[n]:n.bind(r,r);let i;me(e)?i=e:(i=e.handler,t=e);const o=Va(this),a=bf(s,i.bind(r),t);return o(),a}function rv(n,e){const t=e.split(".");return()=>{let r=n;for(let s=0;s<t.length&&r;s++)r=r[t[s]];return r}}function Ps(n,e,t=0,r){if(!Ne(n)||n.__v_skip)return n;if(e&&e>0){if(t>=e)return n;t++}if(r=r||new Set,r.has(n))return n;if(r.add(n),at(n))Ps(n.value,e,t,r);else if(ue(n))for(let s=0;s<n.length;s++)Ps(n[s],e,t,r);else if(jc(n)||ki(n))n.forEach(s=>{Ps(s,e,t,r)});else if(SE(n))for(const s in n)Ps(n[s],e,t,r);return n}function KU(n,e){if(it===null)return n;const t=au(it)||it.proxy,r=n.dirs||(n.dirs=[]);for(let s=0;s<e.length;s++){let[i,o,a,l=$e]=e[s];i&&(me(i)&&(i={mounted:i,updated:i}),i.deep&&Ps(o),r.push({dir:i,instance:t,value:o,oldValue:void 0,arg:a,modifiers:l}))}return n}function vs(n,e,t,r){const s=n.dirs,i=e&&e.dirs;for(let o=0;o<s.length;o++){const a=s[o];i&&(a.oldValue=i[o].value);let l=a.dir[r];l&&(ni(),pn(l,t,8,[n.el,a,n,e]),ri())}}const Cr=Symbol("_leaveCb"),vl=Symbol("_enterCb");function SI(){const n={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Sf(()=>{n.isMounted=!0}),cv(()=>{n.isUnmounting=!0}),n}const cn=[Function,Array],sv={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:cn,onEnter:cn,onAfterEnter:cn,onEnterCancelled:cn,onBeforeLeave:cn,onLeave:cn,onAfterLeave:cn,onLeaveCancelled:cn,onBeforeAppear:cn,onAppear:cn,onAfterAppear:cn,onAppearCancelled:cn},II={name:"BaseTransition",props:sv,setup(n,{slots:e}){const t=fA(),r=SI();return()=>{const s=e.default&&ov(e.default(),!0);if(!s||!s.length)return;let i=s[0];if(s.length>1){for(const f of s)if(f.type!==gn){i=f;break}}const o=Ce(n),{mode:a}=o;if(r.isLeaving)return lh(i);const l=Zm(i);if(!l)return lh(i);const c=nd(l,o,r,t);rd(l,c);const h=t.subTree,d=h&&Zm(h);if(d&&d.type!==gn&&!As(l,d)){const f=nd(d,o,r,t);if(rd(d,f),a==="out-in")return r.isLeaving=!0,f.afterLeave=()=>{r.isLeaving=!1,t.update.active!==!1&&(t.effect.dirty=!0,t.update())},lh(i);a==="in-out"&&l.type!==gn&&(f.delayLeave=(m,y,T)=>{const w=iv(r,d);w[String(d.key)]=d,m[Cr]=()=>{y(),m[Cr]=void 0,delete c.delayedLeave},c.delayedLeave=T})}return i}}},AI=II;function iv(n,e){const{leavingVNodes:t}=n;let r=t.get(e.type);return r||(r=Object.create(null),t.set(e.type,r)),r}function nd(n,e,t,r){const{appear:s,mode:i,persisted:o=!1,onBeforeEnter:a,onEnter:l,onAfterEnter:c,onEnterCancelled:h,onBeforeLeave:d,onLeave:f,onAfterLeave:m,onLeaveCancelled:y,onBeforeAppear:T,onAppear:w,onAfterAppear:P,onAppearCancelled:O}=e,D=String(n.key),$=iv(t,n),q=(_,v)=>{_&&pn(_,r,9,v)},F=(_,v)=>{const I=v[1];q(_,v),ue(_)?_.every(R=>R.length<=1)&&I():_.length<=1&&I()},A={mode:i,persisted:o,beforeEnter(_){let v=a;if(!t.isMounted)if(s)v=T||a;else return;_[Cr]&&_[Cr](!0);const I=$[D];I&&As(n,I)&&I.el[Cr]&&I.el[Cr](),q(v,[_])},enter(_){let v=l,I=c,R=h;if(!t.isMounted)if(s)v=w||l,I=P||c,R=O||h;else return;let k=!1;const S=_[vl]=De=>{k||(k=!0,De?q(R,[_]):q(I,[_]),A.delayedLeave&&A.delayedLeave(),_[vl]=void 0)};v?F(v,[_,S]):S()},leave(_,v){const I=String(n.key);if(_[vl]&&_[vl](!0),t.isUnmounting)return v();q(d,[_]);let R=!1;const k=_[Cr]=S=>{R||(R=!0,v(),S?q(y,[_]):q(m,[_]),_[Cr]=void 0,$[I]===n&&delete $[I])};$[I]=n,f?F(f,[_,k]):k()},clone(_){return nd(_,e,t,r)}};return A}function lh(n){if(tu(n))return n=rs(n),n.children=null,n}function Zm(n){return tu(n)?n.children?n.children[0]:void 0:n}function rd(n,e){n.shapeFlag&6&&n.component?rd(n.component.subTree,e):n.shapeFlag&128?(n.ssContent.transition=e.clone(n.ssContent),n.ssFallback.transition=e.clone(n.ssFallback)):n.transition=e}function ov(n,e=!1,t){let r=[],s=0;for(let i=0;i<n.length;i++){let o=n[i];const a=t==null?o.key:String(t)+String(o.key!=null?o.key:i);o.type===Wt?(o.patchFlag&128&&s++,r=r.concat(ov(o.children,e,a))):(e||o.type!==gn)&&r.push(a!=null?rs(o,{key:a}):o)}if(s>1)for(let i=0;i<r.length;i++)r[i].patchFlag=-2;return r}/*! #__NO_SIDE_EFFECTS__ */function av(n,e){return me(n)?ut({name:n.name},e,{setup:n}):n}const Wo=n=>!!n.type.__asyncLoader,tu=n=>n.type.__isKeepAlive;function CI(n,e){lv(n,"a",e)}function kI(n,e){lv(n,"da",e)}function lv(n,e,t=mt){const r=n.__wdc||(n.__wdc=()=>{let s=t;for(;s;){if(s.isDeactivated)return;s=s.parent}return n()});if(nu(e,r,t),t){let s=t.parent;for(;s&&s.parent;)tu(s.parent.vnode)&&RI(r,e,t,s),s=s.parent}}function RI(n,e,t,r){const s=nu(e,n,r,!0);uv(()=>{cf(r[e],s)},t)}function nu(n,e,t=mt,r=!1){if(t){const s=t[n]||(t[n]=[]),i=e.__weh||(e.__weh=(...o)=>{if(t.isUnmounted)return;ni();const a=Va(t),l=pn(e,t,n,o);return a(),ri(),l});return r?s.unshift(i):s.push(i),i}}const fr=n=>(e,t=mt)=>(!ou||n==="sp")&&nu(n,(...r)=>e(...r),t),PI=fr("bm"),Sf=fr("m"),xI=fr("bu"),OI=fr("u"),cv=fr("bum"),uv=fr("um"),MI=fr("sp"),NI=fr("rtg"),DI=fr("rtc");function LI(n,e=mt){nu("ec",n,e)}function GU(n,e,t,r){let s;const i=t;if(ue(n)||We(n)){s=new Array(n.length);for(let o=0,a=n.length;o<a;o++)s[o]=e(n[o],o,void 0,i)}else if(typeof n=="number"){s=new Array(n);for(let o=0;o<n;o++)s[o]=e(o+1,o,void 0,i)}else if(Ne(n))if(n[Symbol.iterator])s=Array.from(n,(o,a)=>e(o,a,void 0,i));else{const o=Object.keys(n);s=new Array(o.length);for(let a=0,l=o.length;a<l;a++){const c=o[a];s[a]=e(n[c],c,a,i)}}else s=[];return s}function JU(n,e,t={},r,s){if(it.isCE||it.parent&&Wo(it.parent)&&it.parent.isCE)return je("slot",t,r&&r());let i=n[e];i&&i._c&&(i._d=!1),Kr();const o=i&&hv(i(t)),a=sc(Wt,{key:t.key||o&&o.key||`_${e}`},o||(r?r():[]),o&&n._===1?64:-2);return a.scopeId&&(a.slotScopeIds=[a.scopeId+"-s"]),i&&i._c&&(i._d=!0),a}function hv(n){return n.some(e=>ic(e)?!(e.type===gn||e.type===Wt&&!hv(e.children)):!0)?n:null}function QU(n,e){const t={};for(const r in n)t[/[A-Z]/.test(r)?`on:${r}`:Nl(r)]=n[r];return t}const sd=n=>n?bv(n)?au(n)||n.proxy:sd(n.parent):null,Ko=ut(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>sd(n.parent),$root:n=>sd(n.root),$emit:n=>n.emit,$options:n=>If(n),$forceUpdate:n=>n.f||(n.f=()=>{n.effect.dirty=!0,vf(n.update)}),$nextTick:n=>n.n||(n.n=Xc.bind(n.proxy)),$watch:n=>bI.bind(n)}),ch=(n,e)=>n!==$e&&!n.__isScriptSetup&&Re(n,e),VI={get({_:n},e){const{ctx:t,setupState:r,data:s,props:i,accessCache:o,type:a,appContext:l}=n;let c;if(e[0]!=="$"){const m=o[e];if(m!==void 0)switch(m){case 1:return r[e];case 2:return s[e];case 4:return t[e];case 3:return i[e]}else{if(ch(r,e))return o[e]=1,r[e];if(s!==$e&&Re(s,e))return o[e]=2,s[e];if((c=n.propsOptions[0])&&Re(c,e))return o[e]=3,i[e];if(t!==$e&&Re(t,e))return o[e]=4,t[e];id&&(o[e]=0)}}const h=Ko[e];let d,f;if(h)return e==="$attrs"&&Qt(n,"get",e),h(n);if((d=a.__cssModules)&&(d=d[e]))return d;if(t!==$e&&Re(t,e))return o[e]=4,t[e];if(f=l.config.globalProperties,Re(f,e))return f[e]},set({_:n},e,t){const{data:r,setupState:s,ctx:i}=n;return ch(s,e)?(s[e]=t,!0):r!==$e&&Re(r,e)?(r[e]=t,!0):Re(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(i[e]=t,!0)},has({_:{data:n,setupState:e,accessCache:t,ctx:r,appContext:s,propsOptions:i}},o){let a;return!!t[o]||n!==$e&&Re(n,o)||ch(e,o)||(a=i[0])&&Re(a,o)||Re(r,o)||Re(Ko,o)||Re(s.config.globalProperties,o)},defineProperty(n,e,t){return t.get!=null?n._.accessCache[e]=0:Re(t,"value")&&this.set(n,e,t.value,null),Reflect.defineProperty(n,e,t)}};function eg(n){return ue(n)?n.reduce((e,t)=>(e[t]=null,e),{}):n}let id=!0;function FI(n){const e=If(n),t=n.proxy,r=n.ctx;id=!1,e.beforeCreate&&tg(e.beforeCreate,n,"bc");const{data:s,computed:i,methods:o,watch:a,provide:l,inject:c,created:h,beforeMount:d,mounted:f,beforeUpdate:m,updated:y,activated:T,deactivated:w,beforeDestroy:P,beforeUnmount:O,destroyed:D,unmounted:$,render:q,renderTracked:F,renderTriggered:A,errorCaptured:_,serverPrefetch:v,expose:I,inheritAttrs:R,components:k,directives:S,filters:De}=e;if(c&&BI(c,r,null),o)for(const Se in o){const Te=o[Se];me(Te)&&(r[Se]=Te.bind(t))}if(s){const Se=s.call(t,t);Ne(Se)&&(n.data=Da(Se))}if(id=!0,i)for(const Se in i){const Te=i[Se],Xt=me(Te)?Te.bind(t,t):me(Te.get)?Te.get.bind(t,t):dn,En=!me(Te)&&me(Te.set)?Te.set.bind(t):dn,on=hn({get:Xt,set:En});Object.defineProperty(r,Se,{enumerable:!0,configurable:!0,get:()=>on.value,set:He=>on.value=He})}if(a)for(const Se in a)dv(a[Se],r,t,Se);if(l){const Se=me(l)?l.call(t):l;Reflect.ownKeys(Se).forEach(Te=>{Ll(Te,Se[Te])})}h&&tg(h,n,"c");function ve(Se,Te){ue(Te)?Te.forEach(Xt=>Se(Xt.bind(t))):Te&&Se(Te.bind(t))}if(ve(PI,d),ve(Sf,f),ve(xI,m),ve(OI,y),ve(CI,T),ve(kI,w),ve(LI,_),ve(DI,F),ve(NI,A),ve(cv,O),ve(uv,$),ve(MI,v),ue(I))if(I.length){const Se=n.exposed||(n.exposed={});I.forEach(Te=>{Object.defineProperty(Se,Te,{get:()=>t[Te],set:Xt=>t[Te]=Xt})})}else n.exposed||(n.exposed={});q&&n.render===dn&&(n.render=q),R!=null&&(n.inheritAttrs=R),k&&(n.components=k),S&&(n.directives=S)}function BI(n,e,t=dn){ue(n)&&(n=od(n));for(const r in n){const s=n[r];let i;Ne(s)?"default"in s?i=mn(s.from||r,s.default,!0):i=mn(s.from||r):i=mn(s),at(i)?Object.defineProperty(e,r,{enumerable:!0,configurable:!0,get:()=>i.value,set:o=>i.value=o}):e[r]=i}}function tg(n,e,t){pn(ue(n)?n.map(r=>r.bind(e.proxy)):n.bind(e.proxy),e,t)}function dv(n,e,t,r){const s=r.includes(".")?rv(t,r):()=>t[r];if(We(n)){const i=e[n];me(i)&&qo(s,i)}else if(me(n))qo(s,n.bind(t));else if(Ne(n))if(ue(n))n.forEach(i=>dv(i,e,t,r));else{const i=me(n.handler)?n.handler.bind(t):e[n.handler];me(i)&&qo(s,i,n)}}function If(n){const e=n.type,{mixins:t,extends:r}=e,{mixins:s,optionsCache:i,config:{optionMergeStrategies:o}}=n.appContext,a=i.get(e);let l;return a?l=a:!s.length&&!t&&!r?l=e:(l={},s.length&&s.forEach(c=>rc(l,c,o,!0)),rc(l,e,o)),Ne(e)&&i.set(e,l),l}function rc(n,e,t,r=!1){const{mixins:s,extends:i}=e;i&&rc(n,i,t,!0),s&&s.forEach(o=>rc(n,o,t,!0));for(const o in e)if(!(r&&o==="expose")){const a=UI[o]||t&&t[o];n[o]=a?a(n[o],e[o]):e[o]}return n}const UI={data:ng,props:rg,emits:rg,methods:Mo,computed:Mo,beforeCreate:Ut,created:Ut,beforeMount:Ut,mounted:Ut,beforeUpdate:Ut,updated:Ut,beforeDestroy:Ut,beforeUnmount:Ut,destroyed:Ut,unmounted:Ut,activated:Ut,deactivated:Ut,errorCaptured:Ut,serverPrefetch:Ut,components:Mo,directives:Mo,watch:zI,provide:ng,inject:$I};function ng(n,e){return e?n?function(){return ut(me(n)?n.call(this,this):n,me(e)?e.call(this,this):e)}:e:n}function $I(n,e){return Mo(od(n),od(e))}function od(n){if(ue(n)){const e={};for(let t=0;t<n.length;t++)e[n[t]]=n[t];return e}return n}function Ut(n,e){return n?[...new Set([].concat(n,e))]:e}function Mo(n,e){return n?ut(Object.create(null),n,e):e}function rg(n,e){return n?ue(n)&&ue(e)?[...new Set([...n,...e])]:ut(Object.create(null),eg(n),eg(e??{})):e}function zI(n,e){if(!n)return e;if(!e)return n;const t=ut(Object.create(null),n);for(const r in e)t[r]=Ut(n[r],e[r]);return t}function fv(){return{app:null,config:{isNativeTag:_S,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let jI=0;function HI(n,e){return function(r,s=null){me(r)||(r=ut({},r)),s!=null&&!Ne(s)&&(s=null);const i=fv(),o=new WeakSet;let a=!1;const l=i.app={_uid:jI++,_component:r,_props:s,_container:null,_context:i,_instance:null,version:vA,get config(){return i.config},set config(c){},use(c,...h){return o.has(c)||(c&&me(c.install)?(o.add(c),c.install(l,...h)):me(c)&&(o.add(c),c(l,...h))),l},mixin(c){return i.mixins.includes(c)||i.mixins.push(c),l},component(c,h){return h?(i.components[c]=h,l):i.components[c]},directive(c,h){return h?(i.directives[c]=h,l):i.directives[c]},mount(c,h,d){if(!a){const f=je(r,s);return f.appContext=i,d===!0?d="svg":d===!1&&(d=void 0),h&&e?e(f,c):n(f,c,d),a=!0,l._container=c,c.__vue_app__=l,au(f.component)||f.component.proxy}},unmount(){a&&(n(null,l._container),delete l._container.__vue_app__)},provide(c,h){return i.provides[c]=h,l},runWithContext(c){const h=xi;xi=l;try{return c()}finally{xi=h}}};return l}}let xi=null;function Ll(n,e){if(mt){let t=mt.provides;const r=mt.parent&&mt.parent.provides;r===t&&(t=mt.provides=Object.create(r)),t[n]=e}}function mn(n,e,t=!1){const r=mt||it;if(r||xi){const s=r?r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides:xi._context.provides;if(s&&n in s)return s[n];if(arguments.length>1)return t&&me(e)?e.call(r&&r.proxy):e}}function qI(){return!!(mt||it||xi)}function WI(n,e,t,r=!1){const s={},i={};Xl(i,iu,1),n.propsDefaults=Object.create(null),pv(n,e,s,i);for(const o in n.propsOptions[0])o in s||(s[o]=void 0);t?n.props=r?s:zE(s):n.type.props?n.props=s:n.props=i,n.attrs=i}function KI(n,e,t,r){const{props:s,attrs:i,vnode:{patchFlag:o}}=n,a=Ce(s),[l]=n.propsOptions;let c=!1;if((r||o>0)&&!(o&16)){if(o&8){const h=n.vnode.dynamicProps;for(let d=0;d<h.length;d++){let f=h[d];if(Zc(n.emitsOptions,f))continue;const m=e[f];if(l)if(Re(i,f))m!==i[f]&&(i[f]=m,c=!0);else{const y=qn(f);s[y]=ad(l,a,y,m,n,!1)}else m!==i[f]&&(i[f]=m,c=!0)}}}else{pv(n,e,s,i)&&(c=!0);let h;for(const d in a)(!e||!Re(e,d)&&((h=ti(d))===d||!Re(e,h)))&&(l?t&&(t[d]!==void 0||t[h]!==void 0)&&(s[d]=ad(l,a,d,void 0,n,!0)):delete s[d]);if(i!==a)for(const d in i)(!e||!Re(e,d))&&(delete i[d],c=!0)}c&&or(n,"set","$attrs")}function pv(n,e,t,r){const[s,i]=n.propsOptions;let o=!1,a;if(e)for(let l in e){if(jo(l))continue;const c=e[l];let h;s&&Re(s,h=qn(l))?!i||!i.includes(h)?t[h]=c:(a||(a={}))[h]=c:Zc(n.emitsOptions,l)||(!(l in r)||c!==r[l])&&(r[l]=c,o=!0)}if(i){const l=Ce(t),c=a||$e;for(let h=0;h<i.length;h++){const d=i[h];t[d]=ad(s,l,d,c[d],n,!Re(c,d))}}return o}function ad(n,e,t,r,s,i){const o=n[t];if(o!=null){const a=Re(o,"default");if(a&&r===void 0){const l=o.default;if(o.type!==Function&&!o.skipFactory&&me(l)){const{propsDefaults:c}=s;if(t in c)r=c[t];else{const h=Va(s);r=c[t]=l.call(null,e),h()}}else r=l}o[0]&&(i&&!a?r=!1:o[1]&&(r===""||r===ti(t))&&(r=!0))}return r}function mv(n,e,t=!1){const r=e.propsCache,s=r.get(n);if(s)return s;const i=n.props,o={},a=[];let l=!1;if(!me(n)){const h=d=>{l=!0;const[f,m]=mv(d,e,!0);ut(o,f),m&&a.push(...m)};!t&&e.mixins.length&&e.mixins.forEach(h),n.extends&&h(n.extends),n.mixins&&n.mixins.forEach(h)}if(!i&&!l)return Ne(n)&&r.set(n,Ci),Ci;if(ue(i))for(let h=0;h<i.length;h++){const d=qn(i[h]);sg(d)&&(o[d]=$e)}else if(i)for(const h in i){const d=qn(h);if(sg(d)){const f=i[h],m=o[d]=ue(f)||me(f)?{type:f}:ut({},f);if(m){const y=ag(Boolean,m.type),T=ag(String,m.type);m[0]=y>-1,m[1]=T<0||y<T,(y>-1||Re(m,"default"))&&a.push(d)}}}const c=[o,a];return Ne(n)&&r.set(n,c),c}function sg(n){return n[0]!=="$"&&!jo(n)}function ig(n){return n===null?"null":typeof n=="function"?n.name||"":typeof n=="object"&&n.constructor&&n.constructor.name||""}function og(n,e){return ig(n)===ig(e)}function ag(n,e){return ue(e)?e.findIndex(t=>og(t,n)):me(e)&&og(e,n)?0:-1}const gv=n=>n[0]==="_"||n==="$stable",Af=n=>ue(n)?n.map(Nn):[Nn(n)],GI=(n,e,t)=>{if(e._n)return e;const r=Br((...s)=>Af(e(...s)),t);return r._c=!1,r},yv=(n,e,t)=>{const r=n._ctx;for(const s in n){if(gv(s))continue;const i=n[s];if(me(i))e[s]=GI(s,i,r);else if(i!=null){const o=Af(i);e[s]=()=>o}}},_v=(n,e)=>{const t=Af(e);n.slots.default=()=>t},JI=(n,e)=>{if(n.vnode.shapeFlag&32){const t=e._;t?(n.slots=Ce(e),Xl(e,"_",t)):yv(e,n.slots={})}else n.slots={},e&&_v(n,e);Xl(n.slots,iu,1)},QI=(n,e,t)=>{const{vnode:r,slots:s}=n;let i=!0,o=$e;if(r.shapeFlag&32){const a=e._;a?t&&a===1?i=!1:(ut(s,e),!t&&a===1&&delete s._):(i=!e.$stable,yv(e,s)),o=e}else e&&(_v(n,e),o={default:1});if(i)for(const a in s)!gv(a)&&o[a]==null&&delete s[a]};function ld(n,e,t,r,s=!1){if(ue(n)){n.forEach((f,m)=>ld(f,e&&(ue(e)?e[m]:e),t,r,s));return}if(Wo(r)&&!s)return;const i=r.shapeFlag&4?au(r.component)||r.component.proxy:r.el,o=s?null:i,{i:a,r:l}=n,c=e&&e.r,h=a.refs===$e?a.refs={}:a.refs,d=a.setupState;if(c!=null&&c!==l&&(We(c)?(h[c]=null,Re(d,c)&&(d[c]=null)):at(c)&&(c.value=null)),me(l))Wr(l,a,12,[o,h]);else{const f=We(l),m=at(l);if(f||m){const y=()=>{if(n.f){const T=f?Re(d,l)?d[l]:h[l]:l.value;s?ue(T)&&cf(T,i):ue(T)?T.includes(i)||T.push(i):f?(h[l]=[i],Re(d,l)&&(d[l]=h[l])):(l.value=[i],n.k&&(h[n.k]=l.value))}else f?(h[l]=o,Re(d,l)&&(d[l]=o)):m&&(l.value=o,n.k&&(h[n.k]=o))};o?(y.id=-1,qt(y,t)):y()}}}const qt=vI;function YI(n){return XI(n)}function XI(n,e){const t=IE();t.__VUE__=!0;const{insert:r,remove:s,patchProp:i,createElement:o,createText:a,createComment:l,setText:c,setElementText:h,parentNode:d,nextSibling:f,setScopeId:m=dn,insertStaticContent:y}=n,T=(b,C,M,B=null,L=null,K=null,Q=void 0,W=null,G=!!C.dynamicChildren)=>{if(b===C)return;b&&!As(b,C)&&(B=V(b),He(b,L,K,!0),b=null),C.patchFlag===-2&&(G=!1,C.dynamicChildren=null);const{type:j,ref:Z,shapeFlag:ae}=C;switch(j){case ru:w(b,C,M,B);break;case gn:P(b,C,M,B);break;case Vl:b==null&&O(C,M,B,Q);break;case Wt:k(b,C,M,B,L,K,Q,W,G);break;default:ae&1?q(b,C,M,B,L,K,Q,W,G):ae&6?S(b,C,M,B,L,K,Q,W,G):(ae&64||ae&128)&&j.process(b,C,M,B,L,K,Q,W,G,re)}Z!=null&&L&&ld(Z,b&&b.ref,K,C||b,!C)},w=(b,C,M,B)=>{if(b==null)r(C.el=a(C.children),M,B);else{const L=C.el=b.el;C.children!==b.children&&c(L,C.children)}},P=(b,C,M,B)=>{b==null?r(C.el=l(C.children||""),M,B):C.el=b.el},O=(b,C,M,B)=>{[b.el,b.anchor]=y(b.children,C,M,B,b.el,b.anchor)},D=({el:b,anchor:C},M,B)=>{let L;for(;b&&b!==C;)L=f(b),r(b,M,B),b=L;r(C,M,B)},$=({el:b,anchor:C})=>{let M;for(;b&&b!==C;)M=f(b),s(b),b=M;s(C)},q=(b,C,M,B,L,K,Q,W,G)=>{C.type==="svg"?Q="svg":C.type==="math"&&(Q="mathml"),b==null?F(C,M,B,L,K,Q,W,G):v(b,C,L,K,Q,W,G)},F=(b,C,M,B,L,K,Q,W)=>{let G,j;const{props:Z,shapeFlag:ae,transition:oe,dirs:ie}=b;if(G=b.el=o(b.type,K,Z&&Z.is,Z),ae&8?h(G,b.children):ae&16&&_(b.children,G,null,B,L,uh(b,K),Q,W),ie&&vs(b,null,B,"created"),A(G,b,b.scopeId,Q,B),Z){for(const ke in Z)ke!=="value"&&!jo(ke)&&i(G,ke,null,Z[ke],K,b.children,B,L,dt);"value"in Z&&i(G,"value",null,Z.value,K),(j=Z.onVnodeBeforeMount)&&xn(j,B,b)}ie&&vs(b,null,B,"beforeMount");const ce=ZI(L,oe);ce&&oe.beforeEnter(G),r(G,C,M),((j=Z&&Z.onVnodeMounted)||ce||ie)&&qt(()=>{j&&xn(j,B,b),ce&&oe.enter(G),ie&&vs(b,null,B,"mounted")},L)},A=(b,C,M,B,L)=>{if(M&&m(b,M),B)for(let K=0;K<B.length;K++)m(b,B[K]);if(L){let K=L.subTree;if(C===K){const Q=L.vnode;A(b,Q,Q.scopeId,Q.slotScopeIds,L.parent)}}},_=(b,C,M,B,L,K,Q,W,G=0)=>{for(let j=G;j<b.length;j++){const Z=b[j]=W?kr(b[j]):Nn(b[j]);T(null,Z,C,M,B,L,K,Q,W)}},v=(b,C,M,B,L,K,Q)=>{const W=C.el=b.el;let{patchFlag:G,dynamicChildren:j,dirs:Z}=C;G|=b.patchFlag&16;const ae=b.props||$e,oe=C.props||$e;let ie;if(M&&Ts(M,!1),(ie=oe.onVnodeBeforeUpdate)&&xn(ie,M,C,b),Z&&vs(C,b,M,"beforeUpdate"),M&&Ts(M,!0),j?I(b.dynamicChildren,j,W,M,B,uh(C,L),K):Q||Te(b,C,W,null,M,B,uh(C,L),K,!1),G>0){if(G&16)R(W,C,ae,oe,M,B,L);else if(G&2&&ae.class!==oe.class&&i(W,"class",null,oe.class,L),G&4&&i(W,"style",ae.style,oe.style,L),G&8){const ce=C.dynamicProps;for(let ke=0;ke<ce.length;ke++){const Ve=ce[ke],et=ae[Ve],Zt=oe[Ve];(Zt!==et||Ve==="value")&&i(W,Ve,et,Zt,L,b.children,M,B,dt)}}G&1&&b.children!==C.children&&h(W,C.children)}else!Q&&j==null&&R(W,C,ae,oe,M,B,L);((ie=oe.onVnodeUpdated)||Z)&&qt(()=>{ie&&xn(ie,M,C,b),Z&&vs(C,b,M,"updated")},B)},I=(b,C,M,B,L,K,Q)=>{for(let W=0;W<C.length;W++){const G=b[W],j=C[W],Z=G.el&&(G.type===Wt||!As(G,j)||G.shapeFlag&70)?d(G.el):M;T(G,j,Z,null,B,L,K,Q,!0)}},R=(b,C,M,B,L,K,Q)=>{if(M!==B){if(M!==$e)for(const W in M)!jo(W)&&!(W in B)&&i(b,W,M[W],null,Q,C.children,L,K,dt);for(const W in B){if(jo(W))continue;const G=B[W],j=M[W];G!==j&&W!=="value"&&i(b,W,j,G,Q,C.children,L,K,dt)}"value"in B&&i(b,"value",M.value,B.value,Q)}},k=(b,C,M,B,L,K,Q,W,G)=>{const j=C.el=b?b.el:a(""),Z=C.anchor=b?b.anchor:a("");let{patchFlag:ae,dynamicChildren:oe,slotScopeIds:ie}=C;ie&&(W=W?W.concat(ie):ie),b==null?(r(j,M,B),r(Z,M,B),_(C.children||[],M,Z,L,K,Q,W,G)):ae>0&&ae&64&&oe&&b.dynamicChildren?(I(b.dynamicChildren,oe,M,L,K,Q,W),(C.key!=null||L&&C===L.subTree)&&Cf(b,C,!0)):Te(b,C,M,Z,L,K,Q,W,G)},S=(b,C,M,B,L,K,Q,W,G)=>{C.slotScopeIds=W,b==null?C.shapeFlag&512?L.ctx.activate(C,M,B,Q,G):De(C,M,B,L,K,Q,G):Ze(b,C,G)},De=(b,C,M,B,L,K,Q)=>{const W=b.component=dA(b,B,L);if(tu(b)&&(W.ctx.renderer=re),pA(W),W.asyncDep){if(L&&L.registerDep(W,ve),!b.el){const G=W.subTree=je(gn);P(null,G,C,M)}}else ve(W,b,C,M,L,K,Q)},Ze=(b,C,M)=>{const B=C.component=b.component;if(gI(b,C,M))if(B.asyncDep&&!B.asyncResolved){Se(B,C,M);return}else B.next=C,uI(B.update),B.effect.dirty=!0,B.update();else C.el=b.el,B.vnode=C},ve=(b,C,M,B,L,K,Q)=>{const W=()=>{if(b.isMounted){let{next:Z,bu:ae,u:oe,parent:ie,vnode:ce}=b;{const an=Ev(b);if(an){Z&&(Z.el=ce.el,Se(b,Z,Q)),an.asyncDep.then(()=>{b.isUnmounted||W()});return}}let ke=Z,Ve;Ts(b,!1),Z?(Z.el=ce.el,Se(b,Z,Q)):Z=ce,ae&&Dl(ae),(Ve=Z.props&&Z.props.onVnodeBeforeUpdate)&&xn(Ve,ie,Z,ce),Ts(b,!0);const et=ah(b),Zt=b.subTree;b.subTree=et,T(Zt,et,d(Zt.el),V(Zt),b,L,K),Z.el=et.el,ke===null&&yI(b,et.el),oe&&qt(oe,L),(Ve=Z.props&&Z.props.onVnodeUpdated)&&qt(()=>xn(Ve,ie,Z,ce),L)}else{let Z;const{el:ae,props:oe}=C,{bm:ie,m:ce,parent:ke}=b,Ve=Wo(C);if(Ts(b,!1),ie&&Dl(ie),!Ve&&(Z=oe&&oe.onVnodeBeforeMount)&&xn(Z,ke,C),Ts(b,!0),ae&&Le){const et=()=>{b.subTree=ah(b),Le(ae,b.subTree,b,L,null)};Ve?C.type.__asyncLoader().then(()=>!b.isUnmounted&&et()):et()}else{const et=b.subTree=ah(b);T(null,et,M,B,b,L,K),C.el=et.el}if(ce&&qt(ce,L),!Ve&&(Z=oe&&oe.onVnodeMounted)){const et=C;qt(()=>xn(Z,ke,et),L)}(C.shapeFlag&256||ke&&Wo(ke.vnode)&&ke.vnode.shapeFlag&256)&&b.a&&qt(b.a,L),b.isMounted=!0,C=M=B=null}},G=b.effect=new hf(W,dn,()=>vf(j),b.scope),j=b.update=()=>{G.dirty&&G.run()};j.id=b.uid,Ts(b,!0),j()},Se=(b,C,M)=>{C.component=b;const B=b.vnode.props;b.vnode=C,b.next=null,KI(b,C.props,B,M),QI(b,C.children,M),ni(),Qm(b),ri()},Te=(b,C,M,B,L,K,Q,W,G=!1)=>{const j=b&&b.children,Z=b?b.shapeFlag:0,ae=C.children,{patchFlag:oe,shapeFlag:ie}=C;if(oe>0){if(oe&128){En(j,ae,M,B,L,K,Q,W,G);return}else if(oe&256){Xt(j,ae,M,B,L,K,Q,W,G);return}}ie&8?(Z&16&&dt(j,L,K),ae!==j&&h(M,ae)):Z&16?ie&16?En(j,ae,M,B,L,K,Q,W,G):dt(j,L,K,!0):(Z&8&&h(M,""),ie&16&&_(ae,M,B,L,K,Q,W,G))},Xt=(b,C,M,B,L,K,Q,W,G)=>{b=b||Ci,C=C||Ci;const j=b.length,Z=C.length,ae=Math.min(j,Z);let oe;for(oe=0;oe<ae;oe++){const ie=C[oe]=G?kr(C[oe]):Nn(C[oe]);T(b[oe],ie,M,null,L,K,Q,W,G)}j>Z?dt(b,L,K,!0,!1,ae):_(C,M,B,L,K,Q,W,G,ae)},En=(b,C,M,B,L,K,Q,W,G)=>{let j=0;const Z=C.length;let ae=b.length-1,oe=Z-1;for(;j<=ae&&j<=oe;){const ie=b[j],ce=C[j]=G?kr(C[j]):Nn(C[j]);if(As(ie,ce))T(ie,ce,M,null,L,K,Q,W,G);else break;j++}for(;j<=ae&&j<=oe;){const ie=b[ae],ce=C[oe]=G?kr(C[oe]):Nn(C[oe]);if(As(ie,ce))T(ie,ce,M,null,L,K,Q,W,G);else break;ae--,oe--}if(j>ae){if(j<=oe){const ie=oe+1,ce=ie<Z?C[ie].el:B;for(;j<=oe;)T(null,C[j]=G?kr(C[j]):Nn(C[j]),M,ce,L,K,Q,W,G),j++}}else if(j>oe)for(;j<=ae;)He(b[j],L,K,!0),j++;else{const ie=j,ce=j,ke=new Map;for(j=ce;j<=oe;j++){const Vt=C[j]=G?kr(C[j]):Nn(C[j]);Vt.key!=null&&ke.set(Vt.key,j)}let Ve,et=0;const Zt=oe-ce+1;let an=!1,po=0;const mr=new Array(Zt);for(j=0;j<Zt;j++)mr[j]=0;for(j=ie;j<=ae;j++){const Vt=b[j];if(et>=Zt){He(Vt,L,K,!0);continue}let ln;if(Vt.key!=null)ln=ke.get(Vt.key);else for(Ve=ce;Ve<=oe;Ve++)if(mr[Ve-ce]===0&&As(Vt,C[Ve])){ln=Ve;break}ln===void 0?He(Vt,L,K,!0):(mr[ln-ce]=j+1,ln>=po?po=ln:an=!0,T(Vt,C[ln],M,null,L,K,Q,W,G),et++)}const ci=an?eA(mr):Ci;for(Ve=ci.length-1,j=Zt-1;j>=0;j--){const Vt=ce+j,ln=C[Vt],ui=Vt+1<Z?C[Vt+1].el:B;mr[j]===0?T(null,ln,M,ui,L,K,Q,W,G):an&&(Ve<0||j!==ci[Ve]?on(ln,M,ui,2):Ve--)}}},on=(b,C,M,B,L=null)=>{const{el:K,type:Q,transition:W,children:G,shapeFlag:j}=b;if(j&6){on(b.component.subTree,C,M,B);return}if(j&128){b.suspense.move(C,M,B);return}if(j&64){Q.move(b,C,M,re);return}if(Q===Wt){r(K,C,M);for(let ae=0;ae<G.length;ae++)on(G[ae],C,M,B);r(b.anchor,C,M);return}if(Q===Vl){D(b,C,M);return}if(B!==2&&j&1&&W)if(B===0)W.beforeEnter(K),r(K,C,M),qt(()=>W.enter(K),L);else{const{leave:ae,delayLeave:oe,afterLeave:ie}=W,ce=()=>r(K,C,M),ke=()=>{ae(K,()=>{ce(),ie&&ie()})};oe?oe(K,ce,ke):ke()}else r(K,C,M)},He=(b,C,M,B=!1,L=!1)=>{const{type:K,props:Q,ref:W,children:G,dynamicChildren:j,shapeFlag:Z,patchFlag:ae,dirs:oe}=b;if(W!=null&&ld(W,null,M,b,!0),Z&256){C.ctx.deactivate(b);return}const ie=Z&1&&oe,ce=!Wo(b);let ke;if(ce&&(ke=Q&&Q.onVnodeBeforeUnmount)&&xn(ke,C,b),Z&6)Pn(b.component,M,B);else{if(Z&128){b.suspense.unmount(M,B);return}ie&&vs(b,null,C,"beforeUnmount"),Z&64?b.type.remove(b,C,M,L,re,B):j&&(K!==Wt||ae>0&&ae&64)?dt(j,C,M,!1,!0):(K===Wt&&ae&384||!L&&Z&16)&&dt(G,C,M),B&&qe(b)}(ce&&(ke=Q&&Q.onVnodeUnmounted)||ie)&&qt(()=>{ke&&xn(ke,C,b),ie&&vs(b,null,C,"unmounted")},M)},qe=b=>{const{type:C,el:M,anchor:B,transition:L}=b;if(C===Wt){pr(M,B);return}if(C===Vl){$(b);return}const K=()=>{s(M),L&&!L.persisted&&L.afterLeave&&L.afterLeave()};if(b.shapeFlag&1&&L&&!L.persisted){const{leave:Q,delayLeave:W}=L,G=()=>Q(M,K);W?W(b.el,K,G):G()}else K()},pr=(b,C)=>{let M;for(;b!==C;)M=f(b),s(b),b=M;s(C)},Pn=(b,C,M)=>{const{bum:B,scope:L,update:K,subTree:Q,um:W}=b;B&&Dl(B),L.stop(),K&&(K.active=!1,He(Q,b,C,M)),W&&qt(W,C),qt(()=>{b.isUnmounted=!0},C),C&&C.pendingBranch&&!C.isUnmounted&&b.asyncDep&&!b.asyncResolved&&b.suspenseId===C.pendingId&&(C.deps--,C.deps===0&&C.resolve())},dt=(b,C,M,B=!1,L=!1,K=0)=>{for(let Q=K;Q<b.length;Q++)He(b[Q],C,M,B,L)},V=b=>b.shapeFlag&6?V(b.component.subTree):b.shapeFlag&128?b.suspense.next():f(b.anchor||b.el);let ee=!1;const Y=(b,C,M)=>{b==null?C._vnode&&He(C._vnode,null,null,!0):T(C._vnode||null,b,C,null,null,null,M),ee||(ee=!0,Qm(),YE(),ee=!1),C._vnode=b},re={p:T,um:He,m:on,r:qe,mt:De,mc:_,pc:Te,pbc:I,n:V,o:n};let Ie,Le;return{render:Y,hydrate:Ie,createApp:HI(Y,Ie)}}function uh({type:n,props:e},t){return t==="svg"&&n==="foreignObject"||t==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:t}function Ts({effect:n,update:e},t){n.allowRecurse=e.allowRecurse=t}function ZI(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function Cf(n,e,t=!1){const r=n.children,s=e.children;if(ue(r)&&ue(s))for(let i=0;i<r.length;i++){const o=r[i];let a=s[i];a.shapeFlag&1&&!a.dynamicChildren&&((a.patchFlag<=0||a.patchFlag===32)&&(a=s[i]=kr(s[i]),a.el=o.el),t||Cf(o,a)),a.type===ru&&(a.el=o.el)}}function eA(n){const e=n.slice(),t=[0];let r,s,i,o,a;const l=n.length;for(r=0;r<l;r++){const c=n[r];if(c!==0){if(s=t[t.length-1],n[s]<c){e[r]=s,t.push(r);continue}for(i=0,o=t.length-1;i<o;)a=i+o>>1,n[t[a]]<c?i=a+1:o=a;c<n[t[i]]&&(i>0&&(e[r]=t[i-1]),t[i]=r)}}for(i=t.length,o=t[i-1];i-- >0;)t[i]=o,o=e[o];return t}function Ev(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Ev(e)}const tA=n=>n.__isTeleport,Go=n=>n&&(n.disabled||n.disabled===""),lg=n=>typeof SVGElement<"u"&&n instanceof SVGElement,cg=n=>typeof MathMLElement=="function"&&n instanceof MathMLElement,cd=(n,e)=>{const t=n&&n.to;return We(t)?e?e(t):null:t},nA={name:"Teleport",__isTeleport:!0,process(n,e,t,r,s,i,o,a,l,c){const{mc:h,pc:d,pbc:f,o:{insert:m,querySelector:y,createText:T,createComment:w}}=c,P=Go(e.props);let{shapeFlag:O,children:D,dynamicChildren:$}=e;if(n==null){const q=e.el=T(""),F=e.anchor=T("");m(q,t,r),m(F,t,r);const A=e.target=cd(e.props,y),_=e.targetAnchor=T("");A&&(m(_,A),o==="svg"||lg(A)?o="svg":(o==="mathml"||cg(A))&&(o="mathml"));const v=(I,R)=>{O&16&&h(D,I,R,s,i,o,a,l)};P?v(t,F):A&&v(A,_)}else{e.el=n.el;const q=e.anchor=n.anchor,F=e.target=n.target,A=e.targetAnchor=n.targetAnchor,_=Go(n.props),v=_?t:F,I=_?q:A;if(o==="svg"||lg(F)?o="svg":(o==="mathml"||cg(F))&&(o="mathml"),$?(f(n.dynamicChildren,$,v,s,i,o,a),Cf(n,e,!0)):l||d(n,e,v,I,s,i,o,a,!1),P)_?e.props&&n.props&&e.props.to!==n.props.to&&(e.props.to=n.props.to):Tl(e,t,q,c,1);else if((e.props&&e.props.to)!==(n.props&&n.props.to)){const R=e.target=cd(e.props,y);R&&Tl(e,R,null,c,0)}else _&&Tl(e,F,A,c,1)}vv(e)},remove(n,e,t,r,{um:s,o:{remove:i}},o){const{shapeFlag:a,children:l,anchor:c,targetAnchor:h,target:d,props:f}=n;if(d&&i(h),o&&i(c),a&16){const m=o||!Go(f);for(let y=0;y<l.length;y++){const T=l[y];s(T,e,t,m,!!T.dynamicChildren)}}},move:Tl,hydrate:rA};function Tl(n,e,t,{o:{insert:r},m:s},i=2){i===0&&r(n.targetAnchor,e,t);const{el:o,anchor:a,shapeFlag:l,children:c,props:h}=n,d=i===2;if(d&&r(o,e,t),(!d||Go(h))&&l&16)for(let f=0;f<c.length;f++)s(c[f],e,t,2);d&&r(a,e,t)}function rA(n,e,t,r,s,i,{o:{nextSibling:o,parentNode:a,querySelector:l}},c){const h=e.target=cd(e.props,l);if(h){const d=h._lpa||h.firstChild;if(e.shapeFlag&16)if(Go(e.props))e.anchor=c(o(n),e,a(n),t,r,s,i),e.targetAnchor=d;else{e.anchor=o(n);let f=d;for(;f;)if(f=o(f),f&&f.nodeType===8&&f.data==="teleport anchor"){e.targetAnchor=f,h._lpa=e.targetAnchor&&o(e.targetAnchor);break}c(d,e,h,t,r,s,i)}vv(e)}return e.anchor&&o(e.anchor)}const YU=nA;function vv(n){const e=n.ctx;if(e&&e.ut){let t=n.children[0].el;for(;t&&t!==n.targetAnchor;)t.nodeType===1&&t.setAttribute("data-v-owner",e.uid),t=t.nextSibling;e.ut()}}const Wt=Symbol.for("v-fgt"),ru=Symbol.for("v-txt"),gn=Symbol.for("v-cmt"),Vl=Symbol.for("v-stc"),Jo=[];let bn=null;function Kr(n=!1){Jo.push(bn=n?null:[])}function sA(){Jo.pop(),bn=Jo[Jo.length-1]||null}let fa=1;function ug(n){fa+=n}function Tv(n){return n.dynamicChildren=fa>0?bn||Ci:null,sA(),fa>0&&bn&&bn.push(n),n}function su(n,e,t,r,s,i){return Tv(tt(n,e,t,r,s,i,!0))}function sc(n,e,t,r,s){return Tv(je(n,e,t,r,s,!0))}function ic(n){return n?n.__v_isVNode===!0:!1}function As(n,e){return n.type===e.type&&n.key===e.key}const iu="__vInternal",wv=({key:n})=>n??null,Fl=({ref:n,ref_key:e,ref_for:t})=>(typeof n=="number"&&(n=""+n),n!=null?We(n)||at(n)||me(n)?{i:it,r:n,k:e,f:!!t}:n:null);function tt(n,e=null,t=null,r=0,s=null,i=n===Wt?0:1,o=!1,a=!1){const l={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&wv(e),ref:e&&Fl(e),scopeId:eu,slotScopeIds:null,children:t,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:r,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:it};return a?(kf(l,t),i&128&&n.normalize(l)):t&&(l.shapeFlag|=We(t)?8:16),fa>0&&!o&&bn&&(l.patchFlag>0||i&6)&&l.patchFlag!==32&&bn.push(l),l}const je=iA;function iA(n,e=null,t=null,r=0,s=null,i=!1){if((!n||n===nv)&&(n=gn),ic(n)){const a=rs(n,e,!0);return t&&kf(a,t),fa>0&&!i&&bn&&(a.shapeFlag&6?bn[bn.indexOf(n)]=a:bn.push(a)),a.patchFlag|=-2,a}if(EA(n)&&(n=n.__vccOpts),e){e=oA(e);let{class:a,style:l}=e;a&&!We(a)&&(e.class=Kc(a)),Ne(l)&&(HE(l)&&!ue(l)&&(l=ut({},l)),e.style=Wc(l))}const o=We(n)?1:EI(n)?128:tA(n)?64:Ne(n)?4:me(n)?2:0;return tt(n,e,t,r,s,o,i,!0)}function oA(n){return n?HE(n)||iu in n?ut({},n):n:null}function rs(n,e,t=!1){const{props:r,ref:s,patchFlag:i,children:o}=n,a=e?cA(r||{},e):r;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:a,key:a&&wv(a),ref:e&&e.ref?t&&s?ue(s)?s.concat(Fl(e)):[s,Fl(e)]:Fl(e):s,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:o,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==Wt?i===-1?16:i|16:i,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&rs(n.ssContent),ssFallback:n.ssFallback&&rs(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function aA(n=" ",e=0){return je(ru,null,n,e)}function XU(n,e){const t=je(Vl,null,n);return t.staticCount=e,t}function lA(n="",e=!1){return e?(Kr(),sc(gn,null,n)):je(gn,null,n)}function Nn(n){return n==null||typeof n=="boolean"?je(gn):ue(n)?je(Wt,null,n.slice()):typeof n=="object"?kr(n):je(ru,null,String(n))}function kr(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:rs(n)}function kf(n,e){let t=0;const{shapeFlag:r}=n;if(e==null)e=null;else if(ue(e))t=16;else if(typeof e=="object")if(r&65){const s=e.default;s&&(s._c&&(s._d=!1),kf(n,s()),s._c&&(s._d=!0));return}else{t=32;const s=e._;!s&&!(iu in e)?e._ctx=it:s===3&&it&&(it.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else me(e)?(e={default:e,_ctx:it},t=32):(e=String(e),r&64?(t=16,e=[aA(e)]):t=8);n.children=e,n.shapeFlag|=t}function cA(...n){const e={};for(let t=0;t<n.length;t++){const r=n[t];for(const s in r)if(s==="class")e.class!==r.class&&(e.class=Kc([e.class,r.class]));else if(s==="style")e.style=Wc([e.style,r.style]);else if(zc(s)){const i=e[s],o=r[s];o&&i!==o&&!(ue(i)&&i.includes(o))&&(e[s]=i?[].concat(i,o):o)}else s!==""&&(e[s]=r[s])}return e}function xn(n,e,t,r=null){pn(n,e,7,[t,r])}const uA=fv();let hA=0;function dA(n,e,t){const r=n.type,s=(e?e.appContext:n.appContext)||uA,i={uid:hA++,vnode:n,type:r,parent:e,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,scope:new kE(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:mv(r,s),emitsOptions:ZE(r,s),emit:null,emitted:null,propsDefaults:$e,inheritAttrs:r.inheritAttrs,ctx:$e,data:$e,props:$e,attrs:$e,slots:$e,refs:$e,setupState:$e,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:t,suspenseId:t?t.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=e?e.root:i,i.emit=fI.bind(null,i),n.ce&&n.ce(i),i}let mt=null;const fA=()=>mt||it;let oc,ud;{const n=IE(),e=(t,r)=>{let s;return(s=n[t])||(s=n[t]=[]),s.push(r),i=>{s.length>1?s.forEach(o=>o(i)):s[0](i)}};oc=e("__VUE_INSTANCE_SETTERS__",t=>mt=t),ud=e("__VUE_SSR_SETTERS__",t=>ou=t)}const Va=n=>{const e=mt;return oc(n),n.scope.on(),()=>{n.scope.off(),oc(e)}},hg=()=>{mt&&mt.scope.off(),oc(null)};function bv(n){return n.vnode.shapeFlag&4}let ou=!1;function pA(n,e=!1){e&&ud(e);const{props:t,children:r}=n.vnode,s=bv(n);WI(n,t,s,e),JI(n,r);const i=s?mA(n,e):void 0;return e&&ud(!1),i}function mA(n,e){const t=n.type;n.accessCache=Object.create(null),n.proxy=Qc(new Proxy(n.ctx,VI));const{setup:r}=t;if(r){const s=n.setupContext=r.length>1?yA(n):null,i=Va(n);ni();const o=Wr(r,n,0,[n.props,s]);if(ri(),i(),wE(o)){if(o.then(hg,hg),e)return o.then(a=>{dg(n,a,e)}).catch(a=>{Yc(a,n,0)});n.asyncDep=o}else dg(n,o,e)}else Sv(n,e)}function dg(n,e,t){me(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:Ne(e)&&(n.setupState=KE(e)),Sv(n,t)}let fg;function Sv(n,e,t){const r=n.type;if(!n.render){if(!e&&fg&&!r.render){const s=r.template||If(n).template;if(s){const{isCustomElement:i,compilerOptions:o}=n.appContext.config,{delimiters:a,compilerOptions:l}=r,c=ut(ut({isCustomElement:i,delimiters:a},o),l);r.render=fg(s,c)}}n.render=r.render||dn}{const s=Va(n);ni();try{FI(n)}finally{ri(),s()}}}function gA(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(e,t){return Qt(n,"get","$attrs"),e[t]}}))}function yA(n){const e=t=>{n.exposed=t||{}};return{get attrs(){return gA(n)},slots:n.slots,emit:n.emit,expose:e}}function au(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(KE(Qc(n.exposed)),{get(e,t){if(t in e)return e[t];if(t in Ko)return Ko[t](n)},has(e,t){return t in e||t in Ko}}))}function _A(n,e=!0){return me(n)?n.displayName||n.name:n.name||e&&n.__name}function EA(n){return me(n)&&"__vccOpts"in n}const hn=(n,e)=>eI(n,e,ou);function Rf(n,e,t){const r=arguments.length;return r===2?Ne(e)&&!ue(e)?ic(e)?je(n,null,[e]):je(n,e):je(n,null,e):(r>3?t=Array.prototype.slice.call(arguments,2):r===3&&ic(t)&&(t=[t]),je(n,e,t))}const vA="3.4.21";/**
* @vue/runtime-dom v3.4.21
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const TA="http://www.w3.org/2000/svg",wA="http://www.w3.org/1998/Math/MathML",Rr=typeof document<"u"?document:null,pg=Rr&&Rr.createElement("template"),bA={insert:(n,e,t)=>{e.insertBefore(n,t||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,t,r)=>{const s=e==="svg"?Rr.createElementNS(TA,n):e==="mathml"?Rr.createElementNS(wA,n):Rr.createElement(n,t?{is:t}:void 0);return n==="select"&&r&&r.multiple!=null&&s.setAttribute("multiple",r.multiple),s},createText:n=>Rr.createTextNode(n),createComment:n=>Rr.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>Rr.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,t,r,s,i){const o=t?t.previousSibling:e.lastChild;if(s&&(s===i||s.nextSibling))for(;e.insertBefore(s.cloneNode(!0),t),!(s===i||!(s=s.nextSibling)););else{pg.innerHTML=r==="svg"?`<svg>${n}</svg>`:r==="mathml"?`<math>${n}</math>`:n;const a=pg.content;if(r==="svg"||r==="mathml"){const l=a.firstChild;for(;l.firstChild;)a.appendChild(l.firstChild);a.removeChild(l)}e.insertBefore(a,t)}return[o?o.nextSibling:e.firstChild,t?t.previousSibling:e.lastChild]}},vr="transition",ko="animation",pa=Symbol("_vtc"),Iv=(n,{slots:e})=>Rf(AI,SA(n),e);Iv.displayName="Transition";const Av={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Iv.props=ut({},sv,Av);const ws=(n,e=[])=>{ue(n)?n.forEach(t=>t(...e)):n&&n(...e)},mg=n=>n?ue(n)?n.some(e=>e.length>1):n.length>1:!1;function SA(n){const e={};for(const k in n)k in Av||(e[k]=n[k]);if(n.css===!1)return e;const{name:t="v",type:r,duration:s,enterFromClass:i=`${t}-enter-from`,enterActiveClass:o=`${t}-enter-active`,enterToClass:a=`${t}-enter-to`,appearFromClass:l=i,appearActiveClass:c=o,appearToClass:h=a,leaveFromClass:d=`${t}-leave-from`,leaveActiveClass:f=`${t}-leave-active`,leaveToClass:m=`${t}-leave-to`}=n,y=IA(s),T=y&&y[0],w=y&&y[1],{onBeforeEnter:P,onEnter:O,onEnterCancelled:D,onLeave:$,onLeaveCancelled:q,onBeforeAppear:F=P,onAppear:A=O,onAppearCancelled:_=D}=e,v=(k,S,De)=>{bs(k,S?h:a),bs(k,S?c:o),De&&De()},I=(k,S)=>{k._isLeaving=!1,bs(k,d),bs(k,m),bs(k,f),S&&S()},R=k=>(S,De)=>{const Ze=k?A:O,ve=()=>v(S,k,De);ws(Ze,[S,ve]),gg(()=>{bs(S,k?l:i),Tr(S,k?h:a),mg(Ze)||yg(S,r,T,ve)})};return ut(e,{onBeforeEnter(k){ws(P,[k]),Tr(k,i),Tr(k,o)},onBeforeAppear(k){ws(F,[k]),Tr(k,l),Tr(k,c)},onEnter:R(!1),onAppear:R(!0),onLeave(k,S){k._isLeaving=!0;const De=()=>I(k,S);Tr(k,d),kA(),Tr(k,f),gg(()=>{k._isLeaving&&(bs(k,d),Tr(k,m),mg($)||yg(k,r,w,De))}),ws($,[k,De])},onEnterCancelled(k){v(k,!1),ws(D,[k])},onAppearCancelled(k){v(k,!0),ws(_,[k])},onLeaveCancelled(k){I(k),ws(q,[k])}})}function IA(n){if(n==null)return null;if(Ne(n))return[hh(n.enter),hh(n.leave)];{const e=hh(n);return[e,e]}}function hh(n){return bS(n)}function Tr(n,e){e.split(/\s+/).forEach(t=>t&&n.classList.add(t)),(n[pa]||(n[pa]=new Set)).add(e)}function bs(n,e){e.split(/\s+/).forEach(r=>r&&n.classList.remove(r));const t=n[pa];t&&(t.delete(e),t.size||(n[pa]=void 0))}function gg(n){requestAnimationFrame(()=>{requestAnimationFrame(n)})}let AA=0;function yg(n,e,t,r){const s=n._endId=++AA,i=()=>{s===n._endId&&r()};if(t)return setTimeout(i,t);const{type:o,timeout:a,propCount:l}=CA(n,e);if(!o)return r();const c=o+"end";let h=0;const d=()=>{n.removeEventListener(c,f),i()},f=m=>{m.target===n&&++h>=l&&d()};setTimeout(()=>{h<l&&d()},a+1),n.addEventListener(c,f)}function CA(n,e){const t=window.getComputedStyle(n),r=y=>(t[y]||"").split(", "),s=r(`${vr}Delay`),i=r(`${vr}Duration`),o=_g(s,i),a=r(`${ko}Delay`),l=r(`${ko}Duration`),c=_g(a,l);let h=null,d=0,f=0;e===vr?o>0&&(h=vr,d=o,f=i.length):e===ko?c>0&&(h=ko,d=c,f=l.length):(d=Math.max(o,c),h=d>0?o>c?vr:ko:null,f=h?h===vr?i.length:l.length:0);const m=h===vr&&/\b(transform|all)(,|$)/.test(r(`${vr}Property`).toString());return{type:h,timeout:d,propCount:f,hasTransform:m}}function _g(n,e){for(;n.length<e.length;)n=n.concat(n);return Math.max(...e.map((t,r)=>Eg(t)+Eg(n[r])))}function Eg(n){return n==="auto"?0:Number(n.slice(0,-1).replace(",","."))*1e3}function kA(){return document.body.offsetHeight}function RA(n,e,t){const r=n[pa];r&&(e=(e?[e,...r]:[...r]).join(" ")),e==null?n.removeAttribute("class"):t?n.setAttribute("class",e):n.className=e}const vg=Symbol("_vod"),PA=Symbol("_vsh"),xA=Symbol(""),OA=/(^|;)\s*display\s*:/;function MA(n,e,t){const r=n.style,s=We(t);let i=!1;if(t&&!s){if(e)if(We(e))for(const o of e.split(";")){const a=o.slice(0,o.indexOf(":")).trim();t[a]==null&&Bl(r,a,"")}else for(const o in e)t[o]==null&&Bl(r,o,"");for(const o in t)o==="display"&&(i=!0),Bl(r,o,t[o])}else if(s){if(e!==t){const o=r[xA];o&&(t+=";"+o),r.cssText=t,i=OA.test(t)}}else e&&n.removeAttribute("style");vg in n&&(n[vg]=i?r.display:"",n[PA]&&(r.display="none"))}const Tg=/\s*!important$/;function Bl(n,e,t){if(ue(t))t.forEach(r=>Bl(n,e,r));else if(t==null&&(t=""),e.startsWith("--"))n.setProperty(e,t);else{const r=NA(n,e);Tg.test(t)?n.setProperty(ti(r),t.replace(Tg,""),"important"):n[r]=t}}const wg=["Webkit","Moz","ms"],dh={};function NA(n,e){const t=dh[e];if(t)return t;let r=qn(e);if(r!=="filter"&&r in n)return dh[e]=r;r=qc(r);for(let s=0;s<wg.length;s++){const i=wg[s]+r;if(i in n)return dh[e]=i}return e}const bg="http://www.w3.org/1999/xlink";function DA(n,e,t,r,s){if(r&&e.startsWith("xlink:"))t==null?n.removeAttributeNS(bg,e.slice(6,e.length)):n.setAttributeNS(bg,e,t);else{const i=RS(e);t==null||i&&!AE(t)?n.removeAttribute(e):n.setAttribute(e,i?"":t)}}function LA(n,e,t,r,s,i,o){if(e==="innerHTML"||e==="textContent"){r&&o(r,s,i),n[e]=t??"";return}const a=n.tagName;if(e==="value"&&a!=="PROGRESS"&&!a.includes("-")){const c=a==="OPTION"?n.getAttribute("value")||"":n.value,h=t??"";(c!==h||!("_value"in n))&&(n.value=h),t==null&&n.removeAttribute(e),n._value=t;return}let l=!1;if(t===""||t==null){const c=typeof n[e];c==="boolean"?t=AE(t):t==null&&c==="string"?(t="",l=!0):c==="number"&&(t=0,l=!0)}try{n[e]=t}catch{}l&&n.removeAttribute(e)}function Cs(n,e,t,r){n.addEventListener(e,t,r)}function VA(n,e,t,r){n.removeEventListener(e,t,r)}const Sg=Symbol("_vei");function FA(n,e,t,r,s=null){const i=n[Sg]||(n[Sg]={}),o=i[e];if(r&&o)o.value=r;else{const[a,l]=BA(e);if(r){const c=i[e]=zA(r,s);Cs(n,a,c,l)}else o&&(VA(n,a,o,l),i[e]=void 0)}}const Ig=/(?:Once|Passive|Capture)$/;function BA(n){let e;if(Ig.test(n)){e={};let r;for(;r=n.match(Ig);)n=n.slice(0,n.length-r[0].length),e[r[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):ti(n.slice(2)),e]}let fh=0;const UA=Promise.resolve(),$A=()=>fh||(UA.then(()=>fh=0),fh=Date.now());function zA(n,e){const t=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=t.attached)return;pn(jA(r,t.value),e,5,[r])};return t.value=n,t.attached=$A(),t}function jA(n,e){if(ue(e)){const t=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{t.call(n),n._stopped=!0},e.map(r=>s=>!s._stopped&&r&&r(s))}else return e}const Ag=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,HA=(n,e,t,r,s,i,o,a,l)=>{const c=s==="svg";e==="class"?RA(n,r,c):e==="style"?MA(n,t,r):zc(e)?lf(e)||FA(n,e,t,r,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):qA(n,e,r,c))?LA(n,e,r,i,o,a,l):(e==="true-value"?n._trueValue=r:e==="false-value"&&(n._falseValue=r),DA(n,e,r,c))};function qA(n,e,t,r){if(r)return!!(e==="innerHTML"||e==="textContent"||e in n&&Ag(e)&&me(t));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const s=n.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return Ag(e)&&We(t)?!1:e in n}const ac=n=>{const e=n.props["onUpdate:modelValue"]||!1;return ue(e)?t=>Dl(e,t):e};function WA(n){n.target.composing=!0}function Cg(n){const e=n.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const Oi=Symbol("_assign"),ZU={created(n,{modifiers:{lazy:e,trim:t,number:r}},s){n[Oi]=ac(s);const i=r||s.props&&s.props.type==="number";Cs(n,e?"change":"input",o=>{if(o.target.composing)return;let a=n.value;t&&(a=a.trim()),i&&(a=ca(a)),n[Oi](a)}),t&&Cs(n,"change",()=>{n.value=n.value.trim()}),e||(Cs(n,"compositionstart",WA),Cs(n,"compositionend",Cg),Cs(n,"change",Cg))},mounted(n,{value:e}){n.value=e??""},beforeUpdate(n,{value:e,modifiers:{lazy:t,trim:r,number:s}},i){if(n[Oi]=ac(i),n.composing)return;const o=s||n.type==="number"?ca(n.value):n.value,a=e??"";o!==a&&(document.activeElement===n&&n.type!=="range"&&(t||r&&n.value.trim()===a)||(n.value=a))}},e4={deep:!0,created(n,{value:e,modifiers:{number:t}},r){const s=jc(e);Cs(n,"change",()=>{const i=Array.prototype.filter.call(n.options,o=>o.selected).map(o=>t?ca(lc(o)):lc(o));n[Oi](n.multiple?s?new Set(i):i:i[0]),n._assigning=!0,Xc(()=>{n._assigning=!1})}),n[Oi]=ac(r)},mounted(n,{value:e,modifiers:{number:t}}){kg(n,e,t)},beforeUpdate(n,e,t){n[Oi]=ac(t)},updated(n,{value:e,modifiers:{number:t}}){n._assigning||kg(n,e,t)}};function kg(n,e,t){const r=n.multiple,s=ue(e);if(!(r&&!s&&!jc(e))){for(let i=0,o=n.options.length;i<o;i++){const a=n.options[i],l=lc(a);if(r)if(s){const c=typeof l;c==="string"||c==="number"?a.selected=e.includes(t?ca(l):l):a.selected=xS(e,l)>-1}else a.selected=e.has(l);else if(Gc(lc(a),e)){n.selectedIndex!==i&&(n.selectedIndex=i);return}}!r&&n.selectedIndex!==-1&&(n.selectedIndex=-1)}}function lc(n){return"_value"in n?n._value:n.value}const KA=["ctrl","shift","alt","meta"],GA={stop:n=>n.stopPropagation(),prevent:n=>n.preventDefault(),self:n=>n.target!==n.currentTarget,ctrl:n=>!n.ctrlKey,shift:n=>!n.shiftKey,alt:n=>!n.altKey,meta:n=>!n.metaKey,left:n=>"button"in n&&n.button!==0,middle:n=>"button"in n&&n.button!==1,right:n=>"button"in n&&n.button!==2,exact:(n,e)=>KA.some(t=>n[`${t}Key`]&&!e.includes(t))},t4=(n,e)=>{const t=n._withMods||(n._withMods={}),r=e.join(".");return t[r]||(t[r]=(s,...i)=>{for(let o=0;o<e.length;o++){const a=GA[e[o]];if(a&&a(s,e))return}return n(s,...i)})},JA={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},n4=(n,e)=>{const t=n._withKeys||(n._withKeys={}),r=e.join(".");return t[r]||(t[r]=s=>{if(!("key"in s))return;const i=ti(s.key);if(e.some(o=>o===i||JA[o]===i))return n(s)})},QA=ut({patchProp:HA},bA);let Rg;function YA(){return Rg||(Rg=YI(QA))}const XA=(...n)=>{const e=YA().createApp(...n),{mount:t}=e;return e.mount=r=>{const s=eC(r);if(!s)return;const i=e._component;!me(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.innerHTML="";const o=t(s,!1,ZA(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),o},e};function ZA(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function eC(n){return We(n)?document.querySelector(n):n}var tC=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */let Cv;const lu=n=>Cv=n,kv=Symbol();function hd(n){return n&&typeof n=="object"&&Object.prototype.toString.call(n)==="[object Object]"&&typeof n.toJSON!="function"}var Qo;(function(n){n.direct="direct",n.patchObject="patch object",n.patchFunction="patch function"})(Qo||(Qo={}));function nC(){const n=RE(!0),e=n.run(()=>La({}));let t=[],r=[];const s=Qc({install(i){lu(s),s._a=i,i.provide(kv,s),i.config.globalProperties.$pinia=s,r.forEach(o=>t.push(o)),r=[]},use(i){return!this._a&&!tC?r.push(i):t.push(i),this},_p:t,_a:null,_e:n,_s:new Map,state:e});return s}const Rv=()=>{};function Pg(n,e,t,r=Rv){n.push(e);const s=()=>{const i=n.indexOf(e);i>-1&&(n.splice(i,1),r())};return!t&&PE()&&MS(s),s}function mi(n,...e){n.slice().forEach(t=>{t(...e)})}const rC=n=>n();function dd(n,e){n instanceof Map&&e instanceof Map&&e.forEach((t,r)=>n.set(r,t)),n instanceof Set&&e instanceof Set&&e.forEach(n.add,n);for(const t in e){if(!e.hasOwnProperty(t))continue;const r=e[t],s=n[t];hd(s)&&hd(r)&&n.hasOwnProperty(t)&&!at(r)&&!qr(r)?n[t]=dd(s,r):n[t]=r}return n}const sC=Symbol();function iC(n){return!hd(n)||!n.hasOwnProperty(sC)}const{assign:Sr}=Object;function oC(n){return!!(at(n)&&n.effect)}function aC(n,e,t,r){const{state:s,actions:i,getters:o}=e,a=t.state.value[n];let l;function c(){a||(t.state.value[n]=s?s():{});const h=iI(t.state.value[n]);return Sr(h,i,Object.keys(o||{}).reduce((d,f)=>(d[f]=Qc(hn(()=>{lu(t);const m=t._s.get(n);return o[f].call(m,m)})),d),{}))}return l=Pv(n,c,e,t,r,!0),l}function Pv(n,e,t={},r,s,i){let o;const a=Sr({actions:{}},t),l={deep:!0};let c,h,d=[],f=[],m;const y=r.state.value[n];!i&&!y&&(r.state.value[n]={}),La({});let T;function w(_){let v;c=h=!1,typeof _=="function"?(_(r.state.value[n]),v={type:Qo.patchFunction,storeId:n,events:m}):(dd(r.state.value[n],_),v={type:Qo.patchObject,payload:_,storeId:n,events:m});const I=T=Symbol();Xc().then(()=>{T===I&&(c=!0)}),h=!0,mi(d,v,r.state.value[n])}const P=i?function(){const{state:v}=t,I=v?v():{};this.$patch(R=>{Sr(R,I)})}:Rv;function O(){o.stop(),d=[],f=[],r._s.delete(n)}function D(_,v){return function(){lu(r);const I=Array.from(arguments),R=[],k=[];function S(ve){R.push(ve)}function De(ve){k.push(ve)}mi(f,{args:I,name:_,store:q,after:S,onError:De});let Ze;try{Ze=v.apply(this&&this.$id===n?this:q,I)}catch(ve){throw mi(k,ve),ve}return Ze instanceof Promise?Ze.then(ve=>(mi(R,ve),ve)).catch(ve=>(mi(k,ve),Promise.reject(ve))):(mi(R,Ze),Ze)}}const $={_p:r,$id:n,$onAction:Pg.bind(null,f),$patch:w,$reset:P,$subscribe(_,v={}){const I=Pg(d,_,v.detached,()=>R()),R=o.run(()=>qo(()=>r.state.value[n],k=>{(v.flush==="sync"?h:c)&&_({storeId:n,type:Qo.direct,events:m},k)},Sr({},l,v)));return I},$dispose:O},q=Da($);r._s.set(n,q);const A=(r._a&&r._a.runWithContext||rC)(()=>r._e.run(()=>(o=RE()).run(e)));for(const _ in A){const v=A[_];if(at(v)&&!oC(v)||qr(v))i||(y&&iC(v)&&(at(v)?v.value=y[_]:dd(v,y[_])),r.state.value[n][_]=v);else if(typeof v=="function"){const I=D(_,v);A[_]=I,a.actions[_]=v}}return Sr(q,A),Sr(Ce(q),A),Object.defineProperty(q,"$state",{get:()=>r.state.value[n],set:_=>{w(v=>{Sr(v,_)})}}),r._p.forEach(_=>{Sr(q,o.run(()=>_({store:q,app:r._a,pinia:r,options:a})))}),y&&i&&t.hydrate&&t.hydrate(q.$state,y),c=!0,h=!0,q}function lC(n,e,t){let r,s;const i=typeof e=="function";typeof n=="string"?(r=n,s=i?t:e):(s=n,r=n.id);function o(a,l){const c=qI();return a=a||(c?mn(kv,null):null),a&&lu(a),a=Cv,a._s.has(r)||(i?Pv(r,e,s,a):aC(r,s,a)),a._s.get(r)}return o.$id=r,o}const cC={key:0,class:"spinner-container"},uC=tt("div",{class:"spinner"},null,-1),hC=[uC],dC={__name:"LoadingSpinner",props:{loading:{type:Boolean,required:!0}},setup(n){return(e,t)=>n.loading?(Kr(),su("div",cC,hC)):lA("",!0)}},xv=(n,e)=>{const t=n.__vccOpts||n;for(const[r,s]of e)t[r]=s;return t},fC={},Pf=n=>(ev("data-v-3b12e12d"),n=n(),tv(),n),pC={class:"bottomNavContainer"},mC=Pf(()=>tt("svg",{class:"iconSvgs",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512"},[tt("path",{fill:"#ffffff",d:"M96 32V64H48C21.5 64 0 85.5 0 112v48H448V112c0-26.5-21.5-48-48-48H352V32c0-17.7-14.3-32-32-32s-32 14.3-32 32V64H160V32c0-17.7-14.3-32-32-32S96 14.3 96 32zM448 192H0V464c0 26.5 21.5 48 48 48H400c26.5 0 48-21.5 48-48V192z"})],-1)),gC=Pf(()=>tt("svg",{class:"iconSvgs",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},[tt("path",{fill:"#ffffff",d:"M575.8 255.5c0 18-15 32.1-32 32.1h-32l.7 160.2c0 2.7-.2 5.4-.5 8.1V472c0 22.1-17.9 40-40 40H456c-1.1 0-2.2 0-3.3-.1c-1.4 .1-2.8 .1-4.2 .1H416 392c-22.1 0-40-17.9-40-40V448 384c0-17.7-14.3-32-32-32H256c-17.7 0-32 14.3-32 32v64 24c0 22.1-17.9 40-40 40H160 128.1c-1.5 0-3-.1-4.5-.2c-1.2 .1-2.4 .2-3.6 .2H104c-22.1 0-40-17.9-40-40V360c0-.9 0-1.9 .1-2.8V287.6H32c-18 0-32-14-32-32.1c0-9 3-17 10-24L266.4 8c7-7 15-8 22-8s15 2 21 7L564.8 231.5c8 7 12 15 11 24z"})],-1)),yC=Pf(()=>tt("svg",{class:"iconSvgs",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512"},[tt("path",{fill:"#ffffff",d:"M384 476.1L192 421.2V35.9L384 90.8V476.1zm32-1.2V88.4L543.1 37.5c15.8-6.3 32.9 5.3 32.9 22.3V394.6c0 9.8-6 18.6-15.1 22.3L416 474.8zM15.1 95.1L160 37.2V423.6L32.9 474.5C17.1 480.8 0 469.2 0 452.2V117.4c0-9.8 6-18.6 15.1-22.3z"})],-1));function _C(n,e){const t=nc("RouterLink");return Kr(),su("div",pC,[je(t,{to:"/calender"},{default:Br(()=>[mC]),_:1}),je(t,{to:"/"},{default:Br(()=>[gC]),_:1}),je(t,{to:"/map"},{default:Br(()=>[yC]),_:1})])}const EC=xv(fC,[["render",_C],["__scopeId","data-v-3b12e12d"]]);var xg={ACSetupSvcPort:"23210",ACSvcPort:"17532",ADSK_CLM_WPAD_PROXY_CHECK:"FALSE",ALLUSERSPROFILE:"C:\\ProgramData",APPDATA:"C:\\Users\\david\\AppData\\Roaming",BESIEGE_GAME_ASSEMBLIES:"D:/SteamLibrary/steamapps/common/Besiege/Besiege_Data\\Managed/",BESIEGE_UNITY_ASSEMBLIES:"D:/SteamLibrary/steamapps/common/Besiege/Besiege_Data\\Managed/",ChocolateyInstall:"C:\\ProgramData\\chocolatey",ChocolateyLastPathUpdate:"133297499885031750",CHROME_CRASHPAD_PIPE_NAME:"\\\\.\\pipe\\crashpad_21488_GDAGNMFKZFXSDWUZ",COLOR:"1",COLORTERM:"truecolor",CommonProgramFiles:"C:\\Program Files\\Common Files","CommonProgramFiles(x86)":"C:\\Program Files (x86)\\Common Files",CommonProgramW6432:"C:\\Program Files\\Common Files",COMPUTERNAME:"NUKAS-PC",ComSpec:"C:\\WINDOWS\\system32\\cmd.exe",DriverData:"C:\\Windows\\System32\\Drivers\\DriverData",EDITOR:"C:\\WINDOWS\\notepad.exe",EFC_12716:"1",FPS_BROWSER_APP_PROFILE_STRING:"Internet Explorer",FPS_BROWSER_USER_PROFILE_STRING:"Default",GIT_ASKPASS:"c:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass.sh",HOME:"C:\\Users\\david",HOMEDRIVE:"C:",HOMEPATH:"\\Users\\david",INIT_CWD:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog",INTEL_DEV_REDIST:"C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\",LANG:"en_US.UTF-8",LOCALAPPDATA:"C:\\Users\\david\\AppData\\Local",LOGONSERVER:"\\\\NUKAS-PC",MIC_LD_LIBRARY_PATH:"C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\compiler\\lib\\mic",NODE:"E:\\Program Files (x86)\\node.exe",NODE_ENV:"production",NODE_EXE:"E:\\Program Files (x86)\\\\node.exe",NPM_CLI_JS:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",npm_command:"run-script",npm_config_cache:"C:\\Users\\david\\AppData\\Local\\npm-cache",npm_config_globalconfig:"C:\\Users\\david\\AppData\\Roaming\\npm\\etc\\npmrc",npm_config_global_prefix:"C:\\Users\\david\\AppData\\Roaming\\npm",npm_config_init_module:"C:\\Users\\david\\.npm-init.js",npm_config_local_prefix:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog",npm_config_node_gyp:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\node-gyp\\bin\\node-gyp.js",npm_config_noproxy:"",npm_config_npm_version:"10.4.0",npm_config_prefix:"C:\\Users\\david\\AppData\\Roaming\\npm",npm_config_userconfig:"C:\\Users\\david\\.npmrc",npm_config_user_agent:"npm/10.4.0 node/v20.12.2 win32 x64 workspaces/false",npm_execpath:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",npm_lifecycle_event:"build",npm_lifecycle_script:"vite build",npm_node_execpath:"E:\\Program Files (x86)\\node.exe",npm_package_json:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog\\package.json",npm_package_name:"geografisk-have-interaktiv-kort",npm_package_version:"0.0.0",NPM_PREFIX_NPM_CLI_JS:"C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\bin\\npm-cli.js",NUMBER_OF_PROCESSORS:"8",OneDrive:"C:\\Users\\david\\OneDrive",OneDriveConsumer:"C:\\Users\\david\\OneDrive",ORIGINAL_XDG_CURRENT_DESKTOP:"undefined",OS:"Windows_NT",Path:"E:\\ReactSandbox\\eksamen\\geografisk-have-interaktiv-kort-og-lydbog\\node_modules\\.bin;E:\\ReactSandbox\\eksamen\\node_modules\\.bin;E:\\ReactSandbox\\node_modules\\.bin;E:\\node_modules\\.bin;C:\\Users\\david\\AppData\\Roaming\\npm\\node_modules\\npm\\node_modules\\@npmcli\\run-script\\lib\\node-gyp-bin;C:\\Program Files\\Common Files\\Oracle\\Java\\javapath;C:\\Python312\\Scripts\\;C:\\Python312\\;C:\\Python310\\Scripts\\;C:\\Python310\\;C:\\Program Files (x86)\\Common Files\\Intel\\Shared Libraries\\redist\\intel64\\compiler;C:\\Windows\\system32;C:\\Windows;C:\\Windows\\System32\\Wbem;C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\;C:\\Windows\\System32\\OpenSSH\\;C:\\Program Files (x86)\\NVIDIA Corporation\\PhysX\\Common;C:\\Program Files\\NVIDIA Corporation\\NVIDIA NvDLISR;C:\\Program Files\\Microsoft SQL Server\\120\\Tools\\Binn\\;C:\\Program Files\\Common Files\\Autodesk Shared\\;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\dotnet\\;C:\\ProgramData\\chocolatey\\bin;C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem;C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\;C:\\WINDOWS\\System32\\OpenSSH\\;C:\\Program Files\\Git\\cmd;C:\\Program Files (x86)\\Microsoft SQL Server\\160\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\160\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\Client SDK\\ODBC\\170\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\160\\DTS\\Binn\\;C:\\Program Files (x86)\\Microsoft SQL Server\\160\\DTS\\Binn\\;C:\\Program Files\\Azure Data Studio\\bin;C:\\Program Files\\Microsoft SQL Server\\130\\Tools\\Binn\\;C:\\Program Files\\Microsoft SQL Server\\150\\Tools\\Binn\\;C:\\Program Files\\GitHub CLI\\;E:\\Program Files (x86)\\;C:\\Users\\david\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\david\\AppData\\Local\\Microsoft\\WindowsApps;C:\\Users\\david\\AppData\\Local\\GitHubDesktop\\bin;C:\\Users\\david\\.dotnet\\tools;C:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\bin;C:\\Program Files\\Azure Data Studio\\bin;C:\\Program Files\\Azure Data Studio\\bin;C:\\Users\\david\\.dotnet\\tools;C:\\Users\\david\\AppData\\Roaming\\npm",PATHEXT:".COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.MSC;.PY;.PYW;.CPL",PROCESSOR_ARCHITECTURE:"AMD64",PROCESSOR_IDENTIFIER:"AMD64 Family 23 Model 24 Stepping 1, AuthenticAMD",PROCESSOR_LEVEL:"23",PROCESSOR_REVISION:"1801",ProgramData:"C:\\ProgramData",ProgramFiles:"C:\\Program Files","ProgramFiles(x86)":"C:\\Program Files (x86)",ProgramW6432:"C:\\Program Files",PROMPT:"$P$G",PSModulePath:"C:\\Users\\david\\OneDrive\\Dokumenter\\WindowsPowerShell\\Modules;C:\\Program Files\\WindowsPowerShell\\Modules;C:\\WINDOWS\\system32\\WindowsPowerShell\\v1.0\\Modules;C:\\Program Files (x86)\\Microsoft SQL Server\\160\\Tools\\PowerShell\\Modules\\",PUBLIC:"C:\\Users\\Public",RlsSvcPort:"22112",SESSIONNAME:"Console",SystemDrive:"C:",SystemRoot:"C:\\WINDOWS",TEMP:"C:\\Users\\david\\AppData\\Local\\Temp",TERM_PROGRAM:"vscode",TERM_PROGRAM_VERSION:"1.90.0",TMP:"C:\\Users\\david\\AppData\\Local\\Temp",USERDOMAIN:"NUKAS-PC",USERDOMAIN_ROAMINGPROFILE:"NUKAS-PC",USERNAME:"david",USERPROFILE:"C:\\Users\\david",VITE_FIREBASE_API_KEY:"AIzaSyBrXS9zQOlmv6BfZgrTLHY402zKsE7Zm9c",VITE_FIREBASE_APP_ID:"1:447721431608:web:d793a2a1904c6176cfbccd",VITE_FIREBASE_AUTH_DOMAIN:"geo-kort-og-lydbog.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://geo-kort-og-lydbog-default-rtdb.europe-west1.firebasedatabase.app",VITE_FIREBASE_MEASUREMENT_ID:"G-5N25FFYYME",VITE_FIREBASE_MESSAGING_SENDER_ID:"447721431608",VITE_FIREBASE_PROJECT_ID:"geo-kort-og-lydbog",VITE_FIREBASE_STORAGE_BUCKET:"geo-kort-og-lydbog.appspot.com",VSCODE_GIT_ASKPASS_EXTRA_ARGS:"",VSCODE_GIT_ASKPASS_MAIN:"c:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\resources\\app\\extensions\\git\\dist\\askpass-main.js",VSCODE_GIT_ASKPASS_NODE:"C:\\Users\\david\\AppData\\Local\\Programs\\Microsoft VS Code\\Code.exe",VSCODE_GIT_IPC_HANDLE:"\\\\.\\pipe\\vscode-git-4f97f6e042-sock",VSCODE_INJECTION:"1",windir:"C:\\WINDOWS"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ov=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},vC=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=n[t++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=n[t++],o=n[t++],a=n[t++],l=((s&7)<<18|(i&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const i=n[t++],o=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Mv={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const i=n[s],o=s+1<n.length,a=o?n[s+1]:0,l=s+2<n.length,c=l?n[s+2]:0,h=i>>2,d=(i&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),r.push(t[h],t[d],t[f],t[m])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Ov(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):vC(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const i=t[n.charAt(s++)],a=s<n.length?t[n.charAt(s)]:0;++s;const c=s<n.length?t[n.charAt(s)]:64;++s;const d=s<n.length?t[n.charAt(s)]:64;if(++s,i==null||a==null||c==null||d==null)throw new TC;const f=i<<2|a>>4;if(r.push(f),c!==64){const m=a<<4&240|c>>2;if(r.push(m),d!==64){const y=c<<6&192|d;r.push(y)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class TC extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const wC=function(n){const e=Ov(n);return Mv.encodeByteArray(e,!0)},cc=function(n){return wC(n).replace(/\./g,"")},Nv=function(n){try{return Mv.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SC=()=>bC().__FIREBASE_DEFAULTS__,IC=()=>{if(typeof process>"u"||typeof xg>"u")return;const n=xg.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},AC=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&Nv(n[1]);return e&&JSON.parse(e)},cu=()=>{try{return SC()||IC()||AC()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Dv=n=>{var e,t;return(t=(e=cu())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Lv=n=>{const e=Dv(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Vv=()=>{var n;return(n=cu())===null||n===void 0?void 0:n.config},Fv=n=>{var e;return(e=cu())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bv(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,i=n.sub||n.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},n);return[cc(JSON.stringify(t)),cc(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kC(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(At())}function RC(){var n;const e=(n=cu())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function PC(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function xC(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function OC(){const n=At();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function MC(){return!RC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function NC(){try{return typeof indexedDB=="object"}catch{return!1}}function DC(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC="FirebaseError";class Qn extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=LC,Object.setPrototypeOf(this,Qn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fa.prototype.create)}}class Fa{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?VC(i,r):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Qn(s,a,r)}}function VC(n,e){return n.replace(FC,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const FC=/\{\$([^}]+)}/g;function BC(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function uc(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const i=n[s],o=e[s];if(Og(i)&&Og(o)){if(!uc(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function Og(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ba(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function No(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Do(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function UC(n,e){const t=new $C(n,e);return t.subscribe.bind(t)}class $C{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");zC(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=ph),s.error===void 0&&(s.error=ph),s.complete===void 0&&(s.complete=ph);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function zC(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function ph(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qe(n){return n&&n._delegate?n._delegate:n}class ss{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jC{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new CC;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(qC(e))try{this.getOrInitializeService({instanceIdentifier:Ss})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=Ss){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ss){return this.instances.has(e)}getOptions(e=Ss){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[i,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(i);r===a&&o.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:HC(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ss){return this.component?this.component.multipleInstances?e:Ss:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function HC(n){return n===Ss?void 0:n}function qC(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new jC(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var be;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(be||(be={}));const KC={debug:be.DEBUG,verbose:be.VERBOSE,info:be.INFO,warn:be.WARN,error:be.ERROR,silent:be.SILENT},GC=be.INFO,JC={[be.DEBUG]:"log",[be.VERBOSE]:"log",[be.INFO]:"info",[be.WARN]:"warn",[be.ERROR]:"error"},QC=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=JC[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class xf{constructor(e){this.name=e,this._logLevel=GC,this._logHandler=QC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?KC[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,be.DEBUG,...e),this._logHandler(this,be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,be.VERBOSE,...e),this._logHandler(this,be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,be.INFO,...e),this._logHandler(this,be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,be.WARN,...e),this._logHandler(this,be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,be.ERROR,...e),this._logHandler(this,be.ERROR,...e)}}const YC=(n,e)=>e.some(t=>n instanceof t);let Mg,Ng;function XC(){return Mg||(Mg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZC(){return Ng||(Ng=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Uv=new WeakMap,fd=new WeakMap,$v=new WeakMap,mh=new WeakMap,Of=new WeakMap;function ek(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",i),n.removeEventListener("error",o)},i=()=>{t(Gr(n.result)),s()},o=()=>{r(n.error),s()};n.addEventListener("success",i),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Uv.set(t,n)}).catch(()=>{}),Of.set(e,n),e}function tk(n){if(fd.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",i),n.removeEventListener("error",o),n.removeEventListener("abort",o)},i=()=>{t(),s()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",i),n.addEventListener("error",o),n.addEventListener("abort",o)});fd.set(n,e)}let pd={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return fd.get(n);if(e==="objectStoreNames")return n.objectStoreNames||$v.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Gr(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function nk(n){pd=n(pd)}function rk(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(gh(this),e,...t);return $v.set(r,e.sort?e.sort():[e]),Gr(r)}:ZC().includes(n)?function(...e){return n.apply(gh(this),e),Gr(Uv.get(this))}:function(...e){return Gr(n.apply(gh(this),e))}}function sk(n){return typeof n=="function"?rk(n):(n instanceof IDBTransaction&&tk(n),YC(n,XC())?new Proxy(n,pd):n)}function Gr(n){if(n instanceof IDBRequest)return ek(n);if(mh.has(n))return mh.get(n);const e=sk(n);return e!==n&&(mh.set(n,e),Of.set(e,n)),e}const gh=n=>Of.get(n);function ik(n,e,{blocked:t,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(n,e),a=Gr(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Gr(o.result),l.oldVersion,l.newVersion,Gr(o.transaction),l)}),t&&o.addEventListener("blocked",l=>t(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const ok=["get","getKey","getAll","getAllKeys","count"],ak=["put","add","delete","clear"],yh=new Map;function Dg(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(yh.get(e))return yh.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=ak.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||ok.includes(t)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[t](...a),s&&l.done]))[0]};return yh.set(e,i),i}nk(n=>({...n,get:(e,t,r)=>Dg(e,t)||n.get(e,t,r),has:(e,t)=>!!Dg(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(ck(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function ck(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const md="@firebase/app",Lg="0.10.5";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qs=new xf("@firebase/app"),uk="@firebase/app-compat",hk="@firebase/analytics-compat",dk="@firebase/analytics",fk="@firebase/app-check-compat",pk="@firebase/app-check",mk="@firebase/auth",gk="@firebase/auth-compat",yk="@firebase/database",_k="@firebase/database-compat",Ek="@firebase/functions",vk="@firebase/functions-compat",Tk="@firebase/installations",wk="@firebase/installations-compat",bk="@firebase/messaging",Sk="@firebase/messaging-compat",Ik="@firebase/performance",Ak="@firebase/performance-compat",Ck="@firebase/remote-config",kk="@firebase/remote-config-compat",Rk="@firebase/storage",Pk="@firebase/storage-compat",xk="@firebase/firestore",Ok="@firebase/vertexai-preview",Mk="@firebase/firestore-compat",Nk="firebase",Dk="10.12.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gd="[DEFAULT]",Lk={[md]:"fire-core",[uk]:"fire-core-compat",[dk]:"fire-analytics",[hk]:"fire-analytics-compat",[pk]:"fire-app-check",[fk]:"fire-app-check-compat",[mk]:"fire-auth",[gk]:"fire-auth-compat",[yk]:"fire-rtdb",[_k]:"fire-rtdb-compat",[Ek]:"fire-fn",[vk]:"fire-fn-compat",[Tk]:"fire-iid",[wk]:"fire-iid-compat",[bk]:"fire-fcm",[Sk]:"fire-fcm-compat",[Ik]:"fire-perf",[Ak]:"fire-perf-compat",[Ck]:"fire-rc",[kk]:"fire-rc-compat",[Rk]:"fire-gcs",[Pk]:"fire-gcs-compat",[xk]:"fire-fst",[Mk]:"fire-fst-compat",[Ok]:"fire-vertex","fire-js":"fire-js",[Nk]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hc=new Map,Vk=new Map,yd=new Map;function Vg(n,e){try{n.container.addComponent(e)}catch(t){qs.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Ws(n){const e=n.name;if(yd.has(e))return qs.debug(`There were multiple attempts to register component ${e}.`),!1;yd.set(e,n);for(const t of hc.values())Vg(t,n);for(const t of Vk.values())Vg(t,n);return!0}function uu(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function nr(n){return n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fk={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Jr=new Fa("app","Firebase",Fk);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ss("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Jr.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const si=Dk;function zv(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:gd,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Jr.create("bad-app-name",{appName:String(s)});if(t||(t=Vv()),!t)throw Jr.create("no-options");const i=hc.get(s);if(i){if(uc(t,i.options)&&uc(r,i.config))return i;throw Jr.create("duplicate-app",{appName:s})}const o=new WC(s);for(const l of yd.values())o.addComponent(l);const a=new Bk(t,r,o);return hc.set(s,a),a}function Mf(n=gd){const e=hc.get(n);if(!e&&n===gd&&Vv())return zv();if(!e)throw Jr.create("no-app",{appName:n});return e}function Un(n,e,t){var r;let s=(r=Lk[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const a=[`Unable to register library "${s}" with version "${e}":`];i&&a.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),qs.warn(a.join(" "));return}Ws(new ss(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uk="firebase-heartbeat-database",$k=1,ma="firebase-heartbeat-store";let _h=null;function jv(){return _h||(_h=ik(Uk,$k,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ma)}catch(t){console.warn(t)}}}}).catch(n=>{throw Jr.create("idb-open",{originalErrorMessage:n.message})})),_h}async function zk(n){try{const t=(await jv()).transaction(ma),r=await t.objectStore(ma).get(Hv(n));return await t.done,r}catch(e){if(e instanceof Qn)qs.warn(e.message);else{const t=Jr.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});qs.warn(t.message)}}}async function Fg(n,e){try{const r=(await jv()).transaction(ma,"readwrite");await r.objectStore(ma).put(e,Hv(n)),await r.done}catch(t){if(t instanceof Qn)qs.warn(t.message);else{const r=Jr.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});qs.warn(r.message)}}}function Hv(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jk=1024,Hk=30*24*60*60*1e3;class qk{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Kk(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Bg();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)))return this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Hk}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Bg(),{heartbeatsToSend:r,unsentEntries:s}=Wk(this._heartbeatsCache.heartbeats),i=cc(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Bg(){return new Date().toISOString().substring(0,10)}function Wk(n,e=jk){const t=[];let r=n.slice();for(const s of n){const i=t.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Ug(t)>e){i.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Ug(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class Kk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return NC()?DC().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await zk(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Fg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Fg(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Ug(n){return cc(JSON.stringify({version:2,heartbeats:n})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gk(n){Ws(new ss("platform-logger",e=>new lk(e),"PRIVATE")),Ws(new ss("heartbeat",e=>new qk(e),"PRIVATE")),Un(md,Lg,n),Un(md,Lg,"esm2017"),Un("fire-js","")}Gk("");function Nf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function qv(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Jk=qv,Wv=new Fa("auth","Firebase",qv());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dc=new xf("@firebase/auth");function Qk(n,...e){dc.logLevel<=be.WARN&&dc.warn(`Auth (${si}): ${n}`,...e)}function Ul(n,...e){dc.logLevel<=be.ERROR&&dc.error(`Auth (${si}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function An(n,...e){throw Df(n,...e)}function $n(n,...e){return Df(n,...e)}function Kv(n,e,t){const r=Object.assign(Object.assign({},Jk()),{[e]:t});return new Fa("auth","Firebase",r).create(e,{appName:n.name})}function Qr(n){return Kv(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Df(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Wv.create(n,...e)}function de(n,e,...t){if(!n)throw Df(e,...t)}function rr(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Ul(e),new Error(e)}function cr(n,e){n||rr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _d(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function Yk(){return $g()==="http:"||$g()==="https:"}function $g(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Yk()||PC()||"connection"in navigator)?navigator.onLine:!0}function Zk(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ua{constructor(e,t){this.shortDelay=e,this.longDelay=t,cr(t>e,"Short delay should be less than long delay!"),this.isMobile=kC()||xC()}get(){return Xk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lf(n,e){cr(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;rr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;rr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;rr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eR={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tR=new Ua(3e4,6e4);function ii(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function us(n,e,t,r,s={}){return Jv(n,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const a=Ba(Object.assign({key:n.config.apiKey},o)).slice(1),l=await n._getAdditionalHeaders();return l["Content-Type"]="application/json",n.languageCode&&(l["X-Firebase-Locale"]=n.languageCode),Gv.fetch()(Qv(n,n.config.apiHost,t,a),Object.assign({method:e,headers:l,referrerPolicy:"no-referrer"},i))})}async function Jv(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},eR),e);try{const s=new rR(n),i=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw wl(n,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const a=i.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw wl(n,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw wl(n,"email-already-in-use",o);if(l==="USER_DISABLED")throw wl(n,"user-disabled",o);const h=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw Kv(n,h,c);An(n,h)}}catch(s){if(s instanceof Qn)throw s;An(n,"network-request-failed",{message:String(s)})}}async function hu(n,e,t,r,s={}){const i=await us(n,e,t,r,s);return"mfaPendingCredential"in i&&An(n,"multi-factor-auth-required",{_serverResponse:i}),i}function Qv(n,e,t,r){const s=`${e}${t}?${r}`;return n.config.emulator?Lf(n.config,s):`${n.config.apiScheme}://${s}`}function nR(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class rR{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r($n(this.auth,"network-request-failed")),tR.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function wl(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=$n(n,e,r);return s.customData._tokenResponse=t,s}function zg(n){return n!==void 0&&n.enterprise!==void 0}class sR{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return nR(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function iR(n,e){return us(n,"GET","/v2/recaptchaConfig",ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oR(n,e){return us(n,"POST","/v1/accounts:delete",e)}async function Yv(n,e){return us(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yo(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function aR(n,e=!1){const t=Qe(n),r=await t.getIdToken(e),s=Vf(r);de(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Yo(Eh(s.auth_time)),issuedAtTime:Yo(Eh(s.iat)),expirationTime:Yo(Eh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Eh(n){return Number(n)*1e3}function Vf(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ul("JWT malformed, contained fewer than 3 sections"),null;try{const s=Nv(t);return s?JSON.parse(s):(Ul("Failed to decode base64 JWT payload"),null)}catch(s){return Ul("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function jg(n){const e=Vf(n);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ga(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Qn&&lR(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function lR({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cR{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Yo(this.lastLoginAt),this.creationTime=Yo(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fc(n){var e;const t=n.auth,r=await n.getIdToken(),s=await ga(n,Yv(t,{idToken:r}));de(s==null?void 0:s.users.length,t,"internal-error");const i=s.users[0];n._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Xv(i.providerUserInfo):[],a=hR(n.providerData,o),l=n.isAnonymous,c=!(n.email&&i.passwordHash)&&!(a!=null&&a.length),h=l?c:!1,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:a,metadata:new Ed(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,d)}async function uR(n){const e=Qe(n);await fc(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function hR(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Xv(n){return n.map(e=>{var{providerId:t}=e,r=Nf(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dR(n,e){const t=await Jv(n,{},async()=>{const r=Ba({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=n.config,o=Qv(n,s,"/v1/token",`key=${i}`),a=await n._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",Gv.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function fR(n,e){return us(n,"POST","/v2/accounts:revokeToken",ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):jg(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){de(e.length!==0,"internal-error");const t=jg(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:i}=await dR(e,t);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:i}=t,o=new Mi;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Mi,this.toJSON())}_performRefresh(){return rr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wr(n,e){de(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class sr{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,i=Nf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new cR(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ed(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await ga(this,this.stsTokenManager.getToken(this.auth,e));return de(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return aR(this,e)}reload(){return uR(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new sr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await fc(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(nr(this.auth.app))return Promise.reject(Qr(this.auth));const e=await this.getIdToken();return await ga(this,oR(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,i,o,a,l,c,h;const d=(r=t.displayName)!==null&&r!==void 0?r:void 0,f=(s=t.email)!==null&&s!==void 0?s:void 0,m=(i=t.phoneNumber)!==null&&i!==void 0?i:void 0,y=(o=t.photoURL)!==null&&o!==void 0?o:void 0,T=(a=t.tenantId)!==null&&a!==void 0?a:void 0,w=(l=t._redirectEventId)!==null&&l!==void 0?l:void 0,P=(c=t.createdAt)!==null&&c!==void 0?c:void 0,O=(h=t.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:D,emailVerified:$,isAnonymous:q,providerData:F,stsTokenManager:A}=t;de(D&&A,e,"internal-error");const _=Mi.fromJSON(this.name,A);de(typeof D=="string",e,"internal-error"),wr(d,e.name),wr(f,e.name),de(typeof $=="boolean",e,"internal-error"),de(typeof q=="boolean",e,"internal-error"),wr(m,e.name),wr(y,e.name),wr(T,e.name),wr(w,e.name),wr(P,e.name),wr(O,e.name);const v=new sr({uid:D,auth:e,email:f,emailVerified:$,displayName:d,isAnonymous:q,photoURL:y,phoneNumber:m,tenantId:T,stsTokenManager:_,createdAt:P,lastLoginAt:O});return F&&Array.isArray(F)&&(v.providerData=F.map(I=>Object.assign({},I))),w&&(v._redirectEventId=w),v}static async _fromIdTokenResponse(e,t,r=!1){const s=new Mi;s.updateFromServerResponse(t);const i=new sr({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await fc(i),i}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Xv(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),a=new Mi;a.updateFromIdToken(r);const l=new sr({uid:s.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ed(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg=new Map;function ir(n){cr(n instanceof Function,"Expected a class definition");let e=Hg.get(n);return e?(cr(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Hg.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Zv.type="NONE";const qg=Zv;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $l(n,e,t){return`firebase:${n}:${e}:${t}`}class Ni{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=$l(this.userKey,s.apiKey,i),this.fullPersistenceKey=$l("persistence",s.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?sr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Ni(ir(qg),e,r);const s=(await Promise.all(t.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let i=s[0]||ir(qg);const o=$l(r,e.config.apiKey,e.name);let a=null;for(const c of t)try{const h=await c._get(o);if(h){const d=sr._fromJSON(e,h);c!==i&&(a=d),i=c;break}}catch{}const l=s.filter(c=>c._shouldAllowMigration);return!i._shouldAllowMigration||!l.length?new Ni(i,e,r):(i=l[0],a&&await i._set(o,a.toJSON()),await Promise.all(t.map(async c=>{if(c!==i)try{await c._remove(o)}catch{}})),new Ni(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wg(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(n0(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(e0(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(s0(e))return"Blackberry";if(i0(e))return"Webos";if(Ff(e))return"Safari";if((e.includes("chrome/")||t0(e))&&!e.includes("edge/"))return"Chrome";if(r0(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function e0(n=At()){return/firefox\//i.test(n)}function Ff(n=At()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function t0(n=At()){return/crios\//i.test(n)}function n0(n=At()){return/iemobile/i.test(n)}function r0(n=At()){return/android/i.test(n)}function s0(n=At()){return/blackberry/i.test(n)}function i0(n=At()){return/webos/i.test(n)}function du(n=At()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function pR(n=At()){var e;return du(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function mR(){return OC()&&document.documentMode===10}function o0(n=At()){return du(n)||r0(n)||i0(n)||s0(n)||/windows phone/i.test(n)||n0(n)}function gR(){try{return!!(window&&window!==window.top)}catch{return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a0(n,e=[]){let t;switch(n){case"Browser":t=Wg(At());break;case"Worker":t=`${Wg(At())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${si}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=i=>new Promise((o,a)=>{try{const l=e(i);o(l)}catch(l){a(l)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _R(n,e={}){return us(n,"GET","/v2/passwordPolicy",ii(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=6;class vR{constructor(e){var t,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:ER,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,i,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(t=l.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(s=l.containsLowercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(i=l.containsUppercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Kg(this),this.idTokenSubscription=new Kg(this),this.beforeStateQueue=new yR(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wv,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ir(t)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Ni.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Yv(this,{idToken:e}),r=await sr._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(nr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,a=s==null?void 0:s._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(s=l.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await fc(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Zk()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(nr(this.app))return Promise.reject(Qr(this));const t=e?Qe(e):null;return t&&de(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return nr(this.app)?Promise.reject(Qr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return nr(this.app)?Promise.reject(Qr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ir(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await _R(this),t=new vR(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fa("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await fR(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ir(e)||this._popupRedirectResolver;de(t,this,"argument-error"),this.redirectPersistenceManager=await Ni.create(this,[ir(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const i=typeof t=="function"?t:t.next.bind(t);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(a,this,"internal-error"),a.then(()=>{o||i(this.currentUser)}),typeof t=="function"){const l=e.addObserver(t,r,s);return()=>{o=!0,l()}}else{const l=e.addObserver(t);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=a0(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&Qk(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function io(n){return Qe(n)}class Kg{constructor(e){this.auth=e,this.observer=null,this.addObserver=UC(t=>this.observer=t)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wR(n){fu=n}function l0(n){return fu.loadJS(n)}function bR(){return fu.recaptchaEnterpriseScript}function SR(){return fu.gapiScript}function IR(n){return`__${n}${Math.floor(Math.random()*1e6)}`}const AR="recaptcha-enterprise",CR="NO_RECAPTCHA";class kR{constructor(e){this.type=AR,this.auth=io(e)}async verify(e="verify",t=!1){async function r(i){if(!t){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,a)=>{iR(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new sR(l);return i.tenantId==null?i._agentRecaptchaConfig=c:i._tenantRecaptchaConfigs[i.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function s(i,o,a){const l=window.grecaptcha;zg(l)?l.enterprise.ready(()=>{l.enterprise.execute(i,{action:e}).then(c=>{o(c)}).catch(()=>{o(CR)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(a=>{if(!t&&zg(window.grecaptcha))s(a,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=bR();l.length!==0&&(l+=a),l0(l).then(()=>{s(a,i,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Gg(n,e,t,r=!1){const s=new kR(n);let i;try{i=await s.verify(t)}catch{i=await s.verify(t,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Jg(n,e,t,r){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Gg(n,e,t,t==="getOobCode");return r(n,i)}else return r(n,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Gg(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RR(n,e){const t=uu(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),i=t.getOptions();if(uc(i,e??{}))return s;An(s,"already-initialized")}return t.initialize({options:e})}function PR(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ir);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function xR(n,e,t){const r=io(n);de(r._canInitEmulator,r,"emulator-config-failed"),de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=c0(e),{host:o,port:a}=OR(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${i}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),MR()}function c0(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function OR(n){const e=c0(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Qg(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:Qg(o)}}}function Qg(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function MR(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return rr("not implemented")}_getIdTokenResponse(e){return rr("not implemented")}_linkToIdToken(e,t){return rr("not implemented")}_getReauthenticationResolver(e){return rr("not implemented")}}async function NR(n,e){return us(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function DR(n,e){return hu(n,"POST","/v1/accounts:signInWithPassword",ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LR(n,e){return hu(n,"POST","/v1/accounts:signInWithEmailLink",ii(n,e))}async function VR(n,e){return hu(n,"POST","/v1/accounts:signInWithEmailLink",ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends Bf{constructor(e,t,r,s=null){super("password",r),this._email=e,this._password=t,this._tenantId=s}static _fromEmailAndPassword(e,t){return new ya(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new ya(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jg(e,t,"signInWithPassword",DR);case"emailLink":return LR(e,{email:this._email,oobCode:this._password});default:An(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jg(e,r,"signUpPassword",NR);case"emailLink":return VR(e,{idToken:t,email:this._email,oobCode:this._password});default:An(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Di(n,e){return hu(n,"POST","/v1/accounts:signInWithIdp",ii(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR="http://localhost";class Ks extends Bf{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Ks(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):An("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,i=Nf(t,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ks(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Di(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Di(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Di(e,t)}buildRequest(){const e={requestUri:FR,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Ba(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BR(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function UR(n){const e=No(Do(n)).link,t=e?No(Do(e)).deep_link_id:null,r=No(Do(n)).deep_link_id;return(r?No(Do(r)).link:null)||r||t||e||n}class Uf{constructor(e){var t,r,s,i,o,a;const l=No(Do(e)),c=(t=l.apiKey)!==null&&t!==void 0?t:null,h=(r=l.oobCode)!==null&&r!==void 0?r:null,d=BR((s=l.mode)!==null&&s!==void 0?s:null);de(c&&h&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=h,this.continueUrl=(i=l.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const t=UR(e);try{return new Uf(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(){this.providerId=oo.PROVIDER_ID}static credential(e,t){return ya._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Uf.parseLink(t);return de(r,"argument-error"),ya._fromEmailAndCode(e,r.code,r.tenantId)}}oo.PROVIDER_ID="password";oo.EMAIL_PASSWORD_SIGN_IN_METHOD="password";oo.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u0{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a extends u0{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr extends $a{constructor(){super("facebook.com")}static credential(e){return Ks._fromParams({providerId:Mr.PROVIDER_ID,signInMethod:Mr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mr.credentialFromTaggedObject(e)}static credentialFromError(e){return Mr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mr.credential(e.oauthAccessToken)}catch{return null}}}Mr.FACEBOOK_SIGN_IN_METHOD="facebook.com";Mr.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr extends $a{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Ks._fromParams({providerId:Nr.PROVIDER_ID,signInMethod:Nr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Nr.credentialFromTaggedObject(e)}static credentialFromError(e){return Nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return Nr.credential(t,r)}catch{return null}}}Nr.GOOGLE_SIGN_IN_METHOD="google.com";Nr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends $a{constructor(){super("github.com")}static credential(e){return Ks._fromParams({providerId:Dr.PROVIDER_ID,signInMethod:Dr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dr.credentialFromTaggedObject(e)}static credentialFromError(e){return Dr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dr.credential(e.oauthAccessToken)}catch{return null}}}Dr.GITHUB_SIGN_IN_METHOD="github.com";Dr.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr extends $a{constructor(){super("twitter.com")}static credential(e,t){return Ks._fromParams({providerId:Lr.PROVIDER_ID,signInMethod:Lr.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Lr.credentialFromTaggedObject(e)}static credentialFromError(e){return Lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Lr.credential(t,r)}catch{return null}}}Lr.TWITTER_SIGN_IN_METHOD="twitter.com";Lr.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const i=await sr._fromIdTokenResponse(e,r,s),o=Yg(r);return new zi({user:i,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=Yg(r);return new zi({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function Yg(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc extends Qn{constructor(e,t,r,s){var i;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,pc.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new pc(e,t,r,s)}}function h0(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?pc._fromErrorAndOperation(n,i,e,r):i})}async function $R(n,e,t=!1){const r=await ga(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return zi._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zR(n,e,t=!1){const{auth:r}=n;if(nr(r.app))return Promise.reject(Qr(r));const s="reauthenticate";try{const i=await ga(n,h0(r,s,e,n),t);de(i.idToken,r,"internal-error");const o=Vf(i.idToken);de(o,r,"internal-error");const{sub:a}=o;return de(n.uid===a,r,"user-mismatch"),zi._forOperation(n,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&An(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function d0(n,e,t=!1){if(nr(n.app))return Promise.reject(Qr(n));const r="signIn",s=await h0(n,r,e),i=await zi._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(i.user),i}async function jR(n,e){return d0(io(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HR(n){const e=io(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function qR(n,e,t){return nr(n.app)?Promise.reject(Qr(n)):jR(Qe(n),oo.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&HR(n),r})}function WR(n,e,t,r){return Qe(n).onIdTokenChanged(e,t,r)}function KR(n,e,t){return Qe(n).beforeAuthStateChanged(e,t)}function GR(n,e,t,r){return Qe(n).onAuthStateChanged(e,t,r)}function JR(n){return Qe(n).signOut()}const mc="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(mc,"1"),this.storage.removeItem(mc),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QR(){const n=At();return Ff(n)||du(n)}const YR=1e3,XR=10;class p0 extends f0{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=QR()&&gR(),this.fallbackToPolling=o0(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const o=this.storage.getItem(r);if(e.newValue!==o)e.newValue!==null?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!t)return}const s=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);mR()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,XR):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},YR)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}p0.type="LOCAL";const ZR=p0;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m0 extends f0{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}m0.type="SESSION";const g0=m0;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e1(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new pu(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:i}=t.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const a=Array.from(o).map(async c=>c(t.origin,i)),l=await e1(a);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:l})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}pu.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $f(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((a,l)=>{const c=$f("",20);s.port1.start();const h=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(d){const f=d;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),a(f.data.response);break;default:clearTimeout(h),clearTimeout(i),l(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zn(){return window}function n1(n){zn().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(){return typeof zn().WorkerGlobalScope<"u"&&typeof zn().importScripts=="function"}async function r1(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function s1(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function i1(){return y0()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0="firebaseLocalStorageDb",o1=1,gc="firebaseLocalStorage",E0="fbase_key";class za{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function mu(n,e){return n.transaction([gc],e?"readwrite":"readonly").objectStore(gc)}function a1(){const n=indexedDB.deleteDatabase(_0);return new za(n).toPromise()}function vd(){const n=indexedDB.open(_0,o1);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(gc,{keyPath:E0})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(gc)?e(r):(r.close(),await a1(),e(await vd()))})})}async function Xg(n,e,t){const r=mu(n,!0).put({[E0]:e,value:t});return new za(r).toPromise()}async function l1(n,e){const t=mu(n,!1).get(e),r=await new za(t).toPromise();return r===void 0?null:r.value}function Zg(n,e){const t=mu(n,!0).delete(e);return new za(t).toPromise()}const c1=800,u1=3;class v0{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await vd(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>u1)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return y0()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=pu._getInstance(i1()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await r1(),!this.activeServiceWorker)return;this.sender=new t1(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||s1()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await vd();return await Xg(e,mc,"1"),await Zg(e,mc),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>Xg(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>l1(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Zg(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=mu(s,!1).getAll();return new za(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),c1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}v0.type="LOCAL";const h1=v0;new Ua(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(n,e){return e?ir(e):(de(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf extends Bf{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Di(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Di(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Di(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function f1(n){return d0(n.auth,new zf(n),n.bypassAuthState)}function p1(n){const{auth:e,user:t}=n;return de(t,e,"internal-error"),zR(t,new zf(n),n.bypassAuthState)}async function m1(n){const{auth:e,user:t}=n;return de(t,e,"internal-error"),$R(t,new zf(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,t,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:i,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:t,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return f1;case"linkViaPopup":case"linkViaRedirect":return m1;case"reauthViaPopup":case"reauthViaRedirect":return p1;default:An(this.auth,"internal-error")}}resolve(e){cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){cr(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1=new Ua(2e3,1e4);class Si extends T0{constructor(e,t,r,s,i){super(e,t,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Si.currentPopupAction&&Si.currentPopupAction.cancel(),Si.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){cr(this.filter.length===1,"Popup operations only handle one event");const e=$f();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject($n(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject($n(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Si.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject($n(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,g1.get())};e()}}Si.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y1="pendingRedirect",zl=new Map;class _1 extends T0{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=zl.get(this.auth._key());if(!e){try{const r=await E1(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}zl.set(this.auth._key(),e)}return this.bypassAuthState||zl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function E1(n,e){const t=w1(e),r=T1(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function v1(n,e){zl.set(n._key(),e)}function T1(n){return ir(n._redirectPersistence)}function w1(n){return $l(y1,n.config.apiKey,n.name)}async function b1(n,e,t=!1){if(nr(n.app))return Promise.reject(Qr(n));const r=io(n),s=d1(r,e),o=await new _1(r,s,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1=10*60*1e3;class I1{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!A1(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!w0(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError($n(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=S1&&this.cachedEventUids.clear(),this.cachedEventUids.has(ey(e))}saveEventToCache(e){this.cachedEventUids.add(ey(e)),this.lastProcessedEventTime=Date.now()}}function ey(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function w0({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function A1(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return w0(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C1(n,e={}){return us(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k1=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,R1=/^https?/;async function P1(n){if(n.config.emulator)return;const{authorizedDomains:e}=await C1(n);for(const t of e)try{if(x1(t))return}catch{}An(n,"unauthorized-domain")}function x1(n){const e=_d(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!R1.test(t))return!1;if(k1.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O1=new Ua(3e4,6e4);function ty(){const n=zn().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function M1(n){return new Promise((e,t)=>{var r,s,i;function o(){ty(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ty(),t($n(n,"network-request-failed"))},timeout:O1.get()})}if(!((s=(r=zn().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=zn().gapi)===null||i===void 0)&&i.load)o();else{const a=IR("iframefcb");return zn()[a]=()=>{gapi.load?o():t($n(n,"network-request-failed"))},l0(`${SR()}?onload=${a}`).catch(l=>t(l))}}).catch(e=>{throw jl=null,e})}let jl=null;function N1(n){return jl=jl||M1(n),jl}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D1=new Ua(5e3,15e3),L1="__/auth/iframe",V1="emulator/auth/iframe",F1={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},B1=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function U1(n){const e=n.config;de(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Lf(e,V1):`https://${n.config.authDomain}/${L1}`,r={apiKey:e.apiKey,appName:n.name,v:si},s=B1.get(n.config.apiHost);s&&(r.eid=s);const i=n._getFrameworks();return i.length&&(r.fw=i.join(",")),`${t}?${Ba(r).slice(1)}`}async function $1(n){const e=await N1(n),t=zn().gapi;return de(t,n,"internal-error"),e.open({where:document.body,url:U1(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:F1,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=$n(n,"network-request-failed"),a=zn().setTimeout(()=>{i(o)},D1.get());function l(){zn().clearTimeout(a),s(r)}r.ping(l).then(l,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z1={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},j1=500,H1=600,q1="_blank",W1="http://localhost";class ny{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function K1(n,e,t,r=j1,s=H1){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},z1),{width:r.toString(),height:s.toString(),top:i,left:o}),c=At().toLowerCase();t&&(a=t0(c)?q1:t),e0(c)&&(e=e||W1,l.scrollbars="yes");const h=Object.entries(l).reduce((f,[m,y])=>`${f}${m}=${y},`,"");if(pR(c)&&a!=="_self")return G1(e||"",a),new ny(null);const d=window.open(e||"",a,h);de(d,n,"popup-blocked");try{d.focus()}catch{}return new ny(d)}function G1(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1="__/auth/handler",Q1="emulator/auth/handler",Y1=encodeURIComponent("fac");async function ry(n,e,t,r,s,i){de(n.config.authDomain,n,"auth-domain-config-required"),de(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:si,eventId:s};if(e instanceof u0){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",BC(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,d]of Object.entries({}))o[h]=d}if(e instanceof $a){const h=e.getScopes().filter(d=>d!=="");h.length>0&&(o.scopes=h.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const h of Object.keys(a))a[h]===void 0&&delete a[h];const l=await n._getAppCheckToken(),c=l?`#${Y1}=${encodeURIComponent(l)}`:"";return`${X1(n)}?${Ba(a).slice(1)}${c}`}function X1({config:n}){return n.emulator?Lf(n,Q1):`https://${n.authDomain}/${J1}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vh="webStorageSupport";class Z1{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=g0,this._completeRedirectFn=b1,this._overrideRedirectResult=v1}async _openPopup(e,t,r,s){var i;cr((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await ry(e,t,r,_d(),s);return K1(e,o,$f())}async _openRedirect(e,t,r,s){await this._originValidation(e);const i=await ry(e,t,r,_d(),s);return n1(i),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:i}=this.eventManagers[t];return s?Promise.resolve(s):(cr(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await $1(e),r=new I1(e);return t.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(vh,{type:vh},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[vh];o!==void 0&&t(!!o),An(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=P1(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return o0()||Ff()||du()}}const eP=Z1;var sy="@firebase/auth",iy="1.7.4";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nP(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rP(n){Ws(new ss("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:a0(n)},c=new TR(r,s,i,l);return PR(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Ws(new ss("auth-internal",e=>{const t=io(e.getProvider("auth").getImmediate());return(r=>new tP(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Un(sy,iy,nP(n)),Un(sy,iy,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sP=5*60,iP=Fv("authIdTokenMaxAge")||sP;let oy=null;const oP=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>iP)return;const s=t==null?void 0:t.token;oy!==s&&(oy=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function yc(n=Mf()){const e=uu(n,"auth");if(e.isInitialized())return e.getImmediate();const t=RR(n,{popupRedirectResolver:eP,persistence:[h1,ZR,g0]}),r=Fv("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=oP(i.toString());KR(t,o,()=>o(t.currentUser)),WR(t,a=>o(a))}}const s=Dv("auth");return s&&xR(t,`http://${s}`),t}function aP(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}wR({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const i=$n("internal-error");i.customData=s,t(i)},r.type="text/javascript",r.charset="UTF-8",aP().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rP("Browser");/*!
  * vue-router v4.3.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const _i=typeof document<"u";function lP(n){return n.__esModule||n[Symbol.toStringTag]==="Module"}const Oe=Object.assign;function Th(n,e){const t={};for(const r in e){const s=e[r];t[r]=Cn(s)?s.map(n):n(s)}return t}const Xo=()=>{},Cn=Array.isArray,b0=/#/g,cP=/&/g,uP=/\//g,hP=/=/g,dP=/\?/g,S0=/\+/g,fP=/%5B/g,pP=/%5D/g,I0=/%5E/g,mP=/%60/g,A0=/%7B/g,gP=/%7C/g,C0=/%7D/g,yP=/%20/g;function jf(n){return encodeURI(""+n).replace(gP,"|").replace(fP,"[").replace(pP,"]")}function _P(n){return jf(n).replace(A0,"{").replace(C0,"}").replace(I0,"^")}function Td(n){return jf(n).replace(S0,"%2B").replace(yP,"+").replace(b0,"%23").replace(cP,"%26").replace(mP,"`").replace(A0,"{").replace(C0,"}").replace(I0,"^")}function EP(n){return Td(n).replace(hP,"%3D")}function vP(n){return jf(n).replace(b0,"%23").replace(dP,"%3F")}function TP(n){return n==null?"":vP(n).replace(uP,"%2F")}function _a(n){try{return decodeURIComponent(""+n)}catch{}return""+n}const wP=/\/$/,bP=n=>n.replace(wP,"");function wh(n,e,t="/"){let r,s={},i="",o="";const a=e.indexOf("#");let l=e.indexOf("?");return a<l&&a>=0&&(l=-1),l>-1&&(r=e.slice(0,l),i=e.slice(l+1,a>-1?a:e.length),s=n(i)),a>-1&&(r=r||e.slice(0,a),o=e.slice(a,e.length)),r=CP(r??e,t),{fullPath:r+(i&&"?")+i+o,path:r,query:s,hash:_a(o)}}function SP(n,e){const t=e.query?n(e.query):"";return e.path+(t&&"?")+t+(e.hash||"")}function ay(n,e){return!e||!n.toLowerCase().startsWith(e.toLowerCase())?n:n.slice(e.length)||"/"}function IP(n,e,t){const r=e.matched.length-1,s=t.matched.length-1;return r>-1&&r===s&&ji(e.matched[r],t.matched[s])&&k0(e.params,t.params)&&n(e.query)===n(t.query)&&e.hash===t.hash}function ji(n,e){return(n.aliasOf||n)===(e.aliasOf||e)}function k0(n,e){if(Object.keys(n).length!==Object.keys(e).length)return!1;for(const t in n)if(!AP(n[t],e[t]))return!1;return!0}function AP(n,e){return Cn(n)?ly(n,e):Cn(e)?ly(e,n):n===e}function ly(n,e){return Cn(e)?n.length===e.length&&n.every((t,r)=>t===e[r]):n.length===1&&n[0]===e}function CP(n,e){if(n.startsWith("/"))return n;if(!n)return e;const t=e.split("/"),r=n.split("/"),s=r[r.length-1];(s===".."||s===".")&&r.push("");let i=t.length-1,o,a;for(o=0;o<r.length;o++)if(a=r[o],a!==".")if(a==="..")i>1&&i--;else break;return t.slice(0,i).join("/")+"/"+r.slice(o).join("/")}var Ea;(function(n){n.pop="pop",n.push="push"})(Ea||(Ea={}));var Zo;(function(n){n.back="back",n.forward="forward",n.unknown=""})(Zo||(Zo={}));function kP(n){if(!n)if(_i){const e=document.querySelector("base");n=e&&e.getAttribute("href")||"/",n=n.replace(/^\w+:\/\/[^\/]+/,"")}else n="/";return n[0]!=="/"&&n[0]!=="#"&&(n="/"+n),bP(n)}const RP=/^[^#]+#/;function PP(n,e){return n.replace(RP,"#")+e}function xP(n,e){const t=document.documentElement.getBoundingClientRect(),r=n.getBoundingClientRect();return{behavior:e.behavior,left:r.left-t.left-(e.left||0),top:r.top-t.top-(e.top||0)}}const gu=()=>({left:window.scrollX,top:window.scrollY});function OP(n){let e;if("el"in n){const t=n.el,r=typeof t=="string"&&t.startsWith("#"),s=typeof t=="string"?r?document.getElementById(t.slice(1)):document.querySelector(t):t;if(!s)return;e=xP(s,n)}else e=n;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function cy(n,e){return(history.state?history.state.position-e:-1)+n}const wd=new Map;function MP(n,e){wd.set(n,e)}function NP(n){const e=wd.get(n);return wd.delete(n),e}let DP=()=>location.protocol+"//"+location.host;function R0(n,e){const{pathname:t,search:r,hash:s}=e,i=n.indexOf("#");if(i>-1){let a=s.includes(n.slice(i))?n.slice(i).length:1,l=s.slice(a);return l[0]!=="/"&&(l="/"+l),ay(l,"")}return ay(t,n)+r+s}function LP(n,e,t,r){let s=[],i=[],o=null;const a=({state:f})=>{const m=R0(n,location),y=t.value,T=e.value;let w=0;if(f){if(t.value=m,e.value=f,o&&o===y){o=null;return}w=T?f.position-T.position:0}else r(m);s.forEach(P=>{P(t.value,y,{delta:w,type:Ea.pop,direction:w?w>0?Zo.forward:Zo.back:Zo.unknown})})};function l(){o=t.value}function c(f){s.push(f);const m=()=>{const y=s.indexOf(f);y>-1&&s.splice(y,1)};return i.push(m),m}function h(){const{history:f}=window;f.state&&f.replaceState(Oe({},f.state,{scroll:gu()}),"")}function d(){for(const f of i)f();i=[],window.removeEventListener("popstate",a),window.removeEventListener("beforeunload",h)}return window.addEventListener("popstate",a),window.addEventListener("beforeunload",h,{passive:!0}),{pauseListeners:l,listen:c,destroy:d}}function uy(n,e,t,r=!1,s=!1){return{back:n,current:e,forward:t,replaced:r,position:window.history.length,scroll:s?gu():null}}function VP(n){const{history:e,location:t}=window,r={value:R0(n,t)},s={value:e.state};s.value||i(r.value,{back:null,current:r.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function i(l,c,h){const d=n.indexOf("#"),f=d>-1?(t.host&&document.querySelector("base")?n:n.slice(d))+l:DP()+n+l;try{e[h?"replaceState":"pushState"](c,"",f),s.value=c}catch(m){console.error(m),t[h?"replace":"assign"](f)}}function o(l,c){const h=Oe({},e.state,uy(s.value.back,l,s.value.forward,!0),c,{position:s.value.position});i(l,h,!0),r.value=l}function a(l,c){const h=Oe({},s.value,e.state,{forward:l,scroll:gu()});i(h.current,h,!0);const d=Oe({},uy(r.value,l,null),{position:h.position+1},c);i(l,d,!1),r.value=l}return{location:r,state:s,push:a,replace:o}}function FP(n){n=kP(n);const e=VP(n),t=LP(n,e.state,e.location,e.replace);function r(i,o=!0){o||t.pauseListeners(),history.go(i)}const s=Oe({location:"",base:n,go:r,createHref:PP.bind(null,n)},e,t);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>e.state.value}),s}function BP(n){return typeof n=="string"||n&&typeof n=="object"}function P0(n){return typeof n=="string"||typeof n=="symbol"}const br={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},x0=Symbol("");var hy;(function(n){n[n.aborted=4]="aborted",n[n.cancelled=8]="cancelled",n[n.duplicated=16]="duplicated"})(hy||(hy={}));function Hi(n,e){return Oe(new Error,{type:n,[x0]:!0},e)}function Zn(n,e){return n instanceof Error&&x0 in n&&(e==null||!!(n.type&e))}const dy="[^/]+?",UP={sensitive:!1,strict:!1,start:!0,end:!0},$P=/[.+*?^${}()[\]/\\]/g;function zP(n,e){const t=Oe({},UP,e),r=[];let s=t.start?"^":"";const i=[];for(const c of n){const h=c.length?[]:[90];t.strict&&!c.length&&(s+="/");for(let d=0;d<c.length;d++){const f=c[d];let m=40+(t.sensitive?.25:0);if(f.type===0)d||(s+="/"),s+=f.value.replace($P,"\\$&"),m+=40;else if(f.type===1){const{value:y,repeatable:T,optional:w,regexp:P}=f;i.push({name:y,repeatable:T,optional:w});const O=P||dy;if(O!==dy){m+=10;try{new RegExp(`(${O})`)}catch($){throw new Error(`Invalid custom RegExp for param "${y}" (${O}): `+$.message)}}let D=T?`((?:${O})(?:/(?:${O}))*)`:`(${O})`;d||(D=w&&c.length<2?`(?:/${D})`:"/"+D),w&&(D+="?"),s+=D,m+=20,w&&(m+=-8),T&&(m+=-20),O===".*"&&(m+=-50)}h.push(m)}r.push(h)}if(t.strict&&t.end){const c=r.length-1;r[c][r[c].length-1]+=.7000000000000001}t.strict||(s+="/?"),t.end?s+="$":t.strict&&(s+="(?:/|$)");const o=new RegExp(s,t.sensitive?"":"i");function a(c){const h=c.match(o),d={};if(!h)return null;for(let f=1;f<h.length;f++){const m=h[f]||"",y=i[f-1];d[y.name]=m&&y.repeatable?m.split("/"):m}return d}function l(c){let h="",d=!1;for(const f of n){(!d||!h.endsWith("/"))&&(h+="/"),d=!1;for(const m of f)if(m.type===0)h+=m.value;else if(m.type===1){const{value:y,repeatable:T,optional:w}=m,P=y in c?c[y]:"";if(Cn(P)&&!T)throw new Error(`Provided param "${y}" is an array but it is not repeatable (* or + modifiers)`);const O=Cn(P)?P.join("/"):P;if(!O)if(w)f.length<2&&(h.endsWith("/")?h=h.slice(0,-1):d=!0);else throw new Error(`Missing required param "${y}"`);h+=O}}return h||"/"}return{re:o,score:r,keys:i,parse:a,stringify:l}}function jP(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=e[t]-n[t];if(r)return r;t++}return n.length<e.length?n.length===1&&n[0]===80?-1:1:n.length>e.length?e.length===1&&e[0]===80?1:-1:0}function HP(n,e){let t=0;const r=n.score,s=e.score;for(;t<r.length&&t<s.length;){const i=jP(r[t],s[t]);if(i)return i;t++}if(Math.abs(s.length-r.length)===1){if(fy(r))return 1;if(fy(s))return-1}return s.length-r.length}function fy(n){const e=n[n.length-1];return n.length>0&&e[e.length-1]<0}const qP={type:0,value:""},WP=/[a-zA-Z0-9_]/;function KP(n){if(!n)return[[]];if(n==="/")return[[qP]];if(!n.startsWith("/"))throw new Error(`Invalid path "${n}"`);function e(m){throw new Error(`ERR (${t})/"${c}": ${m}`)}let t=0,r=t;const s=[];let i;function o(){i&&s.push(i),i=[]}let a=0,l,c="",h="";function d(){c&&(t===0?i.push({type:0,value:c}):t===1||t===2||t===3?(i.length>1&&(l==="*"||l==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:h,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):e("Invalid state to consume buffer"),c="")}function f(){c+=l}for(;a<n.length;){if(l=n[a++],l==="\\"&&t!==2){r=t,t=4;continue}switch(t){case 0:l==="/"?(c&&d(),o()):l===":"?(d(),t=1):f();break;case 4:f(),t=r;break;case 1:l==="("?t=2:WP.test(l)?f():(d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--);break;case 2:l===")"?h[h.length-1]=="\\"?h=h.slice(0,-1)+l:t=3:h+=l;break;case 3:d(),t=0,l!=="*"&&l!=="?"&&l!=="+"&&a--,h="";break;default:e("Unknown state");break}}return t===2&&e(`Unfinished custom RegExp for param "${c}"`),d(),o(),s}function GP(n,e,t){const r=zP(KP(n.path),t),s=Oe(r,{record:n,parent:e,children:[],alias:[]});return e&&!s.record.aliasOf==!e.record.aliasOf&&e.children.push(s),s}function JP(n,e){const t=[],r=new Map;e=gy({strict:!1,end:!0,sensitive:!1},e);function s(h){return r.get(h)}function i(h,d,f){const m=!f,y=QP(h);y.aliasOf=f&&f.record;const T=gy(e,h),w=[y];if("alias"in h){const D=typeof h.alias=="string"?[h.alias]:h.alias;for(const $ of D)w.push(Oe({},y,{components:f?f.record.components:y.components,path:$,aliasOf:f?f.record:y}))}let P,O;for(const D of w){const{path:$}=D;if(d&&$[0]!=="/"){const q=d.record.path,F=q[q.length-1]==="/"?"":"/";D.path=d.record.path+($&&F+$)}if(P=GP(D,d,T),f?f.alias.push(P):(O=O||P,O!==P&&O.alias.push(P),m&&h.name&&!my(P)&&o(h.name)),y.children){const q=y.children;for(let F=0;F<q.length;F++)i(q[F],P,f&&f.children[F])}f=f||P,(P.record.components&&Object.keys(P.record.components).length||P.record.name||P.record.redirect)&&l(P)}return O?()=>{o(O)}:Xo}function o(h){if(P0(h)){const d=r.get(h);d&&(r.delete(h),t.splice(t.indexOf(d),1),d.children.forEach(o),d.alias.forEach(o))}else{const d=t.indexOf(h);d>-1&&(t.splice(d,1),h.record.name&&r.delete(h.record.name),h.children.forEach(o),h.alias.forEach(o))}}function a(){return t}function l(h){let d=0;for(;d<t.length&&HP(h,t[d])>=0&&(h.record.path!==t[d].record.path||!O0(h,t[d]));)d++;t.splice(d,0,h),h.record.name&&!my(h)&&r.set(h.record.name,h)}function c(h,d){let f,m={},y,T;if("name"in h&&h.name){if(f=r.get(h.name),!f)throw Hi(1,{location:h});T=f.record.name,m=Oe(py(d.params,f.keys.filter(O=>!O.optional).concat(f.parent?f.parent.keys.filter(O=>O.optional):[]).map(O=>O.name)),h.params&&py(h.params,f.keys.map(O=>O.name))),y=f.stringify(m)}else if(h.path!=null)y=h.path,f=t.find(O=>O.re.test(y)),f&&(m=f.parse(y),T=f.record.name);else{if(f=d.name?r.get(d.name):t.find(O=>O.re.test(d.path)),!f)throw Hi(1,{location:h,currentLocation:d});T=f.record.name,m=Oe({},d.params,h.params),y=f.stringify(m)}const w=[];let P=f;for(;P;)w.unshift(P.record),P=P.parent;return{name:T,path:y,params:m,matched:w,meta:XP(w)}}return n.forEach(h=>i(h)),{addRoute:i,resolve:c,removeRoute:o,getRoutes:a,getRecordMatcher:s}}function py(n,e){const t={};for(const r of e)r in n&&(t[r]=n[r]);return t}function QP(n){return{path:n.path,redirect:n.redirect,name:n.name,meta:n.meta||{},aliasOf:void 0,beforeEnter:n.beforeEnter,props:YP(n),children:n.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in n?n.components||null:n.component&&{default:n.component}}}function YP(n){const e={},t=n.props||!1;if("component"in n)e.default=t;else for(const r in n.components)e[r]=typeof t=="object"?t[r]:t;return e}function my(n){for(;n;){if(n.record.aliasOf)return!0;n=n.parent}return!1}function XP(n){return n.reduce((e,t)=>Oe(e,t.meta),{})}function gy(n,e){const t={};for(const r in n)t[r]=r in e?e[r]:n[r];return t}function O0(n,e){return e.children.some(t=>t===n||O0(n,t))}function ZP(n){const e={};if(n===""||n==="?")return e;const r=(n[0]==="?"?n.slice(1):n).split("&");for(let s=0;s<r.length;++s){const i=r[s].replace(S0," "),o=i.indexOf("="),a=_a(o<0?i:i.slice(0,o)),l=o<0?null:_a(i.slice(o+1));if(a in e){let c=e[a];Cn(c)||(c=e[a]=[c]),c.push(l)}else e[a]=l}return e}function yy(n){let e="";for(let t in n){const r=n[t];if(t=EP(t),r==null){r!==void 0&&(e+=(e.length?"&":"")+t);continue}(Cn(r)?r.map(i=>i&&Td(i)):[r&&Td(r)]).forEach(i=>{i!==void 0&&(e+=(e.length?"&":"")+t,i!=null&&(e+="="+i))})}return e}function ex(n){const e={};for(const t in n){const r=n[t];r!==void 0&&(e[t]=Cn(r)?r.map(s=>s==null?null:""+s):r==null?r:""+r)}return e}const tx=Symbol(""),_y=Symbol(""),yu=Symbol(""),Hf=Symbol(""),bd=Symbol("");function Ro(){let n=[];function e(r){return n.push(r),()=>{const s=n.indexOf(r);s>-1&&n.splice(s,1)}}function t(){n=[]}return{add:e,list:()=>n.slice(),reset:t}}function Pr(n,e,t,r,s,i=o=>o()){const o=r&&(r.enterCallbacks[s]=r.enterCallbacks[s]||[]);return()=>new Promise((a,l)=>{const c=f=>{f===!1?l(Hi(4,{from:t,to:e})):f instanceof Error?l(f):BP(f)?l(Hi(2,{from:e,to:f})):(o&&r.enterCallbacks[s]===o&&typeof f=="function"&&o.push(f),a())},h=i(()=>n.call(r&&r.instances[s],e,t,c));let d=Promise.resolve(h);n.length<3&&(d=d.then(c)),d.catch(f=>l(f))})}function bh(n,e,t,r,s=i=>i()){const i=[];for(const o of n)for(const a in o.components){let l=o.components[a];if(!(e!=="beforeRouteEnter"&&!o.instances[a]))if(nx(l)){const h=(l.__vccOpts||l)[e];h&&i.push(Pr(h,t,r,o,a,s))}else{let c=l();i.push(()=>c.then(h=>{if(!h)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${o.path}"`));const d=lP(h)?h.default:h;o.components[a]=d;const m=(d.__vccOpts||d)[e];return m&&Pr(m,t,r,o,a,s)()}))}}return i}function nx(n){return typeof n=="object"||"displayName"in n||"props"in n||"__vccOpts"in n}function Ey(n){const e=mn(yu),t=mn(Hf),r=hn(()=>e.resolve(Ri(n.to))),s=hn(()=>{const{matched:l}=r.value,{length:c}=l,h=l[c-1],d=t.matched;if(!h||!d.length)return-1;const f=d.findIndex(ji.bind(null,h));if(f>-1)return f;const m=vy(l[c-2]);return c>1&&vy(h)===m&&d[d.length-1].path!==m?d.findIndex(ji.bind(null,l[c-2])):f}),i=hn(()=>s.value>-1&&ox(t.params,r.value.params)),o=hn(()=>s.value>-1&&s.value===t.matched.length-1&&k0(t.params,r.value.params));function a(l={}){return ix(l)?e[Ri(n.replace)?"replace":"push"](Ri(n.to)).catch(Xo):Promise.resolve()}return{route:r,href:hn(()=>r.value.href),isActive:i,isExactActive:o,navigate:a}}const rx=av({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Ey,setup(n,{slots:e}){const t=Da(Ey(n)),{options:r}=mn(yu),s=hn(()=>({[Ty(n.activeClass,r.linkActiveClass,"router-link-active")]:t.isActive,[Ty(n.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:t.isExactActive}));return()=>{const i=e.default&&e.default(t);return n.custom?i:Rf("a",{"aria-current":t.isExactActive?n.ariaCurrentValue:null,href:t.href,onClick:t.navigate,class:s.value},i)}}}),sx=rx;function ix(n){if(!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)&&!n.defaultPrevented&&!(n.button!==void 0&&n.button!==0)){if(n.currentTarget&&n.currentTarget.getAttribute){const e=n.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return n.preventDefault&&n.preventDefault(),!0}}function ox(n,e){for(const t in e){const r=e[t],s=n[t];if(typeof r=="string"){if(r!==s)return!1}else if(!Cn(s)||s.length!==r.length||r.some((i,o)=>i!==s[o]))return!1}return!0}function vy(n){return n?n.aliasOf?n.aliasOf.path:n.path:""}const Ty=(n,e,t)=>n??e??t,ax=av({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(n,{attrs:e,slots:t}){const r=mn(bd),s=hn(()=>n.route||r.value),i=mn(_y,0),o=hn(()=>{let c=Ri(i);const{matched:h}=s.value;let d;for(;(d=h[c])&&!d.components;)c++;return c}),a=hn(()=>s.value.matched[o.value]);Ll(_y,hn(()=>o.value+1)),Ll(tx,a),Ll(bd,s);const l=La();return qo(()=>[l.value,a.value,n.name],([c,h,d],[f,m,y])=>{h&&(h.instances[d]=c,m&&m!==h&&c&&c===f&&(h.leaveGuards.size||(h.leaveGuards=m.leaveGuards),h.updateGuards.size||(h.updateGuards=m.updateGuards))),c&&h&&(!m||!ji(h,m)||!f)&&(h.enterCallbacks[d]||[]).forEach(T=>T(c))},{flush:"post"}),()=>{const c=s.value,h=n.name,d=a.value,f=d&&d.components[h];if(!f)return wy(t.default,{Component:f,route:c});const m=d.props[h],y=m?m===!0?c.params:typeof m=="function"?m(c):m:null,w=Rf(f,Oe({},y,e,{onVnodeUnmounted:P=>{P.component.isUnmounted&&(d.instances[h]=null)},ref:l}));return wy(t.default,{Component:w,route:c})||w}}});function wy(n,e){if(!n)return null;const t=n(e);return t.length===1?t[0]:t}const lx=ax;function cx(n){const e=JP(n.routes,n),t=n.parseQuery||ZP,r=n.stringifyQuery||yy,s=n.history,i=Ro(),o=Ro(),a=Ro(),l=tI(br);let c=br;_i&&n.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const h=Th.bind(null,V=>""+V),d=Th.bind(null,TP),f=Th.bind(null,_a);function m(V,ee){let Y,re;return P0(V)?(Y=e.getRecordMatcher(V),re=ee):re=V,e.addRoute(re,Y)}function y(V){const ee=e.getRecordMatcher(V);ee&&e.removeRoute(ee)}function T(){return e.getRoutes().map(V=>V.record)}function w(V){return!!e.getRecordMatcher(V)}function P(V,ee){if(ee=Oe({},ee||l.value),typeof V=="string"){const C=wh(t,V,ee.path),M=e.resolve({path:C.path},ee),B=s.createHref(C.fullPath);return Oe(C,M,{params:f(M.params),hash:_a(C.hash),redirectedFrom:void 0,href:B})}let Y;if(V.path!=null)Y=Oe({},V,{path:wh(t,V.path,ee.path).path});else{const C=Oe({},V.params);for(const M in C)C[M]==null&&delete C[M];Y=Oe({},V,{params:d(C)}),ee.params=d(ee.params)}const re=e.resolve(Y,ee),Ie=V.hash||"";re.params=h(f(re.params));const Le=SP(r,Oe({},V,{hash:_P(Ie),path:re.path})),b=s.createHref(Le);return Oe({fullPath:Le,hash:Ie,query:r===yy?ex(V.query):V.query||{}},re,{redirectedFrom:void 0,href:b})}function O(V){return typeof V=="string"?wh(t,V,l.value.path):Oe({},V)}function D(V,ee){if(c!==V)return Hi(8,{from:ee,to:V})}function $(V){return A(V)}function q(V){return $(Oe(O(V),{replace:!0}))}function F(V){const ee=V.matched[V.matched.length-1];if(ee&&ee.redirect){const{redirect:Y}=ee;let re=typeof Y=="function"?Y(V):Y;return typeof re=="string"&&(re=re.includes("?")||re.includes("#")?re=O(re):{path:re},re.params={}),Oe({query:V.query,hash:V.hash,params:re.path!=null?{}:V.params},re)}}function A(V,ee){const Y=c=P(V),re=l.value,Ie=V.state,Le=V.force,b=V.replace===!0,C=F(Y);if(C)return A(Oe(O(C),{state:typeof C=="object"?Oe({},Ie,C.state):Ie,force:Le,replace:b}),ee||Y);const M=Y;M.redirectedFrom=ee;let B;return!Le&&IP(r,re,Y)&&(B=Hi(16,{to:M,from:re}),on(re,re,!0,!1)),(B?Promise.resolve(B):I(M,re)).catch(L=>Zn(L)?Zn(L,2)?L:En(L):Te(L,M,re)).then(L=>{if(L){if(Zn(L,2))return A(Oe({replace:b},O(L.to),{state:typeof L.to=="object"?Oe({},Ie,L.to.state):Ie,force:Le}),ee||M)}else L=k(M,re,!0,b,Ie);return R(M,re,L),L})}function _(V,ee){const Y=D(V,ee);return Y?Promise.reject(Y):Promise.resolve()}function v(V){const ee=pr.values().next().value;return ee&&typeof ee.runWithContext=="function"?ee.runWithContext(V):V()}function I(V,ee){let Y;const[re,Ie,Le]=ux(V,ee);Y=bh(re.reverse(),"beforeRouteLeave",V,ee);for(const C of re)C.leaveGuards.forEach(M=>{Y.push(Pr(M,V,ee))});const b=_.bind(null,V,ee);return Y.push(b),dt(Y).then(()=>{Y=[];for(const C of i.list())Y.push(Pr(C,V,ee));return Y.push(b),dt(Y)}).then(()=>{Y=bh(Ie,"beforeRouteUpdate",V,ee);for(const C of Ie)C.updateGuards.forEach(M=>{Y.push(Pr(M,V,ee))});return Y.push(b),dt(Y)}).then(()=>{Y=[];for(const C of Le)if(C.beforeEnter)if(Cn(C.beforeEnter))for(const M of C.beforeEnter)Y.push(Pr(M,V,ee));else Y.push(Pr(C.beforeEnter,V,ee));return Y.push(b),dt(Y)}).then(()=>(V.matched.forEach(C=>C.enterCallbacks={}),Y=bh(Le,"beforeRouteEnter",V,ee,v),Y.push(b),dt(Y))).then(()=>{Y=[];for(const C of o.list())Y.push(Pr(C,V,ee));return Y.push(b),dt(Y)}).catch(C=>Zn(C,8)?C:Promise.reject(C))}function R(V,ee,Y){a.list().forEach(re=>v(()=>re(V,ee,Y)))}function k(V,ee,Y,re,Ie){const Le=D(V,ee);if(Le)return Le;const b=ee===br,C=_i?history.state:{};Y&&(re||b?s.replace(V.fullPath,Oe({scroll:b&&C&&C.scroll},Ie)):s.push(V.fullPath,Ie)),l.value=V,on(V,ee,Y,b),En()}let S;function De(){S||(S=s.listen((V,ee,Y)=>{if(!Pn.listening)return;const re=P(V),Ie=F(re);if(Ie){A(Oe(Ie,{replace:!0}),re).catch(Xo);return}c=re;const Le=l.value;_i&&MP(cy(Le.fullPath,Y.delta),gu()),I(re,Le).catch(b=>Zn(b,12)?b:Zn(b,2)?(A(b.to,re).then(C=>{Zn(C,20)&&!Y.delta&&Y.type===Ea.pop&&s.go(-1,!1)}).catch(Xo),Promise.reject()):(Y.delta&&s.go(-Y.delta,!1),Te(b,re,Le))).then(b=>{b=b||k(re,Le,!1),b&&(Y.delta&&!Zn(b,8)?s.go(-Y.delta,!1):Y.type===Ea.pop&&Zn(b,20)&&s.go(-1,!1)),R(re,Le,b)}).catch(Xo)}))}let Ze=Ro(),ve=Ro(),Se;function Te(V,ee,Y){En(V);const re=ve.list();return re.length?re.forEach(Ie=>Ie(V,ee,Y)):console.error(V),Promise.reject(V)}function Xt(){return Se&&l.value!==br?Promise.resolve():new Promise((V,ee)=>{Ze.add([V,ee])})}function En(V){return Se||(Se=!V,De(),Ze.list().forEach(([ee,Y])=>V?Y(V):ee()),Ze.reset()),V}function on(V,ee,Y,re){const{scrollBehavior:Ie}=n;if(!_i||!Ie)return Promise.resolve();const Le=!Y&&NP(cy(V.fullPath,0))||(re||!Y)&&history.state&&history.state.scroll||null;return Xc().then(()=>Ie(V,ee,Le)).then(b=>b&&OP(b)).catch(b=>Te(b,V,ee))}const He=V=>s.go(V);let qe;const pr=new Set,Pn={currentRoute:l,listening:!0,addRoute:m,removeRoute:y,hasRoute:w,getRoutes:T,resolve:P,options:n,push:$,replace:q,go:He,back:()=>He(-1),forward:()=>He(1),beforeEach:i.add,beforeResolve:o.add,afterEach:a.add,onError:ve.add,isReady:Xt,install(V){const ee=this;V.component("RouterLink",sx),V.component("RouterView",lx),V.config.globalProperties.$router=ee,Object.defineProperty(V.config.globalProperties,"$route",{enumerable:!0,get:()=>Ri(l)}),_i&&!qe&&l.value===br&&(qe=!0,$(s.location).catch(Ie=>{}));const Y={};for(const Ie in br)Object.defineProperty(Y,Ie,{get:()=>l.value[Ie],enumerable:!0});V.provide(yu,ee),V.provide(Hf,zE(Y)),V.provide(bd,l);const re=V.unmount;pr.add(V),V.unmount=function(){pr.delete(V),pr.size<1&&(c=br,S&&S(),S=null,l.value=br,qe=!1,Se=!1),re()}}};function dt(V){return V.reduce((ee,Y)=>ee.then(()=>v(Y)),Promise.resolve())}return Pn}function ux(n,e){const t=[],r=[],s=[],i=Math.max(e.matched.length,n.matched.length);for(let o=0;o<i;o++){const a=e.matched[o];a&&(n.matched.find(c=>ji(c,a))?r.push(a):t.push(a));const l=n.matched[o];l&&(e.matched.find(c=>ji(c,l))||s.push(l))}return[t,r,s]}function hx(){return mn(yu)}function r4(){return mn(Hf)}var dx="firebase",fx="10.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Un(dx,fx,"app");var by=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vs,M0;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,_){function v(){}v.prototype=_.prototype,A.D=_.prototype,A.prototype=new v,A.prototype.constructor=A,A.C=function(I,R,k){for(var S=Array(arguments.length-2),De=2;De<arguments.length;De++)S[De-2]=arguments[De];return _.prototype[R].apply(I,S)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,_,v){v||(v=0);var I=Array(16);if(typeof _=="string")for(var R=0;16>R;++R)I[R]=_.charCodeAt(v++)|_.charCodeAt(v++)<<8|_.charCodeAt(v++)<<16|_.charCodeAt(v++)<<24;else for(R=0;16>R;++R)I[R]=_[v++]|_[v++]<<8|_[v++]<<16|_[v++]<<24;_=A.g[0],v=A.g[1],R=A.g[2];var k=A.g[3],S=_+(k^v&(R^k))+I[0]+3614090360&4294967295;_=v+(S<<7&4294967295|S>>>25),S=k+(R^_&(v^R))+I[1]+3905402710&4294967295,k=_+(S<<12&4294967295|S>>>20),S=R+(v^k&(_^v))+I[2]+606105819&4294967295,R=k+(S<<17&4294967295|S>>>15),S=v+(_^R&(k^_))+I[3]+3250441966&4294967295,v=R+(S<<22&4294967295|S>>>10),S=_+(k^v&(R^k))+I[4]+4118548399&4294967295,_=v+(S<<7&4294967295|S>>>25),S=k+(R^_&(v^R))+I[5]+1200080426&4294967295,k=_+(S<<12&4294967295|S>>>20),S=R+(v^k&(_^v))+I[6]+2821735955&4294967295,R=k+(S<<17&4294967295|S>>>15),S=v+(_^R&(k^_))+I[7]+4249261313&4294967295,v=R+(S<<22&4294967295|S>>>10),S=_+(k^v&(R^k))+I[8]+1770035416&4294967295,_=v+(S<<7&4294967295|S>>>25),S=k+(R^_&(v^R))+I[9]+2336552879&4294967295,k=_+(S<<12&4294967295|S>>>20),S=R+(v^k&(_^v))+I[10]+4294925233&4294967295,R=k+(S<<17&4294967295|S>>>15),S=v+(_^R&(k^_))+I[11]+2304563134&4294967295,v=R+(S<<22&4294967295|S>>>10),S=_+(k^v&(R^k))+I[12]+1804603682&4294967295,_=v+(S<<7&4294967295|S>>>25),S=k+(R^_&(v^R))+I[13]+4254626195&4294967295,k=_+(S<<12&4294967295|S>>>20),S=R+(v^k&(_^v))+I[14]+2792965006&4294967295,R=k+(S<<17&4294967295|S>>>15),S=v+(_^R&(k^_))+I[15]+1236535329&4294967295,v=R+(S<<22&4294967295|S>>>10),S=_+(R^k&(v^R))+I[1]+4129170786&4294967295,_=v+(S<<5&4294967295|S>>>27),S=k+(v^R&(_^v))+I[6]+3225465664&4294967295,k=_+(S<<9&4294967295|S>>>23),S=R+(_^v&(k^_))+I[11]+643717713&4294967295,R=k+(S<<14&4294967295|S>>>18),S=v+(k^_&(R^k))+I[0]+3921069994&4294967295,v=R+(S<<20&4294967295|S>>>12),S=_+(R^k&(v^R))+I[5]+3593408605&4294967295,_=v+(S<<5&4294967295|S>>>27),S=k+(v^R&(_^v))+I[10]+38016083&4294967295,k=_+(S<<9&4294967295|S>>>23),S=R+(_^v&(k^_))+I[15]+3634488961&4294967295,R=k+(S<<14&4294967295|S>>>18),S=v+(k^_&(R^k))+I[4]+3889429448&4294967295,v=R+(S<<20&4294967295|S>>>12),S=_+(R^k&(v^R))+I[9]+568446438&4294967295,_=v+(S<<5&4294967295|S>>>27),S=k+(v^R&(_^v))+I[14]+3275163606&4294967295,k=_+(S<<9&4294967295|S>>>23),S=R+(_^v&(k^_))+I[3]+4107603335&4294967295,R=k+(S<<14&4294967295|S>>>18),S=v+(k^_&(R^k))+I[8]+1163531501&4294967295,v=R+(S<<20&4294967295|S>>>12),S=_+(R^k&(v^R))+I[13]+2850285829&4294967295,_=v+(S<<5&4294967295|S>>>27),S=k+(v^R&(_^v))+I[2]+4243563512&4294967295,k=_+(S<<9&4294967295|S>>>23),S=R+(_^v&(k^_))+I[7]+1735328473&4294967295,R=k+(S<<14&4294967295|S>>>18),S=v+(k^_&(R^k))+I[12]+2368359562&4294967295,v=R+(S<<20&4294967295|S>>>12),S=_+(v^R^k)+I[5]+4294588738&4294967295,_=v+(S<<4&4294967295|S>>>28),S=k+(_^v^R)+I[8]+2272392833&4294967295,k=_+(S<<11&4294967295|S>>>21),S=R+(k^_^v)+I[11]+1839030562&4294967295,R=k+(S<<16&4294967295|S>>>16),S=v+(R^k^_)+I[14]+4259657740&4294967295,v=R+(S<<23&4294967295|S>>>9),S=_+(v^R^k)+I[1]+2763975236&4294967295,_=v+(S<<4&4294967295|S>>>28),S=k+(_^v^R)+I[4]+1272893353&4294967295,k=_+(S<<11&4294967295|S>>>21),S=R+(k^_^v)+I[7]+4139469664&4294967295,R=k+(S<<16&4294967295|S>>>16),S=v+(R^k^_)+I[10]+3200236656&4294967295,v=R+(S<<23&4294967295|S>>>9),S=_+(v^R^k)+I[13]+681279174&4294967295,_=v+(S<<4&4294967295|S>>>28),S=k+(_^v^R)+I[0]+3936430074&4294967295,k=_+(S<<11&4294967295|S>>>21),S=R+(k^_^v)+I[3]+3572445317&4294967295,R=k+(S<<16&4294967295|S>>>16),S=v+(R^k^_)+I[6]+76029189&4294967295,v=R+(S<<23&4294967295|S>>>9),S=_+(v^R^k)+I[9]+3654602809&4294967295,_=v+(S<<4&4294967295|S>>>28),S=k+(_^v^R)+I[12]+3873151461&4294967295,k=_+(S<<11&4294967295|S>>>21),S=R+(k^_^v)+I[15]+530742520&4294967295,R=k+(S<<16&4294967295|S>>>16),S=v+(R^k^_)+I[2]+3299628645&4294967295,v=R+(S<<23&4294967295|S>>>9),S=_+(R^(v|~k))+I[0]+4096336452&4294967295,_=v+(S<<6&4294967295|S>>>26),S=k+(v^(_|~R))+I[7]+1126891415&4294967295,k=_+(S<<10&4294967295|S>>>22),S=R+(_^(k|~v))+I[14]+2878612391&4294967295,R=k+(S<<15&4294967295|S>>>17),S=v+(k^(R|~_))+I[5]+4237533241&4294967295,v=R+(S<<21&4294967295|S>>>11),S=_+(R^(v|~k))+I[12]+1700485571&4294967295,_=v+(S<<6&4294967295|S>>>26),S=k+(v^(_|~R))+I[3]+2399980690&4294967295,k=_+(S<<10&4294967295|S>>>22),S=R+(_^(k|~v))+I[10]+4293915773&4294967295,R=k+(S<<15&4294967295|S>>>17),S=v+(k^(R|~_))+I[1]+2240044497&4294967295,v=R+(S<<21&4294967295|S>>>11),S=_+(R^(v|~k))+I[8]+1873313359&4294967295,_=v+(S<<6&4294967295|S>>>26),S=k+(v^(_|~R))+I[15]+4264355552&4294967295,k=_+(S<<10&4294967295|S>>>22),S=R+(_^(k|~v))+I[6]+2734768916&4294967295,R=k+(S<<15&4294967295|S>>>17),S=v+(k^(R|~_))+I[13]+1309151649&4294967295,v=R+(S<<21&4294967295|S>>>11),S=_+(R^(v|~k))+I[4]+4149444226&4294967295,_=v+(S<<6&4294967295|S>>>26),S=k+(v^(_|~R))+I[11]+3174756917&4294967295,k=_+(S<<10&4294967295|S>>>22),S=R+(_^(k|~v))+I[2]+718787259&4294967295,R=k+(S<<15&4294967295|S>>>17),S=v+(k^(R|~_))+I[9]+3951481745&4294967295,A.g[0]=A.g[0]+_&4294967295,A.g[1]=A.g[1]+(R+(S<<21&4294967295|S>>>11))&4294967295,A.g[2]=A.g[2]+R&4294967295,A.g[3]=A.g[3]+k&4294967295}r.prototype.u=function(A,_){_===void 0&&(_=A.length);for(var v=_-this.blockSize,I=this.B,R=this.h,k=0;k<_;){if(R==0)for(;k<=v;)s(this,A,k),k+=this.blockSize;if(typeof A=="string"){for(;k<_;)if(I[R++]=A.charCodeAt(k++),R==this.blockSize){s(this,I),R=0;break}}else for(;k<_;)if(I[R++]=A[k++],R==this.blockSize){s(this,I),R=0;break}}this.h=R,this.o+=_},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var _=1;_<A.length-8;++_)A[_]=0;var v=8*this.o;for(_=A.length-8;_<A.length;++_)A[_]=v&255,v/=256;for(this.u(A),A=Array(16),_=v=0;4>_;++_)for(var I=0;32>I;I+=8)A[v++]=this.g[_]>>>I&255;return A};function i(A,_){var v=a;return Object.prototype.hasOwnProperty.call(v,A)?v[A]:v[A]=_(A)}function o(A,_){this.h=_;for(var v=[],I=!0,R=A.length-1;0<=R;R--){var k=A[R]|0;I&&k==_||(v[R]=k,I=!1)}this.g=v}var a={};function l(A){return-128<=A&&128>A?i(A,function(_){return new o([_|0],0>_?-1:0)}):new o([A|0],0>A?-1:0)}function c(A){if(isNaN(A)||!isFinite(A))return d;if(0>A)return w(c(-A));for(var _=[],v=1,I=0;A>=v;I++)_[I]=A/v|0,v*=4294967296;return new o(_,0)}function h(A,_){if(A.length==0)throw Error("number format error: empty string");if(_=_||10,2>_||36<_)throw Error("radix out of range: "+_);if(A.charAt(0)=="-")return w(h(A.substring(1),_));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=c(Math.pow(_,8)),I=d,R=0;R<A.length;R+=8){var k=Math.min(8,A.length-R),S=parseInt(A.substring(R,R+k),_);8>k?(k=c(Math.pow(_,k)),I=I.j(k).add(c(S))):(I=I.j(v),I=I.add(c(S)))}return I}var d=l(0),f=l(1),m=l(16777216);n=o.prototype,n.m=function(){if(T(this))return-w(this).m();for(var A=0,_=1,v=0;v<this.g.length;v++){var I=this.i(v);A+=(0<=I?I:4294967296+I)*_,_*=4294967296}return A},n.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(y(this))return"0";if(T(this))return"-"+w(this).toString(A);for(var _=c(Math.pow(A,6)),v=this,I="";;){var R=$(v,_).g;v=P(v,R.j(_));var k=((0<v.g.length?v.g[0]:v.h)>>>0).toString(A);if(v=R,y(v))return k+I;for(;6>k.length;)k="0"+k;I=k+I}},n.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function y(A){if(A.h!=0)return!1;for(var _=0;_<A.g.length;_++)if(A.g[_]!=0)return!1;return!0}function T(A){return A.h==-1}n.l=function(A){return A=P(this,A),T(A)?-1:y(A)?0:1};function w(A){for(var _=A.g.length,v=[],I=0;I<_;I++)v[I]=~A.g[I];return new o(v,~A.h).add(f)}n.abs=function(){return T(this)?w(this):this},n.add=function(A){for(var _=Math.max(this.g.length,A.g.length),v=[],I=0,R=0;R<=_;R++){var k=I+(this.i(R)&65535)+(A.i(R)&65535),S=(k>>>16)+(this.i(R)>>>16)+(A.i(R)>>>16);I=S>>>16,k&=65535,S&=65535,v[R]=S<<16|k}return new o(v,v[v.length-1]&-2147483648?-1:0)};function P(A,_){return A.add(w(_))}n.j=function(A){if(y(this)||y(A))return d;if(T(this))return T(A)?w(this).j(w(A)):w(w(this).j(A));if(T(A))return w(this.j(w(A)));if(0>this.l(m)&&0>A.l(m))return c(this.m()*A.m());for(var _=this.g.length+A.g.length,v=[],I=0;I<2*_;I++)v[I]=0;for(I=0;I<this.g.length;I++)for(var R=0;R<A.g.length;R++){var k=this.i(I)>>>16,S=this.i(I)&65535,De=A.i(R)>>>16,Ze=A.i(R)&65535;v[2*I+2*R]+=S*Ze,O(v,2*I+2*R),v[2*I+2*R+1]+=k*Ze,O(v,2*I+2*R+1),v[2*I+2*R+1]+=S*De,O(v,2*I+2*R+1),v[2*I+2*R+2]+=k*De,O(v,2*I+2*R+2)}for(I=0;I<_;I++)v[I]=v[2*I+1]<<16|v[2*I];for(I=_;I<2*_;I++)v[I]=0;return new o(v,0)};function O(A,_){for(;(A[_]&65535)!=A[_];)A[_+1]+=A[_]>>>16,A[_]&=65535,_++}function D(A,_){this.g=A,this.h=_}function $(A,_){if(y(_))throw Error("division by zero");if(y(A))return new D(d,d);if(T(A))return _=$(w(A),_),new D(w(_.g),w(_.h));if(T(_))return _=$(A,w(_)),new D(w(_.g),_.h);if(30<A.g.length){if(T(A)||T(_))throw Error("slowDivide_ only works with positive integers.");for(var v=f,I=_;0>=I.l(A);)v=q(v),I=q(I);var R=F(v,1),k=F(I,1);for(I=F(I,2),v=F(v,2);!y(I);){var S=k.add(I);0>=S.l(A)&&(R=R.add(v),k=S),I=F(I,1),v=F(v,1)}return _=P(A,R.j(_)),new D(R,_)}for(R=d;0<=A.l(_);){for(v=Math.max(1,Math.floor(A.m()/_.m())),I=Math.ceil(Math.log(v)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),k=c(v),S=k.j(_);T(S)||0<S.l(A);)v-=I,k=c(v),S=k.j(_);y(k)&&(k=f),R=R.add(k),A=P(A,S)}return new D(R,A)}n.A=function(A){return $(this,A).h},n.and=function(A){for(var _=Math.max(this.g.length,A.g.length),v=[],I=0;I<_;I++)v[I]=this.i(I)&A.i(I);return new o(v,this.h&A.h)},n.or=function(A){for(var _=Math.max(this.g.length,A.g.length),v=[],I=0;I<_;I++)v[I]=this.i(I)|A.i(I);return new o(v,this.h|A.h)},n.xor=function(A){for(var _=Math.max(this.g.length,A.g.length),v=[],I=0;I<_;I++)v[I]=this.i(I)^A.i(I);return new o(v,this.h^A.h)};function q(A){for(var _=A.g.length+1,v=[],I=0;I<_;I++)v[I]=A.i(I)<<1|A.i(I-1)>>>31;return new o(v,A.h)}function F(A,_){var v=_>>5;_%=32;for(var I=A.g.length-v,R=[],k=0;k<I;k++)R[k]=0<_?A.i(k+v)>>>_|A.i(k+v+1)<<32-_:A.i(k+v);return new o(R,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,M0=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=h,Vs=o}).apply(typeof by<"u"?by:typeof self<"u"?self:typeof window<"u"?window:{});var bl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var N0,D0,Lo,L0,Hl,Sd,V0,F0,B0;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,p,g){return u==Array.prototype||u==Object.prototype||(u[p]=g.value),u};function t(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof bl=="object"&&bl];for(var p=0;p<u.length;++p){var g=u[p];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=t(this);function s(u,p){if(p)e:{var g=r;u=u.split(".");for(var E=0;E<u.length-1;E++){var x=u[E];if(!(x in g))break e;g=g[x]}u=u[u.length-1],E=g[u],p=p(E),p!=E&&p!=null&&e(g,u,{configurable:!0,writable:!0,value:p})}}function i(u,p){u instanceof String&&(u+="");var g=0,E=!1,x={next:function(){if(!E&&g<u.length){var N=g++;return{value:p(N,u[N]),done:!1}}return E=!0,{done:!0,value:void 0}}};return x[Symbol.iterator]=function(){return x},x}s("Array.prototype.values",function(u){return u||function(){return i(this,function(p,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var p=typeof u;return p=p!="object"?p:u?Array.isArray(u)?"array":p:"null",p=="array"||p=="object"&&typeof u.length=="number"}function c(u){var p=typeof u;return p=="object"&&u!=null||p=="function"}function h(u,p,g){return u.call.apply(u.bind,arguments)}function d(u,p,g){if(!u)throw Error();if(2<arguments.length){var E=Array.prototype.slice.call(arguments,2);return function(){var x=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(x,E),u.apply(p,x)}}return function(){return u.apply(p,arguments)}}function f(u,p,g){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,f.apply(null,arguments)}function m(u,p){var g=Array.prototype.slice.call(arguments,1);return function(){var E=g.slice();return E.push.apply(E,arguments),u.apply(this,E)}}function y(u,p){function g(){}g.prototype=p.prototype,u.aa=p.prototype,u.prototype=new g,u.prototype.constructor=u,u.Qb=function(E,x,N){for(var J=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)J[Fe-2]=arguments[Fe];return p.prototype[x].apply(E,J)}}function T(u){const p=u.length;if(0<p){const g=Array(p);for(let E=0;E<p;E++)g[E]=u[E];return g}return[]}function w(u,p){for(let g=1;g<arguments.length;g++){const E=arguments[g];if(l(E)){const x=u.length||0,N=E.length||0;u.length=x+N;for(let J=0;J<N;J++)u[x+J]=E[J]}else u.push(E)}}class P{constructor(p,g){this.i=p,this.j=g,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function O(u){return/^[\s\xa0]*$/.test(u)}function D(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function $(u){return $[" "](u),u}$[" "]=function(){};var q=D().indexOf("Gecko")!=-1&&!(D().toLowerCase().indexOf("webkit")!=-1&&D().indexOf("Edge")==-1)&&!(D().indexOf("Trident")!=-1||D().indexOf("MSIE")!=-1)&&D().indexOf("Edge")==-1;function F(u,p,g){for(const E in u)p.call(g,u[E],E,u)}function A(u,p){for(const g in u)p.call(void 0,u[g],g,u)}function _(u){const p={};for(const g in u)p[g]=u[g];return p}const v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,p){let g,E;for(let x=1;x<arguments.length;x++){E=arguments[x];for(g in E)u[g]=E[g];for(let N=0;N<v.length;N++)g=v[N],Object.prototype.hasOwnProperty.call(E,g)&&(u[g]=E[g])}}function R(u){var p=1;u=u.split(":");const g=[];for(;0<p&&u.length;)g.push(u.shift()),p--;return u.length&&g.push(u.join(":")),g}function k(u){a.setTimeout(()=>{throw u},0)}function S(){var u=Xt;let p=null;return u.g&&(p=u.g,u.g=u.g.next,u.g||(u.h=null),p.next=null),p}class De{constructor(){this.h=this.g=null}add(p,g){const E=Ze.get();E.set(p,g),this.h?this.h.next=E:this.g=E,this.h=E}}var Ze=new P(()=>new ve,u=>u.reset());class ve{constructor(){this.next=this.g=this.h=null}set(p,g){this.h=p,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Se,Te=!1,Xt=new De,En=()=>{const u=a.Promise.resolve(void 0);Se=()=>{u.then(on)}};var on=()=>{for(var u;u=S();){try{u.h.call(u.g)}catch(g){k(g)}var p=Ze;p.j(u),100>p.h&&(p.h++,u.next=p.g,p.g=u)}Te=!1};function He(){this.s=this.s,this.C=this.C}He.prototype.s=!1,He.prototype.ma=function(){this.s||(this.s=!0,this.N())},He.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function qe(u,p){this.type=u,this.g=this.target=p,this.defaultPrevented=!1}qe.prototype.h=function(){this.defaultPrevented=!0};var pr=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,p=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const g=()=>{};a.addEventListener("test",g,p),a.removeEventListener("test",g,p)}catch{}return u}();function Pn(u,p){if(qe.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var g=this.type=u.type,E=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=p,p=u.relatedTarget){if(q){e:{try{$(p.nodeName);var x=!0;break e}catch{}x=!1}x||(p=null)}}else g=="mouseover"?p=u.fromElement:g=="mouseout"&&(p=u.toElement);this.relatedTarget=p,E?(this.clientX=E.clientX!==void 0?E.clientX:E.pageX,this.clientY=E.clientY!==void 0?E.clientY:E.pageY,this.screenX=E.screenX||0,this.screenY=E.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:dt[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&Pn.aa.h.call(this)}}y(Pn,qe);var dt={2:"touch",3:"pen",4:"mouse"};Pn.prototype.h=function(){Pn.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var V="closure_listenable_"+(1e6*Math.random()|0),ee=0;function Y(u,p,g,E,x){this.listener=u,this.proxy=null,this.src=p,this.type=g,this.capture=!!E,this.ha=x,this.key=++ee,this.da=this.fa=!1}function re(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ie(u){this.src=u,this.g={},this.h=0}Ie.prototype.add=function(u,p,g,E,x){var N=u.toString();u=this.g[N],u||(u=this.g[N]=[],this.h++);var J=b(u,p,E,x);return-1<J?(p=u[J],g||(p.fa=!1)):(p=new Y(p,this.src,N,!!E,x),p.fa=g,u.push(p)),p};function Le(u,p){var g=p.type;if(g in u.g){var E=u.g[g],x=Array.prototype.indexOf.call(E,p,void 0),N;(N=0<=x)&&Array.prototype.splice.call(E,x,1),N&&(re(p),u.g[g].length==0&&(delete u.g[g],u.h--))}}function b(u,p,g,E){for(var x=0;x<u.length;++x){var N=u[x];if(!N.da&&N.listener==p&&N.capture==!!g&&N.ha==E)return x}return-1}var C="closure_lm_"+(1e6*Math.random()|0),M={};function B(u,p,g,E,x){if(Array.isArray(p)){for(var N=0;N<p.length;N++)B(u,p[N],g,E,x);return null}return g=oe(g),u&&u[V]?u.K(p,g,c(E)?!!E.capture:!!E,x):L(u,p,g,!1,E,x)}function L(u,p,g,E,x,N){if(!p)throw Error("Invalid event type");var J=c(x)?!!x.capture:!!x,Fe=Z(u);if(Fe||(u[C]=Fe=new Ie(u)),g=Fe.add(p,g,E,J,N),g.proxy)return g;if(E=K(),g.proxy=E,E.src=u,E.listener=g,u.addEventListener)pr||(x=J),x===void 0&&(x=!1),u.addEventListener(p.toString(),E,x);else if(u.attachEvent)u.attachEvent(G(p.toString()),E);else if(u.addListener&&u.removeListener)u.addListener(E);else throw Error("addEventListener and attachEvent are unavailable.");return g}function K(){function u(g){return p.call(u.src,u.listener,g)}const p=j;return u}function Q(u,p,g,E,x){if(Array.isArray(p))for(var N=0;N<p.length;N++)Q(u,p[N],g,E,x);else E=c(E)?!!E.capture:!!E,g=oe(g),u&&u[V]?(u=u.i,p=String(p).toString(),p in u.g&&(N=u.g[p],g=b(N,g,E,x),-1<g&&(re(N[g]),Array.prototype.splice.call(N,g,1),N.length==0&&(delete u.g[p],u.h--)))):u&&(u=Z(u))&&(p=u.g[p.toString()],u=-1,p&&(u=b(p,g,E,x)),(g=-1<u?p[u]:null)&&W(g))}function W(u){if(typeof u!="number"&&u&&!u.da){var p=u.src;if(p&&p[V])Le(p.i,u);else{var g=u.type,E=u.proxy;p.removeEventListener?p.removeEventListener(g,E,u.capture):p.detachEvent?p.detachEvent(G(g),E):p.addListener&&p.removeListener&&p.removeListener(E),(g=Z(p))?(Le(g,u),g.h==0&&(g.src=null,p[C]=null)):re(u)}}}function G(u){return u in M?M[u]:M[u]="on"+u}function j(u,p){if(u.da)u=!0;else{p=new Pn(p,this);var g=u.listener,E=u.ha||u.src;u.fa&&W(u),u=g.call(E,p)}return u}function Z(u){return u=u[C],u instanceof Ie?u:null}var ae="__closure_events_fn_"+(1e9*Math.random()>>>0);function oe(u){return typeof u=="function"?u:(u[ae]||(u[ae]=function(p){return u.handleEvent(p)}),u[ae])}function ie(){He.call(this),this.i=new Ie(this),this.M=this,this.F=null}y(ie,He),ie.prototype[V]=!0,ie.prototype.removeEventListener=function(u,p,g,E){Q(this,u,p,g,E)};function ce(u,p){var g,E=u.F;if(E)for(g=[];E;E=E.F)g.push(E);if(u=u.M,E=p.type||p,typeof p=="string")p=new qe(p,u);else if(p instanceof qe)p.target=p.target||u;else{var x=p;p=new qe(E,u),I(p,x)}if(x=!0,g)for(var N=g.length-1;0<=N;N--){var J=p.g=g[N];x=ke(J,E,!0,p)&&x}if(J=p.g=u,x=ke(J,E,!0,p)&&x,x=ke(J,E,!1,p)&&x,g)for(N=0;N<g.length;N++)J=p.g=g[N],x=ke(J,E,!1,p)&&x}ie.prototype.N=function(){if(ie.aa.N.call(this),this.i){var u=this.i,p;for(p in u.g){for(var g=u.g[p],E=0;E<g.length;E++)re(g[E]);delete u.g[p],u.h--}}this.F=null},ie.prototype.K=function(u,p,g,E){return this.i.add(String(u),p,!1,g,E)},ie.prototype.L=function(u,p,g,E){return this.i.add(String(u),p,!0,g,E)};function ke(u,p,g,E){if(p=u.i.g[String(p)],!p)return!0;p=p.concat();for(var x=!0,N=0;N<p.length;++N){var J=p[N];if(J&&!J.da&&J.capture==g){var Fe=J.listener,Et=J.ha||J.src;J.fa&&Le(u.i,J),x=Fe.call(Et,E)!==!1&&x}}return x&&!E.defaultPrevented}function Ve(u,p,g){if(typeof u=="function")g&&(u=f(u,g));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:a.setTimeout(u,p||0)}function et(u){u.g=Ve(()=>{u.g=null,u.i&&(u.i=!1,et(u))},u.l);const p=u.h;u.h=null,u.m.apply(null,p)}class Zt extends He{constructor(p,g){super(),this.m=p,this.l=g,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:et(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function an(u){He.call(this),this.h=u,this.g={}}y(an,He);var po=[];function mr(u){F(u.g,function(p,g){this.g.hasOwnProperty(g)&&W(p)},u),u.g={}}an.prototype.N=function(){an.aa.N.call(this),mr(this)},an.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ci=a.JSON.stringify,Vt=a.JSON.parse,ln=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ui(){}ui.prototype.h=null;function Qp(u){return u.h||(u.h=u.i())}function Yp(){}var mo={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Wu(){qe.call(this,"d")}y(Wu,qe);function Ku(){qe.call(this,"c")}y(Ku,qe);var gs={},Xp=null;function el(){return Xp=Xp||new ie}gs.La="serverreachability";function Zp(u){qe.call(this,gs.La,u)}y(Zp,qe);function go(u){const p=el();ce(p,new Zp(p))}gs.STAT_EVENT="statevent";function em(u,p){qe.call(this,gs.STAT_EVENT,u),this.stat=p}y(em,qe);function Ft(u){const p=el();ce(p,new em(p,u))}gs.Ma="timingevent";function tm(u,p){qe.call(this,gs.Ma,u),this.size=p}y(tm,qe);function yo(u,p){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},p)}function _o(){this.g=!0}_o.prototype.xa=function(){this.g=!1};function Jb(u,p,g,E,x,N){u.info(function(){if(u.g)if(N)for(var J="",Fe=N.split("&"),Et=0;Et<Fe.length;Et++){var Pe=Fe[Et].split("=");if(1<Pe.length){var Ct=Pe[0];Pe=Pe[1];var kt=Ct.split("_");J=2<=kt.length&&kt[1]=="type"?J+(Ct+"="+Pe+"&"):J+(Ct+"=redacted&")}}else J=null;else J=N;return"XMLHTTP REQ ("+E+") [attempt "+x+"]: "+p+`
`+g+`
`+J})}function Qb(u,p,g,E,x,N,J){u.info(function(){return"XMLHTTP RESP ("+E+") [ attempt "+x+"]: "+p+`
`+g+`
`+N+" "+J})}function hi(u,p,g,E){u.info(function(){return"XMLHTTP TEXT ("+p+"): "+Xb(u,g)+(E?" "+E:"")})}function Yb(u,p){u.info(function(){return"TIMEOUT: "+p})}_o.prototype.info=function(){};function Xb(u,p){if(!u.g)return p;if(!p)return null;try{var g=JSON.parse(p);if(g){for(u=0;u<g.length;u++)if(Array.isArray(g[u])){var E=g[u];if(!(2>E.length)){var x=E[1];if(Array.isArray(x)&&!(1>x.length)){var N=x[0];if(N!="noop"&&N!="stop"&&N!="close")for(var J=1;J<x.length;J++)x[J]=""}}}}return ci(g)}catch{return p}}var tl={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},nm={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Gu;function nl(){}y(nl,ui),nl.prototype.g=function(){return new XMLHttpRequest},nl.prototype.i=function(){return{}},Gu=new nl;function gr(u,p,g,E){this.j=u,this.i=p,this.l=g,this.R=E||1,this.U=new an(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new rm}function rm(){this.i=null,this.g="",this.h=!1}var sm={},Ju={};function Qu(u,p,g){u.L=1,u.v=ol(Yn(p)),u.m=g,u.P=!0,im(u,null)}function im(u,p){u.F=Date.now(),rl(u),u.A=Yn(u.v);var g=u.A,E=u.R;Array.isArray(E)||(E=[String(E)]),Em(g.i,"t",E),u.C=0,g=u.j.J,u.h=new rm,u.g=Vm(u.j,g?p:null,!u.m),0<u.O&&(u.M=new Zt(f(u.Y,u,u.g),u.O)),p=u.U,g=u.g,E=u.ca;var x="readystatechange";Array.isArray(x)||(x&&(po[0]=x.toString()),x=po);for(var N=0;N<x.length;N++){var J=B(g,x[N],E||p.handleEvent,!1,p.h||p);if(!J)break;p.g[J.key]=J}p=u.H?_(u.H):{},u.m?(u.u||(u.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,p)):(u.u="GET",u.g.ea(u.A,u.u,null,p)),go(),Jb(u.i,u.u,u.A,u.l,u.R,u.m)}gr.prototype.ca=function(u){u=u.target;const p=this.M;p&&Xn(u)==3?p.j():this.Y(u)},gr.prototype.Y=function(u){try{if(u==this.g)e:{const kt=Xn(this.g);var p=this.g.Ba();const pi=this.g.Z();if(!(3>kt)&&(kt!=3||this.g&&(this.h.h||this.g.oa()||Am(this.g)))){this.J||kt!=4||p==7||(p==8||0>=pi?go(3):go(2)),Yu(this);var g=this.g.Z();this.X=g;t:if(om(this)){var E=Am(this.g);u="";var x=E.length,N=Xn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ys(this),Eo(this);var J="";break t}this.h.i=new a.TextDecoder}for(p=0;p<x;p++)this.h.h=!0,u+=this.h.i.decode(E[p],{stream:!(N&&p==x-1)});E.length=0,this.h.g+=u,this.C=0,J=this.h.g}else J=this.g.oa();if(this.o=g==200,Qb(this.i,this.u,this.A,this.l,this.R,kt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var Fe,Et=this.g;if((Fe=Et.g?Et.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!O(Fe)){var Pe=Fe;break t}}Pe=null}if(g=Pe)hi(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xu(this,g);else{this.o=!1,this.s=3,Ft(12),ys(this),Eo(this);break e}}if(this.P){g=!0;let vn;for(;!this.J&&this.C<J.length;)if(vn=Zb(this,J),vn==Ju){kt==4&&(this.s=4,Ft(14),g=!1),hi(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==sm){this.s=4,Ft(15),hi(this.i,this.l,J,"[Invalid Chunk]"),g=!1;break}else hi(this.i,this.l,vn,null),Xu(this,vn);if(om(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),kt!=4||J.length!=0||this.h.h||(this.s=1,Ft(16),g=!1),this.o=this.o&&g,!g)hi(this.i,this.l,J,"[Invalid Chunked Response]"),ys(this),Eo(this);else if(0<J.length&&!this.W){this.W=!0;var Ct=this.j;Ct.g==this&&Ct.ba&&!Ct.M&&(Ct.j.info("Great, no buffering proxy detected. Bytes received: "+J.length),sh(Ct),Ct.M=!0,Ft(11))}}else hi(this.i,this.l,J,null),Xu(this,J);kt==4&&ys(this),this.o&&!this.J&&(kt==4?Mm(this.j,this):(this.o=!1,rl(this)))}else gS(this.g),g==400&&0<J.indexOf("Unknown SID")?(this.s=3,Ft(12)):(this.s=0,Ft(13)),ys(this),Eo(this)}}}catch{}finally{}};function om(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Zb(u,p){var g=u.C,E=p.indexOf(`
`,g);return E==-1?Ju:(g=Number(p.substring(g,E)),isNaN(g)?sm:(E+=1,E+g>p.length?Ju:(p=p.slice(E,E+g),u.C=E+g,p)))}gr.prototype.cancel=function(){this.J=!0,ys(this)};function rl(u){u.S=Date.now()+u.I,am(u,u.I)}function am(u,p){if(u.B!=null)throw Error("WatchDog timer not null");u.B=yo(f(u.ba,u),p)}function Yu(u){u.B&&(a.clearTimeout(u.B),u.B=null)}gr.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(Yb(this.i,this.A),this.L!=2&&(go(),Ft(17)),ys(this),this.s=2,Eo(this)):am(this,this.S-u)};function Eo(u){u.j.G==0||u.J||Mm(u.j,u)}function ys(u){Yu(u);var p=u.M;p&&typeof p.ma=="function"&&p.ma(),u.M=null,mr(u.U),u.g&&(p=u.g,u.g=null,p.abort(),p.ma())}function Xu(u,p){try{var g=u.j;if(g.G!=0&&(g.g==u||Zu(g.h,u))){if(!u.K&&Zu(g.h,u)&&g.G==3){try{var E=g.Da.g.parse(p)}catch{E=null}if(Array.isArray(E)&&E.length==3){var x=E;if(x[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<u.F)hl(g),cl(g);else break e;rh(g),Ft(18)}}else g.za=x[1],0<g.za-g.T&&37500>x[2]&&g.F&&g.v==0&&!g.C&&(g.C=yo(f(g.Za,g),6e3));if(1>=um(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Es(g,11)}else if((u.K||g.g==u)&&hl(g),!O(p))for(x=g.Da.g.parse(p),p=0;p<x.length;p++){let Pe=x[p];if(g.T=Pe[0],Pe=Pe[1],g.G==2)if(Pe[0]=="c"){g.K=Pe[1],g.ia=Pe[2];const Ct=Pe[3];Ct!=null&&(g.la=Ct,g.j.info("VER="+g.la));const kt=Pe[4];kt!=null&&(g.Aa=kt,g.j.info("SVER="+g.Aa));const pi=Pe[5];pi!=null&&typeof pi=="number"&&0<pi&&(E=1.5*pi,g.L=E,g.j.info("backChannelRequestTimeoutMs_="+E)),E=g;const vn=u.g;if(vn){const fl=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(fl){var N=E.h;N.g||fl.indexOf("spdy")==-1&&fl.indexOf("quic")==-1&&fl.indexOf("h2")==-1||(N.j=N.l,N.g=new Set,N.h&&(eh(N,N.h),N.h=null))}if(E.D){const ih=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;ih&&(E.ya=ih,Ue(E.I,E.D,ih))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-u.F,g.j.info("Handshake RTT: "+g.R+"ms")),E=g;var J=u;if(E.qa=Lm(E,E.J?E.ia:null,E.W),J.K){hm(E.h,J);var Fe=J,Et=E.L;Et&&(Fe.I=Et),Fe.B&&(Yu(Fe),rl(Fe)),E.g=J}else xm(E);0<g.i.length&&ul(g)}else Pe[0]!="stop"&&Pe[0]!="close"||Es(g,7);else g.G==3&&(Pe[0]=="stop"||Pe[0]=="close"?Pe[0]=="stop"?Es(g,7):nh(g):Pe[0]!="noop"&&g.l&&g.l.ta(Pe),g.v=0)}}go(4)}catch{}}var eS=class{constructor(u,p){this.g=u,this.map=p}};function lm(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function cm(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function um(u){return u.h?1:u.g?u.g.size:0}function Zu(u,p){return u.h?u.h==p:u.g?u.g.has(p):!1}function eh(u,p){u.g?u.g.add(p):u.h=p}function hm(u,p){u.h&&u.h==p?u.h=null:u.g&&u.g.has(p)&&u.g.delete(p)}lm.prototype.cancel=function(){if(this.i=dm(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function dm(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let p=u.i;for(const g of u.g.values())p=p.concat(g.D);return p}return T(u.i)}function tS(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var p=[],g=u.length,E=0;E<g;E++)p.push(u[E]);return p}p=[],g=0;for(E in u)p[g++]=u[E];return p}function nS(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var p=[];u=u.length;for(var g=0;g<u;g++)p.push(g);return p}p=[],g=0;for(const E in u)p[g++]=E;return p}}}function fm(u,p){if(u.forEach&&typeof u.forEach=="function")u.forEach(p,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,p,void 0);else for(var g=nS(u),E=tS(u),x=E.length,N=0;N<x;N++)p.call(void 0,E[N],g&&g[N],u)}var pm=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function rS(u,p){if(u){u=u.split("&");for(var g=0;g<u.length;g++){var E=u[g].indexOf("="),x=null;if(0<=E){var N=u[g].substring(0,E);x=u[g].substring(E+1)}else N=u[g];p(N,x?decodeURIComponent(x.replace(/\+/g," ")):"")}}}function _s(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof _s){this.h=u.h,sl(this,u.j),this.o=u.o,this.g=u.g,il(this,u.s),this.l=u.l;var p=u.i,g=new wo;g.i=p.i,p.g&&(g.g=new Map(p.g),g.h=p.h),mm(this,g),this.m=u.m}else u&&(p=String(u).match(pm))?(this.h=!1,sl(this,p[1]||"",!0),this.o=vo(p[2]||""),this.g=vo(p[3]||"",!0),il(this,p[4]),this.l=vo(p[5]||"",!0),mm(this,p[6]||"",!0),this.m=vo(p[7]||"")):(this.h=!1,this.i=new wo(null,this.h))}_s.prototype.toString=function(){var u=[],p=this.j;p&&u.push(To(p,gm,!0),":");var g=this.g;return(g||p=="file")&&(u.push("//"),(p=this.o)&&u.push(To(p,gm,!0),"@"),u.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&u.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&u.push("/"),u.push(To(g,g.charAt(0)=="/"?oS:iS,!0))),(g=this.i.toString())&&u.push("?",g),(g=this.m)&&u.push("#",To(g,lS)),u.join("")};function Yn(u){return new _s(u)}function sl(u,p,g){u.j=g?vo(p,!0):p,u.j&&(u.j=u.j.replace(/:$/,""))}function il(u,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);u.s=p}else u.s=null}function mm(u,p,g){p instanceof wo?(u.i=p,cS(u.i,u.h)):(g||(p=To(p,aS)),u.i=new wo(p,u.h))}function Ue(u,p,g){u.i.set(p,g)}function ol(u){return Ue(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function vo(u,p){return u?p?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function To(u,p,g){return typeof u=="string"?(u=encodeURI(u).replace(p,sS),g&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function sS(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var gm=/[#\/\?@]/g,iS=/[#\?:]/g,oS=/[#\?]/g,aS=/[#\?@]/g,lS=/#/g;function wo(u,p){this.h=this.g=null,this.i=u||null,this.j=!!p}function yr(u){u.g||(u.g=new Map,u.h=0,u.i&&rS(u.i,function(p,g){u.add(decodeURIComponent(p.replace(/\+/g," ")),g)}))}n=wo.prototype,n.add=function(u,p){yr(this),this.i=null,u=di(this,u);var g=this.g.get(u);return g||this.g.set(u,g=[]),g.push(p),this.h+=1,this};function ym(u,p){yr(u),p=di(u,p),u.g.has(p)&&(u.i=null,u.h-=u.g.get(p).length,u.g.delete(p))}function _m(u,p){return yr(u),p=di(u,p),u.g.has(p)}n.forEach=function(u,p){yr(this),this.g.forEach(function(g,E){g.forEach(function(x){u.call(p,x,E,this)},this)},this)},n.na=function(){yr(this);const u=Array.from(this.g.values()),p=Array.from(this.g.keys()),g=[];for(let E=0;E<p.length;E++){const x=u[E];for(let N=0;N<x.length;N++)g.push(p[E])}return g},n.V=function(u){yr(this);let p=[];if(typeof u=="string")_m(this,u)&&(p=p.concat(this.g.get(di(this,u))));else{u=Array.from(this.g.values());for(let g=0;g<u.length;g++)p=p.concat(u[g])}return p},n.set=function(u,p){return yr(this),this.i=null,u=di(this,u),_m(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[p]),this.h+=1,this},n.get=function(u,p){return u?(u=this.V(u),0<u.length?String(u[0]):p):p};function Em(u,p,g){ym(u,p),0<g.length&&(u.i=null,u.g.set(di(u,p),T(g)),u.h+=g.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],p=Array.from(this.g.keys());for(var g=0;g<p.length;g++){var E=p[g];const N=encodeURIComponent(String(E)),J=this.V(E);for(E=0;E<J.length;E++){var x=N;J[E]!==""&&(x+="="+encodeURIComponent(String(J[E]))),u.push(x)}}return this.i=u.join("&")};function di(u,p){return p=String(p),u.j&&(p=p.toLowerCase()),p}function cS(u,p){p&&!u.j&&(yr(u),u.i=null,u.g.forEach(function(g,E){var x=E.toLowerCase();E!=x&&(ym(this,E),Em(this,x,g))},u)),u.j=p}function uS(u,p){const g=new _o;if(a.Image){const E=new Image;E.onload=m(_r,g,"TestLoadImage: loaded",!0,p,E),E.onerror=m(_r,g,"TestLoadImage: error",!1,p,E),E.onabort=m(_r,g,"TestLoadImage: abort",!1,p,E),E.ontimeout=m(_r,g,"TestLoadImage: timeout",!1,p,E),a.setTimeout(function(){E.ontimeout&&E.ontimeout()},1e4),E.src=u}else p(!1)}function hS(u,p){const g=new _o,E=new AbortController,x=setTimeout(()=>{E.abort(),_r(g,"TestPingServer: timeout",!1,p)},1e4);fetch(u,{signal:E.signal}).then(N=>{clearTimeout(x),N.ok?_r(g,"TestPingServer: ok",!0,p):_r(g,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(x),_r(g,"TestPingServer: error",!1,p)})}function _r(u,p,g,E,x){try{x&&(x.onload=null,x.onerror=null,x.onabort=null,x.ontimeout=null),E(g)}catch{}}function dS(){this.g=new ln}function fS(u,p,g){const E=g||"";try{fm(u,function(x,N){let J=x;c(x)&&(J=ci(x)),p.push(E+N+"="+encodeURIComponent(J))})}catch(x){throw p.push(E+"type="+encodeURIComponent("_badmap")),x}}function bo(u){this.l=u.Ub||null,this.j=u.eb||!1}y(bo,ui),bo.prototype.g=function(){return new al(this.l,this.j)},bo.prototype.i=function(u){return function(){return u}}({});function al(u,p){ie.call(this),this.D=u,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(al,ie),n=al.prototype,n.open=function(u,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=p,this.readyState=1,Io(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(p.body=u),(this.D||a).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,So(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Io(this)),this.g&&(this.readyState=3,Io(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;vm(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function vm(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var p=u.value?u.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!u.done}))&&(this.response=this.responseText+=p)}u.done?So(this):Io(this),this.readyState==3&&vm(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,So(this))},n.Qa=function(u){this.g&&(this.response=u,So(this))},n.ga=function(){this.g&&So(this)};function So(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Io(u)}n.setRequestHeader=function(u,p){this.u.append(u,p)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],p=this.h.entries();for(var g=p.next();!g.done;)g=g.value,u.push(g[0]+": "+g[1]),g=p.next();return u.join(`\r
`)};function Io(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(al.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Tm(u){let p="";return F(u,function(g,E){p+=E,p+=":",p+=g,p+=`\r
`}),p}function th(u,p,g){e:{for(E in g){var E=!1;break e}E=!0}E||(g=Tm(g),typeof u=="string"?g!=null&&encodeURIComponent(String(g)):Ue(u,p,g))}function Ge(u){ie.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Ge,ie);var pS=/^https?$/i,mS=["POST","PUT"];n=Ge.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,p,g,E){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);p=p?p.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Gu.g(),this.v=this.o?Qp(this.o):Qp(Gu),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(p,String(u),!0),this.B=!1}catch(N){wm(this,N);return}if(u=g||"",g=new Map(this.headers),E)if(Object.getPrototypeOf(E)===Object.prototype)for(var x in E)g.set(x,E[x]);else if(typeof E.keys=="function"&&typeof E.get=="function")for(const N of E.keys())g.set(N,E.get(N));else throw Error("Unknown input type for opt_headers: "+String(E));E=Array.from(g.keys()).find(N=>N.toLowerCase()=="content-type"),x=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(mS,p,void 0))||E||x||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[N,J]of g)this.g.setRequestHeader(N,J);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Im(this),this.u=!0,this.g.send(u),this.u=!1}catch(N){wm(this,N)}};function wm(u,p){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=p,u.m=5,bm(u),ll(u)}function bm(u){u.A||(u.A=!0,ce(u,"complete"),ce(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,ce(this,"complete"),ce(this,"abort"),ll(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ll(this,!0)),Ge.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Sm(this):this.bb())},n.bb=function(){Sm(this)};function Sm(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Xn(u)!=4||u.Z()!=2)){if(u.u&&Xn(u)==4)Ve(u.Ea,0,u);else if(ce(u,"readystatechange"),Xn(u)==4){u.h=!1;try{const J=u.Z();e:switch(J){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var g;if(!(g=p)){var E;if(E=J===0){var x=String(u.D).match(pm)[1]||null;!x&&a.self&&a.self.location&&(x=a.self.location.protocol.slice(0,-1)),E=!pS.test(x?x.toLowerCase():"")}g=E}if(g)ce(u,"complete"),ce(u,"success");else{u.m=6;try{var N=2<Xn(u)?u.g.statusText:""}catch{N=""}u.l=N+" ["+u.Z()+"]",bm(u)}}finally{ll(u)}}}}function ll(u,p){if(u.g){Im(u);const g=u.g,E=u.v[0]?()=>{}:null;u.g=null,u.v=null,p||ce(u,"ready");try{g.onreadystatechange=E}catch{}}}function Im(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function Xn(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<Xn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var p=this.g.responseText;return u&&p.indexOf(u)==0&&(p=p.substring(u.length)),Vt(p)}};function Am(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function gS(u){const p={};u=(u.g&&2<=Xn(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let E=0;E<u.length;E++){if(O(u[E]))continue;var g=R(u[E]);const x=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const N=p[x]||[];p[x]=N,N.push(g)}A(p,function(E){return E.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ao(u,p,g){return g&&g.internalChannelParams&&g.internalChannelParams[u]||p}function Cm(u){this.Aa=0,this.i=[],this.j=new _o,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ao("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ao("baseRetryDelayMs",5e3,u),this.cb=Ao("retryDelaySeedMs",1e4,u),this.Wa=Ao("forwardChannelMaxRetries",2,u),this.wa=Ao("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new lm(u&&u.concurrentRequestLimit),this.Da=new dS,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Cm.prototype,n.la=8,n.G=1,n.connect=function(u,p,g,E){Ft(0),this.W=u,this.H=p||{},g&&E!==void 0&&(this.H.OSID=g,this.H.OAID=E),this.F=this.X,this.I=Lm(this,null,this.W),ul(this)};function nh(u){if(km(u),u.G==3){var p=u.U++,g=Yn(u.I);if(Ue(g,"SID",u.K),Ue(g,"RID",p),Ue(g,"TYPE","terminate"),Co(u,g),p=new gr(u,u.j,p),p.L=2,p.v=ol(Yn(g)),g=!1,a.navigator&&a.navigator.sendBeacon)try{g=a.navigator.sendBeacon(p.v.toString(),"")}catch{}!g&&a.Image&&(new Image().src=p.v,g=!0),g||(p.g=Vm(p.j,null),p.g.ea(p.v)),p.F=Date.now(),rl(p)}Dm(u)}function cl(u){u.g&&(sh(u),u.g.cancel(),u.g=null)}function km(u){cl(u),u.u&&(a.clearTimeout(u.u),u.u=null),hl(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function ul(u){if(!cm(u.h)&&!u.s){u.s=!0;var p=u.Ga;Se||En(),Te||(Se(),Te=!0),Xt.add(p,u),u.B=0}}function yS(u,p){return um(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=p.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=yo(f(u.Ga,u,p),Nm(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const x=new gr(this,this.j,u);let N=this.o;if(this.S&&(N?(N=_(N),I(N,this.S)):N=this.S),this.m!==null||this.O||(x.H=N,N=null),this.P)e:{for(var p=0,g=0;g<this.i.length;g++){t:{var E=this.i[g];if("__data__"in E.map&&(E=E.map.__data__,typeof E=="string")){E=E.length;break t}E=void 0}if(E===void 0)break;if(p+=E,4096<p){p=g;break e}if(p===4096||g===this.i.length-1){p=g+1;break e}}p=1e3}else p=1e3;p=Pm(this,x,p),g=Yn(this.I),Ue(g,"RID",u),Ue(g,"CVER",22),this.D&&Ue(g,"X-HTTP-Session-Id",this.D),Co(this,g),N&&(this.O?p="headers="+encodeURIComponent(String(Tm(N)))+"&"+p:this.m&&th(g,this.m,N)),eh(this.h,x),this.Ua&&Ue(g,"TYPE","init"),this.P?(Ue(g,"$req",p),Ue(g,"SID","null"),x.T=!0,Qu(x,g,null)):Qu(x,g,p),this.G=2}}else this.G==3&&(u?Rm(this,u):this.i.length==0||cm(this.h)||Rm(this))};function Rm(u,p){var g;p?g=p.l:g=u.U++;const E=Yn(u.I);Ue(E,"SID",u.K),Ue(E,"RID",g),Ue(E,"AID",u.T),Co(u,E),u.m&&u.o&&th(E,u.m,u.o),g=new gr(u,u.j,g,u.B+1),u.m===null&&(g.H=u.o),p&&(u.i=p.D.concat(u.i)),p=Pm(u,g,1e3),g.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),eh(u.h,g),Qu(g,E,p)}function Co(u,p){u.H&&F(u.H,function(g,E){Ue(p,E,g)}),u.l&&fm({},function(g,E){Ue(p,E,g)})}function Pm(u,p,g){g=Math.min(u.i.length,g);var E=u.l?f(u.l.Na,u.l,u):null;e:{var x=u.i;let N=-1;for(;;){const J=["count="+g];N==-1?0<g?(N=x[0].g,J.push("ofs="+N)):N=0:J.push("ofs="+N);let Fe=!0;for(let Et=0;Et<g;Et++){let Pe=x[Et].g;const Ct=x[Et].map;if(Pe-=N,0>Pe)N=Math.max(0,x[Et].g-100),Fe=!1;else try{fS(Ct,J,"req"+Pe+"_")}catch{E&&E(Ct)}}if(Fe){E=J.join("&");break e}}}return u=u.i.splice(0,g),p.D=u,E}function xm(u){if(!u.g&&!u.u){u.Y=1;var p=u.Fa;Se||En(),Te||(Se(),Te=!0),Xt.add(p,u),u.v=0}}function rh(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=yo(f(u.Fa,u),Nm(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Om(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=yo(f(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ft(10),cl(this),Om(this))};function sh(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Om(u){u.g=new gr(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var p=Yn(u.qa);Ue(p,"RID","rpc"),Ue(p,"SID",u.K),Ue(p,"AID",u.T),Ue(p,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ue(p,"TO",u.ja),Ue(p,"TYPE","xmlhttp"),Co(u,p),u.m&&u.o&&th(p,u.m,u.o),u.L&&(u.g.I=u.L);var g=u.g;u=u.ia,g.L=1,g.v=ol(Yn(p)),g.m=null,g.P=!0,im(g,u)}n.Za=function(){this.C!=null&&(this.C=null,cl(this),rh(this),Ft(19))};function hl(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Mm(u,p){var g=null;if(u.g==p){hl(u),sh(u),u.g=null;var E=2}else if(Zu(u.h,p))g=p.D,hm(u.h,p),E=1;else return;if(u.G!=0){if(p.o)if(E==1){g=p.m?p.m.length:0,p=Date.now()-p.F;var x=u.B;E=el(),ce(E,new tm(E,g)),ul(u)}else xm(u);else if(x=p.s,x==3||x==0&&0<p.X||!(E==1&&yS(u,p)||E==2&&rh(u)))switch(g&&0<g.length&&(p=u.h,p.i=p.i.concat(g)),x){case 1:Es(u,5);break;case 4:Es(u,10);break;case 3:Es(u,6);break;default:Es(u,2)}}}function Nm(u,p){let g=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(g*=2),g*p}function Es(u,p){if(u.j.info("Error code "+p),p==2){var g=f(u.fb,u),E=u.Xa;const x=!E;E=new _s(E||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||sl(E,"https"),ol(E),x?uS(E.toString(),g):hS(E.toString(),g)}else Ft(2);u.G=0,u.l&&u.l.sa(p),Dm(u),km(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ft(2)):(this.j.info("Failed to ping google.com"),Ft(1))};function Dm(u){if(u.G=0,u.ka=[],u.l){const p=dm(u.h);(p.length!=0||u.i.length!=0)&&(w(u.ka,p),w(u.ka,u.i),u.h.i.length=0,T(u.i),u.i.length=0),u.l.ra()}}function Lm(u,p,g){var E=g instanceof _s?Yn(g):new _s(g);if(E.g!="")p&&(E.g=p+"."+E.g),il(E,E.s);else{var x=a.location;E=x.protocol,p=p?p+"."+x.hostname:x.hostname,x=+x.port;var N=new _s(null);E&&sl(N,E),p&&(N.g=p),x&&il(N,x),g&&(N.l=g),E=N}return g=u.D,p=u.ya,g&&p&&Ue(E,g,p),Ue(E,"VER",u.la),Co(u,E),E}function Vm(u,p,g){if(p&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=u.Ca&&!u.pa?new Ge(new bo({eb:g})):new Ge(u.pa),p.Ha(u.J),p}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fm(){}n=Fm.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function dl(){}dl.prototype.g=function(u,p){return new en(u,p)};function en(u,p){ie.call(this),this.g=new Cm(p),this.l=u,this.h=p&&p.messageUrlParams||null,u=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(u?u["X-WebChannel-Content-Type"]=p.messageContentType:u={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(u?u["X-WebChannel-Client-Profile"]=p.va:u={"X-WebChannel-Client-Profile":p.va}),this.g.S=u,(u=p&&p.Sb)&&!O(u)&&(this.g.m=u),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!O(p)&&(this.g.D=p,u=this.h,u!==null&&p in u&&(u=this.h,p in u&&delete u[p])),this.j=new fi(this)}y(en,ie),en.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},en.prototype.close=function(){nh(this.g)},en.prototype.o=function(u){var p=this.g;if(typeof u=="string"){var g={};g.__data__=u,u=g}else this.u&&(g={},g.__data__=ci(u),u=g);p.i.push(new eS(p.Ya++,u)),p.G==3&&ul(p)},en.prototype.N=function(){this.g.l=null,delete this.j,nh(this.g),delete this.g,en.aa.N.call(this)};function Bm(u){Wu.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var p=u.__sm__;if(p){e:{for(const g in p){u=g;break e}u=void 0}(this.i=u)&&(u=this.i,p=p!==null&&u in p?p[u]:void 0),this.data=p}else this.data=u}y(Bm,Wu);function Um(){Ku.call(this),this.status=1}y(Um,Ku);function fi(u){this.g=u}y(fi,Fm),fi.prototype.ua=function(){ce(this.g,"a")},fi.prototype.ta=function(u){ce(this.g,new Bm(u))},fi.prototype.sa=function(u){ce(this.g,new Um)},fi.prototype.ra=function(){ce(this.g,"b")},dl.prototype.createWebChannel=dl.prototype.g,en.prototype.send=en.prototype.o,en.prototype.open=en.prototype.m,en.prototype.close=en.prototype.close,B0=function(){return new dl},F0=function(){return el()},V0=gs,Sd={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},tl.NO_ERROR=0,tl.TIMEOUT=8,tl.HTTP_ERROR=6,Hl=tl,nm.COMPLETE="complete",L0=nm,Yp.EventType=mo,mo.OPEN="a",mo.CLOSE="b",mo.ERROR="c",mo.MESSAGE="d",ie.prototype.listen=ie.prototype.K,Lo=Yp,D0=bo,Ge.prototype.listenOnce=Ge.prototype.L,Ge.prototype.getLastError=Ge.prototype.Ka,Ge.prototype.getLastErrorCode=Ge.prototype.Ba,Ge.prototype.getStatus=Ge.prototype.Z,Ge.prototype.getResponseJson=Ge.prototype.Oa,Ge.prototype.getResponseText=Ge.prototype.oa,Ge.prototype.send=Ge.prototype.ea,Ge.prototype.setWithCredentials=Ge.prototype.Ha,N0=Ge}).apply(typeof bl<"u"?bl:typeof self<"u"?self:typeof window<"u"?window:{});const Sy="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}xt.UNAUTHENTICATED=new xt(null),xt.GOOGLE_CREDENTIALS=new xt("google-credentials-uid"),xt.FIRST_PARTY=new xt("first-party-uid"),xt.MOCK_USER=new xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ao="10.12.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gs=new xf("@firebase/firestore");function Po(){return Gs.logLevel}function se(n,...e){if(Gs.logLevel<=be.DEBUG){const t=e.map(qf);Gs.debug(`Firestore (${ao}): ${n}`,...t)}}function ur(n,...e){if(Gs.logLevel<=be.ERROR){const t=e.map(qf);Gs.error(`Firestore (${ao}): ${n}`,...t)}}function qi(n,...e){if(Gs.logLevel<=be.WARN){const t=e.map(qf);Gs.warn(`Firestore (${ao}): ${n}`,...t)}}function qf(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fe(n="Unexpected state"){const e=`FIRESTORE (${ao}) INTERNAL ASSERTION FAILED: `+n;throw ur(e),new Error(e)}function Be(n,e){n||fe()}function ye(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class te extends Qn{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ar{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U0{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class px{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(xt.UNAUTHENTICATED))}shutdown(){}}class mx{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class gx{constructor(e){this.t=e,this.currentUser=xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let r=this.i;const s=l=>this.i!==r?(r=this.i,t(l)):Promise.resolve();let i=new ar;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ar,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const l=i;e.enqueueRetryable(async()=>{await l.promise,await s(this.currentUser)})},a=l=>{se("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(se("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ar)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(se("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Be(typeof r.accessToken=="string"),new U0(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Be(e===null||typeof e=="string"),new xt(e)}}class yx{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class _x{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new yx(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ex{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vx{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const r=i=>{i.error!=null&&se("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,se("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{se("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):se("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Be(typeof t.token=="string"),this.R=t.token,new Ex(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tx(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $0{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=Tx(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<t&&(r+=e.charAt(s[i]%e.length))}return r}}function xe(n,e){return n<e?-1:n>e?1:0}function Wi(n,e,t){return n.length===e.length&&n.every((r,s)=>t(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new te(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new te(U.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new te(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new te(U.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ct.fromMillis(Date.now())}static fromDate(e){return ct.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new ct(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pe(e)}static min(){return new pe(new ct(0,0))}static max(){return new pe(new ct(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,t,r){t===void 0?t=0:t>e.length&&fe(),r===void 0?r=e.length-t:r>e.length-t&&fe(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return va.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof va?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const i=e.get(s),o=t.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ze extends va{construct(e,t,r){return new ze(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new te(U.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(s=>s.length>0))}return new ze(t)}static emptyPath(){return new ze([])}}const wx=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class St extends va{construct(e,t,r){return new St(e,t,r)}static isValidIdentifier(e){return wx.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),St.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new St(["__name__"])}static fromServerFormat(e){const t=[];let r="",s=0;const i=()=>{if(r.length===0)throw new te(U.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;s<e.length;){const a=e[s];if(a==="\\"){if(s+1===e.length)throw new te(U.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[s+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new te(U.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(r+=a,s++):(i(),s++)}if(i(),o)throw new te(U.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new St(t)}static emptyPath(){return new St([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(ze.fromString(e))}static fromName(e){return new le(ze.fromString(e).popFirst(5))}static empty(){return new le(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new ze(e.slice()))}}function bx(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=pe.fromTimestamp(r===1e9?new ct(t+1,0):new ct(t,r));return new is(s,le.empty(),e)}function Sx(n){return new is(n.readTime,n.key,-1)}class is{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new is(pe.min(),le.empty(),-1)}static max(){return new is(pe.max(),le.empty(),-1)}}function Ix(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=le.comparator(n.documentKey,e.documentKey),t!==0?t:xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ax="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Cx{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ja(n){if(n.code!==U.FAILED_PRECONDITION||n.message!==Ax)throw n;se("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&fe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(t,i).next(r,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):z.reject(t)}static resolve(e){return new z((t,r)=>{t(e)})}static reject(e){return new z((t,r)=>{r(e)})}static waitFor(e){return new z((t,r)=>{let s=0,i=0,o=!1;e.forEach(a=>{++s,a.next(()=>{++i,o&&i===s&&t()},l=>r(l))}),o=!0,i===s&&t()})}static or(e){let t=z.resolve(!1);for(const r of e)t=t.next(s=>s?z.resolve(s):r());return t}static forEach(e,t){const r=[];return e.forEach((s,i)=>{r.push(t.call(this,s,i))}),this.waitFor(r)}static mapArray(e,t){return new z((r,s)=>{const i=e.length,o=new Array(i);let a=0;for(let l=0;l<i;l++){const c=l;t(e[c]).next(h=>{o[c]=h,++a,a===i&&r(o)},h=>s(h))}})}static doWhile(e,t){return new z((r,s)=>{const i=()=>{e()===!0?t().next(()=>{i()},s):r()};i()})}}function kx(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Ha(n){return n.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wf{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ie(r),this.se=r=>t.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Wf.oe=-1;function _u(n){return n==null}function _c(n){return n===0&&1/n==-1/0}function Rx(n){return typeof n=="number"&&Number.isInteger(n)&&!_c(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function oi(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function z0(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e,t){this.comparator=e,this.root=t||Tt.EMPTY}insert(e,t){return new Ke(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Tt.BLACK,null,null))}remove(e){return new Ke(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Tt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Sl(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Sl(this.root,e,this.comparator,!1)}getReverseIterator(){return new Sl(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Sl(this.root,e,this.comparator,!0)}}class Sl{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?r(e.key,t):1,t&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Tt{constructor(e,t,r,s,i){this.key=e,this.value=t,this.color=r??Tt.RED,this.left=s??Tt.EMPTY,this.right=i??Tt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,i){return new Tt(e??this.key,t??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,t,r),null):i===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Tt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Tt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Tt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Tt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw fe();const e=this.left.check();if(e!==this.right.check())throw fe();return e+(this.isRed()?0:1)}}Tt.EMPTY=null,Tt.RED=!0,Tt.BLACK=!1;Tt.EMPTY=new class{constructor(){this.size=0}get key(){throw fe()}get value(){throw fe()}get color(){throw fe()}get left(){throw fe()}get right(){throw fe()}copy(e,t,r,s,i){return this}insert(e,t,r){return new Tt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.comparator=e,this.data=new Ke(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ay(this.data.getIterator())}getIteratorFrom(e){return new Ay(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof It)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new It(this.comparator);return t.data=e,t}}class Ay{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rn{constructor(e){this.fields=e,e.sort(St.comparator)}static empty(){return new rn([])}unionWith(e){let t=new It(St.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new rn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Wi(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j0 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new j0("Invalid base64 string: "+i):i}}(e);return new Nt(t)}static fromUint8Array(e){const t=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Nt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nt.EMPTY_BYTE_STRING=new Nt("");const Px=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function as(n){if(Be(!!n),typeof n=="string"){let e=0;const t=Px.exec(n);if(Be(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:rt(n.seconds),nanos:rt(n.nanos)}}function rt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Js(n){return typeof n=="string"?Nt.fromBase64String(n):Nt.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kf(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function Gf(n){const e=n.mapValue.fields.__previous_value__;return Kf(e)?Gf(e):e}function Ta(n){const e=as(n.mapValue.fields.__local_write_time__.timestampValue);return new ct(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xx{constructor(e,t,r,s,i,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class wa{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new wa("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof wa&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Il={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Qs(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Kf(n)?4:Ox(n)?9007199254740991:10:fe()}function Wn(n,e){if(n===e)return!0;const t=Qs(n);if(t!==Qs(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Ta(n).isEqual(Ta(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=as(s.timestampValue),a=as(i.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(s,i){return Js(s.bytesValue).isEqual(Js(i.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(s,i){return rt(s.geoPointValue.latitude)===rt(i.geoPointValue.latitude)&&rt(s.geoPointValue.longitude)===rt(i.geoPointValue.longitude)}(n,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return rt(s.integerValue)===rt(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=rt(s.doubleValue),a=rt(i.doubleValue);return o===a?_c(o)===_c(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return Wi(n.arrayValue.values||[],e.arrayValue.values||[],Wn);case 10:return function(s,i){const o=s.mapValue.fields||{},a=i.mapValue.fields||{};if(Iy(o)!==Iy(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Wn(o[l],a[l])))return!1;return!0}(n,e);default:return fe()}}function ba(n,e){return(n.values||[]).find(t=>Wn(t,e))!==void 0}function Ki(n,e){if(n===e)return 0;const t=Qs(n),r=Qs(e);if(t!==r)return xe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,e.booleanValue);case 2:return function(i,o){const a=rt(i.integerValue||i.doubleValue),l=rt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return Cy(n.timestampValue,e.timestampValue);case 4:return Cy(Ta(n),Ta(e));case 5:return xe(n.stringValue,e.stringValue);case 6:return function(i,o){const a=Js(i),l=Js(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(i,o){const a=i.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const h=xe(a[c],l[c]);if(h!==0)return h}return xe(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,o){const a=xe(rt(i.latitude),rt(o.latitude));return a!==0?a:xe(rt(i.longitude),rt(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,o){const a=i.values||[],l=o.values||[];for(let c=0;c<a.length&&c<l.length;++c){const h=Ki(a[c],l[c]);if(h)return h}return xe(a.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,o){if(i===Il.mapValue&&o===Il.mapValue)return 0;if(i===Il.mapValue)return 1;if(o===Il.mapValue)return-1;const a=i.fields||{},l=Object.keys(a),c=o.fields||{},h=Object.keys(c);l.sort(),h.sort();for(let d=0;d<l.length&&d<h.length;++d){const f=xe(l[d],h[d]);if(f!==0)return f;const m=Ki(a[l[d]],c[h[d]]);if(m!==0)return m}return xe(l.length,h.length)}(n.mapValue,e.mapValue);default:throw fe()}}function Cy(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xe(n,e);const t=as(n),r=as(e),s=xe(t.seconds,r.seconds);return s!==0?s:xe(t.nanos,r.nanos)}function Gi(n){return Id(n)}function Id(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=as(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Js(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return le.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",s=!0;for(const i of t.values||[])s?s=!1:r+=",",r+=Id(i);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${Id(t.fields[o])}`;return s+"}"}(n.mapValue):fe()}function ky(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Ad(n){return!!n&&"integerValue"in n}function Jf(n){return!!n&&"arrayValue"in n}function Ry(n){return!!n&&"nullValue"in n}function Py(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ql(n){return!!n&&"mapValue"in n}function ea(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return oi(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ea(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ea(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ox(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.value=e}static empty(){return new Kt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ql(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ea(t)}setAll(e){let t=St.emptyPath(),r={},s=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,s),r={},s=[],t=a.popLast()}o?r[a.lastSegment()]=ea(o):s.push(a.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,r,s)}delete(e){const t=this.field(e.popLast());ql(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Wn(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];ql(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){oi(t,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Kt(ea(this.value))}}function H0(n){const e=[];return oi(n.fields,(t,r)=>{const s=new St([t]);if(ql(r)){const i=H0(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new rn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ot{constructor(e,t,r,s,i,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=a}static newInvalidDocument(e){return new Ot(e,0,pe.min(),pe.min(),pe.min(),Kt.empty(),0)}static newFoundDocument(e,t,r,s){return new Ot(e,1,t,pe.min(),r,s,0)}static newNoDocument(e,t){return new Ot(e,2,t,pe.min(),pe.min(),Kt.empty(),0)}static newUnknownDocument(e,t){return new Ot(e,3,t,pe.min(),pe.min(),Kt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ot&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ot(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ec{constructor(e,t){this.position=e,this.inclusive=t}}function xy(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const i=e[s],o=n.position[s];if(i.field.isKeyField()?r=le.comparator(le.fromName(o.referenceValue),t.key):r=Ki(o,t.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Oy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Wn(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e,t="asc"){this.field=e,this.dir=t}}function Mx(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q0{}class st extends q0{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new Dx(e,t,r):t==="array-contains"?new Fx(e,r):t==="in"?new Bx(e,r):t==="not-in"?new Ux(e,r):t==="array-contains-any"?new $x(e,r):new st(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new Lx(e,r):new Vx(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Ki(t,this.value)):t!==null&&Qs(this.value)===Qs(t)&&this.matchesComparison(Ki(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return fe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class kn extends q0{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new kn(e,t)}matches(e){return W0(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function W0(n){return n.op==="and"}function K0(n){return Nx(n)&&W0(n)}function Nx(n){for(const e of n.filters)if(e instanceof kn)return!1;return!0}function Cd(n){if(n instanceof st)return n.field.canonicalString()+n.op.toString()+Gi(n.value);if(K0(n))return n.filters.map(e=>Cd(e)).join(",");{const e=n.filters.map(t=>Cd(t)).join(",");return`${n.op}(${e})`}}function G0(n,e){return n instanceof st?function(r,s){return s instanceof st&&r.op===s.op&&r.field.isEqual(s.field)&&Wn(r.value,s.value)}(n,e):n instanceof kn?function(r,s){return s instanceof kn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,a)=>i&&G0(o,s.filters[a]),!0):!1}(n,e):void fe()}function J0(n){return n instanceof st?function(t){return`${t.field.canonicalString()} ${t.op} ${Gi(t.value)}`}(n):n instanceof kn?function(t){return t.op.toString()+" {"+t.getFilters().map(J0).join(" ,")+"}"}(n):"Filter"}class Dx extends st{constructor(e,t,r){super(e,t,r),this.key=le.fromName(r.referenceValue)}matches(e){const t=le.comparator(e.key,this.key);return this.matchesComparison(t)}}class Lx extends st{constructor(e,t){super(e,"in",t),this.keys=Q0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Vx extends st{constructor(e,t){super(e,"not-in",t),this.keys=Q0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Q0(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>le.fromName(r.referenceValue))}class Fx extends st{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jf(t)&&ba(t.arrayValue,this.value)}}class Bx extends st{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&ba(this.value.arrayValue,t)}}class Ux extends st{constructor(e,t){super(e,"not-in",t)}matches(e){if(ba(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!ba(this.value.arrayValue,t)}}class $x extends st{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jf(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>ba(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zx{constructor(e,t=null,r=[],s=[],i=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=a,this.ue=null}}function My(n,e=null,t=[],r=[],s=null,i=null,o=null){return new zx(n,e,t,r,s,i,o)}function Qf(n){const e=ye(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>Cd(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),_u(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Gi(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Gi(r)).join(",")),e.ue=t}return e.ue}function Yf(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Mx(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!G0(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Oy(n.startAt,e.startAt)&&Oy(n.endAt,e.endAt)}function kd(n){return le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,t=null,r=[],s=[],i=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function jx(n,e,t,r,s,i,o,a){return new qa(n,e,t,r,s,i,o,a)}function Xf(n){return new qa(n)}function Ny(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Y0(n){return n.collectionGroup!==null}function ta(n){const e=ye(n);if(e.ce===null){e.ce=[];const t=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),t.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new It(St.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(i=>{t.has(i.canonicalString())||i.isKeyField()||e.ce.push(new vc(i,r))}),t.has(St.keyField().canonicalString())||e.ce.push(new vc(St.keyField(),r))}return e.ce}function jn(n){const e=ye(n);return e.le||(e.le=Hx(e,ta(n))),e.le}function Hx(n,e){if(n.limitType==="F")return My(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new vc(s.field,i)});const t=n.endAt?new Ec(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ec(n.startAt.position,n.startAt.inclusive):null;return My(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Rd(n,e){const t=n.filters.concat([e]);return new qa(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Pd(n,e,t){return new qa(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Eu(n,e){return Yf(jn(n),jn(e))&&n.limitType===e.limitType}function X0(n){return`${Qf(jn(n))}|lt:${n.limitType}`}function Ei(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(s=>J0(s)).join(", ")}]`),_u(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(s=>Gi(s)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(s=>Gi(s)).join(",")),`Target(${r})`}(jn(n))}; limitType=${n.limitType})`}function vu(n,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):le.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(n,e)&&function(r,s){for(const i of ta(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(n,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(n,e)&&function(r,s){return!(r.startAt&&!function(o,a,l){const c=xy(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,ta(r),s)||r.endAt&&!function(o,a,l){const c=xy(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,ta(r),s))}(n,e)}function qx(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Z0(n){return(e,t)=>{let r=!1;for(const s of ta(n)){const i=Wx(s,e,t);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Wx(n,e,t){const r=n.field.isKeyField()?le.comparator(e.key,t.key):function(i,o,a){const l=o.data.field(i),c=a.data.field(i);return l!==null&&c!==null?Ki(l,c):fe()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return fe()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){oi(this.inner,(t,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return z0(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kx=new Ke(le.comparator);function hr(){return Kx}const eT=new Ke(le.comparator);function Vo(...n){let e=eT;for(const t of n)e=e.insert(t.key,t);return e}function tT(n){let e=eT;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function xs(){return na()}function nT(){return na()}function na(){return new lo(n=>n.toString(),(n,e)=>n.isEqual(e))}const Gx=new Ke(le.comparator),Jx=new It(le.comparator);function we(...n){let e=Jx;for(const t of n)e=e.add(t);return e}const Qx=new It(xe);function Yx(){return Qx}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rT(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:_c(e)?"-0":e}}function sT(n){return{integerValue:""+n}}function Xx(n,e){return Rx(e)?sT(e):rT(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(){this._=void 0}}function Zx(n,e,t){return n instanceof Tc?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Kf(i)&&(i=Gf(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(t,e):n instanceof Sa?oT(n,e):n instanceof Ia?aT(n,e):function(s,i){const o=iT(s,i),a=Dy(o)+Dy(s.Pe);return Ad(o)&&Ad(s.Pe)?sT(a):rT(s.serializer,a)}(n,e)}function eO(n,e,t){return n instanceof Sa?oT(n,e):n instanceof Ia?aT(n,e):t}function iT(n,e){return n instanceof wc?function(r){return Ad(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Tc extends Tu{}class Sa extends Tu{constructor(e){super(),this.elements=e}}function oT(n,e){const t=lT(e);for(const r of n.elements)t.some(s=>Wn(s,r))||t.push(r);return{arrayValue:{values:t}}}class Ia extends Tu{constructor(e){super(),this.elements=e}}function aT(n,e){let t=lT(e);for(const r of n.elements)t=t.filter(s=>!Wn(s,r));return{arrayValue:{values:t}}}class wc extends Tu{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Dy(n){return rt(n.integerValue||n.doubleValue)}function lT(n){return Jf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function tO(n,e){return n.field.isEqual(e.field)&&function(r,s){return r instanceof Sa&&s instanceof Sa||r instanceof Ia&&s instanceof Ia?Wi(r.elements,s.elements,Wn):r instanceof wc&&s instanceof wc?Wn(r.Pe,s.Pe):r instanceof Tc&&s instanceof Tc}(n.transform,e.transform)}class nO{constructor(e,t){this.version=e,this.transformResults=t}}class Sn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Sn}static exists(e){return new Sn(void 0,e)}static updateTime(e){return new Sn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wl(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class wu{}function cT(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Zf(n.key,Sn.none()):new Wa(n.key,n.data,Sn.none());{const t=n.data,r=Kt.empty();let s=new It(St.comparator);for(let i of e.fields)if(!s.has(i)){let o=t.field(i);o===null&&i.length>1&&(i=i.popLast(),o=t.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new hs(n.key,r,new rn(s.toArray()),Sn.none())}}function rO(n,e,t){n instanceof Wa?function(s,i,o){const a=s.value.clone(),l=Vy(s.fieldTransforms,i,o.transformResults);a.setAll(l),i.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof hs?function(s,i,o){if(!Wl(s.precondition,i))return void i.convertToUnknownDocument(o.version);const a=Vy(s.fieldTransforms,i,o.transformResults),l=i.data;l.setAll(uT(s)),l.setAll(a),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function ra(n,e,t,r){return n instanceof Wa?function(i,o,a,l){if(!Wl(i.precondition,o))return a;const c=i.value.clone(),h=Fy(i.fieldTransforms,l,o);return c.setAll(h),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(n,e,t,r):n instanceof hs?function(i,o,a,l){if(!Wl(i.precondition,o))return a;const c=Fy(i.fieldTransforms,l,o),h=o.data;return h.setAll(uT(i)),h.setAll(c),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(d=>d.field))}(n,e,t,r):function(i,o,a){return Wl(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,e,t)}function sO(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),i=iT(r.transform,s||null);i!=null&&(t===null&&(t=Kt.empty()),t.set(r.field,i))}return t||null}function Ly(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Wi(r,s,(i,o)=>tO(i,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Wa extends wu{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class hs extends wu{constructor(e,t,r,s,i=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function uT(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Vy(n,e,t){const r=new Map;Be(n.length===t.length);for(let s=0;s<t.length;s++){const i=n[s],o=i.transform,a=e.data.field(i.field);r.set(i.field,eO(o,a,t[s]))}return r}function Fy(n,e,t){const r=new Map;for(const s of n){const i=s.transform,o=t.data.field(s.field);r.set(s.field,Zx(i,o,e))}return r}class Zf extends wu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class iO extends wu{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oO{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&rO(i,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=ra(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=ra(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=nT();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let a=this.applyToLocalView(o,i.mutatedFields);a=t.has(s.key)?null:a;const l=cT(o,a);l!==null&&r.set(s.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),we())}isEqual(e){return this.batchId===e.batchId&&Wi(this.mutations,e.mutations,(t,r)=>Ly(t,r))&&Wi(this.baseMutations,e.baseMutations,(t,r)=>Ly(t,r))}}class ep{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){Be(e.mutations.length===r.length);let s=function(){return Gx}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new ep(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aO{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lO{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nt,Ae;function cO(n){switch(n){default:return fe();case U.CANCELLED:case U.UNKNOWN:case U.DEADLINE_EXCEEDED:case U.RESOURCE_EXHAUSTED:case U.INTERNAL:case U.UNAVAILABLE:case U.UNAUTHENTICATED:return!1;case U.INVALID_ARGUMENT:case U.NOT_FOUND:case U.ALREADY_EXISTS:case U.PERMISSION_DENIED:case U.FAILED_PRECONDITION:case U.ABORTED:case U.OUT_OF_RANGE:case U.UNIMPLEMENTED:case U.DATA_LOSS:return!0}}function hT(n){if(n===void 0)return ur("GRPC error has no .code"),U.UNKNOWN;switch(n){case nt.OK:return U.OK;case nt.CANCELLED:return U.CANCELLED;case nt.UNKNOWN:return U.UNKNOWN;case nt.DEADLINE_EXCEEDED:return U.DEADLINE_EXCEEDED;case nt.RESOURCE_EXHAUSTED:return U.RESOURCE_EXHAUSTED;case nt.INTERNAL:return U.INTERNAL;case nt.UNAVAILABLE:return U.UNAVAILABLE;case nt.UNAUTHENTICATED:return U.UNAUTHENTICATED;case nt.INVALID_ARGUMENT:return U.INVALID_ARGUMENT;case nt.NOT_FOUND:return U.NOT_FOUND;case nt.ALREADY_EXISTS:return U.ALREADY_EXISTS;case nt.PERMISSION_DENIED:return U.PERMISSION_DENIED;case nt.FAILED_PRECONDITION:return U.FAILED_PRECONDITION;case nt.ABORTED:return U.ABORTED;case nt.OUT_OF_RANGE:return U.OUT_OF_RANGE;case nt.UNIMPLEMENTED:return U.UNIMPLEMENTED;case nt.DATA_LOSS:return U.DATA_LOSS;default:return fe()}}(Ae=nt||(nt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uO(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hO=new Vs([4294967295,4294967295],0);function By(n){const e=uO().encode(n),t=new M0;return t.update(e),new Uint8Array(t.digest())}function Uy(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Vs([t,r],0),new Vs([s,i],0)]}class tp{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Fo(`Invalid padding: ${t}`);if(r<0)throw new Fo(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Fo(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Fo(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Vs.fromNumber(this.Ie)}Ee(e,t,r){let s=e.add(t.multiply(Vs.fromNumber(r)));return s.compare(hO)===1&&(s=new Vs([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const t=By(e),[r,s]=Uy(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new tp(i,s,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const t=By(e),[r,s]=Uy(t);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Fo extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e,t,r,s,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Ka.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new bu(pe.min(),s,new Ke(xe),hr(),we())}}class Ka{constructor(e,t,r,s,i){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Ka(r,t,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,t,r,s){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=s}}class dT{constructor(e,t){this.targetId=e,this.me=t}}class fT{constructor(e,t,r=Nt.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class $y{constructor(){this.fe=0,this.ge=jy(),this.pe=Nt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}Ce(){let e=we(),t=we(),r=we();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:fe()}}),new Ka(this.pe,this.ye,e,t,r)}ve(){this.we=!1,this.ge=jy()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Be(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class dO{constructor(e){this.Le=e,this.Be=new Map,this.ke=hr(),this.qe=zy(),this.Qe=new Ke(xe)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.ve(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:fe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,s)=>{this.ze(s)&&t(s)})}He(e){const t=e.targetId,r=e.me.count,s=this.Je(t);if(s){const i=s.target;if(kd(i))if(r===0){const o=new le(i.path);this.Ue(t,o,Ot.newNoDocument(o,pe.min()))}else Be(r===1);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(t);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,c)}}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=t;let o,a;try{o=Js(r).toUint8Array()}catch(l){if(l instanceof j0)return qi("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new tp(o,s,i)}catch(l){return qi(l instanceof Fo?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let s=0;return r.forEach(i=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,i,null),s++)}),s}rt(e){const t=new Map;this.Be.forEach((i,o)=>{const a=this.Je(o);if(a){if(i.current&&kd(a.target)){const l=new le(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,Ot.newNoDocument(l,e))}i.be&&(t.set(o,i.Ce()),i.ve())}});let r=we();this.qe.forEach((i,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new bu(e,t,this.Qe,this.ke,r);return this.ke=hr(),this.qe=zy(),this.Qe=new Ke(xe),s}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,t)?s.Fe(t,1):s.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).Ce();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new $y,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new It(xe),this.qe=this.qe.insert(e,t)),t}ze(e){const t=this.Je(e)!==null;return t||se("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new $y),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function zy(){return new Ke(le.comparator)}function jy(){return new Ke(le.comparator)}const fO={asc:"ASCENDING",desc:"DESCENDING"},pO={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mO={and:"AND",or:"OR"};class gO{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xd(n,e){return n.useProto3Json||_u(e)?e:{value:e}}function bc(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function pT(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function yO(n,e){return bc(n,e.toTimestamp())}function Hn(n){return Be(!!n),pe.fromTimestamp(function(t){const r=as(t);return new ct(r.seconds,r.nanos)}(n))}function np(n,e){return Od(n,e).canonicalString()}function Od(n,e){const t=function(s){return new ze(["projects",s.projectId,"databases",s.database])}(n).child("documents");return e===void 0?t:t.child(e)}function mT(n){const e=ze.fromString(n);return Be(vT(e)),e}function Md(n,e){return np(n.databaseId,e.path)}function Sh(n,e){const t=mT(e);if(t.get(1)!==n.databaseId.projectId)throw new te(U.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new te(U.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new le(yT(t))}function gT(n,e){return np(n.databaseId,e)}function _O(n){const e=mT(n);return e.length===4?ze.emptyPath():yT(e)}function Nd(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function yT(n){return Be(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function Hy(n,e,t){return{name:Md(n,e),fields:t.value.mapValue.fields}}function EO(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:fe()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(c,h){return c.useProto3Json?(Be(h===void 0||typeof h=="string"),Nt.fromBase64String(h||"")):(Be(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Nt.fromUint8Array(h||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const h=c.code===void 0?U.UNKNOWN:hT(c.code);return new te(h,c.message||"")}(o);t=new fT(r,s,i,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Sh(n,r.document.name),i=Hn(r.document.updateTime),o=r.document.createTime?Hn(r.document.createTime):pe.min(),a=new Kt({mapValue:{fields:r.document.fields}}),l=Ot.newFoundDocument(s,i,o,a),c=r.targetIds||[],h=r.removedTargetIds||[];t=new Kl(c,h,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Sh(n,r.document),i=r.readTime?Hn(r.readTime):pe.min(),o=Ot.newNoDocument(s,i),a=r.removedTargetIds||[];t=new Kl([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Sh(n,r.document),i=r.removedTargetIds||[];t=new Kl([],i,s,null)}else{if(!("filter"in e))return fe();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new lO(s,i),a=r.targetId;t=new dT(a,o)}}return t}function vO(n,e){let t;if(e instanceof Wa)t={update:Hy(n,e.key,e.value)};else if(e instanceof Zf)t={delete:Md(n,e.key)};else if(e instanceof hs)t={update:Hy(n,e.key,e.data),updateMask:RO(e.fieldMask)};else{if(!(e instanceof iO))return fe();t={verify:Md(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const a=o.transform;if(a instanceof Tc)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Sa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ia)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof wc)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw fe()}(0,r))),e.precondition.isNone||(t.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:yO(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:fe()}(n,e.precondition)),t}function TO(n,e){return n&&n.length>0?(Be(e!==void 0),n.map(t=>function(s,i){let o=s.updateTime?Hn(s.updateTime):Hn(i);return o.isEqual(pe.min())&&(o=Hn(i)),new nO(o,s.transformResults||[])}(t,e))):[]}function wO(n,e){return{documents:[gT(n,e.path)]}}function bO(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=gT(n,s);const i=function(c){if(c.length!==0)return ET(kn.create(c,"and"))}(e.filters);i&&(t.structuredQuery.where=i);const o=function(c){if(c.length!==0)return c.map(h=>function(f){return{field:vi(f.field),direction:AO(f.dir)}}(h))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=xd(n,e.limit);return a!==null&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:t,parent:s}}function SO(n){let e=_O(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){Be(r===1);const h=t.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];t.where&&(i=function(d){const f=_T(d);return f instanceof kn&&K0(f)?f.getFilters():[f]}(t.where));let o=[];t.orderBy&&(o=function(d){return d.map(f=>function(y){return new vc(Ti(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(f))}(t.orderBy));let a=null;t.limit&&(a=function(d){let f;return f=typeof d=="object"?d.value:d,_u(f)?null:f}(t.limit));let l=null;t.startAt&&(l=function(d){const f=!!d.before,m=d.values||[];return new Ec(m,f)}(t.startAt));let c=null;return t.endAt&&(c=function(d){const f=!d.before,m=d.values||[];return new Ec(m,f)}(t.endAt)),jx(e,s,o,i,a,"F",l,c)}function IO(n,e){const t=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return fe()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function _T(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ti(t.unaryFilter.field);return st.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ti(t.unaryFilter.field);return st.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ti(t.unaryFilter.field);return st.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ti(t.unaryFilter.field);return st.create(o,"!=",{nullValue:"NULL_VALUE"});default:return fe()}}(n):n.fieldFilter!==void 0?function(t){return st.create(Ti(t.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return fe()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return kn.create(t.compositeFilter.filters.map(r=>_T(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return fe()}}(t.compositeFilter.op))}(n):fe()}function AO(n){return fO[n]}function CO(n){return pO[n]}function kO(n){return mO[n]}function vi(n){return{fieldPath:n.canonicalString()}}function Ti(n){return St.fromServerFormat(n.fieldPath)}function ET(n){return n instanceof st?function(t){if(t.op==="=="){if(Py(t.value))return{unaryFilter:{field:vi(t.field),op:"IS_NAN"}};if(Ry(t.value))return{unaryFilter:{field:vi(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Py(t.value))return{unaryFilter:{field:vi(t.field),op:"IS_NOT_NAN"}};if(Ry(t.value))return{unaryFilter:{field:vi(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vi(t.field),op:CO(t.op),value:t.value}}}(n):n instanceof kn?function(t){const r=t.getFilters().map(s=>ET(s));return r.length===1?r[0]:{compositeFilter:{op:kO(t.op),filters:r}}}(n):fe()}function RO(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function vT(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{constructor(e,t,r,s,i=pe.min(),o=pe.min(),a=Nt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Ur(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ur(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e){this.ct=e}}function xO(n){const e=SO({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Pd(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OO{constructor(){this._n=new MO}addToCollectionParentIndex(e,t){return this._n.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(is.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(is.min())}updateCollectionGroup(e,t,r){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class MO{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new It(ze.comparator),i=!s.has(r);return this.index[t]=s.add(r),i}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new It(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Ji(0)}static Ln(){return new Ji(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NO{constructor(){this.changes=new lo(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ot.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,t))).next(s=>(r!==null&&ra(r.mutation,s,rn.empty(),ct.now()),s))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,we()).next(()=>r))}getLocalViewOfDocuments(e,t,r=we()){const s=xs();return this.populateOverlays(e,s,t).next(()=>this.computeViews(e,t,s,r).next(i=>{let o=Vo();return i.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=xs();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,we()))}populateOverlays(e,t,r){const s=[];return r.forEach(i=>{t.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,s){let i=hr();const o=na(),a=function(){return na()}();return t.forEach((l,c)=>{const h=r.get(c.key);s.has(c.key)&&(h===void 0||h.mutation instanceof hs)?i=i.insert(c.key,c):h!==void 0?(o.set(c.key,h.mutation.getFieldMask()),ra(h.mutation,c,h.mutation.getFieldMask(),ct.now())):o.set(c.key,rn.empty())}),this.recalculateAndSaveOverlays(e,i).next(l=>(l.forEach((c,h)=>o.set(c,h)),t.forEach((c,h)=>{var d;return a.set(c,new DO(h,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,t){const r=na();let s=new Ke((o,a)=>o-a),i=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=t.get(l);if(c===null)return;let h=r.get(l)||rn.empty();h=a.applyToLocalView(c,h),r.set(l,h);const d=(s.get(a.batchId)||we()).add(l);s=s.insert(a.batchId,d)})}).next(()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,h=l.value,d=nT();h.forEach(f=>{if(!i.has(f)){const m=cT(t.get(f),r.get(f));m!==null&&d.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return z.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,s){return function(o){return le.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Y0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-i.size):z.resolve(xs());let a=-1,l=i;return o.next(c=>z.forEach(c,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),i.get(h)?z.resolve():this.remoteDocumentCache.getEntry(e,h).next(f=>{l=l.insert(h,f)}))).next(()=>this.populateOverlays(e,c,i)).next(()=>this.computeViews(e,l,c,we())).next(h=>({batchId:a,changes:tT(h)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new le(t)).next(r=>{let s=Vo();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const i=t.collectionGroup;let o=Vo();return this.indexManager.getCollectionParents(e,i).next(a=>z.forEach(a,l=>{const c=function(d,f){return new qa(f,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(t,l.child(i));return this.getDocumentsMatchingCollectionQuery(e,c,r,s).next(h=>{h.forEach((d,f)=>{o=o.insert(d,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,i,s))).next(o=>{i.forEach((l,c)=>{const h=c.getKey();o.get(h)===null&&(o=o.insert(h,Ot.newInvalidDocument(h)))});let a=Vo();return o.forEach((l,c)=>{const h=i.get(l);h!==void 0&&ra(h.mutation,c,rn.empty(),ct.now()),vu(t,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VO{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return z.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(s){return{id:s.id,version:s.version,createTime:Hn(s.createTime)}}(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(s){return{name:s.name,query:xO(s.bundledQuery),readTime:Hn(s.readTime)}}(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FO{constructor(){this.overlays=new Ke(le.comparator),this.hr=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=xs();return z.forEach(t,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((s,i)=>{this.ht(e,t,i)}),z.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.hr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.hr.delete(r)),z.resolve()}getOverlaysForCollection(e,t,r){const s=xs(),i=t.length+1,o=new le(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!t.isPrefixOf(c.path))break;c.path.length===i&&l.largestBatchId>r&&s.set(l.getKey(),l)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let i=new Ke((c,h)=>c-h);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===t&&c.largestBatchId>r){let h=i.get(c.largestBatchId);h===null&&(h=xs(),i=i.insert(c.largestBatchId,h)),h.set(c.getKey(),c)}}const a=xs(),l=i.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,h)=>a.set(c,h)),!(a.size()>=s)););return z.resolve(a)}ht(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.hr.get(s.largestBatchId).delete(r.key);this.hr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new aO(t,r));let i=this.hr.get(t);i===void 0&&(i=we(),this.hr.set(t,i)),this.hr.set(t,i.add(r.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(){this.Pr=new It(ft.Ir),this.Tr=new It(ft.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const r=new ft(e,t);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Ar(new ft(e,t))}Rr(e,t){e.forEach(r=>this.removeReference(r,t))}Vr(e){const t=new le(new ze([])),r=new ft(t,e),s=new ft(t,e+1),i=[];return this.Tr.forEachInRange([r,s],o=>{this.Ar(o),i.push(o.key)}),i}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new le(new ze([])),r=new ft(t,e),s=new ft(t,e+1);let i=we();return this.Tr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const t=new ft(e,0),r=this.Pr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class ft{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return le.comparator(e.key,t.key)||xe(e.pr,t.pr)}static Er(e,t){return xe(e.pr,t.pr)||le.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BO{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new It(ft.Ir)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const i=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new oO(i,t,r,s);this.mutationQueue.push(o);for(const a of s)this.wr=this.wr.add(new ft(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return z.resolve(o)}lookupMutationBatch(e,t){return z.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.br(r),i=s<0?0:s;return z.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ft(t,0),s=new ft(t,Number.POSITIVE_INFINITY),i=[];return this.wr.forEachInRange([r,s],o=>{const a=this.Sr(o.pr);i.push(a)}),z.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new It(xe);return t.forEach(s=>{const i=new ft(s,0),o=new ft(s,Number.POSITIVE_INFINITY);this.wr.forEachInRange([i,o],a=>{r=r.add(a.pr)})}),z.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let i=r;le.isDocumentKey(i)||(i=i.child(""));const o=new ft(new le(i),0);let a=new It(xe);return this.wr.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===s&&(a=a.add(l.pr)),!0)},o),z.resolve(this.Dr(a))}Dr(e){const t=[];return e.forEach(r=>{const s=this.Sr(r);s!==null&&t.push(s)}),t}removeMutationBatch(e,t){Be(this.Cr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return z.forEach(t.mutations,s=>{const i=new ft(s.key,t.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,t){const r=new ft(t,0),s=this.wr.firstAfterOrEqual(r);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}Cr(e,t){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(e){this.vr=e,this.docs=function(){return new Ke(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),i=s?s.size:0,o=this.vr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return z.resolve(r?r.document.mutableCopy():Ot.newInvalidDocument(t))}getEntries(e,t){let r=hr();return t.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Ot.newInvalidDocument(s))}),z.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let i=hr();const o=t.path,a=new le(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:h}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Ix(Sx(h),r)<=0||(s.has(h.key)||vu(t,h))&&(i=i.insert(h.key,h.mutableCopy()))}return z.resolve(i)}getAllFromCollectionGroup(e,t,r,s){fe()}Fr(e,t){return z.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new $O(this)}getSize(e){return z.resolve(this.size)}}class $O extends NO{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?t.push(this.ar.addEntry(e,s)):this.ar.removeEntry(r)}),z.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zO{constructor(e){this.persistence=e,this.Mr=new lo(t=>Qf(t),Yf),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.Or=0,this.Nr=new rp,this.targetCount=0,this.Lr=Ji.Nn()}forEachTarget(e,t){return this.Mr.forEach((r,s)=>t(s)),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Lr.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Or&&(this.Or=t),z.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Lr=new Ji(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.qn(t),z.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,r){let s=0;const i=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=t&&r.get(a.targetId)===null&&(this.Mr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),s++)}),z.waitFor(i).next(()=>s)}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const r=this.Mr.get(t)||null;return z.resolve(r)}addMatchingKeys(e,t,r){return this.Nr.dr(t,r),z.resolve()}removeMatchingKeys(e,t,r){this.Nr.Rr(t,r);const s=this.persistence.referenceDelegate,i=[];return s&&t.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),z.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Nr.gr(t);return z.resolve(r)}containsKey(e,t){return z.resolve(this.Nr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jO{constructor(e,t){this.Br={},this.overlays={},this.kr=new Wf(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new zO(this),this.indexManager=new OO,this.remoteDocumentCache=function(s){return new UO(s)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new PO(t),this.$r=new VO(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new FO,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Br[e.toKey()];return r||(r=new BO(t,this.referenceDelegate),this.Br[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,r){se("MemoryPersistence","Starting transaction:",e);const s=new HO(this.kr.next());return this.referenceDelegate.Ur(),r(s).next(i=>this.referenceDelegate.Wr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Gr(e,t){return z.or(Object.values(this.Br).map(r=>()=>r.containsKey(e,t)))}}class HO extends Cx{constructor(e){super(),this.currentSequenceNumber=e}}class sp{constructor(e){this.persistence=e,this.zr=new rp,this.jr=null}static Hr(e){return new sp(e)}get Jr(){if(this.jr)return this.jr;throw fe()}addReference(e,t,r){return this.zr.addReference(r,t),this.Jr.delete(r.toString()),z.resolve()}removeReference(e,t,r){return this.zr.removeReference(r,t),this.Jr.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),z.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(s=>this.Jr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(i=>this.Jr.add(i.toString()))}).next(()=>r.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.Jr,r=>{const s=le.fromPath(r);return this.Yr(e,s).next(i=>{i||t.removeEntry(s,pe.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(r=>{r?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return z.or([()=>z.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.qi=r,this.Qi=s}static Ki(e,t){let r=we(),s=we();for(const i of t.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ip(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qO{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WO{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return MC()?8:kx(At())>0?6:4}()}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,r,s){const i={result:null};return this.ji(e,t).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Hi(e,t,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new qO;return this.Ji(e,t,o).next(a=>{if(i.result=a,this.Ui)return this.Yi(e,t,o,a.size)})}).next(()=>i.result)}Yi(e,t,r,s){return r.documentReadCount<this.Wi?(Po()<=be.DEBUG&&se("QueryEngine","SDK will not create cache indexes for query:",Ei(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),z.resolve()):(Po()<=be.DEBUG&&se("QueryEngine","Query:",Ei(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Gi*s?(Po()<=be.DEBUG&&se("QueryEngine","The SDK decides to create cache indexes for query:",Ei(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,jn(t))):z.resolve())}ji(e,t){if(Ny(t))return z.resolve(null);let r=jn(t);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(t.limit!==null&&s===1&&(t=Pd(t,null,"F"),r=jn(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=we(...i);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.Zi(t,a);return this.Xi(t,c,o,l.readTime)?this.ji(e,Pd(t,null,"F")):this.es(e,c,t,l)}))})))}Hi(e,t,r,s){return Ny(t)||s.isEqual(pe.min())?z.resolve(null):this.zi.getDocuments(e,r).next(i=>{const o=this.Zi(t,i);return this.Xi(t,o,r,s)?z.resolve(null):(Po()<=be.DEBUG&&se("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ei(t)),this.es(e,o,t,bx(s,-1)).next(a=>a))})}Zi(e,t){let r=new It(Z0(e));return t.forEach((s,i)=>{vu(e,i)&&(r=r.add(i))}),r}Xi(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const i=e.limitType==="F"?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Ji(e,t,r){return Po()<=be.DEBUG&&se("QueryEngine","Using full collection scan to execute query:",Ei(t)),this.zi.getDocumentsMatchingQuery(e,t,is.min(),r)}es(e,t,r,s){return this.zi.getDocumentsMatchingQuery(e,r,s).next(i=>(t.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KO{constructor(e,t,r,s){this.persistence=e,this.ts=t,this.serializer=s,this.ns=new Ke(xe),this.rs=new lo(i=>Qf(i),Yf),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new LO(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}}function GO(n,e,t,r){return new KO(n,e,t,r)}async function TT(n,e){const t=ye(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,t._s(e),t.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],a=[];let l=we();for(const c of s){o.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}for(const c of i){a.push(c.batchId);for(const h of c.mutations)l=l.add(h.key)}return t.localDocuments.getDocuments(r,l).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})}function JO(n,e){const t=ye(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=t.os.newChangeBuffer({trackRemovals:!0});return function(a,l,c,h){const d=c.batch,f=d.keys();let m=z.resolve();return f.forEach(y=>{m=m.next(()=>h.getEntry(l,y)).next(T=>{const w=c.docVersions.get(y);Be(w!==null),T.version.compareTo(w)<0&&(d.applyToRemoteDocument(T,c),T.isValidDocument()&&(T.setReadTime(c.commitVersion),h.addEntry(T)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,d))}(t,r,e,i).next(()=>i.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=we();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,s))})}function wT(n){const e=ye(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Qr.getLastRemoteSnapshotVersion(t))}function QO(n,e){const t=ye(n),r=e.snapshotVersion;let s=t.ns;return t.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=t.os.newChangeBuffer({trackRemovals:!0});s=t.ns;const a=[];e.targetChanges.forEach((h,d)=>{const f=s.get(d);if(!f)return;a.push(t.Qr.removeMatchingKeys(i,h.removedDocuments,d).next(()=>t.Qr.addMatchingKeys(i,h.addedDocuments,d)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(d)!==null?m=m.withResumeToken(Nt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):h.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(h.resumeToken,r)),s=s.insert(d,m),function(T,w,P){return T.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=3e8?!0:P.addedDocuments.size+P.modifiedDocuments.size+P.removedDocuments.size>0}(f,m,h)&&a.push(t.Qr.updateTargetData(i,m))});let l=hr(),c=we();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(i,h))}),a.push(YO(i,o,e.documentUpdates).next(h=>{l=h.cs,c=h.ls})),!r.isEqual(pe.min())){const h=t.Qr.getLastRemoteSnapshotVersion(i).next(d=>t.Qr.setTargetsMetadata(i,i.currentSequenceNumber,r));a.push(h)}return z.waitFor(a).next(()=>o.apply(i)).next(()=>t.localDocuments.getLocalViewOfDocuments(i,l,c)).next(()=>l)}).then(i=>(t.ns=s,i))}function YO(n,e,t){let r=we(),s=we();return t.forEach(i=>r=r.add(i)),e.getEntries(n,r).next(i=>{let o=hr();return t.forEach((a,l)=>{const c=i.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(s=s.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):se("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{cs:o,ls:s}})}function XO(n,e){const t=ye(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function ZO(n,e){const t=ye(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return t.Qr.getTargetData(r,e).next(i=>i?(s=i,z.resolve(s)):t.Qr.allocateTargetId(r).next(o=>(s=new Ur(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Qr.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=t.ns.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.ns=t.ns.insert(r.targetId,r),t.rs.set(e,r.targetId)),r})}async function Dd(n,e,t){const r=ye(n),s=r.ns.get(e),i=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Ha(o))throw o;se("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(s.target)}function qy(n,e,t){const r=ye(n);let s=pe.min(),i=we();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,h){const d=ye(l),f=d.rs.get(h);return f!==void 0?z.resolve(d.ns.get(f)):d.Qr.getTargetData(c,h)}(r,o,jn(e)).next(a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(l=>{i=l})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,t?s:pe.min(),t?i:we())).next(a=>(eM(r,qx(e),a),{documents:a,hs:i})))}function eM(n,e,t){let r=n.ss.get(e)||pe.min();t.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),n.ss.set(e,r)}class Wy{constructor(){this.activeTargetIds=Yx()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class tM{constructor(){this.no=new Wy,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,r){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new Wy,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{io(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ky{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){se("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){se("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Al=null;function Ih(){return Al===null?Al=function(){return 268435456+Math.round(2147483648*Math.random())}():Al++,"0x"+Al.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rM={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sM{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}Ao(e){this.Ro=e}onMessage(e){this.Vo=e}close(){this.ho()}send(e){this.lo(e)}mo(){this.Io()}fo(){this.Eo()}po(e){this.Ro(e)}yo(e){this.Vo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rt="WebChannelConnection";class iM extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.wo=r+"://"+t.host,this.So=`projects/${s}/databases/${i}`,this.bo=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Do(){return!1}Co(t,r,s,i,o){const a=Ih(),l=this.vo(t,r.toUriEncodedString());se("RestConnection",`Sending RPC '${t}' ${a}:`,l,s);const c={"google-cloud-resource-prefix":this.So,"x-goog-request-params":this.bo};return this.Fo(c,i,o),this.Mo(t,l,c,s).then(h=>(se("RestConnection",`Received RPC '${t}' ${a}: `,h),h),h=>{throw qi("RestConnection",`RPC '${t}' ${a} failed with error: `,h,"url: ",l,"request:",s),h})}xo(t,r,s,i,o,a){return this.Co(t,r,s,i,o)}Fo(t,r,s){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ao}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>t[o]=i),s&&s.headers.forEach((i,o)=>t[o]=i)}vo(t,r){const s=rM[t];return`${this.wo}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Mo(e,t,r,s){const i=Ih();return new Promise((o,a)=>{const l=new N0;l.setWithCredentials(!0),l.listenOnce(L0.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Hl.NO_ERROR:const h=l.getResponseJson();se(Rt,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Hl.TIMEOUT:se(Rt,`RPC '${e}' ${i} timed out`),a(new te(U.DEADLINE_EXCEEDED,"Request time out"));break;case Hl.HTTP_ERROR:const d=l.getStatus();if(se(Rt,`RPC '${e}' ${i} failed with status:`,d,"response text:",l.getResponseText()),d>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const y=function(w){const P=w.toLowerCase().replace(/_/g,"-");return Object.values(U).indexOf(P)>=0?P:U.UNKNOWN}(m.status);a(new te(y,m.message))}else a(new te(U.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new te(U.UNAVAILABLE,"Connection failed."));break;default:fe()}}finally{se(Rt,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(s);se(Rt,`RPC '${e}' ${i} sending request:`,s),l.send(t,"POST",c,r,15)})}Oo(e,t,r){const s=Ih(),i=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=B0(),a=F0(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.xmlHttpFactory=new D0({})),this.Fo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const h=i.join("");se(Rt,`Creating RPC '${e}' stream ${s}: ${h}`,l);const d=o.createWebChannel(h,l);let f=!1,m=!1;const y=new sM({lo:w=>{m?se(Rt,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(f||(se(Rt,`Opening RPC '${e}' stream ${s} transport.`),d.open(),f=!0),se(Rt,`RPC '${e}' stream ${s} sending:`,w),d.send(w))},ho:()=>d.close()}),T=(w,P,O)=>{w.listen(P,D=>{try{O(D)}catch($){setTimeout(()=>{throw $},0)}})};return T(d,Lo.EventType.OPEN,()=>{m||(se(Rt,`RPC '${e}' stream ${s} transport opened.`),y.mo())}),T(d,Lo.EventType.CLOSE,()=>{m||(m=!0,se(Rt,`RPC '${e}' stream ${s} transport closed`),y.po())}),T(d,Lo.EventType.ERROR,w=>{m||(m=!0,qi(Rt,`RPC '${e}' stream ${s} transport errored:`,w),y.po(new te(U.UNAVAILABLE,"The operation could not be completed")))}),T(d,Lo.EventType.MESSAGE,w=>{var P;if(!m){const O=w.data[0];Be(!!O);const D=O,$=D.error||((P=D[0])===null||P===void 0?void 0:P.error);if($){se(Rt,`RPC '${e}' stream ${s} received error:`,$);const q=$.status;let F=function(v){const I=nt[v];if(I!==void 0)return hT(I)}(q),A=$.message;F===void 0&&(F=U.INTERNAL,A="Unknown error status: "+q+" with message "+$.message),m=!0,y.po(new te(F,A)),d.close()}else se(Rt,`RPC '${e}' stream ${s} received:`,O),y.yo(O)}}),T(a,V0.STAT_EVENT,w=>{w.stat===Sd.PROXY?se(Rt,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===Sd.NOPROXY&&se(Rt,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{y.fo()},0),y}}function Ah(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(n){return new gO(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(e,t,r=1e3,s=1.5,i=6e4){this.oi=e,this.timerId=t,this.No=r,this.Lo=s,this.Bo=i,this.ko=0,this.qo=null,this.Qo=Date.now(),this.reset()}reset(){this.ko=0}Ko(){this.ko=this.Bo}$o(e){this.cancel();const t=Math.floor(this.ko+this.Uo()),r=Math.max(0,Date.now()-this.Qo),s=Math.max(0,t-r);s>0&&se("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.qo=this.oi.enqueueAfterDelay(this.timerId,s,()=>(this.Qo=Date.now(),e())),this.ko*=this.Lo,this.ko<this.No&&(this.ko=this.No),this.ko>this.Bo&&(this.ko=this.Bo)}Wo(){this.qo!==null&&(this.qo.skipDelay(),this.qo=null)}cancel(){this.qo!==null&&(this.qo.cancel(),this.qo=null)}Uo(){return(Math.random()-.5)*this.ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,t,r,s,i,o,a,l){this.oi=e,this.Go=r,this.zo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.jo=0,this.Ho=null,this.Jo=null,this.stream=null,this.Yo=new bT(e,t)}Zo(){return this.state===1||this.state===5||this.Xo()}Xo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.e_()}async stop(){this.Zo()&&await this.close(0)}t_(){this.state=0,this.Yo.reset()}n_(){this.Xo()&&this.Ho===null&&(this.Ho=this.oi.enqueueAfterDelay(this.Go,6e4,()=>this.r_()))}i_(e){this.s_(),this.stream.send(e)}async r_(){if(this.Xo())return this.close(0)}s_(){this.Ho&&(this.Ho.cancel(),this.Ho=null)}o_(){this.Jo&&(this.Jo.cancel(),this.Jo=null)}async close(e,t){this.s_(),this.o_(),this.Yo.cancel(),this.jo++,e!==4?this.Yo.reset():t&&t.code===U.RESOURCE_EXHAUSTED?(ur(t.toString()),ur("Using maximum backoff delay to prevent overloading the backend."),this.Yo.Ko()):t&&t.code===U.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.__(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ao(t)}__(){}auth(){this.state=1;const e=this.a_(this.jo),t=this.jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.jo===t&&this.u_(r,s)},r=>{e(()=>{const s=new te(U.UNKNOWN,"Fetching auth token failed: "+r.message);return this.c_(s)})})}u_(e,t){const r=this.a_(this.jo);this.stream=this.l_(e,t),this.stream.Po(()=>{r(()=>this.listener.Po())}),this.stream.To(()=>{r(()=>(this.state=2,this.Jo=this.oi.enqueueAfterDelay(this.zo,1e4,()=>(this.Xo()&&(this.state=3),Promise.resolve())),this.listener.To()))}),this.stream.Ao(s=>{r(()=>this.c_(s))}),this.stream.onMessage(s=>{r(()=>this.onMessage(s))})}e_(){this.state=5,this.Yo.$o(async()=>{this.state=0,this.start()})}c_(e){return se("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}a_(e){return t=>{this.oi.enqueueAndForget(()=>this.jo===e?t():(se("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class oM extends ST{constructor(e,t,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i}l_(e,t){return this.connection.Oo("Listen",e,t)}onMessage(e){this.Yo.reset();const t=EO(this.serializer,e),r=function(i){if(!("targetChange"in i))return pe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?Hn(o.readTime):pe.min()}(e);return this.listener.h_(t,r)}P_(e){const t={};t.database=Nd(this.serializer),t.addTarget=function(i,o){let a;const l=o.target;if(a=kd(l)?{documents:wO(i,l)}:{query:bO(i,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=pT(i,o.resumeToken);const c=xd(i,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=bc(i,o.snapshotVersion.toTimestamp());const c=xd(i,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=IO(this.serializer,e);r&&(t.labels=r),this.i_(t)}I_(e){const t={};t.database=Nd(this.serializer),t.removeTarget=e,this.i_(t)}}class aM extends ST{constructor(e,t,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,o),this.serializer=i,this.T_=!1}get E_(){return this.T_}start(){this.T_=!1,this.lastStreamToken=void 0,super.start()}__(){this.T_&&this.d_([])}l_(e,t){return this.connection.Oo("Write",e,t)}onMessage(e){if(Be(!!e.streamToken),this.lastStreamToken=e.streamToken,this.T_){this.Yo.reset();const t=TO(e.writeResults,e.commitTime),r=Hn(e.commitTime);return this.listener.A_(r,t)}return Be(!e.writeResults||e.writeResults.length===0),this.T_=!0,this.listener.R_()}V_(){const e={};e.database=Nd(this.serializer),this.i_(e)}d_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>vO(this.serializer,r))};this.i_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lM extends class{}{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.m_=!1}f_(){if(this.m_)throw new te(U.FAILED_PRECONDITION,"The client has already been terminated.")}Co(e,t,r,s){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Co(e,Od(t,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new te(U.UNKNOWN,i.toString())})}xo(e,t,r,s,i){return this.f_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.xo(e,Od(t,r),s,o,a,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===U.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new te(U.UNKNOWN,o.toString())})}terminate(){this.m_=!0,this.connection.terminate()}}class cM{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.g_=0,this.p_=null,this.y_=!0}w_(){this.g_===0&&(this.S_("Unknown"),this.p_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.p_=null,this.b_("Backend didn't respond within 10 seconds."),this.S_("Offline"),Promise.resolve())))}D_(e){this.state==="Online"?this.S_("Unknown"):(this.g_++,this.g_>=1&&(this.C_(),this.b_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.S_("Offline")))}set(e){this.C_(),this.g_=0,e==="Online"&&(this.y_=!1),this.S_(e)}S_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}b_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.y_?(ur(t),this.y_=!1):se("OnlineStateTracker",t)}C_(){this.p_!==null&&(this.p_.cancel(),this.p_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(e,t,r,s,i){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.v_=[],this.F_=new Map,this.M_=new Set,this.x_=[],this.O_=i,this.O_.io(o=>{r.enqueueAndForget(async()=>{ai(this)&&(se("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=ye(l);c.M_.add(4),await Ga(c),c.N_.set("Unknown"),c.M_.delete(4),await Iu(c)}(this))})}),this.N_=new cM(r,s)}}async function Iu(n){if(ai(n))for(const e of n.x_)await e(!0)}async function Ga(n){for(const e of n.x_)await e(!1)}function IT(n,e){const t=ye(n);t.F_.has(e.targetId)||(t.F_.set(e.targetId,e),cp(t)?lp(t):co(t).Xo()&&ap(t,e))}function op(n,e){const t=ye(n),r=co(t);t.F_.delete(e),r.Xo()&&AT(t,e),t.F_.size===0&&(r.Xo()?r.n_():ai(t)&&t.N_.set("Unknown"))}function ap(n,e){if(n.L_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}co(n).P_(e)}function AT(n,e){n.L_.xe(e),co(n).I_(e)}function lp(n){n.L_=new dO({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.F_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),co(n).start(),n.N_.w_()}function cp(n){return ai(n)&&!co(n).Zo()&&n.F_.size>0}function ai(n){return ye(n).M_.size===0}function CT(n){n.L_=void 0}async function hM(n){n.N_.set("Online")}async function dM(n){n.F_.forEach((e,t)=>{ap(n,e)})}async function fM(n,e){CT(n),cp(n)?(n.N_.D_(e),lp(n)):n.N_.set("Unknown")}async function pM(n,e,t){if(n.N_.set("Online"),e instanceof fT&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const a of i.targetIds)s.F_.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.F_.delete(a),s.L_.removeTarget(a))}(n,e)}catch(r){se("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Sc(n,r)}else if(e instanceof Kl?n.L_.Ke(e):e instanceof dT?n.L_.He(e):n.L_.We(e),!t.isEqual(pe.min()))try{const r=await wT(n.localStore);t.compareTo(r)>=0&&await function(i,o){const a=i.L_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const h=i.F_.get(c);h&&i.F_.set(c,h.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const h=i.F_.get(l);if(!h)return;i.F_.set(l,h.withResumeToken(Nt.EMPTY_BYTE_STRING,h.snapshotVersion)),AT(i,l);const d=new Ur(h.target,l,c,h.sequenceNumber);ap(i,d)}),i.remoteSyncer.applyRemoteEvent(a)}(n,t)}catch(r){se("RemoteStore","Failed to raise snapshot:",r),await Sc(n,r)}}async function Sc(n,e,t){if(!Ha(e))throw e;n.M_.add(1),await Ga(n),n.N_.set("Offline"),t||(t=()=>wT(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{se("RemoteStore","Retrying IndexedDB access"),await t(),n.M_.delete(1),await Iu(n)})}function kT(n,e){return e().catch(t=>Sc(n,t,e))}async function Au(n){const e=ye(n),t=ls(e);let r=e.v_.length>0?e.v_[e.v_.length-1].batchId:-1;for(;mM(e);)try{const s=await XO(e.localStore,r);if(s===null){e.v_.length===0&&t.n_();break}r=s.batchId,gM(e,s)}catch(s){await Sc(e,s)}RT(e)&&PT(e)}function mM(n){return ai(n)&&n.v_.length<10}function gM(n,e){n.v_.push(e);const t=ls(n);t.Xo()&&t.E_&&t.d_(e.mutations)}function RT(n){return ai(n)&&!ls(n).Zo()&&n.v_.length>0}function PT(n){ls(n).start()}async function yM(n){ls(n).V_()}async function _M(n){const e=ls(n);for(const t of n.v_)e.d_(t.mutations)}async function EM(n,e,t){const r=n.v_.shift(),s=ep.from(r,e,t);await kT(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),await Au(n)}async function vM(n,e){e&&ls(n).E_&&await async function(r,s){if(function(o){return cO(o)&&o!==U.ABORTED}(s.code)){const i=r.v_.shift();ls(r).t_(),await kT(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await Au(r)}}(n,e),RT(n)&&PT(n)}async function Gy(n,e){const t=ye(n);t.asyncQueue.verifyOperationInProgress(),se("RemoteStore","RemoteStore received new credentials");const r=ai(t);t.M_.add(3),await Ga(t),r&&t.N_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.M_.delete(3),await Iu(t)}async function TM(n,e){const t=ye(n);e?(t.M_.delete(2),await Iu(t)):e||(t.M_.add(2),await Ga(t),t.N_.set("Unknown"))}function co(n){return n.B_||(n.B_=function(t,r,s){const i=ye(t);return i.f_(),new oM(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Po:hM.bind(null,n),To:dM.bind(null,n),Ao:fM.bind(null,n),h_:pM.bind(null,n)}),n.x_.push(async e=>{e?(n.B_.t_(),cp(n)?lp(n):n.N_.set("Unknown")):(await n.B_.stop(),CT(n))})),n.B_}function ls(n){return n.k_||(n.k_=function(t,r,s){const i=ye(t);return i.f_(),new aM(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(n.datastore,n.asyncQueue,{Po:()=>Promise.resolve(),To:yM.bind(null,n),Ao:vM.bind(null,n),R_:_M.bind(null,n),A_:EM.bind(null,n)}),n.x_.push(async e=>{e?(n.k_.t_(),await Au(n)):(await n.k_.stop(),n.v_.length>0&&(se("RemoteStore",`Stopping write stream with ${n.v_.length} pending writes`),n.v_=[]))})),n.k_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e,t,r,s,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,i){const o=Date.now()+r,a=new up(e,t,o,s,i);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new te(U.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function hp(n,e){if(ur("AsyncQueue",`${e}: ${n}`),Ha(n))return new te(U.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this.comparator=e?(t,r)=>e(t,r)||le.comparator(t.key,r.key):(t,r)=>le.comparator(t.key,r.key),this.keyedMap=Vo(),this.sortedSet=new Ke(this.comparator)}static emptySet(e){return new Li(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Li)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Li;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(){this.q_=new Ke(le.comparator)}track(e){const t=e.doc.key,r=this.q_.get(t);r?e.type!==0&&r.type===3?this.q_=this.q_.insert(t,e):e.type===3&&r.type!==1?this.q_=this.q_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.q_=this.q_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.q_=this.q_.remove(t):e.type===1&&r.type===2?this.q_=this.q_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.q_=this.q_.insert(t,{type:2,doc:e.doc}):fe():this.q_=this.q_.insert(t,e)}Q_(){const e=[];return this.q_.inorderTraversal((t,r)=>{e.push(r)}),e}}class Qi{constructor(e,t,r,s,i,o,a,l,c){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,t,r,s,i){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new Qi(e,t,Li.emptySet(t),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Eu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(){this.K_=void 0,this.U_=[]}W_(){return this.U_.some(e=>e.G_())}}class bM{constructor(){this.queries=new lo(e=>X0(e),Eu),this.onlineState="Unknown",this.z_=new Set}}async function xT(n,e){const t=ye(n);let r=3;const s=e.query;let i=t.queries.get(s);i?!i.W_()&&e.G_()&&(r=2):(i=new wM,r=e.G_()?0:1);try{switch(r){case 0:i.K_=await t.onListen(s,!0);break;case 1:i.K_=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(o){const a=hp(o,`Initialization of query '${Ei(e.query)}' failed`);return void e.onError(a)}t.queries.set(s,i),i.U_.push(e),e.j_(t.onlineState),i.K_&&e.H_(i.K_)&&dp(t)}async function OT(n,e){const t=ye(n),r=e.query;let s=3;const i=t.queries.get(r);if(i){const o=i.U_.indexOf(e);o>=0&&(i.U_.splice(o,1),i.U_.length===0?s=e.G_()?0:1:!i.W_()&&e.G_()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function SM(n,e){const t=ye(n);let r=!1;for(const s of e){const i=s.query,o=t.queries.get(i);if(o){for(const a of o.U_)a.H_(s)&&(r=!0);o.K_=s}}r&&dp(t)}function IM(n,e,t){const r=ye(n),s=r.queries.get(e);if(s)for(const i of s.U_)i.onError(t);r.queries.delete(e)}function dp(n){n.z_.forEach(e=>{e.next()})}var Ld,Qy;(Qy=Ld||(Ld={})).J_="default",Qy.Cache="cache";class MT{constructor(e,t,r){this.query=e,this.Y_=t,this.Z_=!1,this.X_=null,this.onlineState="Unknown",this.options=r||{}}H_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Qi(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Z_?this.ea(e)&&(this.Y_.next(e),t=!0):this.ta(e,this.onlineState)&&(this.na(e),t=!0),this.X_=e,t}onError(e){this.Y_.error(e)}j_(e){this.onlineState=e;let t=!1;return this.X_&&!this.Z_&&this.ta(this.X_,e)&&(this.na(this.X_),t=!0),t}ta(e,t){if(!e.fromCache||!this.G_())return!0;const r=t!=="Offline";return(!this.options.ra||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ea(e){if(e.docChanges.length>0)return!0;const t=this.X_&&this.X_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}na(e){e=Qi.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Z_=!0,this.Y_.next(e)}G_(){return this.options.source!==Ld.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NT{constructor(e){this.key=e}}class DT{constructor(e){this.key=e}}class AM{constructor(e,t){this.query=e,this.la=t,this.ha=null,this.hasCachedResults=!1,this.current=!1,this.Pa=we(),this.mutatedKeys=we(),this.Ia=Z0(e),this.Ta=new Li(this.Ia)}get Ea(){return this.la}da(e,t){const r=t?t.Aa:new Jy,s=t?t.Ta:this.Ta;let i=t?t.mutatedKeys:this.mutatedKeys,o=s,a=!1;const l=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,c=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,d)=>{const f=s.get(h),m=vu(this.query,d)?d:null,y=!!f&&this.mutatedKeys.has(f.key),T=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;f&&m?f.data.isEqual(m.data)?y!==T&&(r.track({type:3,doc:m}),w=!0):this.Ra(f,m)||(r.track({type:2,doc:m}),w=!0,(l&&this.Ia(m,l)>0||c&&this.Ia(m,c)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),w=!0):f&&!m&&(r.track({type:1,doc:f}),w=!0,(l||c)&&(a=!0)),w&&(m?(o=o.add(m),i=T?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ta:o,Aa:r,Xi:a,mutatedKeys:i}}Ra(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const i=this.Ta;this.Ta=e.Ta,this.mutatedKeys=e.mutatedKeys;const o=e.Aa.Q_();o.sort((h,d)=>function(m,y){const T=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return fe()}};return T(m)-T(y)}(h.type,d.type)||this.Ia(h.doc,d.doc)),this.Va(r),s=s!=null&&s;const a=t&&!s?this.ma():[],l=this.Pa.size===0&&this.current&&!s?1:0,c=l!==this.ha;return this.ha=l,o.length!==0||c?{snapshot:new Qi(this.query,e.Ta,i,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),fa:a}:{fa:a}}j_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ta:this.Ta,Aa:new Jy,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{fa:[]}}ga(e){return!this.la.has(e)&&!!this.Ta.has(e)&&!this.Ta.get(e).hasLocalMutations}Va(e){e&&(e.addedDocuments.forEach(t=>this.la=this.la.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.la=this.la.delete(t)),this.current=e.current)}ma(){if(!this.current)return[];const e=this.Pa;this.Pa=we(),this.Ta.forEach(r=>{this.ga(r.key)&&(this.Pa=this.Pa.add(r.key))});const t=[];return e.forEach(r=>{this.Pa.has(r)||t.push(new DT(r))}),this.Pa.forEach(r=>{e.has(r)||t.push(new NT(r))}),t}pa(e){this.la=e.hs,this.Pa=we();const t=this.da(e.documents);return this.applyChanges(t,!0)}ya(){return Qi.fromInitialDocuments(this.query,this.Ta,this.mutatedKeys,this.ha===0,this.hasCachedResults)}}class CM{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class kM{constructor(e){this.key=e,this.wa=!1}}class RM{constructor(e,t,r,s,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Sa={},this.ba=new lo(a=>X0(a),Eu),this.Da=new Map,this.Ca=new Set,this.va=new Ke(le.comparator),this.Fa=new Map,this.Ma=new rp,this.xa={},this.Oa=new Map,this.Na=Ji.Ln(),this.onlineState="Unknown",this.La=void 0}get isPrimaryClient(){return this.La===!0}}async function PM(n,e,t=!0){const r=$T(n);let s;const i=r.ba.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ya()):s=await LT(r,e,t,!0),s}async function xM(n,e){const t=$T(n);await LT(t,e,!0,!1)}async function LT(n,e,t,r){const s=await ZO(n.localStore,jn(e)),i=s.targetId,o=t?n.sharedClientState.addLocalQueryTarget(i):"not-current";let a;return r&&(a=await OM(n,e,i,o==="current",s.resumeToken)),n.isPrimaryClient&&t&&IT(n.remoteStore,s),a}async function OM(n,e,t,r,s){n.Ba=(d,f,m)=>async function(T,w,P,O){let D=w.view.da(P);D.Xi&&(D=await qy(T.localStore,w.query,!1).then(({documents:A})=>w.view.da(A,D)));const $=O&&O.targetChanges.get(w.targetId),q=O&&O.targetMismatches.get(w.targetId)!=null,F=w.view.applyChanges(D,T.isPrimaryClient,$,q);return Xy(T,w.targetId,F.fa),F.snapshot}(n,d,f,m);const i=await qy(n.localStore,e,!0),o=new AM(e,i.hs),a=o.da(i.documents),l=Ka.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),c=o.applyChanges(a,n.isPrimaryClient,l);Xy(n,t,c.fa);const h=new CM(e,t,o);return n.ba.set(e,h),n.Da.has(t)?n.Da.get(t).push(e):n.Da.set(t,[e]),c.snapshot}async function MM(n,e,t){const r=ye(n),s=r.ba.get(e),i=r.Da.get(s.targetId);if(i.length>1)return r.Da.set(s.targetId,i.filter(o=>!Eu(o,e))),void r.ba.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Dd(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),t&&op(r.remoteStore,s.targetId),Vd(r,s.targetId)}).catch(ja)):(Vd(r,s.targetId),await Dd(r.localStore,s.targetId,!0))}async function NM(n,e){const t=ye(n),r=t.ba.get(e),s=t.Da.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),op(t.remoteStore,r.targetId))}async function DM(n,e,t){const r=zM(n);try{const s=await function(o,a){const l=ye(o),c=ct.now(),h=a.reduce((m,y)=>m.add(y.key),we());let d,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let y=hr(),T=we();return l.os.getEntries(m,h).next(w=>{y=w,y.forEach((P,O)=>{O.isValidDocument()||(T=T.add(P))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,y)).next(w=>{d=w;const P=[];for(const O of a){const D=sO(O,d.get(O.key).overlayedDocument);D!=null&&P.push(new hs(O.key,D,H0(D.value.mapValue),Sn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,P,a)}).next(w=>{f=w;const P=w.applyToLocalDocumentSet(d,T);return l.documentOverlayCache.saveOverlays(m,w.batchId,P)})}).then(()=>({batchId:f.batchId,changes:tT(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,a,l){let c=o.xa[o.currentUser.toKey()];c||(c=new Ke(xe)),c=c.insert(a,l),o.xa[o.currentUser.toKey()]=c}(r,s.batchId,t),await Ja(r,s.changes),await Au(r.remoteStore)}catch(s){const i=hp(s,"Failed to persist write");t.reject(i)}}async function VT(n,e){const t=ye(n);try{const r=await QO(t.localStore,e);e.targetChanges.forEach((s,i)=>{const o=t.Fa.get(i);o&&(Be(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.wa=!0:s.modifiedDocuments.size>0?Be(o.wa):s.removedDocuments.size>0&&(Be(o.wa),o.wa=!1))}),await Ja(t,r,e)}catch(r){await ja(r)}}function Yy(n,e,t){const r=ye(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.ba.forEach((i,o)=>{const a=o.view.j_(e);a.snapshot&&s.push(a.snapshot)}),function(o,a){const l=ye(o);l.onlineState=a;let c=!1;l.queries.forEach((h,d)=>{for(const f of d.U_)f.j_(a)&&(c=!0)}),c&&dp(l)}(r.eventManager,e),s.length&&r.Sa.h_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function LM(n,e,t){const r=ye(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Fa.get(e),i=s&&s.key;if(i){let o=new Ke(le.comparator);o=o.insert(i,Ot.newNoDocument(i,pe.min()));const a=we().add(i),l=new bu(pe.min(),new Map,new Ke(xe),o,a);await VT(r,l),r.va=r.va.remove(i),r.Fa.delete(e),fp(r)}else await Dd(r.localStore,e,!1).then(()=>Vd(r,e,t)).catch(ja)}async function VM(n,e){const t=ye(n),r=e.batch.batchId;try{const s=await JO(t.localStore,e);BT(t,r,null),FT(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ja(t,s)}catch(s){await ja(s)}}async function FM(n,e,t){const r=ye(n);try{const s=await function(o,a){const l=ye(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let h;return l.mutationQueue.lookupMutationBatch(c,a).next(d=>(Be(d!==null),h=d.keys(),l.mutationQueue.removeMutationBatch(c,d))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,h,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,h)).next(()=>l.localDocuments.getDocuments(c,h))})}(r.localStore,e);BT(r,e,t),FT(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ja(r,s)}catch(s){await ja(s)}}function FT(n,e){(n.Oa.get(e)||[]).forEach(t=>{t.resolve()}),n.Oa.delete(e)}function BT(n,e,t){const r=ye(n);let s=r.xa[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(t?i.reject(t):i.resolve(),s=s.remove(e)),r.xa[r.currentUser.toKey()]=s}}function Vd(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Da.get(e))n.ba.delete(r),t&&n.Sa.ka(r,t);n.Da.delete(e),n.isPrimaryClient&&n.Ma.Vr(e).forEach(r=>{n.Ma.containsKey(r)||UT(n,r)})}function UT(n,e){n.Ca.delete(e.path.canonicalString());const t=n.va.get(e);t!==null&&(op(n.remoteStore,t),n.va=n.va.remove(e),n.Fa.delete(t),fp(n))}function Xy(n,e,t){for(const r of t)r instanceof NT?(n.Ma.addReference(r.key,e),BM(n,r)):r instanceof DT?(se("SyncEngine","Document no longer in limbo: "+r.key),n.Ma.removeReference(r.key,e),n.Ma.containsKey(r.key)||UT(n,r.key)):fe()}function BM(n,e){const t=e.key,r=t.path.canonicalString();n.va.get(t)||n.Ca.has(r)||(se("SyncEngine","New document in limbo: "+t),n.Ca.add(r),fp(n))}function fp(n){for(;n.Ca.size>0&&n.va.size<n.maxConcurrentLimboResolutions;){const e=n.Ca.values().next().value;n.Ca.delete(e);const t=new le(ze.fromString(e)),r=n.Na.next();n.Fa.set(r,new kM(t)),n.va=n.va.insert(t,r),IT(n.remoteStore,new Ur(jn(Xf(t.path)),r,"TargetPurposeLimboResolution",Wf.oe))}}async function Ja(n,e,t){const r=ye(n),s=[],i=[],o=[];r.ba.isEmpty()||(r.ba.forEach((a,l)=>{o.push(r.Ba(l,e,t).then(c=>{if((c||t)&&r.isPrimaryClient){const h=c&&!c.fromCache;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){s.push(c);const h=ip.Ki(l.targetId,c);i.push(h)}}))}),await Promise.all(o),r.Sa.h_(s),await async function(l,c){const h=ye(l);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>z.forEach(c,f=>z.forEach(f.qi,m=>h.persistence.referenceDelegate.addReference(d,f.targetId,m)).next(()=>z.forEach(f.Qi,m=>h.persistence.referenceDelegate.removeReference(d,f.targetId,m)))))}catch(d){if(!Ha(d))throw d;se("LocalStore","Failed to update sequence numbers: "+d)}for(const d of c){const f=d.targetId;if(!d.fromCache){const m=h.ns.get(f),y=m.snapshotVersion,T=m.withLastLimboFreeSnapshotVersion(y);h.ns=h.ns.insert(f,T)}}}(r.localStore,i))}async function UM(n,e){const t=ye(n);if(!t.currentUser.isEqual(e)){se("SyncEngine","User change. New user:",e.toKey());const r=await TT(t.localStore,e);t.currentUser=e,function(i,o){i.Oa.forEach(a=>{a.forEach(l=>{l.reject(new te(U.CANCELLED,o))})}),i.Oa.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ja(t,r.us)}}function $M(n,e){const t=ye(n),r=t.Fa.get(e);if(r&&r.wa)return we().add(r.key);{let s=we();const i=t.Da.get(e);if(!i)return s;for(const o of i){const a=t.ba.get(o);s=s.unionWith(a.view.Ea)}return s}}function $T(n){const e=ye(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=VT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=$M.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=LM.bind(null,e),e.Sa.h_=SM.bind(null,e.eventManager),e.Sa.ka=IM.bind(null,e.eventManager),e}function zM(n){const e=ye(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=VM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=FM.bind(null,e),e}class Zy{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=Su(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return GO(this.persistence,new WO,e.initialUser,this.serializer)}createPersistence(e){return new jO(sp.Hr,this.serializer)}createSharedClientState(e){return new tM}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class jM{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Yy(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=UM.bind(null,this.syncEngine),await TM(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new bM}()}createDatastore(e){const t=Su(e.databaseInfo.databaseId),r=function(i){return new iM(i)}(e.databaseInfo);return function(i,o,a,l){return new lM(i,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,s,i,o,a){return new uM(r,s,i,o,a)}(this.localStore,this.datastore,e.asyncQueue,t=>Yy(this.syncEngine,t,0),function(){return Ky.D()?new Ky:new nM}())}createSyncEngine(e,t){return function(s,i,o,a,l,c,h){const d=new RM(s,i,o,a,l,c);return h&&(d.La=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(r){const s=ye(r);se("RemoteStore","RemoteStore shutting down."),s.M_.add(5),await Ga(s),s.O_.shutdown(),s.N_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zT{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ka(this.observer.next,e)}error(e){this.observer.error?this.Ka(this.observer.error,e):ur("Uncaught Error in snapshot listener:",e.toString())}$a(){this.muted=!0}Ka(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HM{constructor(e,t,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=xt.UNAUTHENTICATED,this.clientId=$0.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,async i=>{se("FirestoreClient","Received user=",i.uid),await this.authCredentialListener(i),this.user=i}),this.appCheckCredentials.start(r,i=>(se("FirestoreClient","Received new app check token=",i),this.appCheckCredentialListener(i,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new te(U.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=hp(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ch(n,e){n.asyncQueue.verifyOperationInProgress(),se("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async s=>{r.isEqual(s)||(await TT(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function e_(n,e){n.asyncQueue.verifyOperationInProgress();const t=await WM(n);se("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>Gy(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,s)=>Gy(e.remoteStore,s)),n._onlineComponents=e}function qM(n){return n.name==="FirebaseError"?n.code===U.FAILED_PRECONDITION||n.code===U.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}async function WM(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){se("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ch(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!qM(t))throw t;qi("Error using user provided cache. Falling back to memory cache: "+t),await Ch(n,new Zy)}}else se("FirestoreClient","Using default OfflineComponentProvider"),await Ch(n,new Zy);return n._offlineComponents}async function jT(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(se("FirestoreClient","Using user provided OnlineComponentProvider"),await e_(n,n._uninitializedComponentsProvider._online)):(se("FirestoreClient","Using default OnlineComponentProvider"),await e_(n,new jM))),n._onlineComponents}function KM(n){return jT(n).then(e=>e.syncEngine)}async function HT(n){const e=await jT(n),t=e.eventManager;return t.onListen=PM.bind(null,e.syncEngine),t.onUnlisten=MM.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xM.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=NM.bind(null,e.syncEngine),t}function GM(n,e,t={}){const r=new ar;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const h=new zT({next:f=>{o.enqueueAndForget(()=>OT(i,d));const m=f.docs.has(a);!m&&f.fromCache?c.reject(new te(U.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?c.reject(new te(U.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new MT(Xf(a.path),h,{includeMetadataChanges:!0,ra:!0});return xT(i,d)}(await HT(n),n.asyncQueue,e,t,r)),r.promise}function JM(n,e,t={}){const r=new ar;return n.asyncQueue.enqueueAndForget(async()=>function(i,o,a,l,c){const h=new zT({next:f=>{o.enqueueAndForget(()=>OT(i,d)),f.fromCache&&l.source==="server"?c.reject(new te(U.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),d=new MT(a,h,{includeMetadataChanges:!0,ra:!0});return xT(i,d)}(await HT(n),n.asyncQueue,e,t,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qT(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WT(n,e,t){if(!t)throw new te(U.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function QM(n,e,t,r){if(e===!0&&r===!0)throw new te(U.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function n_(n){if(!le.isDocumentKey(n))throw new te(U.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function r_(n){if(le.isDocumentKey(n))throw new te(U.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Cu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":fe()}function dr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new te(U.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Cu(n);throw new te(U.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s_{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new te(U.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new te(U.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=qT((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new te(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new te(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new te(U.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class ku{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new s_({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new te(U.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new te(U.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new s_(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new px;switch(r.type){case"firstParty":return new _x(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new te(U.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=t_.get(t);r&&(se("ComponentProvider","Removing Datastore"),t_.delete(t),r.terminate())}(this),Promise.resolve()}}function YM(n,e,t,r={}){var s;const i=(n=dr(n,ku))._getSettings(),o=`${e}:${t}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&qi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=xt.MOCK_USER;else{a=Bv(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new te(U.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new xt(c)}n._authCredentials=new mx(new U0(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new uo(this.firestore,e,this._query)}}class Gt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Yr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Gt(this.firestore,e,this._key)}}class Yr extends uo{constructor(e,t,r){super(e,t,Xf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Gt(this.firestore,null,new le(e))}withConverter(e){return new Yr(this.firestore,e,this._path)}}function a4(n,e,...t){if(n=Qe(n),WT("collection","path",e),n instanceof ku){const r=ze.fromString(e,...t);return r_(r),new Yr(n,null,r)}{if(!(n instanceof Gt||n instanceof Yr))throw new te(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return r_(r),new Yr(n.firestore,null,r)}}function XM(n,e,...t){if(n=Qe(n),arguments.length===1&&(e=$0.newId()),WT("doc","path",e),n instanceof ku){const r=ze.fromString(e,...t);return n_(r),new Gt(n,null,new le(r))}{if(!(n instanceof Gt||n instanceof Yr))throw new te(U.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return n_(r),new Gt(n.firestore,n instanceof Yr?n.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZM{constructor(){this.iu=Promise.resolve(),this.su=[],this.ou=!1,this._u=[],this.au=null,this.uu=!1,this.cu=!1,this.lu=[],this.Yo=new bT(this,"async_queue_retry"),this.hu=()=>{const t=Ah();t&&se("AsyncQueue","Visibility state changed to "+t.visibilityState),this.Yo.Wo()};const e=Ah();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.hu)}get isShuttingDown(){return this.ou}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Pu(),this.Iu(e)}enterRestrictedMode(e){if(!this.ou){this.ou=!0,this.cu=e||!1;const t=Ah();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.hu)}}enqueue(e){if(this.Pu(),this.ou)return new Promise(()=>{});const t=new ar;return this.Iu(()=>this.ou&&this.cu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.su.push(e),this.Tu()))}async Tu(){if(this.su.length!==0){try{await this.su[0](),this.su.shift(),this.Yo.reset()}catch(e){if(!Ha(e))throw e;se("AsyncQueue","Operation failed with retryable error: "+e)}this.su.length>0&&this.Yo.$o(()=>this.Tu())}}Iu(e){const t=this.iu.then(()=>(this.uu=!0,e().catch(r=>{this.au=r,this.uu=!1;const s=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw ur("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.uu=!1,r))));return this.iu=t,t}enqueueAfterDelay(e,t,r){this.Pu(),this.lu.indexOf(e)>-1&&(t=0);const s=up.createAndSchedule(this,e,t,r,i=>this.Eu(i));return this._u.push(s),s}Pu(){this.au&&fe()}verifyOperationInProgress(){}async du(){let e;do e=this.iu,await e;while(e!==this.iu)}Au(e){for(const t of this._u)if(t.timerId===e)return!0;return!1}Ru(e){return this.du().then(()=>{this._u.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this._u)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.du()})}Vu(e){this.lu.push(e)}Eu(e){const t=this._u.indexOf(e);this._u.splice(t,1)}}class ho extends ku{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=function(){return new ZM}(),this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||KT(this),this._firestoreClient.terminate()}}function eN(n,e){const t=typeof n=="object"?n:Mf(),r=typeof n=="string"?n:"(default)",s=uu(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=Lv("firestore");i&&YM(s,...i)}return s}function pp(n){return n._firestoreClient||KT(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function KT(n){var e,t,r;const s=n._freezeSettings(),i=function(a,l,c,h){return new xx(a,l,c,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,qT(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._firestoreClient=new HM(n._authCredentials,n._appCheckCredentials,n._queue,i),!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Yi(Nt.fromBase64String(e))}catch(t){throw new te(U.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Yi(Nt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ru{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new te(U.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new St(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new te(U.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new te(U.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN=/^__.*__$/;class nN{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new hs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Wa(e,this.data,t,this.fieldTransforms)}}class GT{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new hs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function JT(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw fe()}}class yp{constructor(e,t,r,s,i,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.mu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get fu(){return this.settings.fu}gu(e){return new yp(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}pu(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.gu({path:r,yu:!1});return s.wu(e),s}Su(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.gu({path:r,yu:!1});return s.mu(),s}bu(e){return this.gu({path:void 0,yu:!0})}Du(e){return Ic(e,this.settings.methodName,this.settings.Cu||!1,this.path,this.settings.vu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}mu(){if(this.path)for(let e=0;e<this.path.length;e++)this.wu(this.path.get(e))}wu(e){if(e.length===0)throw this.Du("Document fields must not be empty");if(JT(this.fu)&&tN.test(e))throw this.Du('Document fields cannot begin and end with "__"')}}class rN{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Su(e)}Fu(e,t,r,s=!1){return new yp({fu:e,methodName:t,vu:r,path:St.emptyPath(),yu:!1,Cu:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function _p(n){const e=n._freezeSettings(),t=Su(n._databaseId);return new rN(n._databaseId,!!e.ignoreUndefinedProperties,t)}function sN(n,e,t,r,s,i={}){const o=n.Fu(i.merge||i.mergeFields?2:0,e,t,s);Ep("Data must be an object, but it was:",o,r);const a=QT(r,o);let l,c;if(i.merge)l=new rn(o.fieldMask),c=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const d of i.mergeFields){const f=Fd(e,d,t);if(!o.contains(f))throw new te(U.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);XT(h,f)||h.push(f)}l=new rn(h),c=o.fieldTransforms.filter(d=>l.covers(d.field))}else l=null,c=o.fieldTransforms;return new nN(new Kt(a),l,c)}class Pu extends mp{_toFieldTransform(e){if(e.fu!==2)throw e.fu===1?e.Du(`${this._methodName}() can only appear at the top level of your update data`):e.Du(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pu}}function iN(n,e,t,r){const s=n.Fu(1,e,t);Ep("Data must be an object, but it was:",s,r);const i=[],o=Kt.empty();oi(r,(l,c)=>{const h=vp(e,l,t);c=Qe(c);const d=s.Su(h);if(c instanceof Pu)i.push(h);else{const f=Qa(c,d);f!=null&&(i.push(h),o.set(h,f))}});const a=new rn(i);return new GT(o,a,s.fieldTransforms)}function oN(n,e,t,r,s,i){const o=n.Fu(1,e,t),a=[Fd(e,r,t)],l=[s];if(i.length%2!=0)throw new te(U.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)a.push(Fd(e,i[f])),l.push(i[f+1]);const c=[],h=Kt.empty();for(let f=a.length-1;f>=0;--f)if(!XT(c,a[f])){const m=a[f];let y=l[f];y=Qe(y);const T=o.Su(m);if(y instanceof Pu)c.push(m);else{const w=Qa(y,T);w!=null&&(c.push(m),h.set(m,w))}}const d=new rn(c);return new GT(h,d,o.fieldTransforms)}function aN(n,e,t,r=!1){return Qa(t,n.Fu(r?4:3,e))}function Qa(n,e){if(YT(n=Qe(n)))return Ep("Unsupported field value:",e,n),QT(n,e);if(n instanceof mp)return function(r,s){if(!JT(s.fu))throw s.Du(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Du(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.yu&&e.fu!==4)throw e.Du("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const a of r){let l=Qa(a,s.bu(o));l==null&&(l={nullValue:"NULL_VALUE"}),i.push(l),o++}return{arrayValue:{values:i}}}(n,e)}return function(r,s){if((r=Qe(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Xx(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=ct.fromDate(r);return{timestampValue:bc(s.serializer,i)}}if(r instanceof ct){const i=new ct(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:bc(s.serializer,i)}}if(r instanceof gp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Yi)return{bytesValue:pT(s.serializer,r._byteString)};if(r instanceof Gt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Du(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:np(r.firestore._databaseId||s.databaseId,r._key.path)}}throw s.Du(`Unsupported field value: ${Cu(r)}`)}(n,e)}function QT(n,e){const t={};return z0(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):oi(n,(r,s)=>{const i=Qa(s,e.pu(r));i!=null&&(t[r]=i)}),{mapValue:{fields:t}}}function YT(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ct||n instanceof gp||n instanceof Yi||n instanceof Gt||n instanceof mp)}function Ep(n,e,t){if(!YT(t)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(t)){const r=Cu(t);throw r==="an object"?e.Du(n+" a custom object"):e.Du(n+" "+r)}}function Fd(n,e,t){if((e=Qe(e))instanceof Ru)return e._internalPath;if(typeof e=="string")return vp(n,e);throw Ic("Field path arguments must be of type string or ",n,!1,void 0,t)}const lN=new RegExp("[~\\*/\\[\\]]");function vp(n,e,t){if(e.search(lN)>=0)throw Ic(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ru(...e.split("."))._internalPath}catch{throw Ic(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ic(n,e,t,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(i||o)&&(l+=" (found",i&&(l+=` in field ${r}`),o&&(l+=` in document ${s}`),l+=")"),new te(U.INVALID_ARGUMENT,a+n+l)}function XT(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(e,t,r,s,i){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Gt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new cN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Tp("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class cN extends ZT{data(){return super.data()}}function Tp(n,e){return typeof e=="string"?vp(n,e):e instanceof Ru?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uN(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new te(U.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class wp{}class hN extends wp{}function l4(n,e,...t){let r=[];e instanceof wp&&r.push(e),r=r.concat(t),function(i){const o=i.filter(l=>l instanceof bp).length,a=i.filter(l=>l instanceof xu).length;if(o>1||o>0&&a>0)throw new te(U.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)n=s._apply(n);return n}class xu extends hN{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new xu(e,t,r)}_apply(e){const t=this._parse(e);return ew(e._query,t),new uo(e.firestore,e.converter,Rd(e._query,t))}_parse(e){const t=_p(e.firestore);return function(i,o,a,l,c,h,d){let f;if(c.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new te(U.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){o_(d,h);const m=[];for(const y of d)m.push(i_(l,i,y));f={arrayValue:{values:m}}}else f=i_(l,i,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||o_(d,h),f=aN(a,o,d,h==="in"||h==="not-in");return st.create(c,h,f)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function c4(n,e,t){const r=e,s=Tp("where",n);return xu._create(s,r,t)}class bp extends wp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new bp(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:kn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(s,i){let o=s;const a=i.getFlattenedFilters();for(const l of a)ew(o,l),o=Rd(o,l)}(e._query,t),new uo(e.firestore,e.converter,Rd(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function i_(n,e,t){if(typeof(t=Qe(t))=="string"){if(t==="")throw new te(U.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Y0(e)&&t.indexOf("/")!==-1)throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ze.fromString(t));if(!le.isDocumentKey(r))throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ky(n,new le(r))}if(t instanceof Gt)return ky(n,t._key);throw new te(U.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Cu(t)}.`)}function o_(n,e){if(!Array.isArray(n)||n.length===0)throw new te(U.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ew(n,e){const t=function(s,i){for(const o of s)for(const a of o.getFlattenedFilters())if(i.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new te(U.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new te(U.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class dN{convertValue(e,t="none"){switch(Qs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return rt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Js(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw fe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return oi(e,(s,i)=>{r[s]=this.convertValue(i,t)}),r}convertGeoPoint(e){return new gp(rt(e.latitude),rt(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Gf(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Ta(e));default:return null}}convertTimestamp(e){const t=as(e);return new ct(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ze.fromString(e);Be(vT(r));const s=new wa(r.get(1),r.get(3)),i=new le(r.popFirst(5));return s.isEqual(t)||ur(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fN(n,e,t){let r;return r=n?n.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class tw extends ZT{constructor(e,t,r,s,i,o){super(e,t,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Gl(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Tp("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class Gl extends tw{data(e={}){return super.data(e)}}class pN{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Bo(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Gl(this._firestore,this._userDataWriter,r.key,r,new Bo(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new te(U.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(a=>{const l=new Gl(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Bo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(a=>i||a.type!==3).map(a=>{const l=new Gl(s._firestore,s._userDataWriter,a.doc.key,a.doc,new Bo(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let c=-1,h=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:mN(a.type),doc:l,oldIndex:c,newIndex:h}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function mN(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return fe()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u4(n){n=dr(n,Gt);const e=dr(n.firestore,ho);return GM(pp(e),n._key).then(t=>gN(e,n,t))}class nw extends dN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Yi(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Gt(this.firestore,null,t)}}function h4(n){n=dr(n,uo);const e=dr(n.firestore,ho),t=pp(e),r=new nw(e);return uN(n._query),JM(t,n._query).then(s=>new pN(e,r,n,s))}function d4(n,e,t,...r){n=dr(n,Gt);const s=dr(n.firestore,ho),i=_p(s);let o;return o=typeof(e=Qe(e))=="string"||e instanceof Ru?oN(i,"updateDoc",n._key,e,t,r):iN(i,"updateDoc",n._key,e),Sp(s,[o.toMutation(n._key,Sn.exists(!0))])}function f4(n){return Sp(dr(n.firestore,ho),[new Zf(n._key,Sn.none())])}function p4(n,e){const t=dr(n.firestore,ho),r=XM(n),s=fN(n.converter,e);return Sp(t,[sN(_p(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Sn.exists(!1))]).then(()=>r)}function Sp(n,e){return function(r,s){const i=new ar;return r.asyncQueue.enqueueAndForget(async()=>DM(await KM(r),s,i)),i.promise}(pp(n),e)}function gN(n,e,t){const r=t.docs.get(e._key),s=new nw(n);return new tw(n,s,e._key,r,new Bo(t.hasPendingWrites,t.fromCache),e.converter)}(function(e,t=!0){(function(s){ao=s})(si),Ws(new ss("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),a=new ho(new gx(r.getProvider("auth-internal")),new vx(r.getProvider("app-check-internal")),function(c,h){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new te(U.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new wa(c.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a},"PUBLIC").setMultipleInstances(!0)),Un(Sy,"4.6.3",e),Un(Sy,"4.6.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw="firebasestorage.googleapis.com",sw="storageBucket",yN=2*60*1e3,_N=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xe extends Qn{constructor(e,t,r=0){super(kh(e),`Firebase Storage: ${t} (${kh(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Xe.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return kh(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ye;(function(n){n.UNKNOWN="unknown",n.OBJECT_NOT_FOUND="object-not-found",n.BUCKET_NOT_FOUND="bucket-not-found",n.PROJECT_NOT_FOUND="project-not-found",n.QUOTA_EXCEEDED="quota-exceeded",n.UNAUTHENTICATED="unauthenticated",n.UNAUTHORIZED="unauthorized",n.UNAUTHORIZED_APP="unauthorized-app",n.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",n.INVALID_CHECKSUM="invalid-checksum",n.CANCELED="canceled",n.INVALID_EVENT_NAME="invalid-event-name",n.INVALID_URL="invalid-url",n.INVALID_DEFAULT_BUCKET="invalid-default-bucket",n.NO_DEFAULT_BUCKET="no-default-bucket",n.CANNOT_SLICE_BLOB="cannot-slice-blob",n.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",n.NO_DOWNLOAD_URL="no-download-url",n.INVALID_ARGUMENT="invalid-argument",n.INVALID_ARGUMENT_COUNT="invalid-argument-count",n.APP_DELETED="app-deleted",n.INVALID_ROOT_OPERATION="invalid-root-operation",n.INVALID_FORMAT="invalid-format",n.INTERNAL_ERROR="internal-error",n.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ye||(Ye={}));function kh(n){return"storage/"+n}function Ip(){const n="An unknown error occurred, please check the error payload for server response.";return new Xe(Ye.UNKNOWN,n)}function EN(n){return new Xe(Ye.OBJECT_NOT_FOUND,"Object '"+n+"' does not exist.")}function vN(n){return new Xe(Ye.QUOTA_EXCEEDED,"Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function TN(){const n="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Xe(Ye.UNAUTHENTICATED,n)}function wN(){return new Xe(Ye.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function bN(n){return new Xe(Ye.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")}function SN(){return new Xe(Ye.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function IN(){return new Xe(Ye.CANCELED,"User canceled the upload/download.")}function AN(n){return new Xe(Ye.INVALID_URL,"Invalid URL '"+n+"'.")}function CN(n){return new Xe(Ye.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+n+"'.")}function kN(){return new Xe(Ye.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+sw+"' property when initializing the app?")}function RN(){return new Xe(Ye.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function PN(){return new Xe(Ye.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function xN(n){return new Xe(Ye.UNSUPPORTED_ENVIRONMENT,`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Bd(n){return new Xe(Ye.INVALID_ARGUMENT,n)}function iw(){return new Xe(Ye.APP_DELETED,"The Firebase app was deleted.")}function ON(n){return new Xe(Ye.INVALID_ROOT_OPERATION,"The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function sa(n,e){return new Xe(Ye.INVALID_FORMAT,"String does not match format '"+n+"': "+e)}function xo(n){throw new Xe(Ye.INTERNAL_ERROR,"Internal error: "+n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=sn.makeFromUrl(e,t)}catch{return new sn(e,"")}if(r.path==="")return r;throw CN(e)}static makeFromUrl(e,t){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i($){$.path.charAt($.path.length-1)==="/"&&($.path_=$.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+s+o,"i"),l={bucket:1,path:3};function c($){$.path_=decodeURIComponent($.path)}const h="v[A-Za-z0-9_]+",d=t.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${d}/${h}/b/${s}/o${f}`,"i"),y={bucket:1,path:3},T=t===rw?"(?:storage.googleapis.com|storage.cloud.google.com)":t,w="([^?#]*)",P=new RegExp(`^https?://${T}/${s}/${w}`,"i"),D=[{regex:a,indices:l,postModify:i},{regex:m,indices:y,postModify:c},{regex:P,indices:{bucket:1,path:2},postModify:c}];for(let $=0;$<D.length;$++){const q=D[$],F=q.regex.exec(e);if(F){const A=F[q.indices.bucket];let _=F[q.indices.path];_||(_=""),r=new sn(A,_),q.postModify(r);break}}if(r==null)throw AN(e);return r}}class MN{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(n,e,t){let r=1,s=null,i=null,o=!1,a=0;function l(){return a===2}let c=!1;function h(...w){c||(c=!0,e.apply(null,w))}function d(w){s=setTimeout(()=>{s=null,n(m,l())},w)}function f(){i&&clearTimeout(i)}function m(w,...P){if(c){f();return}if(w){f(),h.call(null,w,...P);return}if(l()||o){f(),h.call(null,w,...P);return}r<64&&(r*=2);let D;a===1?(a=2,D=0):D=(r+Math.random())*1e3,d(D)}let y=!1;function T(w){y||(y=!0,f(),!c&&(s!==null?(w||(a=2),clearTimeout(s),d(0)):w||(a=1)))}return d(0),i=setTimeout(()=>{o=!0,T(!0)},t),T}function DN(n){n(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(n){return n!==void 0}function VN(n){return typeof n=="object"&&!Array.isArray(n)}function Ap(n){return typeof n=="string"||n instanceof String}function a_(n){return Cp()&&n instanceof Blob}function Cp(){return typeof Blob<"u"}function l_(n,e,t,r){if(r<e)throw Bd(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw Bd(`Invalid value for '${n}'. Expected ${t} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kp(n,e,t){let r=e;return t==null&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function ow(n){const e=encodeURIComponent;let t="?";for(const r in n)if(n.hasOwnProperty(r)){const s=e(r)+"="+e(n[r]);t=t+s+"&"}return t=t.slice(0,-1),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fs;(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"})(Fs||(Fs={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FN(n,e){const t=n>=500&&n<600,s=[408,429].indexOf(n)!==-1,i=e.indexOf(n)!==-1;return t||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e,t,r,s,i,o,a,l,c,h,d,f=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=h,this.connectionFactory_=d,this.retry=f,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((m,y)=>{this.resolve_=m,this.reject_=y,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new Cl(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const a=i.getErrorCode()===Fs.NO_ERROR,l=i.getStatus();if(!a||FN(l,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Fs.ABORT;r(!1,new Cl(!1,null,h));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new Cl(c,i))})},t=(r,s)=>{const i=this.resolve_,o=this.reject_,a=s.connection;if(s.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());LN(l)?i(l):i()}catch(l){o(l)}else if(a!==null){const l=Ip();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(s.canceled){const l=this.appDelete_?iw():IN();o(l)}else{const l=SN();o(l)}};this.canceled_?t(!1,new Cl(!1,null,!0)):this.backoffId_=NN(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&DN(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Cl{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function UN(n,e){e!==null&&e.length>0&&(n.Authorization="Firebase "+e)}function $N(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function zN(n,e){e&&(n["X-Firebase-GMPID"]=e)}function jN(n,e){e!==null&&(n["X-Firebase-AppCheck"]=e)}function HN(n,e,t,r,s,i,o=!0){const a=ow(n.urlParams),l=n.url+a,c=Object.assign({},n.headers);return zN(c,e),UN(c,t),$N(c,i),jN(c,r),new BN(l,n.method,c,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qN(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function WN(...n){const e=qN();if(e!==void 0){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}else{if(Cp())return new Blob(n);throw new Xe(Ye.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function KN(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(n){if(typeof atob>"u")throw xN("base-64");return atob(n)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Rh{constructor(e,t){this.data=e,this.contentType=t||null}}function JN(n,e){switch(n){case Vn.RAW:return new Rh(aw(e));case Vn.BASE64:case Vn.BASE64URL:return new Rh(lw(n,e));case Vn.DATA_URL:return new Rh(YN(e),XN(e))}throw Ip()}function aw(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(t<n.length-1&&(n.charCodeAt(t+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=n.charCodeAt(++t);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function QN(n){let e;try{e=decodeURIComponent(n)}catch{throw sa(Vn.DATA_URL,"Malformed data URL.")}return aw(e)}function lw(n,e){switch(n){case Vn.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw sa(n,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case Vn.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw sa(n,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=GN(e)}catch(s){throw s.message.includes("polyfill")?s:sa(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r}class cw{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(t===null)throw sa(Vn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;r!=null&&(this.base64=ZN(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function YN(n){const e=new cw(n);return e.base64?lw(Vn.BASE64,e.rest):QN(e.rest)}function XN(n){return new cw(n).contentType}function ZN(n,e){return n.length>=e.length?n.substring(n.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e,t){let r=0,s="";a_(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,t){if(a_(this.data_)){const r=this.data_,s=KN(r,e,t);return s===null?null:new Vr(s)}else{const r=new Uint8Array(this.data_.buffer,e,t-e);return new Vr(r,!0)}}static getBlob(...e){if(Cp()){const t=e.map(r=>r instanceof Vr?r.data_:r);return new Vr(WN.apply(null,t))}else{const t=e.map(o=>Ap(o)?JN(Vn.RAW,o).data:o.data_);let r=0;t.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return t.forEach(o=>{for(let a=0;a<o.length;a++)s[i++]=o[a]}),new Vr(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uw(n){let e;try{e=JSON.parse(n)}catch{return null}return VN(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eD(n){if(n.length===0)return null;const e=n.lastIndexOf("/");return e===-1?"":n.slice(0,e)}function tD(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return n.length===0?t:n+"/"+t}function hw(n){const e=n.lastIndexOf("/",n.length-2);return e===-1?n:n.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(n,e){return e}let Bt=class{constructor(e,t,r,s){this.server=e,this.local=t||e,this.writable=!!r,this.xform=s||nD}},kl=null;function rD(n){return!Ap(n)||n.length<2?n:hw(n)}function dw(){if(kl)return kl;const n=[];n.push(new Bt("bucket")),n.push(new Bt("generation")),n.push(new Bt("metageneration")),n.push(new Bt("name","fullPath",!0));function e(i,o){return rD(o)}const t=new Bt("name");t.xform=e,n.push(t);function r(i,o){return o!==void 0?Number(o):o}const s=new Bt("size");return s.xform=r,n.push(s),n.push(new Bt("timeCreated")),n.push(new Bt("updated")),n.push(new Bt("md5Hash",null,!0)),n.push(new Bt("cacheControl",null,!0)),n.push(new Bt("contentDisposition",null,!0)),n.push(new Bt("contentEncoding",null,!0)),n.push(new Bt("contentLanguage",null,!0)),n.push(new Bt("contentType",null,!0)),n.push(new Bt("metadata","customMetadata",!0)),kl=n,kl}function sD(n,e){function t(){const r=n.bucket,s=n.fullPath,i=new sn(r,s);return e._makeStorageReference(i)}Object.defineProperty(n,"ref",{get:t})}function iD(n,e,t){const r={};r.type="file";const s=t.length;for(let i=0;i<s;i++){const o=t[i];r[o.local]=o.xform(r,e[o.server])}return sD(r,n),r}function fw(n,e,t){const r=uw(e);return r===null?null:iD(n,r,t)}function oD(n,e,t,r){const s=uw(e);if(s===null||!Ap(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(c=>{const h=n.bucket,d=n.fullPath,f="/b/"+o(h)+"/o/"+o(d),m=kp(f,t,r),y=ow({alt:"media",token:c});return m+y})[0]}function aD(n,e){const t={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(t[i.server]=n[i.local])}return JSON.stringify(t)}class pw{constructor(e,t,r,s){this.url=e,this.method=t,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mw(n){if(!n)throw Ip()}function lD(n,e){function t(r,s){const i=fw(n,s,e);return mw(i!==null),i}return t}function cD(n,e){function t(r,s){const i=fw(n,s,e);return mw(i!==null),oD(i,s,n.host,n._protocol)}return t}function gw(n){function e(t,r){let s;return t.getStatus()===401?t.getErrorText().includes("Firebase App Check token is invalid")?s=wN():s=TN():t.getStatus()===402?s=vN(n.bucket):t.getStatus()===403?s=bN(n.path):s=r,s.status=t.getStatus(),s.serverResponse=r.serverResponse,s}return e}function uD(n){const e=gw(n);function t(r,s){let i=e(r,s);return r.getStatus()===404&&(i=EN(n.path)),i.serverResponse=s.serverResponse,i}return t}function hD(n,e,t){const r=e.fullServerUrl(),s=kp(r,n.host,n._protocol),i="GET",o=n.maxOperationRetryTime,a=new pw(s,i,cD(n,t),o);return a.errorHandler=uD(e),a}function dD(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}function fD(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=dD(null,e)),r}function pD(n,e,t,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function a(){let D="";for(let $=0;$<2;$++)D=D+Math.random().toString().slice(2);return D}const l=a();o["Content-Type"]="multipart/related; boundary="+l;const c=fD(e,r,s),h=aD(c,t),d="--"+l+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+l+`\r
Content-Type: `+c.contentType+`\r
\r
`,f=`\r
--`+l+"--",m=Vr.getBlob(d,r,f);if(m===null)throw RN();const y={name:c.fullPath},T=kp(i,n.host,n._protocol),w="POST",P=n.maxUploadRetryTime,O=new pw(T,w,lD(n,t),P);return O.urlParams=y,O.headers=o,O.body=m.uploadData(),O.errorHandler=gw(e),O}class mD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Fs.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Fs.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Fs.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,s){if(this.sent_)throw xo("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw xo("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw xo("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw xo("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw xo("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class gD extends mD{initXhr(){this.xhr_.responseType="text"}}function yw(){return new gD}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ys{constructor(e,t){this._service=e,t instanceof sn?this._location=t:this._location=sn.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ys(e,t)}get root(){const e=new sn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return hw(this._location.path)}get storage(){return this._service}get parent(){const e=eD(this._location.path);if(e===null)return null;const t=new sn(this._location.bucket,e);return new Ys(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw ON(e)}}function yD(n,e,t){n._throwIfRoot("uploadBytes");const r=pD(n.storage,n._location,dw(),new Vr(e,!0),t);return n.storage.makeRequestWithTokens(r,yw).then(s=>({metadata:s,ref:n}))}function _D(n){n._throwIfRoot("getDownloadURL");const e=hD(n.storage,n._location,dw());return n.storage.makeRequestWithTokens(e,yw).then(t=>{if(t===null)throw PN();return t})}function ED(n,e){const t=tD(n._location.path,e),r=new sn(n._location.bucket,t);return new Ys(n.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vD(n){return/^[A-Za-z]+:\/\//.test(n)}function TD(n,e){return new Ys(n,e)}function _w(n,e){if(n instanceof Rp){const t=n;if(t._bucket==null)throw kN();const r=new Ys(t,t._bucket);return e!=null?_w(r,e):r}else return e!==void 0?ED(n,e):n}function wD(n,e){if(e&&vD(e)){if(n instanceof Rp)return TD(n,e);throw Bd("To use ref(service, url), the first argument must be a Storage instance.")}else return _w(n,e)}function c_(n,e){const t=e==null?void 0:e[sw];return t==null?null:sn.makeFromBucketSpec(t,n)}function bD(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:s}=r;s&&(n._overrideAuthToken=typeof s=="string"?s:Bv(s,n.app.options.projectId))}class Rp{constructor(e,t,r,s,i){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=rw,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=yN,this._maxUploadRetryTime=_N,this._requests=new Set,s!=null?this._bucket=sn.makeFromBucketSpec(s,this._host):this._bucket=c_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=sn.makeFromBucketSpec(this._url,e):this._bucket=c_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){l_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){l_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ys(this,e)}_makeRequest(e,t,r,s,i=!0){if(this._deleted)return new MN(iw());{const o=HN(e,this._appId,r,s,t,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,t){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,s).getPromise()}}const u_="@firebase/storage",h_="0.12.5";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ew="storage";function g4(n,e,t){return n=Qe(n),yD(n,e,t)}function y4(n){return n=Qe(n),_D(n)}function _4(n,e){return n=Qe(n),wD(n,e)}function SD(n=Mf(),e){n=Qe(n);const r=uu(n,Ew).getImmediate({identifier:e}),s=Lv("storage");return s&&ID(r,...s),r}function ID(n,e,t,r={}){bD(n,e,t,r)}function AD(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),s=n.getProvider("app-check-internal");return new Rp(t,r,s,e,si)}function CD(){Ws(new ss(Ew,AD,"PUBLIC").setMultipleInstances(!0)),Un(u_,h_,""),Un(u_,h_,"esm2017")}CD();const kD={__name:"App",setup(n){const e={apiKey:"AIzaSyBrXS9zQOlmv6BfZgrTLHY402zKsE7Zm9c",authDomain:"geo-kort-og-lydbog.firebaseapp.com",databaseURL:"https://geo-kort-og-lydbog-default-rtdb.europe-west1.firebasedatabase.app",projectId:"geo-kort-og-lydbog",storageBucket:"geo-kort-og-lydbog.appspot.com",messagingSenderId:"447721431608",appId:"1:447721431608:web:d793a2a1904c6176cfbccd",measurementId:"G-5N25FFYYME"};console.log("G-5N25FFYYME");const t=zv(e);eN(t),SD(t);const r=La(!0),s=async()=>{r.value=!0;try{}catch(a){console.error("Error fetching data: ",a)}finally{r.value=!1}},i=hx(),o=yc();return GR(o,a=>{i.currentRoute.value.path}),Sf(()=>{s()}),(a,l)=>{const c=nc("router-view");return Kr(),su(Wt,null,[tt("div",null,[r.value?(Kr(),sc(dC,{key:0,loading:!0})):(Kr(),sc(c,{key:1}))]),je(EC)],64)}}},RD="modulepreload",PD=function(n){return"/"+n},d_={},On=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.all(t.map(a=>{if(a=PD(a),a in d_)return;d_[a]=!0;const l=a.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${a}"]${c}`))return;const h=document.createElement("link");if(h.rel=l?"stylesheet":RD,l||(h.as="script",h.crossOrigin=""),h.href=a,o&&h.setAttribute("nonce",o),document.head.appendChild(h),l)return new Promise((d,f)=>{h.addEventListener("load",d),h.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${a}`)))})}))}return s.then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},xD="/assets/hero-img-CemFhB33.png",OD="/assets/geografiskhave_logo_hvid_med_tekst-BklwCJA6.svg",MD={},li=n=>(ev("data-v-167c4aad"),n=n(),tv(),n),ND=li(()=>tt("div",{class:"bannerContainer"},[tt("img",{src:xD,alt:"Geografisk Have",class:"banner-image"}),tt("img",{src:OD,alt:"logo",class:"geografisk-logo"})],-1)),DD={class:"geografisk-have"},LD=li(()=>tt("h1",null,"Geografisk have",-1)),VD=li(()=>tt("p",null,"Geografisk Have er en 14 ha stor oplevelsespark og botanisk have med mere end 2000 forskellige trer, buske og planter, som er opdelt i geografiske omrder. Lad dig inspirere af Naturhaven, Krydderurtehaven, Den kologiske Kkkenhave, Staudehaven og mange flere dejlige steder.",-1)),FD={class:"button-container"},BD=li(()=>tt("button",null,"Kort",-1)),UD=li(()=>tt("button",null,"Om haven",-1)),$D=li(()=>tt("button",null,"Event",-1)),zD=li(()=>tt("button",{id:"empty"},"kun for medlemmer ",-1));function jD(n,e){const t=nc("router-link"),r=nc("bottomNav");return Kr(),su(Wt,null,[ND,tt("div",DD,[LD,VD,tt("div",FD,[je(t,{to:"/map"},{default:Br(()=>[BD]),_:1}),je(t,{to:"/omHaven"},{default:Br(()=>[UD]),_:1}),je(t,{to:"/calender"},{default:Br(()=>[$D]),_:1}),je(t,{to:"/admin"},{default:Br(()=>[zD]),_:1})])]),je(r)],64)}const HD=xv(MD,[["render",jD],["__scopeId","data-v-167c4aad"]]);function vt(n){this.content=n}vt.prototype={constructor:vt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,s=r.find(n),i=r.content.slice();return s==-1?i.push(t||n,e):(i[s+1]=e,t&&(i[s]=t)),new vt(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new vt(t)},addToStart:function(n,e){return new vt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new vt(t)},addBefore:function(n,e,t){var r=this.remove(e),s=r.content.slice(),i=r.find(n);return s.splice(i==-1?s.length:i,0,e,t),new vt(s)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=vt.from(n),n.size?new vt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=vt.from(n),n.size?new vt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=vt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};vt.from=function(n){if(n instanceof vt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new vt(e)};function vw(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let s=n.child(r),i=e.child(r);if(s==i){t+=s.nodeSize;continue}if(!s.sameMarkup(i))return t;if(s.isText&&s.text!=i.text){for(let o=0;s.text[o]==i.text[o];o++)t++;return t}if(s.content.size||i.content.size){let o=vw(s.content,i.content,t+1);if(o!=null)return o}t+=s.nodeSize}}function Tw(n,e,t,r){for(let s=n.childCount,i=e.childCount;;){if(s==0||i==0)return s==i?null:{a:t,b:r};let o=n.child(--s),a=e.child(--i),l=o.nodeSize;if(o==a){t-=l,r-=l;continue}if(!o.sameMarkup(a))return{a:t,b:r};if(o.isText&&o.text!=a.text){let c=0,h=Math.min(o.text.length,a.text.length);for(;c<h&&o.text[o.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(o.content.size||a.content.size){let c=Tw(o.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class H{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,s=0,i){for(let o=0,a=0;a<t;o++){let l=this.content[o],c=a+l.nodeSize;if(c>e&&r(l,s+a,i||null,o)!==!1&&l.content.size){let h=a+1;l.nodesBetween(Math.max(0,e-h),Math.min(l.content.size,t-h),r,s+h)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,s){let i="",o=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?s?typeof s=="function"?s(a):s:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(o?o=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,s=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(s[s.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)s.push(e.content[i]);return new H(s,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],s=0;if(t>e)for(let i=0,o=0;o<t;i++){let a=this.content[i],l=o+a.nodeSize;l>e&&((o<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-o),Math.min(a.text.length,t-o)):a=a.cut(Math.max(0,e-o-1),Math.min(a.content.size,t-o-1))),r.push(a),s+=a.nodeSize),o=l}return new H(r,s)}cutByIndex(e,t){return e==t?H.empty:e==0&&t==this.content.length?this:new H(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let s=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return s[e]=t,new H(s,i)}addToStart(e){return new H([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new H(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let s=this.content[t];e(s,r,t),r+=s.nodeSize}}findDiffStart(e,t=0){return vw(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return Tw(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Rl(0,e);if(e==this.size)return Rl(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,s=0;;r++){let i=this.child(r),o=s+i.nodeSize;if(o>=e)return o==e||t>0?Rl(r+1,o):Rl(r,s);s=o}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return H.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new H(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return H.empty;let t,r=0;for(let s=0;s<e.length;s++){let i=e[s];r+=i.nodeSize,s&&i.isText&&e[s-1].sameMarkup(i)?(t||(t=e.slice(0,s)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new H(t||e,r)}static from(e){if(!e)return H.empty;if(e instanceof H)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new H([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}H.empty=new H([],0);const Ph={index:0,offset:0};function Rl(n,e){return Ph.index=n,Ph.offset=e,Ph}function Ac(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!Ac(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!Ac(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Me=class Ud{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let s=0;s<e.length;s++){let i=e[s];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,s));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,s)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Ac(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);return r.create(t.attrs)}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Ud.none;if(e instanceof Ud)return[e];let t=e.slice();return t.sort((r,s)=>r.type.rank-s.type.rank),t}};Me.none=[];class Cc extends Error{}class X{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=bw(this.content,e+this.openStart,t);return r&&new X(r,this.openStart,this.openEnd)}removeBetween(e,t){return new X(ww(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return X.empty;let r=t.openStart||0,s=t.openEnd||0;if(typeof r!="number"||typeof s!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new X(H.fromJSON(e,t.content),r,s)}static maxOpen(e,t=!0){let r=0,s=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)s++;return new X(e,r,s)}}X.empty=new X(H.empty,0,0);function ww(n,e,t){let{index:r,offset:s}=n.findIndex(e),i=n.maybeChild(r),{index:o,offset:a}=n.findIndex(t);if(s==e||i.isText){if(a!=t&&!n.child(o).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=o)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(ww(i.content,e-s-1,t-s-1)))}function bw(n,e,t,r){let{index:s,offset:i}=n.findIndex(e),o=n.maybeChild(s);if(i==e||o.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=bw(o.content,e-i-1,t);return a&&n.replaceChild(s,o.copy(a))}function qD(n,e,t){if(t.openStart>n.depth)throw new Cc("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new Cc("Inconsistent open depths");return Sw(n,e,t,0)}function Sw(n,e,t,r){let s=n.index(r),i=n.node(r);if(s==e.index(r)&&r<n.depth-t.openStart){let o=Sw(n,e,t,r+1);return i.copy(i.content.replaceChild(s,o))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let o=n.parent,a=o.content;return Us(o,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:o,end:a}=WD(t,n);return Us(i,Aw(n,o,a,e,r))}else return Us(i,kc(n,e,r))}function Iw(n,e){if(!e.type.compatibleContent(n.type))throw new Cc("Cannot join "+e.type.name+" onto "+n.type.name)}function $d(n,e,t){let r=n.node(t);return Iw(r,e.node(t)),r}function Bs(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function ia(n,e,t,r){let s=(e||n).node(t),i=0,o=e?e.index(t):s.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(Bs(n.nodeAfter,r),i++));for(let a=i;a<o;a++)Bs(s.child(a),r);e&&e.depth==t&&e.textOffset&&Bs(e.nodeBefore,r)}function Us(n,e){return n.type.checkContent(e),n.copy(e)}function Aw(n,e,t,r,s){let i=n.depth>s&&$d(n,e,s+1),o=r.depth>s&&$d(t,r,s+1),a=[];return ia(null,n,s,a),i&&o&&e.index(s)==t.index(s)?(Iw(i,o),Bs(Us(i,Aw(n,e,t,r,s+1)),a)):(i&&Bs(Us(i,kc(n,e,s+1)),a),ia(e,t,s,a),o&&Bs(Us(o,kc(t,r,s+1)),a)),ia(r,null,s,a),new H(a)}function kc(n,e,t){let r=[];if(ia(null,n,t,r),n.depth>t){let s=$d(n,e,t+1);Bs(Us(s,kc(n,e,t+1)),r)}return ia(e,null,t,r),new H(r)}function WD(n,e){let t=e.depth-n.openStart,s=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)s=e.node(i).copy(H.from(s));return{start:s.resolveNoCache(n.openStart+t),end:s.resolveNoCache(s.content.size-n.openEnd-t)}}class Aa{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],s=e.child(t);return r?e.child(t).cut(r):s}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],s=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)s+=r.child(i).nodeSize;return s}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Me.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),s=e.maybeChild(t);if(!r){let a=r;r=s,s=a}let i=r.marks;for(var o=0;o<i.length;o++)i[o].type.spec.inclusive===!1&&(!s||!i[o].isInSet(s.marks))&&(i=i[o--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,s=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!s||!r[i].isInSet(s.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new Rc(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],s=0,i=t;for(let o=e;;){let{index:a,offset:l}=o.content.findIndex(i),c=i-l;if(r.push(o,a,s+l),!c||(o=o.child(a),o.isText))break;i=c-1,s+=l+1}return new Aa(t,r,i)}static resolveCached(e,t){for(let s=0;s<xh.length;s++){let i=xh[s];if(i.pos==t&&i.doc==e)return i}let r=xh[Oh]=Aa.resolve(e,t);return Oh=(Oh+1)%KD,r}}let xh=[],Oh=0,KD=12;class Rc{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const GD=Object.create(null);let $s=class zd{constructor(e,t,r,s=Me.none){this.type=e,this.attrs=t,this.marks=s,this.content=r||H.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,s=0){this.content.nodesBetween(e,t,r,s,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,s){return this.content.textBetween(e,t,r,s)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&Ac(this.attrs,t||e.defaultAttrs||GD)&&Me.sameSet(this.marks,r||Me.none)}copy(e=null){return e==this.content?this:new zd(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new zd(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return X.empty;let s=this.resolve(e),i=this.resolve(t),o=r?0:s.sharedDepth(t),a=s.start(o),c=s.node(o).content.cut(s.pos-a,i.pos-a);return new X(c,s.depth-o,i.depth-o)}replace(e,t,r){return qD(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:s}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(s==e||t.isText)return t;e-=s+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let s=this.content.child(t-1);return{node:s,index:t-1,offset:r-s.nodeSize}}resolve(e){return Aa.resolveCached(this,e)}resolveNoCache(e){return Aa.resolve(this,e)}rangeHasMark(e,t,r){let s=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(s=!0),!s)),s}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Cw(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=H.empty,s=0,i=r.childCount){let o=this.contentMatchAt(e).matchFragment(r,s,i),a=o&&o.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=s;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,s){if(s&&!this.type.allowsMarks(s))return!1;let i=this.contentMatchAt(e).matchType(r),o=i&&i.matchFragment(this.content,t);return o?o.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content);let e=Me.none;for(let t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!Me.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let s=H.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,s,r)}};$s.prototype.text=void 0;class Pc extends $s{constructor(e,t,r,s){if(super(e,t,null,s),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Cw(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new Pc(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new Pc(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Cw(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class Xs{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new JD(e,t);if(r.next==null)return Xs.empty;let s=kw(r);r.next&&r.err("Unexpected trailing text");let i=nL(tL(s));return rL(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let s=this;for(let i=t;s&&i<r;i++)s=s.matchType(e.child(i).type);return s}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let s=[this];function i(o,a){let l=o.matchFragment(e,r);if(l&&(!t||l.validEnd))return H.from(a.map(c=>c.createAndFill()));for(let c=0;c<o.next.length;c++){let{type:h,next:d}=o.next[c];if(!(h.isText||h.hasRequiredAttrs())&&s.indexOf(d)==-1){s.push(d);let f=i(d,a.concat(h));if(f)return f}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let s=r.shift(),i=s.match;if(i.matchType(e)){let o=[];for(let a=s;a.type;a=a.via)o.push(a.type);return o.reverse()}for(let o=0;o<i.next.length;o++){let{type:a,next:l}=i.next[o];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!s.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:s}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let s=0;s<r.next.length;s++)e.indexOf(r.next[s].next)==-1&&t(r.next[s].next)}return t(this),e.map((r,s)=>{let i=s+(r.validEnd?"*":" ")+" ";for(let o=0;o<r.next.length;o++)i+=(o?", ":"")+r.next[o].type.name+"->"+e.indexOf(r.next[o].next);return i}).join(`
`)}}Xs.empty=new Xs(!0);class JD{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function kw(n){let e=[];do e.push(QD(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function QD(n){let e=[];do e.push(YD(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function YD(n){let e=eL(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=XD(n,e);else break;return e}function f_(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function XD(n,e){let t=f_(n),r=t;return n.eat(",")&&(n.next!="}"?r=f_(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function ZD(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let s=[];for(let i in t){let o=t[i];o.groups.indexOf(e)>-1&&s.push(o)}return s.length==0&&n.err("No node type or group '"+e+"' found"),s}function eL(n){if(n.eat("(")){let e=kw(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=ZD(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function tL(n){let e=[[]];return s(i(n,0),t()),e;function t(){return e.push([])-1}function r(o,a,l){let c={term:l,to:a};return e[o].push(c),c}function s(o,a){o.forEach(l=>l.to=a)}function i(o,a){if(o.type=="choice")return o.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(o.type=="seq")for(let l=0;;l++){let c=i(o.exprs[l],a);if(l==o.exprs.length-1)return c;s(c,a=t())}else if(o.type=="star"){let l=t();return r(a,l),s(i(o.expr,l),l),[r(l)]}else if(o.type=="plus"){let l=t();return s(i(o.expr,a),l),s(i(o.expr,l),l),[r(l)]}else{if(o.type=="opt")return[r(a)].concat(i(o.expr,a));if(o.type=="range"){let l=a;for(let c=0;c<o.min;c++){let h=t();s(i(o.expr,l),h),l=h}if(o.max==-1)s(i(o.expr,l),l);else for(let c=o.min;c<o.max;c++){let h=t();r(l,h),s(i(o.expr,l),h),l=h}return[r(l)]}else{if(o.type=="name")return[r(a,void 0,o.value)];throw new Error("Unknown expr type")}}}}function Rw(n,e){return e-n}function p_(n,e){let t=[];return r(e),t.sort(Rw);function r(s){let i=n[s];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(s);for(let o=0;o<i.length;o++){let{term:a,to:l}=i[o];!a&&t.indexOf(l)==-1&&r(l)}}}function nL(n){let e=Object.create(null);return t(p_(n,0));function t(r){let s=[];r.forEach(o=>{n[o].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let h=0;h<s.length;h++)s[h][0]==a&&(c=s[h][1]);p_(n,l).forEach(h=>{c||s.push([a,c=[]]),c.indexOf(h)==-1&&c.push(h)})})});let i=e[r.join(",")]=new Xs(r.indexOf(n.length-1)>-1);for(let o=0;o<s.length;o++){let a=s[o][1].sort(Rw);i.next.push({type:s[o][0],next:e[a.join(",")]||t(a)})}return i}}function rL(n,e){for(let t=0,r=[n];t<r.length;t++){let s=r[t],i=!s.validEnd,o=[];for(let a=0;a<s.next.length;a++){let{type:l,next:c}=s.next[a];o.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Pw(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function xw(n,e){let t=Object.create(null);for(let r in n){let s=e&&e[r];if(s===void 0){let i=n[r];if(i.hasDefault)s=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=s}return t}function Ow(n){let e=Object.create(null);if(n)for(let t in n)e[t]=new sL(n[t]);return e}let m_=class Mw{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Ow(r.attrs),this.defaultAttrs=Pw(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Xs.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:xw(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new $s(this,this.computeAttrs(e),H.from(t),Me.setFrom(r))}createChecked(e=null,t,r){return t=H.from(t),this.checkContent(t),new $s(this,this.computeAttrs(e),t,Me.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=H.from(t),t.size){let o=this.contentMatch.fillBefore(t);if(!o)return null;t=o.append(t)}let s=this.contentMatch.matchFragment(t),i=s&&s.fillBefore(H.empty,!0);return i?new $s(this,e,t.append(i),Me.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Me.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,o)=>r[i]=new Mw(i,t,o));let s=t.spec.topNode||"doc";if(!r[s])throw new RangeError("Schema is missing its top node type ('"+s+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};class sL{constructor(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default}get isRequired(){return!this.hasDefault}}class Ou{constructor(e,t,r,s){this.name=e,this.rank=t,this.schema=r,this.spec=s,this.attrs=Ow(s.attrs),this.excluded=null;let i=Pw(this.attrs);this.instance=i?new Me(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Me(this,xw(this.attrs,e))}static compile(e,t){let r=Object.create(null),s=0;return e.forEach((i,o)=>r[i]=new Ou(i,s++,t,o)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}excludes(e){return this.excluded.indexOf(e)>-1}}class iL{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let s in e)t[s]=e[s];t.nodes=vt.from(e.nodes),t.marks=vt.from(e.marks||{}),this.nodes=m_.compile(this.spec.nodes,this),this.marks=Ou.compile(this.spec.marks,this);let r=Object.create(null);for(let s in this.nodes){if(s in this.marks)throw new RangeError(s+" can not be both a node and a mark");let i=this.nodes[s],o=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[o]||(r[o]=Xs.parse(o,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?g_(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let s in this.marks){let i=this.marks[s],o=i.spec.excludes;i.excluded=o==null?[i]:o==""?[]:g_(this,o.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,s){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof m_){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,s)}text(e,t){let r=this.nodes.text;return new Pc(r,r.defaultAttrs,e,Me.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return $s.fromJSON(this,e)}markFromJSON(e){return Me.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function g_(n,e){let t=[];for(let r=0;r<e.length;r++){let s=e[r],i=n.marks[s],o=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(s=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(s)>-1)&&t.push(o=l)}if(!o)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function oL(n){return n.tag!=null}function aL(n){return n.style!=null}class Xi{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach(r=>{oL(r)?this.tags.push(r):aL(r)&&this.styles.push(r)}),this.normalizeLists=!this.tags.some(r=>{if(!/^(ul|ol)\b/.test(r.tag)||!r.node)return!1;let s=e.nodes[r.node];return s.contentMatch.matchType(s)})}parse(e,t={}){let r=new __(this,t,!1);return r.addAll(e,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new __(this,t,!0);return r.addAll(e,t.from,t.to),X.maxOpen(r.finish())}matchTag(e,t,r){for(let s=r?this.tags.indexOf(r)+1:0;s<this.tags.length;s++){let i=this.tags[s];if(uL(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let o=i.getAttrs(e);if(o===!1)continue;i.attrs=o||void 0}return i}}}matchStyle(e,t,r,s){for(let i=s?this.styles.indexOf(s)+1:0;i<this.styles.length;i++){let o=this.styles[i],a=o.style;if(!(a.indexOf(e)!=0||o.context&&!r.matchesContext(o.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(o.getAttrs){let l=o.getAttrs(t);if(l===!1)continue;o.attrs=l||void 0}return o}}}static schemaRules(e){let t=[];function r(s){let i=s.priority==null?50:s.priority,o=0;for(;o<t.length;o++){let a=t[o];if((a.priority==null?50:a.priority)<i)break}t.splice(o,0,s)}for(let s in e.marks){let i=e.marks[s].spec.parseDOM;i&&i.forEach(o=>{r(o=E_(o)),o.mark||o.ignore||o.clearMark||(o.mark=s)})}for(let s in e.nodes){let i=e.nodes[s].spec.parseDOM;i&&i.forEach(o=>{r(o=E_(o)),o.node||o.ignore||o.mark||(o.node=s)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Xi(e,Xi.schemaRules(e)))}}const Nw={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},lL={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Dw={ol:!0,ul:!0},xc=1,Oc=2,oa=4;function y_(n,e,t){return e!=null?(e?xc:0)|(e==="full"?Oc:0):n&&n.whitespace=="pre"?xc|Oc:t&~oa}class Pl{constructor(e,t,r,s,i,o,a){this.type=e,this.attrs=t,this.marks=r,this.pendingMarks=s,this.solid=i,this.options=a,this.content=[],this.activeMarks=Me.none,this.stashMarks=[],this.match=o||(a&oa?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(H.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,s;return(s=r.findWrapping(e.type))?(this.match=r,s):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&xc)){let r=this.content[this.content.length-1],s;if(r&&r.isText&&(s=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==s[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-s[0].length))}}let t=H.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(H.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}popFromStashMark(e){for(let t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]}applyPending(e){for(let t=0,r=this.pendingMarks;t<r.length;t++){let s=r[t];(this.type?this.type.allowsMarkType(s.type):dL(s.type,e))&&!s.isInSet(this.activeMarks)&&(this.activeMarks=s.addToSet(this.activeMarks),this.pendingMarks=s.removeFromSet(this.pendingMarks))}}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Nw.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class __{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0;let s=t.topNode,i,o=y_(null,t.preserveWhitespace,0)|(r?oa:0);s?i=new Pl(s.type,s.attrs,Me.none,Me.none,!0,t.topMatch||s.type.contentMatch,o):r?i=new Pl(null,null,Me.none,Me.none,!0,null,o):i=new Pl(e.schema.topNodeType,null,Me.none,Me.none,!0,null,o),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e){e.nodeType==3?this.addTextNode(e):e.nodeType==1&&this.addElement(e)}withStyleRules(e,t){let r=e.getAttribute("style");if(!r)return t();let s=this.readStyles(hL(r));if(!s)return;let[i,o]=s,a=this.top;for(let l=0;l<o.length;l++)this.removePendingMark(o[l],a);for(let l=0;l<i.length;l++)this.addPendingMark(i[l]);t();for(let l=0;l<i.length;l++)this.removePendingMark(i[l],a);for(let l=0;l<o.length;l++)this.addPendingMark(o[l])}addTextNode(e){let t=e.nodeValue,r=this.top;if(r.options&Oc||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(r.options&xc)r.options&Oc?t=t.replace(/\r\n?/g,`
`):t=t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){let s=r.content[r.content.length-1],i=e.previousSibling;(!s||i&&i.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)}addElement(e,t){let r=e.nodeName.toLowerCase(),s;Dw.hasOwnProperty(r)&&this.parser.normalizeLists&&cL(e);let i=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,t));if(i?i.ignore:lL.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!i||i.skip||i.closeParent){i&&i.closeParent?this.open=Math.max(0,this.open-1):i&&i.skip.nodeType&&(e=i.skip);let o,a=this.top,l=this.needsBlock;if(Nw.hasOwnProperty(r))a.content.length&&a.content[0].isInline&&this.open&&(this.open--,a=this.top),o=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e);return}i&&i.skip?this.addAll(e):this.withStyleRules(e,()=>this.addAll(e)),o&&this.sync(a),this.needsBlock=l}else this.withStyleRules(e,()=>{this.addElementByRule(e,i,i.consuming===!1?s:void 0)})}leafFallback(e){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`))}ignoreFallback(e){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(e){let t=Me.none,r=Me.none;for(let s=0;s<e.length;s+=2)for(let i=void 0;;){let o=this.parser.matchStyle(e[s],e[s+1],this,i);if(!o)break;if(o.ignore)return null;if(o.clearMark?this.top.pendingMarks.concat(this.top.activeMarks).forEach(a=>{o.clearMark(a)&&(r=a.addToSet(r))}):t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),o.consuming===!1)i=o;else break}return[t,r]}addElementByRule(e,t,r){let s,i,o;t.node?(i=this.parser.schema.nodes[t.node],i.isLeaf?this.insertNode(i.create(t.attrs))||this.leafFallback(e):s=this.enter(i,t.attrs||null,t.preserveWhitespace)):(o=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(o));let a=this.top;if(i&&i.isLeaf)this.findInside(e);else if(r)this.addElement(e,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l)}s&&this.sync(a)&&this.open--,o&&this.removePendingMark(o,a)}addAll(e,t,r){let s=t||0;for(let i=t?e.childNodes[t]:e.firstChild,o=r==null?null:e.childNodes[r];i!=o;i=i.nextSibling,++s)this.findAtPoint(e,s),this.addDOM(i);this.findAtPoint(e,s)}findPlace(e){let t,r;for(let s=this.open;s>=0;s--){let i=this.nodes[s],o=i.findWrapping(e);if(o&&(!t||t.length>o.length)&&(t=o,r=i,!o.length)||i.solid)break}if(!t)return!1;this.sync(r);for(let s=0;s<t.length;s++)this.enterInner(t[s],null,!1);return!0}insertNode(e){if(e.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();let t=this.top;t.applyPending(e.type),t.match&&(t.match=t.match.matchType(e.type));let r=t.activeMarks;for(let s=0;s<e.marks.length;s++)(!t.type||t.type.allowsMarkType(e.marks[s].type))&&(r=e.marks[s].addToSet(r));return t.content.push(e.mark(r)),!0}return!1}enter(e,t,r){let s=this.findPlace(e.create(t));return s&&this.enterInner(e,t,!0,r),s}enterInner(e,t=null,r=!1,s){this.closeExtra();let i=this.top;i.applyPending(e),i.match=i.match&&i.match.matchType(e);let o=y_(e,s,i.options);i.options&oa&&i.content.length==0&&(o|=oa),this.nodes.push(new Pl(e,t,i.activeMarks,i.pendingMarks,r,null,o)),this.open++}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let s=r.length-1;s>=0;s--)e+=r[s].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let s=0;s<this.find.length;s++)this.find[s].pos==null&&e.nodeType==1&&e.contains(this.find[s].node)&&t.compareDocumentPosition(this.find[s].node)&(r?2:4)&&(this.find[s].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,s=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(s?0:1),o=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(o(a-1,l))return!0;return!1}else{let h=l>0||l==0&&s?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!h||h.name!=c&&h.groups.indexOf(c)==-1)return!1;l--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}addPendingMark(e){let t=fL(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)}removePendingMark(e,t){for(let r=this.open;r>=0;r--){let s=this.nodes[r];if(s.pendingMarks.lastIndexOf(e)>-1)s.pendingMarks=e.removeFromSet(s.pendingMarks);else{s.activeMarks=e.removeFromSet(s.activeMarks);let o=s.popFromStashMark(e);o&&s.type&&s.type.allowsMarkType(o.type)&&(s.activeMarks=o.addToSet(s.activeMarks))}if(s==t)break}}}function cL(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Dw.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function uL(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function hL(n){let e=/\s*([\w-]+)\s*:\s*([^;]+)/g,t,r=[];for(;t=e.exec(n);)r.push(t[1],t[2].trim());return r}function E_(n){let e={};for(let t in n)e[t]=n[t];return e}function dL(n,e){let t=e.schema.nodes;for(let r in t){let s=t[r];if(!s.allowsMarkType(n))continue;let i=[],o=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:h}=a.edge(l);if(c==e||i.indexOf(h)<0&&o(h))return!0}};if(o(s.contentMatch))return!0}}function fL(n,e){for(let t=0;t<e.length;t++)if(n.eq(e[t]))return e[t]}class Fn{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Mh(t).createDocumentFragment());let s=r,i=[];return e.forEach(o=>{if(i.length||o.marks.length){let a=0,l=0;for(;a<i.length&&l<o.marks.length;){let c=o.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)s=i.pop()[1];for(;l<o.marks.length;){let c=o.marks[l++],h=this.serializeMark(c,o.isInline,t);h&&(i.push([c,s]),s.appendChild(h.dom),s=h.contentDOM||h.dom)}}s.appendChild(this.serializeNodeInner(o,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:s}=Fn.renderSpec(Mh(t),this.nodes[e.type.name](e));if(s){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,s)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let s=e.marks.length-1;s>=0;s--){let i=this.serializeMark(e.marks[s],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let s=this.marks[e.type.name];return s&&Fn.renderSpec(Mh(r),s(e,t))}static renderSpec(e,t,r=null){if(typeof t=="string")return{dom:e.createTextNode(t)};if(t.nodeType!=null)return{dom:t};if(t.dom&&t.dom.nodeType!=null)return t;let s=t[0],i=s.indexOf(" ");i>0&&(r=s.slice(0,i),s=s.slice(i+1));let o,a=r?e.createElementNS(r,s):e.createElement(s),l=t[1],c=1;if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){c=2;for(let h in l)if(l[h]!=null){let d=h.indexOf(" ");d>0?a.setAttributeNS(h.slice(0,d),h.slice(d+1),l[h]):a.setAttribute(h,l[h])}}for(let h=c;h<t.length;h++){let d=t[h];if(d===0){if(h<t.length-1||h>c)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}else{let{dom:f,contentDOM:m}=Fn.renderSpec(e,d,r);if(a.appendChild(f),m){if(o)throw new RangeError("Multiple content holes");o=m}}}return{dom:a,contentDOM:o}}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Fn(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=v_(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return v_(e.marks)}}function v_(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Mh(n){return n.document||window.document}const Lw=65535,Vw=Math.pow(2,16);function pL(n,e){return n+e*Vw}function T_(n){return n&Lw}function mL(n){return(n-(n&Lw))/Vw}const Fw=1,Bw=2,Jl=4,Uw=8;class jd{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&Uw)>0}get deletedBefore(){return(this.delInfo&(Fw|Jl))>0}get deletedAfter(){return(this.delInfo&(Bw|Jl))>0}get deletedAcross(){return(this.delInfo&Jl)>0}}class nn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&nn.empty)return nn.empty}recover(e){let t=0,r=T_(e);if(!this.inverted)for(let s=0;s<r;s++)t+=this.ranges[s*3+2]-this.ranges[s*3+1];return this.ranges[r*3]+t+mL(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let s=0,i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?s:0);if(l>e)break;let c=this.ranges[a+i],h=this.ranges[a+o],d=l+c;if(e<=d){let f=c?e==l?-1:e==d?1:t:t,m=l+s+(f<0?0:h);if(r)return m;let y=e==(t<0?l:d)?null:pL(a/3,e-l),T=e==l?Bw:e==d?Fw:Jl;return(t<0?e!=l:e!=d)&&(T|=Uw),new jd(m,T,y)}s+=h-c}return r?e+s:new jd(e+s,0,null)}touches(e,t){let r=0,s=T_(t),i=this.inverted?2:1,o=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],h=l+c;if(e<=h&&a==s*3)return!0;r+=this.ranges[a+o]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let s=0,i=0;s<this.ranges.length;s+=3){let o=this.ranges[s],a=o-(this.inverted?i:0),l=o+(this.inverted?0:i),c=this.ranges[s+t],h=this.ranges[s+r];e(a,a+c,l,l+h),i+=h-c}}invert(){return new nn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?nn.empty:new nn(e<0?[0,-e,0]:[0,0,e])}}nn.empty=new nn([]);class Vi{constructor(e=[],t,r=0,s=e.length){this.maps=e,this.mirror=t,this.from=r,this.to=s}slice(e=0,t=this.maps.length){return new Vi(this.maps,this.mirror,e,t)}copy(){return new Vi(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(e,t){this.to=this.maps.push(e),t!=null&&this.setMirror(this.maps.length-1,t)}appendMapping(e){for(let t=0,r=this.maps.length;t<e.maps.length;t++){let s=e.getMirror(t);this.appendMap(e.maps[t],s!=null&&s<t?r+s:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this.maps.length+e.maps.length;t>=0;t--){let s=e.getMirror(t);this.appendMap(e.maps[t].invert(),s!=null&&s>t?r-s-1:void 0)}}invert(){let e=new Vi;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this.maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let s=0;for(let i=this.from;i<this.to;i++){let o=this.maps[i],a=o.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this.maps[l].recover(a.recover);continue}}s|=a.delInfo,e=a.pos}return r?e:new jd(e,s,null)}}const Nh=Object.create(null);class Lt{getMap(){return nn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=Nh[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Nh)throw new RangeError("Duplicate use of step JSON ID "+e);return Nh[e]=t,t.prototype.jsonID=e,t}}class ot{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new ot(e,null)}static fail(e){return new ot(null,e)}static fromReplace(e,t,r,s){try{return ot.ok(e.replace(t,r,s))}catch(i){if(i instanceof Cc)return ot.fail(i.message);throw i}}}function Pp(n,e,t){let r=[];for(let s=0;s<n.childCount;s++){let i=n.child(s);i.content.size&&(i=i.copy(Pp(i.content,e,i))),i.isInline&&(i=e(i,t,s)),r.push(i)}return H.fromArray(r)}class $r extends Lt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),s=r.node(r.sharedDepth(this.to)),i=new X(Pp(t.content,(o,a)=>!o.isAtom||!a.type.allowsMarkType(this.mark.type)?o:o.mark(this.mark.addToSet(o.marks)),s),t.openStart,t.openEnd);return ot.fromReplace(e,this.from,this.to,i)}invert(){return new Bn(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new $r(t.pos,r.pos,this.mark)}merge(e){return e instanceof $r&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new $r(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new $r(t.from,t.to,e.markFromJSON(t.mark))}}Lt.jsonID("addMark",$r);class Bn extends Lt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new X(Pp(t.content,s=>s.mark(this.mark.removeFromSet(s.marks)),e),t.openStart,t.openEnd);return ot.fromReplace(e,this.from,this.to,r)}invert(){return new $r(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new Bn(t.pos,r.pos,this.mark)}merge(e){return e instanceof Bn&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new Bn(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new Bn(t.from,t.to,e.markFromJSON(t.mark))}}Lt.jsonID("removeMark",Bn);class zr extends Lt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ot.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return ot.fromReplace(e,this.pos,this.pos+1,new X(H.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let s=0;s<t.marks.length;s++)if(!t.marks[s].isInSet(r))return new zr(this.pos,t.marks[s]);return new zr(this.pos,this.mark)}}return new Zi(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new zr(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new zr(t.pos,e.markFromJSON(t.mark))}}Lt.jsonID("addNodeMark",zr);class Zi extends Lt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return ot.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return ot.fromReplace(e,this.pos,this.pos+1,new X(H.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new zr(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Zi(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new Zi(t.pos,e.markFromJSON(t.mark))}}Lt.jsonID("removeNodeMark",Zi);class pt extends Lt{constructor(e,t,r,s=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=s}apply(e){return this.structure&&Hd(e,this.from,this.to)?ot.fail("Structure replace would overwrite content"):ot.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new nn([this.from,this.to-this.from,this.slice.size])}invert(e){return new pt(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new pt(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof pt)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?X.empty:new X(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new pt(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?X.empty:new X(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new pt(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new pt(t.from,t.to,X.fromJSON(e,t.slice),!!t.structure)}}Lt.jsonID("replace",pt);class gt extends Lt{constructor(e,t,r,s,i,o,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=s,this.slice=i,this.insert=o,this.structure=a}apply(e){if(this.structure&&(Hd(e,this.from,this.gapFrom)||Hd(e,this.gapTo,this.to)))return ot.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return ot.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?ot.fromReplace(e,this.from,this.to,r):ot.fail("Content does not fit in gap")}getMap(){return new nn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new gt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),s=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||s<t.pos||i>r.pos?null:new gt(t.pos,r.pos,s,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new gt(t.from,t.to,t.gapFrom,t.gapTo,X.fromJSON(e,t.slice),t.insert,!!t.structure)}}Lt.jsonID("replaceAround",gt);function Hd(n,e,t){let r=n.resolve(e),s=t-e,i=r.depth;for(;s>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,s--;if(s>0){let o=r.node(i).maybeChild(r.indexAfter(i));for(;s>0;){if(!o||o.isLeaf)return!0;o=o.firstChild,s--}}return!1}function gL(n,e,t,r){let s=[],i=[],o,a;n.doc.nodesBetween(e,t,(l,c,h)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&h.type.allowsMarkType(r.type)){let f=Math.max(c,e),m=Math.min(c+l.nodeSize,t),y=r.addToSet(d);for(let T=0;T<d.length;T++)d[T].isInSet(y)||(o&&o.to==f&&o.mark.eq(d[T])?o.to=m:s.push(o=new Bn(f,m,d[T])));a&&a.to==f?a.to=m:i.push(a=new $r(f,m,r))}}),s.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function yL(n,e,t,r){let s=[],i=0;n.doc.nodesBetween(e,t,(o,a)=>{if(!o.isInline)return;i++;let l=null;if(r instanceof Ou){let c=o.marks,h;for(;h=r.isInSet(c);)(l||(l=[])).push(h),c=h.removeFromSet(c)}else r?r.isInSet(o.marks)&&(l=[r]):l=o.marks;if(l&&l.length){let c=Math.min(a+o.nodeSize,t);for(let h=0;h<l.length;h++){let d=l[h],f;for(let m=0;m<s.length;m++){let y=s[m];y.step==i-1&&d.eq(s[m].style)&&(f=y)}f?(f.to=c,f.step=i):s.push({style:d,from:Math.max(a,e),to:c,step:i})}}}),s.forEach(o=>n.step(new Bn(o.from,o.to,o.style)))}function $w(n,e,t,r=t.contentMatch,s=!0){let i=n.doc.nodeAt(e),o=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),h=a+c.nodeSize,d=r.matchType(c.type);if(!d)o.push(new pt(a,h,X.empty));else{r=d;for(let f=0;f<c.marks.length;f++)t.allowsMarkType(c.marks[f].type)||n.step(new Bn(a,h,c.marks[f]));if(s&&c.isText&&t.whitespace!="pre"){let f,m=/\r?\n|\r/g,y;for(;f=m.exec(c.text);)y||(y=new X(H.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),o.push(new pt(a+f.index,a+f.index+f[0].length,y))}}a=h}if(!r.validEnd){let l=r.fillBefore(H.empty,!0);n.replace(a,a,new X(l,0,0))}for(let l=o.length-1;l>=0;l--)n.step(o[l])}function _L(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function fo(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let s=n.$from.node(r),i=n.$from.index(r),o=n.$to.indexAfter(r);if(r<n.depth&&s.canReplace(i,o,t))return r;if(r==0||s.type.spec.isolating||!_L(s,i,o))break}return null}function EL(n,e,t){let{$from:r,$to:s,depth:i}=e,o=r.before(i+1),a=s.after(i+1),l=o,c=a,h=H.empty,d=0;for(let y=i,T=!1;y>t;y--)T||r.index(y)>0?(T=!0,h=H.from(r.node(y).copy(h)),d++):l--;let f=H.empty,m=0;for(let y=i,T=!1;y>t;y--)T||s.after(y+1)<s.end(y)?(T=!0,f=H.from(s.node(y).copy(f)),m++):c++;n.step(new gt(l,c,o,a,new X(h.append(f),d,m),h.size-d,!0))}function xp(n,e,t=null,r=n){let s=vL(n,e),i=s&&TL(r,e);return i?s.map(w_).concat({type:e,attrs:t}).concat(i.map(w_)):null}function w_(n){return{type:n,attrs:null}}function vL(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let o=i.length?i[0]:e;return t.canReplaceWith(r,s,o)?i:null}function TL(n,e){let{parent:t,startIndex:r,endIndex:s}=n,i=t.child(r),o=e.contentMatch.findWrapping(i.type);if(!o)return null;let l=(o.length?o[o.length-1]:e).contentMatch;for(let c=r;l&&c<s;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:o}function wL(n,e,t){let r=H.empty;for(let o=t.length-1;o>=0;o--){if(r.size){let a=t[o].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=H.from(t[o].type.create(t[o].attrs,r))}let s=e.start,i=e.end;n.step(new gt(s,i,s,i,new X(r,0,0),t.length,!0))}function bL(n,e,t,r,s){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(o,a)=>{if(o.isTextblock&&!o.hasMarkup(r,s)&&AL(n.doc,n.mapping.slice(i).map(a),r)){let l=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",m=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!m?l=!1:!f&&m&&(l=!0)}l===!1&&IL(n,o,a,i),$w(n,n.mapping.slice(i).map(a,1),r,void 0,l===null);let c=n.mapping.slice(i),h=c.map(a,1),d=c.map(a+o.nodeSize,1);return n.step(new gt(h,d,h+1,d-1,new X(H.from(r.create(s,null,o.marks)),0,0),1,!0)),l===!0&&SL(n,o,a,i),!1}})}function SL(n,e,t,r){e.forEach((s,i)=>{if(s.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(s.text);){let l=n.mapping.slice(r).map(t+1+i+o.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function IL(n,e,t,r){e.forEach((s,i)=>{if(s.type==s.type.schema.linebreakReplacement){let o=n.mapping.slice(r).map(t+1+i);n.replaceWith(o,o+1,e.type.schema.text(`
`))}})}function AL(n,e,t){let r=n.resolve(e),s=r.index();return r.parent.canReplaceWith(s,s+1,t)}function CL(n,e,t,r,s){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let o=t.create(r,null,s||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,o);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new gt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new X(H.from(o),0,0),1,!0))}function Fi(n,e,t=1,r){let s=n.resolve(e),i=s.depth-t,o=r&&r[r.length-1]||s.parent;if(i<0||s.parent.type.spec.isolating||!s.parent.canReplace(s.index(),s.parent.childCount)||!o.type.validContent(s.parent.content.cutByIndex(s.index(),s.parent.childCount)))return!1;for(let c=s.depth-1,h=t-2;c>i;c--,h--){let d=s.node(c),f=s.index(c);if(d.type.spec.isolating)return!1;let m=d.content.cutByIndex(f,d.childCount),y=r&&r[h+1];y&&(m=m.replaceChild(0,y.type.create(y.attrs)));let T=r&&r[h]||d;if(!d.canReplace(f+1,d.childCount)||!T.type.validContent(m))return!1}let a=s.indexAfter(i),l=r&&r[0];return s.node(i).canReplaceWith(a,a,l?l.type:s.node(i+1).type)}function kL(n,e,t=1,r){let s=n.doc.resolve(e),i=H.empty,o=H.empty;for(let a=s.depth,l=s.depth-t,c=t-1;a>l;a--,c--){i=H.from(s.node(a).copy(i));let h=r&&r[c];o=H.from(h?h.type.create(h.attrs,o):s.node(a).copy(o))}n.step(new pt(e,e,new X(i.append(o),t,t),!0))}function ds(n,e){let t=n.resolve(e),r=t.index();return zw(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function zw(n,e){return!!(n&&e&&!n.isLeaf&&n.canAppend(e))}function Mu(n,e,t=-1){let r=n.resolve(e);for(let s=r.depth;;s--){let i,o,a=r.index(s);if(s==r.depth?(i=r.nodeBefore,o=r.nodeAfter):t>0?(i=r.node(s+1),a++,o=r.node(s).maybeChild(a)):(i=r.node(s).maybeChild(a-1),o=r.node(s+1)),i&&!i.isTextblock&&zw(i,o)&&r.node(s).canReplace(a,a+1))return e;if(s==0)break;e=t<0?r.before(s):r.after(s)}}function RL(n,e,t){let r=new pt(e-t,e+t,X.empty,!0);n.step(r)}function PL(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let s=r.depth-1;s>=0;s--){let i=r.index(s);if(r.node(s).canReplaceWith(i,i,t))return r.before(s+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let s=r.depth-1;s>=0;s--){let i=r.indexAfter(s);if(r.node(s).canReplaceWith(i,i,t))return r.after(s+1);if(i<r.node(s).childCount)return null}return null}function jw(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let s=t.content;for(let i=0;i<t.openStart;i++)s=s.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let o=r.depth;o>=0;o--){let a=o==r.depth?0:r.pos<=(r.start(o+1)+r.end(o+1))/2?-1:1,l=r.index(o)+(a>0?1:0),c=r.node(o),h=!1;if(i==1)h=c.canReplace(l,l,s);else{let d=c.contentMatchAt(l).findWrapping(s.firstChild.type);h=d&&c.canReplaceWith(l,l,d[0])}if(h)return a==0?r.pos:a<0?r.before(o+1):r.after(o+1)}return null}function Nu(n,e,t=e,r=X.empty){if(e==t&&!r.size)return null;let s=n.resolve(e),i=n.resolve(t);return Hw(s,i,r)?new pt(e,t,r):new xL(s,i,r).fit()}function Hw(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class xL{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=H.empty;for(let s=0;s<=e.depth;s++){let i=e.node(s);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(s))})}for(let s=e.depth;s>0;s--)this.placed=H.from(e.node(s).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,s=this.close(e<0?this.$to:r.doc.resolve(e));if(!s)return null;let i=this.placed,o=r.depth,a=s.depth;for(;o&&a&&i.childCount==1;)i=i.firstChild.content,o--,a--;let l=new X(i,o,a);return e>-1?new gt(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new pt(r.pos,s.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,s=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(s=0),i.type.spec.isolating&&s<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let s,i=null;r?(i=Dh(this.unplaced.content,r-1).firstChild,s=i.content):s=this.unplaced.content;let o=s.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],h,d=null;if(t==1&&(o?c.matchType(o.type)||(d=c.fillBefore(H.from(o),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:d};if(t==2&&o&&(h=c.findWrapping(o.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:h};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Dh(e,t);return!s.childCount||s.firstChild.isLeaf?!1:(this.unplaced=new X(e,t+1,Math.max(r,s.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,s=Dh(e,t);if(s.childCount<=1&&t>0){let i=e.size-t<=t+s.size;this.unplaced=new X(Uo(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new X(Uo(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:s,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let T=0;T<i.length;T++)this.openFrontierNode(i[T]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-e,c=0,h=[],{match:d,type:f}=this.frontier[t];if(s){for(let T=0;T<s.childCount;T++)h.push(s.child(T));d=d.matchFragment(s)}let m=a.size+e-(o.content.size-o.openEnd);for(;c<a.childCount;){let T=a.child(c),w=d.matchType(T.type);if(!w)break;c++,(c>1||l==0||T.content.size)&&(d=w,h.push(qw(T.mark(f.allowedMarks(T.marks)),c==1?l:0,c==a.childCount?m:-1)))}let y=c==a.childCount;y||(m=-1),this.placed=$o(this.placed,t,H.from(h)),this.frontier[t].match=d,y&&m<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let T=0,w=a;T<m;T++){let P=w.lastChild;this.frontier.push({type:P.type,match:P.contentMatchAt(P.childCount)}),w=P.content}this.unplaced=y?e==0?X.empty:new X(Uo(o.content,e-1,1),e-1,m<0?o.openEnd:e-1):new X(Uo(o.content,e,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!Lh(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,s=this.$to.after(r);for(;r>1&&s==this.$to.end(--r);)++s;return s}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:s}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=Lh(e,t,s,r,i);if(o){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],h=Lh(e,a,c,l,!0);if(!h||h.childCount)continue e}return{depth:t,fit:o,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=$o(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let s=e.node(r),i=s.type.contentMatch.fillBefore(s.content,!0,e.index(r));this.openFrontierNode(s.type,s.attrs,i)}return e}openFrontierNode(e,t=null,r){let s=this.frontier[this.depth];s.match=s.match.matchType(e),this.placed=$o(this.placed,this.depth,H.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(H.empty,!0);t.childCount&&(this.placed=$o(this.placed,this.frontier.length,t))}}function Uo(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Uo(n.firstChild.content,e-1,t)))}function $o(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy($o(n.lastChild.content,e-1,t)))}function Dh(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function qw(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,qw(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(H.empty,!0)))),n.copy(r)}function Lh(n,e,t,r,s){let i=n.node(e),o=s?n.indexAfter(e):n.index(e);if(o==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,o);return a&&!OL(t,i.content,o)?a:null}function OL(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function ML(n){return n.spec.defining||n.spec.definingForContent}function NL(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let s=n.doc.resolve(e),i=n.doc.resolve(t);if(Hw(s,i,r))return n.step(new pt(e,t,r));let o=Kw(s,n.doc.resolve(t));o[o.length-1]==0&&o.pop();let a=-(s.depth+1);o.unshift(a);for(let f=s.depth,m=s.pos-1;f>0;f--,m--){let y=s.node(f).type.spec;if(y.defining||y.definingAsContext||y.isolating)break;o.indexOf(f)>-1?a=f:s.before(f)==m&&o.splice(1,0,-f)}let l=o.indexOf(a),c=[],h=r.openStart;for(let f=r.content,m=0;;m++){let y=f.firstChild;if(c.push(y),m==r.openStart)break;f=y.content}for(let f=h-1;f>=0;f--){let m=c[f],y=ML(m.type);if(y&&!m.sameMarkup(s.node(Math.abs(a)-1)))h=f;else if(y||!m.type.isTextblock)break}for(let f=r.openStart;f>=0;f--){let m=(f+h+1)%(r.openStart+1),y=c[m];if(y)for(let T=0;T<o.length;T++){let w=o[(T+l)%o.length],P=!0;w<0&&(P=!1,w=-w);let O=s.node(w-1),D=s.index(w-1);if(O.canReplaceWith(D,D,y.type,y.marks))return n.replace(s.before(w),P?i.after(w):t,new X(Ww(r.content,0,r.openStart,m),m,r.openEnd))}}let d=n.steps.length;for(let f=o.length-1;f>=0&&(n.replace(e,t,r),!(n.steps.length>d));f--){let m=o[f];m<0||(e=s.before(m),t=i.after(m))}}function Ww(n,e,t,r,s){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(Ww(i.content,e+1,t,r,i)))}if(e>r){let i=s.contentMatchAt(0),o=i.fillBefore(n).append(n);n=o.append(i.matchFragment(o).fillBefore(H.empty,!0))}return n}function DL(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let s=PL(n.doc,e,r.type);s!=null&&(e=t=s)}n.replaceRange(e,t,new X(H.from(r),0,0))}function LL(n,e,t){let r=n.doc.resolve(e),s=n.doc.resolve(t),i=Kw(r,s);for(let o=0;o<i.length;o++){let a=i[o],l=o==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),s.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),s.indexAfter(a-1))))return n.delete(r.before(a),s.after(a))}for(let o=1;o<=r.depth&&o<=s.depth;o++)if(e-r.start(o)==r.depth-o&&t>r.end(o)&&s.end(o)-t!=s.depth-o)return n.delete(r.before(o),t);n.delete(e,t)}function Kw(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let s=r;s>=0;s--){let i=n.start(s);if(i<n.pos-(n.depth-s)||e.end(s)>e.pos+(e.depth-s)||n.node(s).type.spec.isolating||e.node(s).type.spec.isolating)break;(i==e.start(s)||s==n.depth&&s==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&s&&e.start(s-1)==i-1)&&t.push(s)}return t}class Bi extends Lt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return ot.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let s=t.type.create(r,null,t.marks);return ot.fromReplace(e,this.pos,this.pos+1,new X(H.from(s),0,t.isLeaf?0:1))}getMap(){return nn.empty}invert(e){return new Bi(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Bi(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new Bi(t.pos,t.attr,t.value)}}Lt.jsonID("attr",Bi);class Ca extends Lt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let s in e.attrs)t[s]=e.attrs[s];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return ot.ok(r)}getMap(){return nn.empty}invert(e){return new Ca(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ca(t.attr,t.value)}}Lt.jsonID("docAttr",Ca);let eo=class extends Error{};eo=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};eo.prototype=Object.create(Error.prototype);eo.prototype.constructor=eo;eo.prototype.name="TransformError";class VL{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Vi}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new eo(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=X.empty){let s=Nu(this.doc,e,t,r);return s&&this.step(s),this}replaceWith(e,t,r){return this.replace(e,t,new X(H.from(r),0,0))}delete(e,t){return this.replace(e,t,X.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return NL(this,e,t,r),this}replaceRangeWith(e,t,r){return DL(this,e,t,r),this}deleteRange(e,t){return LL(this,e,t),this}lift(e,t){return EL(this,e,t),this}join(e,t=1){return RL(this,e,t),this}wrap(e,t){return wL(this,e,t),this}setBlockType(e,t=e,r,s=null){return bL(this,e,t,r,s),this}setNodeMarkup(e,t,r=null,s){return CL(this,e,t,r,s),this}setNodeAttribute(e,t,r){return this.step(new Bi(e,t,r)),this}setDocAttribute(e,t){return this.step(new Ca(e,t)),this}addNodeMark(e,t){return this.step(new zr(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Me)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new Zi(e,t)),this}split(e,t=1,r){return kL(this,e,t,r),this}addMark(e,t,r){return gL(this,e,t,r),this}removeMark(e,t,r){return yL(this,e,t,r),this}clearIncompatible(e,t,r){return $w(this,e,t,r),this}}const Vh=Object.create(null);class Ee{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new FL(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=X.empty){let r=t.content.lastChild,s=null;for(let a=0;a<t.openEnd;a++)s=r,r=r.lastChild;let i=e.steps.length,o=this.ranges;for(let a=0;a<o.length;a++){let{$from:l,$to:c}=o[a],h=e.mapping.slice(i);e.replaceRange(h.map(l.pos),h.map(c.pos),a?X.empty:t),a==0&&I_(e,i,(r?r.isInline:s&&s.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,s=this.ranges;for(let i=0;i<s.length;i++){let{$from:o,$to:a}=s[i],l=e.mapping.slice(r),c=l.map(o.pos),h=l.map(a.pos);i?e.deleteRange(c,h):(e.replaceRangeWith(c,h,t),I_(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let s=e.parent.inlineContent?new ge(e):wi(e.node(0),e.parent,e.pos,e.index(),t,r);if(s)return s;for(let i=e.depth-1;i>=0;i--){let o=t<0?wi(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):wi(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(o)return o}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new In(e.node(0))}static atStart(e){return wi(e,e,0,0,1)||new In(e)}static atEnd(e){return wi(e,e,e.content.size,e.childCount,-1)||new In(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=Vh[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in Vh)throw new RangeError("Duplicate use of selection JSON ID "+e);return Vh[e]=t,t.prototype.jsonID=e,t}getBookmark(){return ge.between(this.$anchor,this.$head).getBookmark()}}Ee.prototype.visible=!0;class FL{constructor(e,t){this.$from=e,this.$to=t}}let b_=!1;function S_(n){!b_&&!n.parent.inlineContent&&(b_=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class ge extends Ee{constructor(e,t=e){S_(e),S_(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return Ee.near(r);let s=e.resolve(t.map(this.anchor));return new ge(s.parent.inlineContent?s:r,r)}replace(e,t=X.empty){if(super.replace(e,t),t==X.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof ge&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Du(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new ge(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let s=e.resolve(t);return new this(s,r==t?s:e.resolve(r))}static between(e,t,r){let s=e.pos-t.pos;if((!r||s)&&(r=s>=0?1:-1),!t.parent.inlineContent){let i=Ee.findFrom(t,r,!0)||Ee.findFrom(t,-r,!0);if(i)t=i.$head;else return Ee.near(t,r)}return e.parent.inlineContent||(s==0?e=t:(e=(Ee.findFrom(e,-r,!0)||Ee.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=s<0&&(e=t))),new ge(e,t)}}Ee.jsonID("text",ge);class Du{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Du(e.map(this.anchor),e.map(this.head))}resolve(e){return ge.between(e.resolve(this.anchor),e.resolve(this.head))}}class he extends Ee{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:s}=t.mapResult(this.anchor),i=e.resolve(s);return r?Ee.near(i):new he(i)}content(){return new X(H.from(this.node),0,0)}eq(e){return e instanceof he&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Op(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new he(e.resolve(t.anchor))}static create(e,t){return new he(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}he.prototype.visible=!1;Ee.jsonID("node",he);class Op{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new Du(r,r):new Op(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&he.isSelectable(r)?new he(t):Ee.near(t)}}class In extends Ee{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=X.empty){if(t==X.empty){e.delete(0,e.doc.content.size);let r=Ee.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new In(e)}map(e){return new In(e)}eq(e){return e instanceof In}getBookmark(){return BL}}Ee.jsonID("all",In);const BL={map(){return this},resolve(n){return new In(n)}};function wi(n,e,t,r,s,i=!1){if(e.inlineContent)return ge.create(n,t);for(let o=r-(s>0?0:1);s>0?o<e.childCount:o>=0;o+=s){let a=e.child(o);if(a.isAtom){if(!i&&he.isSelectable(a))return he.create(n,t-(s<0?a.nodeSize:0))}else{let l=wi(n,a,t+s,s<0?a.childCount:0,s,i);if(l)return l}t+=a.nodeSize*s}return null}function I_(n,e,t){let r=n.steps.length-1;if(r<e)return;let s=n.steps[r];if(!(s instanceof pt||s instanceof gt))return;let i=n.mapping.maps[r],o;i.forEach((a,l,c,h)=>{o==null&&(o=h)}),n.setSelection(Ee.near(n.doc.resolve(o),t))}const A_=1,xl=2,C_=4;class UL extends VL{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|A_)&~xl,this.storedMarks=null,this}get selectionSet(){return(this.updated&A_)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=xl,this}ensureMarks(e){return Me.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&xl)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~xl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Me.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let s=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(s.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let o=this.doc.resolve(t);i=r==t?o.marks():o.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,s.text(e,i)),this.selection.empty||this.setSelection(Ee.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=C_,this}get scrolledIntoView(){return(this.updated&C_)>0}}function k_(n,e){return!e||!n?n:n.bind(e)}class zo{constructor(e,t,r){this.name=e,this.init=k_(t.init,r),this.apply=k_(t.apply,r)}}const $L=[new zo("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new zo("selection",{init(n,e){return n.selection||Ee.atStart(e.doc)},apply(n){return n.selection}}),new zo("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new zo("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Fh{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=$L.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new zo(r.key,r.spec.state,r))})}}class Ii{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let s=this.config.plugins[r];if(s.spec.filterTransaction&&!s.spec.filterTransaction.call(s,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),s=null;for(;;){let i=!1;for(let o=0;o<this.config.plugins.length;o++){let a=this.config.plugins[o];if(a.spec.appendTransaction){let l=s?s[o].n:0,c=s?s[o].state:this,h=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(h&&r.filterTransaction(h,o)){if(h.setMeta("appendedTransaction",e),!s){s=[];for(let d=0;d<this.config.plugins.length;d++)s.push(d<o?{state:r,n:t.length}:{state:this,n:0})}t.push(h),r=r.applyInner(h),i=!0}s&&(s[o]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new Ii(this.config),r=this.config.fields;for(let s=0;s<r.length;s++){let i=r[s];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new UL(this)}static create(e){let t=new Fh(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new Ii(t);for(let s=0;s<t.fields.length;s++)r[t.fields[s].name]=t.fields[s].init(e,r);return r}reconfigure(e){let t=new Fh(this.schema,e.plugins),r=t.fields,s=new Ii(t);for(let i=0;i<r.length;i++){let o=r[i].name;s[o]=this.hasOwnProperty(o)?this[o]:r[i].init(e,s)}return s}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let s=e[r],i=s.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(s,this[s.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let s=new Fh(e.schema,e.plugins),i=new Ii(s);return s.fields.forEach(o=>{if(o.name=="doc")i.doc=$s.fromJSON(e.schema,t.doc);else if(o.name=="selection")i.selection=Ee.fromJSON(i.doc,t.selection);else if(o.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==o.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[o.name]=c.fromJSON.call(l,e,t[a],i);return}}i[o.name]=o.init(e,i)}}),i}}function Gw(n,e,t){for(let r in n){let s=n[r];s instanceof Function?s=s.bind(e):r=="handleDOMEvents"&&(s=Gw(s,e,{})),t[r]=s}return t}class _n{constructor(e){this.spec=e,this.props={},e.props&&Gw(e.props,this,this.props),this.key=e.key?e.key.key:Jw("plugin")}getState(e){return e[this.key]}}const Bh=Object.create(null);function Jw(n){return n in Bh?n+"$"+ ++Bh[n]:(Bh[n]=0,n+"$")}class fs{constructor(e="key"){this.key=Jw(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const wt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},ka=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let qd=null;const tr=function(n,e,t){let r=qd||(qd=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},zL=function(){qd=null},Zs=function(n,e,t,r){return t&&(R_(n,e,t,r,-1)||R_(n,e,t,r,1))},jL=/^(img|br|input|textarea|hr)$/i;function R_(n,e,t,r,s){for(;;){if(n==t&&e==r)return!0;if(e==(s<0?0:Ln(n))){let i=n.parentNode;if(!i||i.nodeType!=1||Ya(n)||jL.test(n.nodeName)||n.contentEditable=="false")return!1;e=wt(n)+(s<0?0:1),n=i}else if(n.nodeType==1){if(n=n.childNodes[e+(s<0?-1:0)],n.contentEditable=="false")return!1;e=s<0?Ln(n):0}else return!1}}function Ln(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function HL(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=Ln(n)}else if(n.parentNode&&!Ya(n))e=wt(n),n=n.parentNode;else return null}}function qL(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!Ya(n))e=wt(n)+1,n=n.parentNode;else return null}}function WL(n,e,t){for(let r=e==0,s=e==Ln(n);r||s;){if(n==t)return!0;let i=wt(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,s=s&&i==Ln(n)}}function Ya(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const Lu=function(n){return n.focusNode&&Zs(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function ks(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function KL(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function GL(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:r.offset}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:r.startOffset}}}const Kn=typeof navigator<"u"?navigator:null,P_=typeof document<"u"?document:null,ps=Kn&&Kn.userAgent||"",Wd=/Edge\/(\d+)/.exec(ps),Qw=/MSIE \d/.exec(ps),Kd=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(ps),Jt=!!(Qw||Kd||Wd),Xr=Qw?document.documentMode:Kd?+Kd[1]:Wd?+Wd[1]:0,Rn=!Jt&&/gecko\/(\d+)/i.test(ps);Rn&&+(/Firefox\/(\d+)/.exec(ps)||[0,0])[1];const Gd=!Jt&&/Chrome\/(\d+)/.exec(ps),$t=!!Gd,JL=Gd?+Gd[1]:0,zt=!Jt&&!!Kn&&/Apple Computer/.test(Kn.vendor),to=zt&&(/Mobile\/\w+/.test(ps)||!!Kn&&Kn.maxTouchPoints>2),un=to||(Kn?/Mac/.test(Kn.platform):!1),QL=Kn?/Win/.test(Kn.platform):!1,Tn=/Android \d/.test(ps),Xa=!!P_&&"webkitFontSmoothing"in P_.documentElement.style,YL=Xa?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function XL(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function er(n,e){return typeof n=="number"?n:n[e]}function ZL(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function x_(n,e,t){let r=n.someProp("scrollThreshold")||0,s=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let o=t||n.dom;o;o=ka(o)){if(o.nodeType!=1)continue;let a=o,l=a==i.body,c=l?XL(i):ZL(a),h=0,d=0;if(e.top<c.top+er(r,"top")?d=-(c.top-e.top+er(s,"top")):e.bottom>c.bottom-er(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+er(s,"top")-c.top:e.bottom-c.bottom+er(s,"bottom")),e.left<c.left+er(r,"left")?h=-(c.left-e.left+er(s,"left")):e.right>c.right-er(r,"right")&&(h=e.right-c.right+er(s,"right")),h||d)if(l)i.defaultView.scrollBy(h,d);else{let f=a.scrollLeft,m=a.scrollTop;d&&(a.scrollTop+=d),h&&(a.scrollLeft+=h);let y=a.scrollLeft-f,T=a.scrollTop-m;e={left:e.left-y,top:e.top-T,right:e.right-y,bottom:e.bottom-T}}if(l||/^(fixed|sticky)$/.test(getComputedStyle(o).position))break}}function eV(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,s;for(let i=(e.left+e.right)/2,o=t+1;o<Math.min(innerHeight,e.bottom);o+=5){let a=n.root.elementFromPoint(i,o);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,s=l.top;break}}return{refDOM:r,refTop:s,stack:Yw(n.dom)}}function Yw(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=ka(r));return e}function tV({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;Xw(t,r==0?0:r-e)}function Xw(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:s,left:i}=n[t];r.scrollTop!=s+e&&(r.scrollTop=s+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let gi=null;function nV(n){if(n.setActive)return n.setActive();if(gi)return n.focus(gi);let e=Yw(n);n.focus(gi==null?{get preventScroll(){return gi={preventScroll:!0},!0}}:void 0),gi||(gi=!1,Xw(e,0))}function Zw(n,e){let t,r=2e8,s,i=0,o=e.top,a=e.top,l,c;for(let h=n.firstChild,d=0;h;h=h.nextSibling,d++){let f;if(h.nodeType==1)f=h.getClientRects();else if(h.nodeType==3)f=tr(h).getClientRects();else continue;for(let m=0;m<f.length;m++){let y=f[m];if(y.top<=o&&y.bottom>=a){o=Math.max(y.bottom,o),a=Math.min(y.top,a);let T=y.left>e.left?y.left-e.left:y.right<e.left?e.left-y.right:0;if(T<r){t=h,r=T,s=T&&t.nodeType==3?{left:y.right<e.left?y.right:y.left,top:e.top}:e,h.nodeType==1&&T&&(i=d+(e.left>=(y.left+y.right)/2?1:0));continue}}else y.top>e.top&&!l&&y.left<=e.left&&y.right>=e.left&&(l=h,c={left:Math.max(y.left,Math.min(y.right,e.left)),top:y.top});!t&&(e.left>=y.right&&e.top>=y.top||e.left>=y.left&&e.top>=y.bottom)&&(i=d+1)}}return!t&&l&&(t=l,s=c,r=0),t&&t.nodeType==3?rV(t,s):!t||r&&t.nodeType==1?{node:n,offset:i}:Zw(t,s)}function rV(n,e){let t=n.nodeValue.length,r=document.createRange();for(let s=0;s<t;s++){r.setEnd(n,s+1),r.setStart(n,s);let i=Ir(r,1);if(i.top!=i.bottom&&Mp(e,i))return{node:n,offset:s+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function Mp(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function sV(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function iV(n,e,t){let{node:r,offset:s}=Zw(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let o=r.getBoundingClientRect();i=o.left!=o.right&&t.left>(o.left+o.right)/2?1:-1}return n.docView.posFromDOM(r,s,i)}function oV(n,e,t,r){let s=-1;for(let i=e,o=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0);if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent&&!o||!a.contentDOM)){let l=a.dom.getBoundingClientRect();if(a.node.isBlock&&a.parent&&!o&&(o=!0,l.left>r.left||l.top>r.top?s=a.posBefore:(l.right<r.left||l.bottom<r.top)&&(s=a.posAfter)),!a.contentDOM&&s<0&&!a.node.isText)return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter}i=a.dom.parentNode}return s>-1?s:n.docView.posFromDOM(e,t,-1)}function eb(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let s=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=s;;){let o=n.childNodes[i];if(o.nodeType==1){let a=o.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Mp(e,c))return eb(o,e,c)}}if((i=(i+1)%r)==s)break}return n}function aV(n,e){let t=n.dom.ownerDocument,r,s=0,i=GL(t,e.left,e.top);i&&({node:r,offset:s}=i);let o=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!o||!n.dom.contains(o.nodeType!=1?o.parentNode:o)){let c=n.dom.getBoundingClientRect();if(!Mp(e,c)||(o=eb(n.dom,e,c),!o))return null}if(zt)for(let c=o;r&&c;c=ka(c))c.draggable&&(r=void 0);if(o=sV(o,e),r){if(Rn&&r.nodeType==1&&(s=Math.min(s,r.childNodes.length),s<r.childNodes.length)){let h=r.childNodes[s],d;h.nodeName=="IMG"&&(d=h.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&s++}let c;Xa&&s&&r.nodeType==1&&(c=r.childNodes[s-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&s--,r==n.dom&&s==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(s==0||r.nodeType!=1||r.childNodes[s-1].nodeName!="BR")&&(a=oV(n,r,s,e))}a==null&&(a=iV(n,o,e));let l=n.docView.nearestDesc(o,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function O_(n){return n.top<n.bottom||n.left<n.right}function Ir(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(O_(r))return r}return Array.prototype.find.call(t,O_)||n.getBoundingClientRect()}const lV=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function tb(n,e,t){let{node:r,offset:s,atom:i}=n.docView.domFromPos(e,t<0?-1:1),o=Xa||Rn;if(r.nodeType==3)if(o&&(lV.test(r.nodeValue)||(t<0?!s:s==r.nodeValue.length))){let l=Ir(tr(r,s,s),t);if(Rn&&s&&/\s/.test(r.nodeValue[s-1])&&s<r.nodeValue.length){let c=Ir(tr(r,s-1,s-1),-1);if(c.top==l.top){let h=Ir(tr(r,s,s+1),-1);if(h.top!=l.top)return Oo(h,h.left<c.left)}}return l}else{let l=s,c=s,h=t<0?1:-1;return t<0&&!s?(c++,h=-1):t>=0&&s==r.nodeValue.length?(l--,h=1):t<0?l--:c++,Oo(Ir(tr(r,l,c),h),h<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&s&&(t<0||s==Ln(r))){let l=r.childNodes[s-1];if(l.nodeType==1)return Uh(l.getBoundingClientRect(),!1)}if(i==null&&s<Ln(r)){let l=r.childNodes[s];if(l.nodeType==1)return Uh(l.getBoundingClientRect(),!0)}return Uh(r.getBoundingClientRect(),t>=0)}if(i==null&&s&&(t<0||s==Ln(r))){let l=r.childNodes[s-1],c=l.nodeType==3?tr(l,Ln(l)-(o?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Oo(Ir(c,1),!1)}if(i==null&&s<Ln(r)){let l=r.childNodes[s];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?tr(l,0,o?0:1):l.nodeType==1?l:null:null;if(c)return Oo(Ir(c,-1),!0)}return Oo(Ir(r.nodeType==3?tr(r):r,-t),t>=0)}function Oo(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function Uh(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function nb(n,e,t){let r=n.state,s=n.root.activeElement;r!=e&&n.updateState(e),s!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),s!=n.dom&&s&&s.focus()}}function cV(n,e,t){let r=e.selection,s=t=="up"?r.$from:r.$to;return nb(n,e,()=>{let{node:i}=n.docView.domFromPos(s.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let o=tb(n,s.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=tr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let h=l[c];if(h.bottom>h.top+1&&(t=="up"?o.top-h.top>(h.bottom-o.top)*2:h.bottom-o.bottom>(o.bottom-h.top)*2))return!1}}return!0})}const uV=/[\u0590-\u08ac]/;function hV(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let s=r.parentOffset,i=!s,o=s==r.parent.content.size,a=n.domSelection();return!uV.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:o:nb(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:h,anchorOffset:d}=n.domSelectionRange(),f=a.caretBidiLevel;a.modify("move",t,"character");let m=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:y,focusOffset:T}=n.domSelectionRange(),w=y&&!m.contains(y.nodeType==1?y:y.parentNode)||l==y&&c==T;try{a.collapse(h,d),l&&(l!=h||c!=d)&&a.extend&&a.extend(l,c)}catch{}return f!=null&&(a.caretBidiLevel=f),w})}let M_=null,N_=null,D_=!1;function dV(n,e,t){return M_==e&&N_==t?D_:(M_=e,N_=t,D_=t=="up"||t=="down"?cV(n,e,t):hV(n,e,t))}const yn=0,L_=1,Os=2,Gn=3;class Za{constructor(e,t,r,s){this.parent=e,this.children=t,this.dom=r,this.contentDOM=s,this.dirty=yn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let s=this.children[t];if(s==e)return r;r+=s.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,o;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(o)+o.size:this.posAtStart}else{let i,o;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((o=i.pmViewDesc)&&o.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(o):this.posAtEnd}let s;if(e==this.dom&&this.contentDOM)s=t>wt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!1;break}if(i.previousSibling)break}if(s==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){s=!0;break}if(i.nextSibling)break}}return s??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,s=e;s;s=s.parentNode){let i=this.getDesc(s),o;if(i&&(!t||i.node))if(r&&(o=i.nodeDOM)&&!(o.nodeType==1?o.contains(e.nodeType==1?e:e.parentNode):o==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let s=e;s;s=s.parentNode){let i=this.getDesc(s);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let s=this.children[t],i=r+s.size;if(r==e&&i!=r){for(;!s.border&&s.children.length;)s=s.children[0];return s}if(e<i)return s.descAt(e-r-s.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,s=0;for(let i=0;r<this.children.length;r++){let o=this.children[r],a=i+o.size;if(a>e||o instanceof sb){s=e-i;break}i=a}if(s)return this.children[r].domFromPos(s-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof rb&&i.side>=0;r--);if(t<=0){let i,o=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,o=!1);return i&&t&&o&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?wt(i.dom)+1:0}}else{let i,o=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,o=!1);return i&&o&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?wt(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let s=-1,i=-1;for(let o=r,a=0;;a++){let l=this.children[a],c=o+l.size;if(s==-1&&e<=c){let h=o+l.border;if(e>=h&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,h);e=o;for(let d=a;d>0;d--){let f=this.children[d-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){s=wt(f.dom)+1;break}e-=f.size}s==-1&&(s=0)}if(s>-1&&(c>t||a==this.children.length-1)){t=c;for(let h=a+1;h<this.children.length;h++){let d=this.children[h];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=wt(d.dom);break}t+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}o=c}return{node:this.contentDOM,from:e,to:t,fromOffset:s,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,s=!1){let i=Math.min(e,t),o=Math.max(e,t);for(let f=0,m=0;f<this.children.length;f++){let y=this.children[f],T=m+y.size;if(i>m&&o<T)return y.setSelection(e-m-y.border,t-m-y.border,r,s);m=T}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.getSelection(),h=!1;if((Rn||zt)&&e==t){let{node:f,offset:m}=a;if(f.nodeType==3){if(h=!!(m&&f.nodeValue[m-1]==`
`),h&&m==f.nodeValue.length)for(let y=f,T;y;y=y.parentNode){if(T=y.nextSibling){T.nodeName=="BR"&&(a=l={node:T.parentNode,offset:wt(T)+1});break}let w=y.pmViewDesc;if(w&&w.node&&w.node.isBlock)break}}else{let y=f.childNodes[m-1];h=y&&(y.nodeName=="BR"||y.contentEditable=="false")}}if(Rn&&c.focusNode&&c.focusNode!=l.node&&c.focusNode.nodeType==1){let f=c.focusNode.childNodes[c.focusOffset];f&&f.contentEditable=="false"&&(s=!0)}if(!(s||h&&zt)&&Zs(a.node,a.offset,c.anchorNode,c.anchorOffset)&&Zs(l.node,l.offset,c.focusNode,c.focusOffset))return;let d=!1;if((c.extend||e==t)&&!h){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),d=!0}catch{}}if(!d){if(e>t){let m=a;a=l,l=m}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,s=0;s<this.children.length;s++){let i=this.children[s],o=r+i.size;if(r==o?e<=o&&t>=r:e<o&&t>r){let a=r+i.border,l=o-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==o?Os:L_,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=Gn:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Os:Gn}r=o}this.dirty=Os}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Os:L_;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class rb extends Za{constructor(e,t,r,s){let i,o=t.type.toDOM;if(typeof o=="function"&&(o=o(r,()=>{if(!i)return s;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(o.nodeType!=1){let a=document.createElement("span");a.appendChild(o),o=a}o.contentEditable="false",o.classList.add("ProseMirror-widget")}super(e,[],o,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==yn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class fV extends Za{constructor(e,t,r,s){super(e,[],t,null),this.textDOM=r,this.text=s}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class ei extends Za{constructor(e,t,r,s){super(e,[],r,s),this.mark=t}static create(e,t,r,s){let i=s.nodeViews[t.type.name],o=i&&i(t,s,r);return(!o||!o.dom)&&(o=Fn.renderSpec(document,t.type.spec.toDOM(t,r))),new ei(e,t,o.dom,o.contentDOM||o.dom)}parseRule(){return this.dirty&Gn||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=Gn&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=yn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=yn}}slice(e,t,r){let s=ei.create(this.parent,this.mark,!0,r),i=this.children,o=this.size;t<o&&(i=Yd(i,t,o,r)),e>0&&(i=Yd(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=s;return s.children=i,s}}class Zr extends Za{constructor(e,t,r,s,i,o,a,l,c){super(e,[],i,o),this.node=t,this.outerDeco=r,this.innerDeco=s,this.nodeDOM=a}static create(e,t,r,s,i,o){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return o;if(l.parent)return l.parent.posBeforeChild(l)},r,s),h=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!h)h=document.createTextNode(t.text);else if(h.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else h||({dom:h,contentDOM:d}=Fn.renderSpec(document,t.type.spec.toDOM(t)));!d&&!t.isText&&h.nodeName!="BR"&&(h.hasAttribute("contenteditable")||(h.contentEditable="false"),t.type.spec.draggable&&(h.draggable=!0));let f=h;return h=ab(h,r,t),c?l=new pV(e,t,r,s,h,d||null,f,c,i,o+1):t.isText?new Vu(e,t,r,s,h,f,i):new Zr(e,t,r,s,h,d||null,f,i,o+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>H.empty)}return e}matchesNode(e,t,r){return this.dirty==yn&&e.eq(this.node)&&Qd(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,s=t,i=e.composing?this.localCompositionInfo(e,t):null,o=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new gV(this,o&&o.node,e);EV(this.node,this.innerDeco,(c,h,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(h==this.node.childCount?Me.none:this.node.child(h).marks,r,e),l.placeWidget(c,e,s)},(c,h,d,f)=>{l.syncToMarks(c.marks,r,e);let m;l.findNodeMatch(c,h,d,f)||a&&e.state.selection.from>s&&e.state.selection.to<s+c.nodeSize&&(m=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,h,d,m,e)||l.updateNextNode(c,h,d,e,f,s)||l.addNode(c,h,d,e,s),s+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Os)&&(o&&this.protectLocalComposition(e,o),ib(this.contentDOM,this.children,e),to&&vV(this.dom))}localCompositionInfo(e,t){let{from:r,to:s}=e.state.selection;if(!(e.state.selection instanceof ge)||r<t||s>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let o=i.nodeValue,a=TV(this.node.content,o,r-t,s-t);return a<0?null:{node:i,pos:a,text:o}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:s}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let o=new fV(this,i,t,s);e.input.compositionNodes.push(o),this.children=Yd(this.children,r,r+s.length,e,o)}update(e,t,r,s){return this.dirty==Gn||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,s),!0)}updateInner(e,t,r,s){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(s,this.posAtStart),this.dirty=yn}updateOuterDeco(e){if(Qd(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=ob(this.dom,this.nodeDOM,Jd(this.outerDeco,this.node,t),Jd(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function V_(n,e,t,r,s){ab(r,e,n);let i=new Zr(void 0,n,e,t,r,r,r,s,0);return i.contentDOM&&i.updateChildren(s,0),i}class Vu extends Zr{constructor(e,t,r,s,i,o,a){super(e,t,r,s,i,null,o,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,s){return this.dirty==Gn||this.dirty!=yn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=yn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,s.trackWrites==this.nodeDOM&&(s.trackWrites=null)),this.node=e,this.dirty=yn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let s=this.node.cut(e,t),i=document.createTextNode(s.text);return new Vu(this.parent,s,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=Gn)}get domAtom(){return!1}isText(e){return this.node.text==e}}class sb extends Za{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==yn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class pV extends Zr{constructor(e,t,r,s,i,o,a,l,c,h){super(e,t,r,s,i,o,a,c,h),this.spec=l}update(e,t,r,s){if(this.dirty==Gn)return!1;if(this.spec.update){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,s),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,s)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,s){this.spec.setSelection?this.spec.setSelection(e,t,r):super.setSelection(e,t,r,s)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function ib(n,e,t){let r=n.firstChild,s=!1;for(let i=0;i<e.length;i++){let o=e[i],a=o.dom;if(a.parentNode==n){for(;a!=r;)r=F_(r),s=!0;r=r.nextSibling}else s=!0,n.insertBefore(a,r);if(o instanceof ei){let l=r?r.previousSibling:n.lastChild;ib(o.contentDOM,o.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=F_(r),s=!0;s&&t.trackWrites==n&&(t.trackWrites=null)}const aa=function(n){n&&(this.nodeName=n)};aa.prototype=Object.create(null);const Ms=[new aa];function Jd(n,e,t){if(n.length==0)return Ms;let r=t?Ms[0]:new aa,s=[r];for(let i=0;i<n.length;i++){let o=n[i].type.attrs;if(o){o.nodeName&&s.push(r=new aa(o.nodeName));for(let a in o){let l=o[a];l!=null&&(t&&s.length==1&&s.push(r=new aa(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return s}function ob(n,e,t,r){if(t==Ms&&r==Ms)return e;let s=e;for(let i=0;i<r.length;i++){let o=r[i],a=t[i];if(i){let l;a&&a.nodeName==o.nodeName&&s!=n&&(l=s.parentNode)&&l.nodeName.toLowerCase()==o.nodeName||(l=document.createElement(o.nodeName),l.pmIsDeco=!0,l.appendChild(s),a=Ms[0]),s=l}mV(s,a||Ms[0],o)}return s}function mV(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],s=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)s.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<s.length;i++)r.indexOf(s[i])==-1&&n.classList.add(s[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,s;for(;s=r.exec(e.style);)n.style.removeProperty(s[1])}t.style&&(n.style.cssText+=t.style)}}function ab(n,e,t){return ob(n,n,Ms,Jd(e,t,n.nodeType!=1))}function Qd(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function F_(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class gV{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=yV(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let s=0,i=this.stack.length>>1,o=Math.min(i,e.length);for(;s<o&&(s==i-1?this.top:this.stack[s+1<<1]).matchesMark(e[s])&&e[s].type.spec.spanning!==!1;)s++;for(;s<i;)this.destroyRest(),this.top.dirty=yn,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=ei.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,s){let i=-1,o;if(s>=this.preMatch.index&&(o=this.preMatch.matches[s-this.preMatch.index]).parent==this.top&&o.matchesNode(e,t,r))i=this.top.children.indexOf(o,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,s,i){let o=this.top.children[s];return o.dirty==Gn&&o.dom==o.contentDOM&&(o.dirty=Os),o.update(e,t,r,i)?(this.destroyBetween(this.index,s),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let s=this.index;s<this.top.children.length;s++)if(this.top.children[s]==r)return s}return-1}e=t}}updateNextNode(e,t,r,s,i,o){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof Zr){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let h=l.dom,d,f=this.isLocked(h)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=Gn&&Qd(t,l.outerDeco));if(!f&&l.update(e,t,r,s))return this.destroyBetween(this.index,a),l.dom!=h&&(this.changed=!0),this.index++,!0;if(!f&&(d=this.recreateWrapper(l,e,t,r,s,o)))return this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Os,d.updateChildren(s,o+1),d.dirty=yn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,s,i,o){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content))return null;let a=Zr.create(this.top,t,r,s,i,o);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,s,i){let o=Zr.create(this.top,e,t,r,s,i);o.contentDOM&&o.updateChildren(s,i+1),this.top.children.splice(this.index++,0,o),this.changed=!0}placeWidget(e,t,r){let s=this.index<this.top.children.length?this.top.children[this.index]:null;if(s&&s.matchesWidget(e)&&(e==s.widget||!s.widget.type.toDOM.parentNode))this.index++;else{let i=new rb(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof ei;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof Vu)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((zt||$t)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let s=new sb(this.top,[],r,null);t!=this.top?t.children.push(s):t.children.splice(this.index++,0,s),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function yV(n,e){let t=e,r=t.children.length,s=n.childCount,i=new Map,o=[];e:for(;s>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof ei)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(s-1))break;--s,i.set(a,s),o.push(a)}}return{index:s,matched:i,matches:o.reverse()}}function _V(n,e){return n.type.side-e.type.side}function EV(n,e,t,r){let s=e.locals(n),i=0;if(s.length==0){for(let c=0;c<n.childCount;c++){let h=n.child(c);r(h,s,e.forChild(i,h),c),i+=h.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let h,d;for(;o<s.length&&s[o].to==i;){let w=s[o++];w.widget&&(h?(d||(d=[h])).push(w):h=w)}if(h)if(d){d.sort(_V);for(let w=0;w<d.length;w++)t(d[w],c,!!l)}else t(h,c,!!l);let f,m;if(l)m=-1,f=l,l=null;else if(c<n.childCount)m=c,f=n.child(c++);else break;for(let w=0;w<a.length;w++)a[w].to<=i&&a.splice(w--,1);for(;o<s.length&&s[o].from<=i&&s[o].to>i;)a.push(s[o++]);let y=i+f.nodeSize;if(f.isText){let w=y;o<s.length&&s[o].from<w&&(w=s[o].from);for(let P=0;P<a.length;P++)a[P].to<w&&(w=a[P].to);w<y&&(l=f.cut(w-i),f=f.cut(0,w-i),y=w,m=-1)}else for(;o<s.length&&s[o].to<y;)o++;let T=f.isInline&&!f.isLeaf?a.filter(w=>!w.inline):a.slice();r(f,T,e.forChild(i,f),m),i=y}}function vV(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function TV(n,e,t,r){for(let s=0,i=0;s<n.childCount&&i<=r;){let o=n.child(s++),a=i;if(i+=o.nodeSize,!o.isText)continue;let l=o.text;for(;s<n.childCount;){let c=n.child(s++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Yd(n,e,t,r,s){let i=[];for(let o=0,a=0;o<n.length;o++){let l=n[o],c=a,h=a+=l.size;c>=t||h<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),s&&(i.push(s),s=void 0),h>t&&i.push(l.slice(t-c,l.size,r)))}return i}function Np(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let s=n.docView.nearestDesc(t.focusNode),i=s&&s.size==0,o=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(o<0)return null;let a=r.resolve(o),l,c;if(Lu(t)){for(l=a;s&&!s.node;)s=s.parent;let h=s.node;if(s&&h.isAtom&&he.isSelectable(h)&&s.parent&&!(h.isInline&&WL(t.focusNode,t.focusOffset,s.dom))){let d=s.posBefore;c=new he(o==d?a:r.resolve(d))}}else{let h=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(h<0)return null;l=r.resolve(h)}if(!c){let h=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=Dp(n,l,a,h)}return c}function lb(n){return n.editable?n.hasFocus():ub(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function lr(n,e=!1){let t=n.state.selection;if(cb(n,t),!!lb(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&$t){let r=n.domSelectionRange(),s=n.domObserver.currentSelection;if(r.anchorNode&&s.anchorNode&&Zs(r.anchorNode,r.anchorOffset,s.anchorNode,s.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)bV(n);else{let{anchor:r,head:s}=t,i,o;B_&&!(t instanceof ge)&&(t.$from.parent.inlineContent||(i=U_(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(o=U_(n,t.to))),n.docView.setSelection(r,s,n.root,e),B_&&(i&&$_(i),o&&$_(o)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&wV(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const B_=zt||$t&&JL<63;function U_(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),s=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(zt&&s&&s.contentEditable=="false")return $h(s);if((!s||s.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(s)return $h(s);if(i)return $h(i)}}function $h(n){return n.contentEditable="true",zt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function $_(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function wV(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,s=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=s)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!lb(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function bV(n){let e=n.domSelection(),t=document.createRange(),r=n.cursorWrapper.dom,s=r.nodeName=="IMG";s?t.setEnd(r.parentNode,wt(r)+1):t.setEnd(r,0),t.collapse(!1),e.removeAllRanges(),e.addRange(t),!s&&!n.state.selection.visible&&Jt&&Xr<=11&&(r.disabled=!0,r.disabled=!1)}function cb(n,e){if(e instanceof he){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(z_(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else z_(n)}function z_(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function Dp(n,e,t,r){return n.someProp("createSelectionBetween",s=>s(n,e,t))||ge.between(e,t,r)}function j_(n){return n.editable&&!n.hasFocus()?!1:ub(n)}function ub(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function SV(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return Zs(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Xd(n,e){let{$anchor:t,$head:r}=n.selection,s=e>0?t.max(r):t.min(r),i=s.parent.inlineContent?s.depth?n.doc.resolve(e>0?s.after():s.before()):null:s;return i&&Ee.findFrom(i,e)}function xr(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function H_(n,e,t){let r=n.state.selection;if(r instanceof ge)if(t.indexOf("s")>-1){let{$head:s}=r,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let o=n.state.doc.resolve(s.pos+i.nodeSize*(e<0?-1:1));return xr(n,new ge(r.$anchor,o))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let s=Xd(n.state,e);return s&&s instanceof he?xr(n,s):!1}else if(!(un&&t.indexOf("m")>-1)){let s=r.$head,i=s.textOffset?null:e<0?s.nodeBefore:s.nodeAfter,o;if(!i||i.isText)return!1;let a=e<0?s.pos-i.nodeSize:s.pos;return i.isAtom||(o=n.docView.descAt(a))&&!o.contentDOM?he.isSelectable(i)?xr(n,new he(e<0?n.state.doc.resolve(s.pos-i.nodeSize):s)):Xa?xr(n,new ge(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof he&&r.node.isInline)return xr(n,new ge(e>0?r.$to:r.$from));{let s=Xd(n.state,e);return s?xr(n,s):!1}}}function Mc(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function la(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function yi(n,e){return e<0?IV(n):AV(n)}function IV(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s,i,o=!1;for(Rn&&t.nodeType==1&&r<Mc(t)&&la(t.childNodes[r],-1)&&(o=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(la(a,-1))s=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(hb(t))break;{let a=t.previousSibling;for(;a&&la(a,-1);)s=t.parentNode,i=wt(a),a=a.previousSibling;if(a)t=a,r=Mc(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}o?Zd(n,t,r):s&&Zd(n,s,i)}function AV(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let s=Mc(t),i,o;for(;;)if(r<s){if(t.nodeType!=1)break;let a=t.childNodes[r];if(la(a,1))i=t,o=++r;else break}else{if(hb(t))break;{let a=t.nextSibling;for(;a&&la(a,1);)i=a.parentNode,o=wt(a)+1,a=a.nextSibling;if(a)t=a,r=0,s=Mc(t);else{if(t=t.parentNode,t==n.dom)break;r=s=0}}}i&&Zd(n,i,o)}function hb(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function CV(n,e){for(;n&&e==n.childNodes.length&&!Ya(n);)e=wt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function kV(n,e){for(;n&&!e&&!Ya(n);)e=wt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Zd(n,e,t){if(e.nodeType!=3){let i,o;(o=CV(e,t))?(e=o,t=0):(i=kV(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(Lu(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:s}=n;setTimeout(()=>{n.state==s&&lr(n)},50)}function q_(n,e){let t=n.state.doc.resolve(e);if(!($t||QL)&&t.parent.inlineContent){let s=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left<s.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),o=(i.top+i.bottom)/2;if(o>s.top&&o<s.bottom&&Math.abs(i.left-s.left)>1)return i.left>s.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function W_(n,e,t){let r=n.state.selection;if(r instanceof ge&&!r.empty||t.indexOf("s")>-1||un&&t.indexOf("m")>-1)return!1;let{$from:s,$to:i}=r;if(!s.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let o=Xd(n.state,e);if(o&&o instanceof he)return xr(n,o)}if(!s.parent.inlineContent){let o=e<0?s:i,a=r instanceof In?Ee.near(o,e):Ee.findFrom(o,e);return a?xr(n,a):!1}return!1}function K_(n,e){if(!(n.state.selection instanceof ge))return!0;let{$head:t,$anchor:r,empty:s}=n.state.selection;if(!t.sameParent(r))return!0;if(!s)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let o=n.state.tr;return e<0?o.delete(t.pos-i.nodeSize,t.pos):o.delete(t.pos,t.pos+i.nodeSize),n.dispatch(o),!0}return!1}function G_(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function RV(n){if(!zt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;G_(n,r,"true"),setTimeout(()=>G_(n,r,"false"),20)}return!1}function PV(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function xV(n,e){let t=e.keyCode,r=PV(e);if(t==8||un&&t==72&&r=="c")return K_(n,-1)||yi(n,-1);if(t==46&&!e.shiftKey||un&&t==68&&r=="c")return K_(n,1)||yi(n,1);if(t==13||t==27)return!0;if(t==37||un&&t==66&&r=="c"){let s=t==37?q_(n,n.state.selection.from)=="ltr"?-1:1:-1;return H_(n,s,r)||yi(n,s)}else if(t==39||un&&t==70&&r=="c"){let s=t==39?q_(n,n.state.selection.from)=="ltr"?1:-1:1;return H_(n,s,r)||yi(n,s)}else{if(t==38||un&&t==80&&r=="c")return W_(n,-1,r)||yi(n,-1);if(t==40||un&&t==78&&r=="c")return RV(n)||W_(n,1,r)||yi(n,1);if(r==(un?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function db(n,e){n.someProp("transformCopied",m=>{e=m(e,n)});let t=[],{content:r,openStart:s,openEnd:i}=e;for(;s>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){s--,i--;let m=r.firstChild;t.push(m.type.name,m.attrs!=m.type.defaultAttrs?m.attrs:null),r=m.content}let o=n.someProp("clipboardSerializer")||Fn.fromSchema(n.state.schema),a=_b(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c=l.firstChild,h,d=0;for(;c&&c.nodeType==1&&(h=yb[c.nodeName.toLowerCase()]);){for(let m=h.length-1;m>=0;m--){let y=a.createElement(h[m]);for(;l.firstChild;)y.appendChild(l.firstChild);l.appendChild(y),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${s} ${i}${d?` -${d}`:""} ${JSON.stringify(t)}`);let f=n.someProp("clipboardTextSerializer",m=>m(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:f,slice:e}}function fb(n,e,t,r,s){let i=s.parent.type.spec.code,o,a;if(!t&&!e)return null;let l=e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",f=>{e=f(e,i||r,n)}),i)return e?new X(H.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):X.empty;let d=n.someProp("clipboardTextParser",f=>f(e,s,r,n));if(d)a=d;else{let f=s.marks(),{schema:m}=n.state,y=Fn.fromSchema(m);o=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(T=>{let w=o.appendChild(document.createElement("p"));T&&w.appendChild(y.serializeNode(m.text(T,f)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),o=NV(t),Xa&&DV(o);let c=o&&o.querySelector("[data-pm-slice]"),h=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(h&&h[3])for(let d=+h[3];d>0;d--){let f=o.firstChild;for(;f&&f.nodeType!=1;)f=f.nextSibling;if(!f)break;o=f}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||Xi.fromSchema(n.state.schema)).parseSlice(o,{preserveWhitespace:!!(l||h),context:s,ruleFromNode(f){return f.nodeName=="BR"&&!f.nextSibling&&f.parentNode&&!OV.test(f.parentNode.nodeName)?{ignore:!0}:null}})),h)a=LV(J_(a,+h[1],+h[2]),h[4]);else if(a=X.maxOpen(MV(a.content,s),!0),a.openStart||a.openEnd){let d=0,f=0;for(let m=a.content.firstChild;d<a.openStart&&!m.type.spec.isolating;d++,m=m.firstChild);for(let m=a.content.lastChild;f<a.openEnd&&!m.type.spec.isolating;f++,m=m.lastChild);a=J_(a,d,f)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const OV=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function MV(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let s=e.node(t).contentMatchAt(e.index(t)),i,o=[];if(n.forEach(a=>{if(!o)return;let l=s.findWrapping(a.type),c;if(!l)return o=null;if(c=o.length&&i.length&&mb(l,i,a,o[o.length-1],0))o[o.length-1]=c;else{o.length&&(o[o.length-1]=gb(o[o.length-1],i.length));let h=pb(a,l);o.push(h),s=s.matchType(h.type),i=l}}),o)return H.from(o)}return n}function pb(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,H.from(n));return n}function mb(n,e,t,r,s){if(s<n.length&&s<e.length&&n[s]==e[s]){let i=mb(n,e,t,r.lastChild,s+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(s==n.length-1?t.type:n[s+1]))return r.copy(r.content.append(H.from(pb(t,n,s+1))))}}function gb(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,gb(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(H.empty,!0);return n.copy(t.append(r))}function ef(n,e,t,r,s,i){let o=e<0?n.firstChild:n.lastChild,a=o.content;return n.childCount>1&&(i=0),s<r-1&&(a=ef(a,e,t,r,s+1,i)),s>=t&&(a=e<0?o.contentMatchAt(0).fillBefore(a,i<=s).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(H.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,o.copy(a))}function J_(n,e,t){return e<n.openStart&&(n=new X(ef(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new X(ef(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const yb={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let Q_=null;function _b(){return Q_||(Q_=document.implementation.createHTMLDocument("title"))}function NV(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=_b().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),s;if((s=r&&yb[r[1].toLowerCase()])&&(n=s.map(i=>"<"+i+">").join("")+n+s.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=n,s)for(let i=0;i<s.length;i++)t=t.querySelector(s[i])||t;return t}function DV(n){let e=n.querySelectorAll($t?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==""&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function LV(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:s,openStart:i,openEnd:o}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;s=H.from(l.create(r[a+1],s)),i++,o++}return new X(s,i,o)}const jt={},Ht={},VV={touchstart:!0,touchmove:!0};class FV{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastAndroidDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function BV(n){for(let e in jt){let t=jt[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{$V(n,r)&&!Lp(n,r)&&(n.editable||!(r.type in Ht))&&t(n,r)},VV[e]?{passive:!0}:void 0)}zt&&n.dom.addEventListener("input",()=>null),tf(n)}function jr(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function UV(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function tf(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Lp(n,r))})}function Lp(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function $V(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function zV(n,e){!Lp(n,e)&&jt[e.type]&&(n.editable||!(e.type in Ht))&&jt[e.type](n,e)}Ht.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!vb(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Tn&&$t&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),to&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",s=>s(n,ks(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||xV(n,t)?t.preventDefault():jr(n,"key")};Ht.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Ht.keypress=(n,e)=>{let t=e;if(vb(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||un&&t.metaKey)return;if(n.someProp("handleKeyPress",s=>s(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof ge)||!r.$from.sameParent(r.$to)){let s=String.fromCharCode(t.charCode);!/[\r\n]/.test(s)&&!n.someProp("handleTextInput",i=>i(n,r.$from.pos,r.$to.pos,s))&&n.dispatch(n.state.tr.insertText(s).scrollIntoView()),t.preventDefault()}};function Fu(n){return{left:n.clientX,top:n.clientY}}function jV(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function Vp(n,e,t,r,s){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let o=i.depth+1;o>0;o--)if(n.someProp(e,a=>o>i.depth?a(n,t,i.nodeAfter,i.before(o),s,!0):a(n,t,i.node(o),i.before(o),s,!1)))return!0;return!1}function Ui(n,e,t){n.focused||n.focus();let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function HV(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&he.isSelectable(r)?(Ui(n,new he(t)),!0):!1}function qV(n,e){if(e==-1)return!1;let t=n.state.selection,r,s;t instanceof he&&(r=t.node);let i=n.state.doc.resolve(e);for(let o=i.depth+1;o>0;o--){let a=o>i.depth?i.nodeAfter:i.node(o);if(he.isSelectable(a)){r&&t.$from.depth>0&&o>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?s=i.before(t.$from.depth):s=i.before(o);break}}return s!=null?(Ui(n,he.create(n.state.doc,s)),!0):!1}function WV(n,e,t,r,s){return Vp(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(s?qV(n,t):HV(n,t))}function KV(n,e,t,r){return Vp(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",s=>s(n,e,r))}function GV(n,e,t,r){return Vp(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",s=>s(n,e,r))||JV(n,t,r)}function JV(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(Ui(n,ge.create(r,0,r.content.size)),!0):!1;let s=r.resolve(e);for(let i=s.depth+1;i>0;i--){let o=i>s.depth?s.nodeAfter:s.node(i),a=s.before(i);if(o.inlineContent)Ui(n,ge.create(r,a+1,a+1+o.content.size));else if(he.isSelectable(o))Ui(n,he.create(r,a));else continue;return!0}}function Fp(n){return Nc(n)}const Eb=un?"metaKey":"ctrlKey";jt.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Fp(n),s=Date.now(),i="singleClick";s-n.input.lastClick.time<500&&jV(t,n.input.lastClick)&&!t[Eb]&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:s,x:t.clientX,y:t.clientY,type:i};let o=n.posAtCoords(Fu(t));o&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new QV(n,o,t,!!r)):(i=="doubleClick"?KV:GV)(n,o.pos,o.inside,t)?t.preventDefault():jr(n,"pointer"))};class QV{constructor(e,t,r,s){this.view=e,this.pos=t,this.event=r,this.flushed=s,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[Eb],this.allowDefault=r.shiftKey;let i,o;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),o=t.inside;else{let h=e.state.doc.resolve(t.pos);i=h.parent,o=h.depth?h.before():0}const a=s?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l?l.dom:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof he&&c.from<=o&&c.to>o)&&(this.mightDrag={node:i,pos:o,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Rn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),jr(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>lr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Fu(e))),this.updateAllowDefault(e),this.allowDefault||!t?jr(this.view,"pointer"):WV(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||zt&&this.mightDrag&&!this.mightDrag.node.isAtom||$t&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Ui(this.view,Ee.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):jr(this.view,"pointer")}move(e){this.updateAllowDefault(e),jr(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}jt.touchstart=n=>{n.input.lastTouch=Date.now(),Fp(n),jr(n,"pointer")};jt.touchmove=n=>{n.input.lastTouch=Date.now(),jr(n,"pointer")};jt.contextmenu=n=>Fp(n);function vb(n,e){return n.composing?!0:zt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const YV=Tn?5e3:-1;Ht.compositionstart=Ht.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$from;if(e.selection.empty&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Nc(n,!0),n.markCursor=null;else if(Nc(n),Rn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let s=r.focusNode,i=r.focusOffset;s&&s.nodeType==1&&i!=0;){let o=i<0?s.lastChild:s.childNodes[i-1];if(!o)break;if(o.nodeType==3){n.domSelection().collapse(o,o.nodeValue.length);break}else s=o,i=-1}}n.input.composing=!0}Tb(n,YV)};Ht.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,Tb(n,20))};function Tb(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Nc(n),e))}function wb(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=ZV());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function XV(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=HL(e.focusNode,e.focusOffset),r=qL(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let s=r.pmViewDesc;if(!s||!s.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let i=t.pmViewDesc;if(!(!i||!i.isText(t.nodeValue)))return r}}return t||r}function ZV(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Nc(n,e=!1){if(!(Tn&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),wb(n),e||n.docView&&n.docView.dirty){let t=Np(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):n.updateState(n.state),!0}return!1}}function eF(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),s=document.createRange();s.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(s),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ra=Jt&&Xr<15||to&&YL<604;jt.copy=Ht.cut=(n,e)=>{let t=e,r=n.state.selection,s=t.type=="cut";if(r.empty)return;let i=Ra?null:t.clipboardData,o=r.content(),{dom:a,text:l}=db(n,o);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):eF(n,a),s&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function tF(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function nF(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let s=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Pa(n,r.value,null,s,e):Pa(n,r.textContent,r.innerHTML,s,e)},50)}function Pa(n,e,t,r,s){let i=fb(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,s,i||X.empty)))return!0;if(!i)return!1;let o=tF(i),a=o?n.state.tr.replaceSelectionWith(o,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function bb(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Ht.paste=(n,e)=>{let t=e;if(n.composing&&!Tn)return;let r=Ra?null:t.clipboardData,s=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Pa(n,bb(r),r.getData("text/html"),s,t)?t.preventDefault():nF(n,t)};class Sb{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const Ib=un?"altKey":"ctrlKey";jt.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let s=n.state.selection,i=s.empty?null:n.posAtCoords(Fu(t)),o;if(!(i&&i.pos>=s.from&&i.pos<=(s instanceof he?s.to-1:s.to))){if(r&&r.mightDrag)o=he.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(o=he.create(n.state.doc,d.posBefore))}}let a=(o||n.state.selection).content(),{dom:l,text:c,slice:h}=db(n,a);t.dataTransfer.clearData(),t.dataTransfer.setData(Ra?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ra||t.dataTransfer.setData("text/plain",c),n.dragging=new Sb(h,!t[Ib],o)};jt.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Ht.dragover=Ht.dragenter=(n,e)=>e.preventDefault();Ht.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let s=n.posAtCoords(Fu(t));if(!s)return;let i=n.state.doc.resolve(s.pos),o=r&&r.slice;o?n.someProp("transformPasted",y=>{o=y(o,n)}):o=fb(n,bb(t.dataTransfer),Ra?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&!t[Ib]);if(n.someProp("handleDrop",y=>y(n,t,o||X.empty,a))){t.preventDefault();return}if(!o)return;t.preventDefault();let l=o?jw(n.state.doc,i.pos,o):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:y}=r;y?y.replace(c):c.deleteSelection()}let h=c.mapping.map(l),d=o.openStart==0&&o.openEnd==0&&o.content.childCount==1,f=c.doc;if(d?c.replaceRangeWith(h,h,o.content.firstChild):c.replaceRange(h,h,o),c.doc.eq(f))return;let m=c.doc.resolve(h);if(d&&he.isSelectable(o.content.firstChild)&&m.nodeAfter&&m.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new he(m));else{let y=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((T,w,P,O)=>y=O),c.setSelection(Dp(n,m,c.doc.resolve(y)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};jt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&lr(n)},20))};jt.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};jt.beforeinput=(n,e)=>{if($t&&Tn&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,ks(8,"Backspace")))))return;let{$cursor:s}=n.state.selection;s&&s.pos>0&&n.dispatch(n.state.tr.delete(s.pos-1,s.pos).scrollIntoView())},50)}};for(let n in Ht)jt[n]=Ht[n];function xa(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class Dc{constructor(e,t){this.toDOM=e,this.spec=t||zs,this.side=this.spec.side||0}map(e,t,r,s){let{pos:i,deleted:o}=e.mapResult(t.from+s,this.side<0?-1:1);return o?null:new fn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof Dc&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&xa(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class es{constructor(e,t){this.attrs=e,this.spec=t||zs}map(e,t,r,s){let i=e.map(t.from+s,this.spec.inclusiveStart?-1:1)-r,o=e.map(t.to+s,this.spec.inclusiveEnd?1:-1)-r;return i>=o?null:new fn(i,o,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof es&&xa(this.attrs,e.attrs)&&xa(this.spec,e.spec)}static is(e){return e.type instanceof es}destroy(){}}class Bp{constructor(e,t){this.attrs=e,this.spec=t||zs}map(e,t,r,s){let i=e.mapResult(t.from+s,1);if(i.deleted)return null;let o=e.mapResult(t.to+s,-1);return o.deleted||o.pos<=i.pos?null:new fn(i.pos-r,o.pos-r,this)}valid(e,t){let{index:r,offset:s}=e.content.findIndex(t.from),i;return s==t.from&&!(i=e.child(r)).isText&&s+i.nodeSize==t.to}eq(e){return this==e||e instanceof Bp&&xa(this.attrs,e.attrs)&&xa(this.spec,e.spec)}destroy(){}}class fn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new fn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new fn(e,e,new Dc(t,r))}static inline(e,t,r,s){return new fn(e,t,new es(r,s))}static node(e,t,r,s){return new fn(e,t,new Bp(r,s))}get spec(){return this.type.spec}get inline(){return this.type instanceof es}get widget(){return this.type instanceof Dc}}const bi=[],zs={};class lt{constructor(e,t){this.local=e.length?e:bi,this.children=t.length?t:bi}static create(e,t){return t.length?Lc(t,e,0,zs):Pt}find(e,t,r){let s=[];return this.findInner(e??0,t??1e9,s,0,r),s}findInner(e,t,r,s,i){for(let o=0;o<this.local.length;o++){let a=this.local[o];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+s,a.to+s))}for(let o=0;o<this.children.length;o+=3)if(this.children[o]<t&&this.children[o+1]>e){let a=this.children[o]+1;this.children[o+2].findInner(e-a,t-a,r,s+a,i)}}map(e,t,r){return this==Pt||e.maps.length==0?this:this.mapInner(e,t,0,0,r||zs)}mapInner(e,t,r,s,i){let o;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,s);l&&l.type.valid(t,l)?(o||(o=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?rF(this.children,o||[],e,t,r,s,i):o?new lt(o.sort(js),bi):Pt}add(e,t){return t.length?this==Pt?lt.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let s,i=0;e.forEach((a,l)=>{let c=l+r,h;if(h=Cb(t,a,c)){for(s||(s=this.children.slice());i<s.length&&s[i]<l;)i+=3;s[i]==l?s[i+2]=s[i+2].addInner(a,h,c+1):s.splice(i,0,l,l+a.nodeSize,Lc(h,a,c+1,zs)),i+=3}});let o=Ab(i?kb(t):t,-r);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||o.splice(a--,1);return new lt(o.length?this.local.concat(o).sort(js):this.local,s||this.children)}remove(e){return e.length==0||this==Pt?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,s=this.local;for(let i=0;i<r.length;i+=3){let o,a=r[i]+t,l=r[i+1]+t;for(let h=0,d;h<e.length;h++)(d=e[h])&&d.from>a&&d.to<l&&(e[h]=null,(o||(o=[])).push(d));if(!o)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(o,a+1);c!=Pt?r[i+2]=c:(r.splice(i,3),i-=3)}if(s.length){for(let i=0,o;i<e.length;i++)if(o=e[i])for(let a=0;a<s.length;a++)s[a].eq(o,t)&&(s==this.local&&(s=this.local.slice()),s.splice(a--,1))}return r==this.children&&s==this.local?this:s.length||r.length?new lt(s,r):Pt}forChild(e,t){if(this==Pt)return this;if(t.isLeaf)return lt.empty;let r,s;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,o=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<o&&l.to>i&&l.type instanceof es){let c=Math.max(i,l.from)-i,h=Math.min(o,l.to)-i;c<h&&(s||(s=[])).push(l.copy(c,h))}}if(s){let a=new lt(s.sort(js),bi);return r?new Fr([a,r]):a}return r||Pt}eq(e){if(this==e)return!0;if(!(e instanceof lt)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return Up(this.localsInner(e))}localsInner(e){if(this==Pt)return bi;if(e.inlineContent||!this.local.some(es.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof es||t.push(this.local[r]);return t}}lt.empty=new lt([],[]);lt.removeOverlap=Up;const Pt=lt.empty;class Fr{constructor(e){this.members=e}map(e,t){const r=this.members.map(s=>s.map(e,t,zs));return Fr.from(r)}forChild(e,t){if(t.isLeaf)return lt.empty;let r=[];for(let s=0;s<this.members.length;s++){let i=this.members[s].forChild(e,t);i!=Pt&&(i instanceof Fr?r=r.concat(i.members):r.push(i))}return Fr.from(r)}eq(e){if(!(e instanceof Fr)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let s=0;s<this.members.length;s++){let i=this.members[s].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let o=0;o<i.length;o++)t.push(i[o])}}return t?Up(r?t:t.sort(js)):bi}static from(e){switch(e.length){case 0:return Pt;case 1:return e[0];default:return new Fr(e.every(t=>t instanceof lt)?e:e.reduce((t,r)=>t.concat(r instanceof lt?r:r.members),[]))}}}function rF(n,e,t,r,s,i,o){let a=n.slice();for(let c=0,h=i;c<t.maps.length;c++){let d=0;t.maps[c].forEach((f,m,y,T)=>{let w=T-y-(m-f);for(let P=0;P<a.length;P+=3){let O=a[P+1];if(O<0||f>O+h-d)continue;let D=a[P]+h-d;m>=D?a[P+1]=f<=D?-2:-1:f>=h&&w&&(a[P]+=w,a[P+1]+=w)}d+=w}),h=t.maps[c].map(h,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let h=t.map(n[c]+i),d=h-s;if(d<0||d>=r.content.size){l=!0;continue}let f=t.map(n[c+1]+i,-1),m=f-s,{index:y,offset:T}=r.content.findIndex(d),w=r.maybeChild(y);if(w&&T==d&&T+w.nodeSize==m){let P=a[c+2].mapInner(t,w,h+1,n[c]+i+1,o);P!=Pt?(a[c]=d,a[c+1]=m,a[c+2]=P):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=sF(a,n,e,t,s,i,o),h=Lc(c,r,0,o);e=h.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,f=0;d<h.children.length;d+=3){let m=h.children[d];for(;f<a.length&&a[f]<m;)f+=3;a.splice(f,0,h.children[d],h.children[d+1],h.children[d+2])}}return new lt(e.sort(js),a)}function Ab(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let s=n[r];t.push(new fn(s.from+e,s.to+e,s.type))}return t}function sF(n,e,t,r,s,i,o){function a(l,c){for(let h=0;h<l.local.length;h++){let d=l.local[h].map(r,s,c);d?t.push(d):o.onRemove&&o.onRemove(l.local[h].spec)}for(let h=0;h<l.children.length;h+=3)a(l.children[h+2],l.children[h]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function Cb(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,s=null;for(let i=0,o;i<n.length;i++)(o=n[i])&&o.from>t&&o.to<r&&((s||(s=[])).push(o),n[i]=null);return s}function kb(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Lc(n,e,t,r){let s=[],i=!1;e.forEach((a,l)=>{let c=Cb(n,a,l+t);if(c){i=!0;let h=Lc(c,a,t+l+1,r);h!=Pt&&s.push(l,l+a.nodeSize,h)}});let o=Ab(i?kb(n):n,-t).sort(js);for(let a=0;a<o.length;a++)o[a].type.valid(e,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||s.length?new lt(o,s):Pt}function js(n,e){return n.from-e.from||n.to-e.to}function Up(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let s=t+1;s<e.length;s++){let i=e[s];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[s]=i.copy(i.from,r.to),Y_(e,s+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),Y_(e,s,r.copy(i.from,r.to)));break}}}return e}function Y_(n,e,t){for(;e<n.length&&js(t,n[e])>0;)e++;n.splice(e,0,t)}function zh(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Pt&&e.push(r)}),n.cursorWrapper&&e.push(lt.create(n.state.doc,[n.cursorWrapper.deco])),Fr.from(e)}const iF={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},oF=Jt&&Xr<=11;class aF{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class lF{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new aF,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let s=0;s<r.length;s++)this.queue.push(r[s]);Jt&&Xr<=11&&r.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),oF&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,iF)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(j_(this.view)){if(this.suppressingSelectionUpdates)return lr(this.view);if(Jt&&Xr<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&Zs(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=ka(i))t.add(i);for(let i=e.anchorNode;i;i=ka(i))if(t.has(i)){r=i;break}let s=r&&this.view.docView.nearestDesc(r);if(s&&s.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&j_(e)&&!this.ignoreSelectionChange(r),i=-1,o=-1,a=!1,l=[];if(e.editable)for(let h=0;h<t.length;h++){let d=this.registerMutation(t[h],l);d&&(i=i<0?d.from:Math.min(d.from,i),o=o<0?d.to:Math.max(d.to,o),d.typeOver&&(a=!0))}if(Rn&&l.length>1){let h=l.filter(d=>d.nodeName=="BR");if(h.length==2){let d=h[0],f=h[1];d.parentNode&&d.parentNode.parentNode==f.parentNode?f.remove():d.remove()}}let c=null;i<0&&s&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&Lu(r)&&(c=Np(e))&&c.eq(Ee.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,lr(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||s)&&(i>-1&&(e.docView.markDirty(i,o),cF(e)),this.handleDOMChange(i,o,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||lr(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let h=0;h<e.addedNodes.length;h++)t.push(e.addedNodes[h]);if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let s=e.previousSibling,i=e.nextSibling;if(Jt&&Xr<=11&&e.addedNodes.length)for(let h=0;h<e.addedNodes.length;h++){let{previousSibling:d,nextSibling:f}=e.addedNodes[h];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(s=d),(!f||Array.prototype.indexOf.call(e.addedNodes,f)<0)&&(i=f)}let o=s&&s.parentNode==e.target?wt(s)+1:0,a=r.localPosFromDOM(e.target,o,-1),l=i&&i.parentNode==e.target?wt(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}}}let X_=new WeakMap,Z_=!1;function cF(n){if(!X_.has(n)&&(X_.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Rn,Z_)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),Z_=!0}}function eE(n,e){let t=e.startContainer,r=e.startOffset,s=e.endContainer,i=e.endOffset,o=n.domAtPos(n.state.selection.anchor);return Zs(o.node,o.offset,s,i)&&([t,r,s,i]=[s,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:s,focusOffset:i}}function uF(n,e){if(e.getComposedRanges){let s=e.getComposedRanges(n.root)[0];if(s)return eE(n,s)}let t;function r(s){s.preventDefault(),s.stopImmediatePropagation(),t=s.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?eE(n,t):null}function hF(n,e,t){let{node:r,fromOffset:s,toOffset:i,from:o,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,h=l.anchorNode;if(h&&n.dom.contains(h.nodeType==1?h:h.parentNode)&&(c=[{node:h,offset:l.anchorOffset}],Lu(l)||c.push({node:l.focusNode,offset:l.focusOffset})),$t&&n.input.lastKeyCode===8)for(let w=i;w>s;w--){let P=r.childNodes[w-1],O=P.pmViewDesc;if(P.nodeName=="BR"&&!O){i=w;break}if(!O||O.size)break}let d=n.state.doc,f=n.someProp("domParser")||Xi.fromSchema(n.state.schema),m=d.resolve(o),y=null,T=f.parse(r,{topNode:m.parent,topMatch:m.parent.contentMatchAt(m.index()),topOpen:!0,from:s,to:i,preserveWhitespace:m.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:dF,context:m});if(c&&c[0].pos!=null){let w=c[0].pos,P=c[1]&&c[1].pos;P==null&&(P=w),y={anchor:w+o,head:P+o}}return{doc:T,sel:y,from:o,to:a}}function dF(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(zt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||zt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const fF=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function pF(n,e,t,r,s){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let v=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,I=Np(n,v);if(I&&!n.state.selection.eq(I)){if($t&&Tn&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",k=>k(n,ks(13,"Enter"))))return;let R=n.state.tr.setSelection(I);v=="pointer"?R.setMeta("pointer",!0):v=="key"&&R.scrollIntoView(),i&&R.setMeta("composition",i),n.dispatch(R)}return}let o=n.state.doc.resolve(e),a=o.sharedDepth(t);e=o.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=hF(n,e,t),h=n.state.doc,d=h.slice(c.from,c.to),f,m;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(f=n.state.selection.to,m="end"):(f=n.state.selection.from,m="start"),n.input.lastKeyCode=null;let y=yF(d.content,c.doc.content,c.from,f,m);if((to&&n.input.lastIOSEnter>Date.now()-225||Tn)&&s.some(v=>v.nodeType==1&&!fF.test(v.nodeName))&&(!y||y.endA>=y.endB)&&n.someProp("handleKeyDown",v=>v(n,ks(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!y)if(r&&l instanceof ge&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))y={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let v=tE(n,n.state.doc,c.sel);if(v&&!v.eq(n.state.selection)){let I=n.state.tr.setSelection(v);i&&I.setMeta("composition",i),n.dispatch(I)}}return}n.input.domChangeCount++,n.state.selection.from<n.state.selection.to&&y.start==y.endB&&n.state.selection instanceof ge&&(y.start>n.state.selection.from&&y.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?y.start=n.state.selection.from:y.endA<n.state.selection.to&&y.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(y.endB+=n.state.selection.to-y.endA,y.endA=n.state.selection.to)),Jt&&Xr<=11&&y.endB==y.start+1&&y.endA==y.start&&y.start>c.from&&c.doc.textBetween(y.start-c.from-1,y.start-c.from+1)==" "&&(y.start--,y.endA--,y.endB--);let T=c.doc.resolveNoCache(y.start-c.from),w=c.doc.resolveNoCache(y.endB-c.from),P=h.resolve(y.start),O=T.sameParent(w)&&T.parent.inlineContent&&P.end()>=y.endA,D;if((to&&n.input.lastIOSEnter>Date.now()-225&&(!O||s.some(v=>v.nodeName=="DIV"||v.nodeName=="P"))||!O&&T.pos<c.doc.content.size&&!T.sameParent(w)&&(D=Ee.findFrom(c.doc.resolve(T.pos+1),1,!0))&&D.head==w.pos)&&n.someProp("handleKeyDown",v=>v(n,ks(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>y.start&&gF(h,y.start,y.endA,T,w)&&n.someProp("handleKeyDown",v=>v(n,ks(8,"Backspace")))){Tn&&$t&&n.domObserver.suppressSelectionUpdates();return}$t&&Tn&&y.endB==y.start&&(n.input.lastAndroidDelete=Date.now()),Tn&&!O&&T.start()!=w.start()&&w.parentOffset==0&&T.depth==w.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==y.endA&&(y.endB-=2,w=c.doc.resolveNoCache(y.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(v){return v(n,ks(13,"Enter"))})},20));let $=y.start,q=y.endA,F,A,_;if(O){if(T.pos==w.pos)Jt&&Xr<=11&&T.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>lr(n),20)),F=n.state.tr.delete($,q),A=h.resolve(y.start).marksAcross(h.resolve(y.endA));else if(y.endA==y.endB&&(_=mF(T.parent.content.cut(T.parentOffset,w.parentOffset),P.parent.content.cut(P.parentOffset,y.endA-P.start()))))F=n.state.tr,_.type=="add"?F.addMark($,q,_.mark):F.removeMark($,q,_.mark);else if(T.parent.child(T.index()).isText&&T.index()==w.index()-(w.textOffset?0:1)){let v=T.parent.textBetween(T.parentOffset,w.parentOffset);if(n.someProp("handleTextInput",I=>I(n,$,q,v)))return;F=n.state.tr.insertText(v,$,q)}}if(F||(F=n.state.tr.replace($,q,c.doc.slice(y.start-c.from,y.endB-c.from))),c.sel){let v=tE(n,F.doc,c.sel);v&&!($t&&Tn&&n.composing&&v.empty&&(y.start!=y.endB||n.input.lastAndroidDelete<Date.now()-100)&&(v.head==$||v.head==F.mapping.map(q)-1)||Jt&&v.empty&&v.head==$)&&F.setSelection(v)}A&&F.ensureMarks(A),i&&F.setMeta("composition",i),n.dispatch(F.scrollIntoView())}function tE(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:Dp(n,e.resolve(t.anchor),e.resolve(t.head))}function mF(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,s=t,i=r,o,a,l;for(let h=0;h<r.length;h++)s=r[h].removeFromSet(s);for(let h=0;h<t.length;h++)i=t[h].removeFromSet(i);if(s.length==1&&i.length==0)a=s[0],o="add",l=h=>h.mark(a.addToSet(h.marks));else if(s.length==0&&i.length==1)a=i[0],o="remove",l=h=>h.mark(a.removeFromSet(h.marks));else return null;let c=[];for(let h=0;h<e.childCount;h++)c.push(l(e.child(h)));if(H.from(c).eq(n))return{mark:a,type:o}}function gF(n,e,t,r,s){if(t-e<=s.pos-r.pos||jh(r,!0,!1)<s.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let o=n.resolve(jh(i,!0,!0));return!o.parent.isTextblock||o.pos>t||jh(o,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(o.parent.content)}function jh(n,e,t){let r=n.depth,s=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,s++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,s++}return s}function yF(n,e,t,r,s){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:o,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(s=="end"){let l=Math.max(0,i-Math.min(o,a));r-=o+l-i}if(o<i&&n.size<e.size){let l=r<=i&&r>=o?i-r:0;i-=l,i&&i<e.size&&nE(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-o),o=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&nE(n.textBetween(i-1,i+1))&&(i+=l?1:-1),o=i+(o-a),a=i}return{start:i,endA:o,endB:a}}function nE(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class _F{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new FV,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(aE),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=iE(this),sE(this),this.nodeViews=oE(this),this.docView=V_(this.state.doc,rE(this),zh(this),this.dom,this),this.domObserver=new lF(this,(r,s,i,o)=>pF(this,r,s,i,o)),this.domObserver.start(),BV(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&tf(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(aE),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let s=this.state,i=!1,o=!1;e.storedMarks&&this.composing&&(wb(this),o=!0),this.state=e;let a=s.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let m=oE(this);vF(m,this.nodeViews)&&(this.nodeViews=m,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&tf(this),this.editable=iE(this),sE(this);let l=zh(this),c=rE(this),h=s.plugins!=e.plugins&&!s.doc.eq(e.doc)?"reset":e.scrollToSelection>s.scrollToSelection?"to selection":"preserve",d=i||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(s.selection))&&(o=!0);let f=h=="preserve"&&o&&this.dom.style.overflowAnchor==null&&eV(this);if(o){this.domObserver.stop();let m=d&&(Jt||$t)&&!this.composing&&!s.selection.empty&&!e.selection.empty&&EF(s.selection,e.selection);if(d){let y=$t?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=XV(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=V_(e.doc,c,l,this.dom,this)),y&&!this.trackWrites&&(m=!0)}m||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&SV(this))?lr(this,m):(cb(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(s),!((r=this.dragging)===null||r===void 0)&&r.node&&!s.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,s),h=="reset"?this.dom.scrollTop=0:h=="to selection"?this.scrollToSelection():f&&tV(f)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof he){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&x_(this,t.getBoundingClientRect(),e)}else x_(this,this.coordsAtPos(this.state.selection.head,1),e)}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,s=-1;if(this.state.doc.nodeAt(r.from)==r.node)s=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(s=i)}this.dragging=new Sb(e.slice,e.move,s<0?void 0:he.create(this.state.doc,s))}someProp(e,t){let r=this._props&&this._props[e],s;if(r!=null&&(s=t?t(r):r))return s;for(let o=0;o<this.directPlugins.length;o++){let a=this.directPlugins[o].props[e];if(a!=null&&(s=t?t(a):a))return s}let i=this.state.plugins;if(i)for(let o=0;o<i.length;o++){let a=i[o].props[e];if(a!=null&&(s=t?t(a):a))return s}}hasFocus(){if(Jt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&nV(this.dom),lr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return aV(this,e)}coordsAtPos(e,t=1){return tb(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let s=this.docView.posFromDOM(e,t,r);if(s==null)throw new RangeError("DOM position not inside the editor");return s}endOfTextblock(e,t){return dV(this,t||this.state,e)}pasteHTML(e,t){return Pa(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Pa(this,e,null,!0,t||new ClipboardEvent("paste"))}destroy(){this.docView&&(UV(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],zh(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,zL())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return zV(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return zt&&this.root.nodeType===11&&KL(this.dom.ownerDocument)==this.dom&&uF(this,e)||e}domSelection(){return this.root.getSelection()}}function rE(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[fn.node(0,n.state.doc.content.size,e)]}function sE(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:fn.widget(n.state.selection.head,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function iE(n){return!n.someProp("editable",e=>e(n.state)===!1)}function EF(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function oE(n){let e=Object.create(null);function t(r){for(let s in r)Object.prototype.hasOwnProperty.call(e,s)||(e[s]=r[s])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function vF(n,e){let t=0,r=0;for(let s in n){if(n[s]!=e[s])return!0;t++}for(let s in e)r++;return t!=r}function aE(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var cs={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Vc={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},TF=typeof navigator<"u"&&/Mac/.test(navigator.platform),wF=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var bt=0;bt<10;bt++)cs[48+bt]=cs[96+bt]=String(bt);for(var bt=1;bt<=24;bt++)cs[bt+111]="F"+bt;for(var bt=65;bt<=90;bt++)cs[bt]=String.fromCharCode(bt+32),Vc[bt]=String.fromCharCode(bt);for(var Hh in cs)Vc.hasOwnProperty(Hh)||(Vc[Hh]=cs[Hh]);function bF(n){var e=TF&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||wF&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Vc:cs)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const SF=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function IF(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))SF?o=!0:s=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),s&&(t="Ctrl-"+t),o&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function AF(n){let e=Object.create(null);for(let t in n)e[IF(t)]=n[t];return e}function qh(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function CF(n){return new _n({props:{handleKeyDown:Rb(n)}})}function Rb(n){let e=AF(n);return function(t,r){let s=bF(r),i,o=e[qh(s,r)];if(o&&o(t.state,t.dispatch,t))return!0;if(s.length==1&&s!=" "){if(r.shiftKey){let a=e[qh(s,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||s.charCodeAt(0)>127)&&(i=cs[r.keyCode])&&i!=s){let a=e[qh(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const kF=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function Pb(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const RF=(n,e,t)=>{let r=Pb(n,t);if(!r)return!1;let s=$p(r);if(!s){let o=r.blockRange(),a=o&&fo(o);return a==null?!1:(e&&e(n.tr.lift(o,a).scrollIntoView()),!0)}let i=s.nodeBefore;if(!i.type.spec.isolating&&Nb(n,s,e))return!0;if(r.parent.content.size==0&&(no(i,"end")||he.isSelectable(i))){let o=Nu(n.doc,r.before(),r.after(),X.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(no(i,"end")?Ee.findFrom(a.doc.resolve(a.mapping.map(s.pos,-1)),-1):he.create(a.doc,s.pos-i.nodeSize)),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos-i.nodeSize,s.pos).scrollIntoView()),!0):!1},PF=(n,e,t)=>{let r=Pb(n,t);if(!r)return!1;let s=$p(r);return s?xb(n,s,e):!1},xF=(n,e,t)=>{let r=Ob(n,t);if(!r)return!1;let s=zp(r);return s?xb(n,s,e):!1};function xb(n,e,t){let r=e.nodeBefore,s=r,i=e.pos-1;for(;!s.isTextblock;i--){if(s.type.spec.isolating)return!1;let h=s.lastChild;if(!h)return!1;s=h}let o=e.nodeAfter,a=o,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let h=a.firstChild;if(!h)return!1;a=h}let c=Nu(n.doc,i,l,X.empty);if(!c||c.from!=i||c instanceof pt&&c.slice.size>=l-i)return!1;if(t){let h=n.tr.step(c);h.setSelection(ge.create(h.doc,i)),t(h.scrollIntoView())}return!0}function no(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const OF=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=$p(r)}let o=i&&i.nodeBefore;return!o||!he.isSelectable(o)?!1:(e&&e(n.tr.setSelection(he.create(n.doc,i.pos-o.nodeSize)).scrollIntoView()),!0)};function $p(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function Ob(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const MF=(n,e,t)=>{let r=Ob(n,t);if(!r)return!1;let s=zp(r);if(!s)return!1;let i=s.nodeAfter;if(Nb(n,s,e))return!0;if(r.parent.content.size==0&&(no(i,"start")||he.isSelectable(i))){let o=Nu(n.doc,r.before(),r.after(),X.empty);if(o&&o.slice.size<o.to-o.from){if(e){let a=n.tr.step(o);a.setSelection(no(i,"start")?Ee.findFrom(a.doc.resolve(a.mapping.map(s.pos)),1):he.create(a.doc,a.mapping.map(s.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&s.depth==r.depth-1?(e&&e(n.tr.delete(s.pos,s.pos+i.nodeSize).scrollIntoView()),!0):!1},NF=(n,e,t)=>{let{$head:r,empty:s}=n.selection,i=r;if(!s)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=zp(r)}let o=i&&i.nodeAfter;return!o||!he.isSelectable(o)?!1:(e&&e(n.tr.setSelection(he.create(n.doc,i.pos)).scrollIntoView()),!0)};function zp(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const DF=(n,e)=>{let t=n.selection,r=t instanceof he,s;if(r){if(t.node.isTextblock||!ds(n.doc,t.from))return!1;s=t.from}else if(s=Mu(n.doc,t.from,-1),s==null)return!1;if(e){let i=n.tr.join(s);r&&i.setSelection(he.create(i.doc,s-n.doc.resolve(s).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},LF=(n,e)=>{let t=n.selection,r;if(t instanceof he){if(t.node.isTextblock||!ds(n.doc,t.to))return!1;r=t.to}else if(r=Mu(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},VF=(n,e)=>{let{$from:t,$to:r}=n.selection,s=t.blockRange(r),i=s&&fo(s);return i==null?!1:(e&&e(n.tr.lift(s,i).scrollIntoView()),!0)},FF=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Mb(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const BF=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let s=t.node(-1),i=t.indexAfter(-1),o=Mb(s.contentMatchAt(i));if(!o||!s.canReplaceWith(i,i,o))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,o.createAndFill());l.setSelection(Ee.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},UF=(n,e)=>{let t=n.selection,{$from:r,$to:s}=t;if(t instanceof In||r.parent.inlineContent||s.parent.inlineContent)return!1;let i=Mb(s.parent.contentMatchAt(s.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let o=(!r.parentOffset&&s.index()<s.parent.childCount?r:s).pos,a=n.tr.insert(o,i.createAndFill());a.setSelection(ge.create(a.doc,o+1)),e(a.scrollIntoView())}return!0},$F=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(Fi(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),s=r&&fo(r);return s==null?!1:(e&&e(n.tr.lift(r,s).scrollIntoView()),!0)},zF=(n,e)=>{let{$from:t,to:r}=n.selection,s,i=t.sharedDepth(r);return i==0?!1:(s=t.before(i),e&&e(n.tr.setSelection(he.create(n.doc,s))),!0)};function jF(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i=e.index();return!r||!s||!r.type.compatibleContent(s.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(s.isTextblock||ds(n.doc,e.pos))?!1:(t&&t(n.tr.clearIncompatible(e.pos,r.type,r.contentMatchAt(r.childCount)).join(e.pos).scrollIntoView()),!0)}function Nb(n,e,t){let r=e.nodeBefore,s=e.nodeAfter,i,o;if(r.type.spec.isolating||s.type.spec.isolating)return!1;if(jF(n,e,t))return!0;let a=e.parent.canReplace(e.index(),e.index()+1);if(a&&(i=(o=r.contentMatchAt(r.childCount)).findWrapping(s.type))&&o.matchType(i[0]||s.type).validEnd){if(t){let d=e.pos+s.nodeSize,f=H.empty;for(let T=i.length-1;T>=0;T--)f=H.from(i[T].create(null,f));f=H.from(r.copy(f));let m=n.tr.step(new gt(e.pos-1,d,e.pos,d,new X(f,1,0),i.length,!0)),y=d+2*i.length;ds(m.doc,y)&&m.join(y),t(m.scrollIntoView())}return!0}let l=Ee.findFrom(e,1),c=l&&l.$from.blockRange(l.$to),h=c&&fo(c);if(h!=null&&h>=e.depth)return t&&t(n.tr.lift(c,h).scrollIntoView()),!0;if(a&&no(s,"start",!0)&&no(r,"end")){let d=r,f=[];for(;f.push(d),!d.isTextblock;)d=d.lastChild;let m=s,y=1;for(;!m.isTextblock;m=m.firstChild)y++;if(d.canReplace(d.childCount,d.childCount,m.content)){if(t){let T=H.empty;for(let P=f.length-1;P>=0;P--)T=H.from(f[P].copy(T));let w=n.tr.step(new gt(e.pos-f.length,e.pos+s.nodeSize,e.pos+y,e.pos+s.nodeSize-y,new X(T,f.length,0),0,!0));t(w.scrollIntoView())}return!0}}return!1}function Db(n){return function(e,t){let r=e.selection,s=n<0?r.$from:r.$to,i=s.depth;for(;s.node(i).isInline;){if(!i)return!1;i--}return s.node(i).isTextblock?(t&&t(e.tr.setSelection(ge.create(e.doc,n<0?s.start(i):s.end(i)))),!0):!1}}const HF=Db(-1),qF=Db(1);function WF(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=o&&xp(o,n,e);return a?(r&&r(t.tr.wrap(o,a).scrollIntoView()),!0):!1}}function lE(n,e=null){return function(t,r){let s=!1;for(let i=0;i<t.selection.ranges.length&&!s;i++){let{$from:{pos:o},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(o,a,(l,c)=>{if(s)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)s=!0;else{let h=t.doc.resolve(c),d=h.index();s=h.parent.canReplaceWith(d,d+1,n)}})}if(!s)return!1;if(r){let i=t.tr;for(let o=0;o<t.selection.ranges.length;o++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[o];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function KF(n,e=null){return function(t,r){let{$from:s,$to:i}=t.selection,o=s.blockRange(i),a=!1,l=o;if(!o)return!1;if(o.depth>=2&&s.node(o.depth-1).type.compatibleContent(n)&&o.startIndex==0){if(s.index(o.depth-1)==0)return!1;let h=t.doc.resolve(o.start-2);l=new Rc(h,h,o.depth),o.endIndex<o.parent.childCount&&(o=new Rc(s,t.doc.resolve(i.end(o.depth)),o.depth)),a=!0}let c=xp(l,n,e,o);return c?(r&&r(GF(t.tr,o,c,a,n).scrollIntoView()),!0):!1}}function GF(n,e,t,r,s){let i=H.empty;for(let h=t.length-1;h>=0;h--)i=H.from(t[h].type.create(t[h].attrs,i));n.step(new gt(e.start-(r?2:0),e.end,e.start,e.end,new X(i,0,0),t.length,!0));let o=0;for(let h=0;h<t.length;h++)t[h].type==s&&(o=h+1);let a=t.length-o,l=e.start+t.length-(r?2:0),c=e.parent;for(let h=e.startIndex,d=e.endIndex,f=!0;h<d;h++,f=!1)!f&&Fi(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(h).nodeSize;return n}function JF(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,o=>o.childCount>0&&o.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?QF(e,t,n,i):YF(e,t,i):!0:!1}}function QF(n,e,t,r){let s=n.tr,i=r.end,o=r.$to.end(r.depth);i<o&&(s.step(new gt(i-1,o,i,o,new X(H.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new Rc(s.doc.resolve(r.$from.pos),s.doc.resolve(o),r.depth));const a=fo(r);if(a==null)return!1;s.lift(r,a);let l=s.mapping.map(i,-1)-1;return ds(s.doc,l)&&s.join(l),e(s.scrollIntoView()),!0}function YF(n,e,t){let r=n.tr,s=t.parent;for(let m=t.end,y=t.endIndex-1,T=t.startIndex;y>T;y--)m-=s.child(y).nodeSize,r.delete(m-1,m+1);let i=r.doc.resolve(t.start),o=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==s.childCount,c=i.node(-1),h=i.index(-1);if(!c.canReplace(h+(a?0:1),h+1,o.content.append(l?H.empty:H.from(s))))return!1;let d=i.pos,f=d+o.nodeSize;return r.step(new gt(d-(a?1:0),f+(l?1:0),d+1,f-1,new X((a?H.empty:H.from(s.copy(H.empty))).append(l?H.empty:H.from(s.copy(H.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function XF(n){return function(e,t){let{$from:r,$to:s}=e.selection,i=r.blockRange(s,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let o=i.startIndex;if(o==0)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,h=H.from(c?n.create():null),d=new X(H.from(n.create(null,H.from(a.type.create(null,h)))),c?3:1,0),f=i.start,m=i.end;t(e.tr.step(new gt(f-(c?3:1),m,f,m,d,1,!0)).scrollIntoView())}return!0}}function Bu(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:s}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return s},get tr(){return r=t.selection,s=t.doc,i=t.storedMarks,t}}}class Uu{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:s}=t,{tr:i}=r,o=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...h)=>{const d=l(...h)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a=[],l=!!e,c=e||i.tr,h=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(c),a.every(f=>f===!0)),d={...Object.fromEntries(Object.entries(r).map(([f,m])=>[f,(...T)=>{const w=this.buildProps(c,t),P=m(...T)(w);return a.push(P),d}])),run:h};return d}createCan(e){const{rawCommands:t,state:r}=this,s=!1,i=e||r.tr,o=this.buildProps(i,s);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...h)=>c(...h)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,s)}}buildProps(e,t=!0){const{rawCommands:r,editor:s,state:i}=this,{view:o}=s,a={tr:e,editor:s,view:o,state:Bu({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...h)=>c(...h)(a)]))}};return a}}class ZF{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(s=>s.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(s=>s!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}function ne(n,e,t){return n.config[e]===void 0&&n.parent?ne(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?ne(n.parent,e,t):null}):n.config[e]}function $u(n){const e=n.filter(s=>s.type==="extension"),t=n.filter(s=>s.type==="node"),r=n.filter(s=>s.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function Lb(n){const e=[],{nodeExtensions:t,markExtensions:r}=$u(n),s=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=ne(o,"addGlobalAttributes",a);if(!l)return;l().forEach(h=>{h.types.forEach(d=>{Object.entries(h.attributes).forEach(([f,m])=>{e.push({type:d,name:f,attribute:{...i,...m}})})})})}),s.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},l=ne(o,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([h,d])=>{const f={...i,...d};typeof(f==null?void 0:f.default)=="function"&&(f.default=f.default()),f!=null&&f.isRequired&&(f==null?void 0:f.default)===void 0&&delete f.default,e.push({type:o.name,name:h,attribute:f})})}),e}function _t(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function ht(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([s,i])=>{if(!r[s]){r[s]=i;return}if(s==="class"){const a=i?i.split(" "):[],l=r[s]?r[s].split(" "):[],c=a.filter(h=>!l.includes(h));r[s]=[...l,...c].join(" ")}else s==="style"?r[s]=[r[s],i].join("; "):r[s]=i}),r},{})}function nf(n,e){return e.filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>ht(t,r),{})}function Vb(n){return typeof n=="function"}function _e(n,e=void 0,...t){return Vb(n)?e?n.bind(e)(...t):n(...t):n}function e2(n={}){return Object.keys(n).length===0&&n.constructor===Object}function t2(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function cE(n,e){return n.style?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const s=e.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(t):t2(t.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...r,...s}}}}function uE(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&e2(t)?!1:t!=null))}function n2(n,e){var t;const r=Lb(n),{nodeExtensions:s,markExtensions:i}=$u(n),o=(t=s.find(c=>ne(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(s.map(c=>{const h=r.filter(P=>P.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((P,O)=>{const D=ne(O,"extendNodeSchema",d);return{...P,...D?D(c):{}}},{}),m=uE({...f,content:_e(ne(c,"content",d)),marks:_e(ne(c,"marks",d)),group:_e(ne(c,"group",d)),inline:_e(ne(c,"inline",d)),atom:_e(ne(c,"atom",d)),selectable:_e(ne(c,"selectable",d)),draggable:_e(ne(c,"draggable",d)),code:_e(ne(c,"code",d)),defining:_e(ne(c,"defining",d)),isolating:_e(ne(c,"isolating",d)),attrs:Object.fromEntries(h.map(P=>{var O;return[P.name,{default:(O=P==null?void 0:P.attribute)===null||O===void 0?void 0:O.default}]}))}),y=_e(ne(c,"parseHTML",d));y&&(m.parseDOM=y.map(P=>cE(P,h)));const T=ne(c,"renderHTML",d);T&&(m.toDOM=P=>T({node:P,HTMLAttributes:nf(P,h)}));const w=ne(c,"renderText",d);return w&&(m.toText=w),[c.name,m]})),l=Object.fromEntries(i.map(c=>{const h=r.filter(w=>w.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},f=n.reduce((w,P)=>{const O=ne(P,"extendMarkSchema",d);return{...w,...O?O(c):{}}},{}),m=uE({...f,inclusive:_e(ne(c,"inclusive",d)),excludes:_e(ne(c,"excludes",d)),group:_e(ne(c,"group",d)),spanning:_e(ne(c,"spanning",d)),code:_e(ne(c,"code",d)),attrs:Object.fromEntries(h.map(w=>{var P;return[w.name,{default:(P=w==null?void 0:w.attribute)===null||P===void 0?void 0:P.default}]}))}),y=_e(ne(c,"parseHTML",d));y&&(m.parseDOM=y.map(w=>cE(w,h)));const T=ne(c,"renderHTML",d);return T&&(m.toDOM=w=>T({mark:w,HTMLAttributes:nf(w,h)})),[c.name,m]}));return new iL({topNode:o,nodes:a,marks:l})}function Wh(n,e){return e.nodes[n]||e.marks[n]||null}function hE(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}const r2=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(s,i,o,a)=>{var l,c;const h=((c=(l=s.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:s,pos:i,parent:o,index:a}))||s.textContent||"%leaf%";t+=h.slice(0,Math.max(0,r-i))}),t};function jp(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class zu{constructor(e){this.find=e.find,this.handler=e.handler}}const s2=(n,e)=>{if(jp(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Ol(n){var e;const{editor:t,from:r,to:s,text:i,rules:o,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(f=>f.type.spec.code))return!1;let h=!1;const d=r2(c)+i;return o.forEach(f=>{if(h)return;const m=s2(d,f.find);if(!m)return;const y=l.state.tr,T=Bu({state:l.state,transaction:y}),w={from:r-(m[0].length-i.length),to:s},{commands:P,chain:O,can:D}=new Uu({editor:t,state:T});f.handler({state:T,range:w,match:m,commands:P,chain:O,can:D})===null||!y.steps.length||(y.setMeta(a,{transform:y,from:r,to:s,text:i}),l.dispatch(y),h=!0)}),h}function i2(n){const{editor:e,rules:t}=n,r=new _n({state:{init(){return null},apply(s,i){const o=s.getMeta(r);if(o)return o;const a=s.getMeta("applyInputRules");return!!a&&setTimeout(()=>{const{from:c,text:h}=a,d=c+h.length;Ol({editor:e,from:c,to:d,text:h,rules:t,plugin:r})}),s.selectionSet||s.docChanged?null:i}},props:{handleTextInput(s,i,o,a){return Ol({editor:e,from:i,to:o,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:s=>(setTimeout(()=>{const{$cursor:i}=s.state.selection;i&&Ol({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(s,i){if(i.key!=="Enter")return!1;const{$cursor:o}=s.state.selection;return o?Ol({editor:e,from:o.pos,to:o.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function o2(n){return typeof n=="number"}class a2{constructor(e){this.find=e.find,this.handler=e.handler}}const l2=(n,e,t)=>{if(jp(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(s=>{const i=[s.text];return i.index=s.index,i.input=n,i.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(s.replaceWith)),i}):[]};function c2(n){const{editor:e,state:t,from:r,to:s,rule:i,pasteEvent:o,dropEvent:a}=n,{commands:l,chain:c,can:h}=new Uu({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,s,(m,y)=>{if(!m.isTextblock||m.type.spec.code)return;const T=Math.max(r,y),w=Math.min(s,y+m.content.size),P=m.textBetween(T-y,w-y,void 0,"");l2(P,i.find,o).forEach(D=>{if(D.index===void 0)return;const $=T+D.index+1,q=$+D[0].length,F={from:t.tr.mapping.map($),to:t.tr.mapping.map(q)},A=i.handler({state:t,range:F,match:D,commands:l,chain:c,can:h,pasteEvent:o,dropEvent:a});d.push(A)})}),d.every(m=>m!==null)}const u2=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function h2(n){const{editor:e,rules:t}=n;let r=null,s=!1,i=!1,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a=typeof DragEvent<"u"?new DragEvent("drop"):null;const l=({state:h,from:d,to:f,rule:m,pasteEvt:y})=>{const T=h.tr,w=Bu({state:h,transaction:T});if(!(!c2({editor:e,state:w,from:Math.max(d-1,0),to:f.b-1,rule:m,pasteEvent:y,dropEvent:a})||!T.steps.length))return a=typeof DragEvent<"u"?new DragEvent("drop"):null,o=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,T};return t.map(h=>new _n({view(d){const f=m=>{var y;r=!((y=d.dom.parentElement)===null||y===void 0)&&y.contains(m.target)?d.dom.parentElement:null};return window.addEventListener("dragstart",f),{destroy(){window.removeEventListener("dragstart",f)}}},props:{handleDOMEvents:{drop:(d,f)=>(i=r===d.dom.parentElement,a=f,!1),paste:(d,f)=>{var m;const y=(m=f.clipboardData)===null||m===void 0?void 0:m.getData("text/html");return o=f,s=!!(y!=null&&y.includes("data-pm-slice")),!1}}},appendTransaction:(d,f,m)=>{const y=d[0],T=y.getMeta("uiEvent")==="paste"&&!s,w=y.getMeta("uiEvent")==="drop"&&!i,P=y.getMeta("applyPasteRules"),O=!!P;if(!T&&!w&&!O)return;if(O){const{from:q,text:F}=P,A=q+F.length,_=u2(F);return l({rule:h,state:m,from:q,to:{b:A},pasteEvt:_})}const D=f.doc.content.findDiffStart(m.doc.content),$=f.doc.content.findDiffEnd(m.doc.content);if(!(!o2(D)||!$||D===$.b))return l({rule:h,state:m,from:D,to:$,pasteEvt:o})}}))}function d2(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return[...new Set(e)]}class Ai{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Ai.resolve(e),this.schema=n2(this.extensions,t),this.extensions.forEach(r=>{var s;this.editor.extensionStorage[r.name]=r.storage;const i={name:r.name,options:r.options,storage:r.storage,editor:this.editor,type:Wh(r.name,this.schema)};r.type==="mark"&&(!((s=_e(ne(r,"keepOnSplit",i)))!==null&&s!==void 0)||s)&&this.splittableMarks.push(r.name);const o=ne(r,"onBeforeCreate",i);o&&this.editor.on("beforeCreate",o);const a=ne(r,"onCreate",i);a&&this.editor.on("create",a);const l=ne(r,"onUpdate",i);l&&this.editor.on("update",l);const c=ne(r,"onSelectionUpdate",i);c&&this.editor.on("selectionUpdate",c);const h=ne(r,"onTransaction",i);h&&this.editor.on("transaction",h);const d=ne(r,"onFocus",i);d&&this.editor.on("focus",d);const f=ne(r,"onBlur",i);f&&this.editor.on("blur",f);const m=ne(r,"onDestroy",i);m&&this.editor.on("destroy",m)})}static resolve(e){const t=Ai.sort(Ai.flatten(e)),r=d2(t.map(s=>s.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(s=>`'${s}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},s=ne(t,"addExtensions",r);return s?[t,...this.flatten(s())]:t}).flat(10)}static sort(e){return e.sort((r,s)=>{const i=ne(r,"priority")||100,o=ne(s,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Wh(t.name,this.schema)},s=ne(t,"addCommands",r);return s?{...e,...s()}:e},{})}get plugins(){const{editor:e}=this,t=Ai.sort([...this.extensions].reverse()),r=[],s=[],i=t.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:e,type:Wh(o.name,this.schema)},l=[],c=ne(o,"addKeyboardShortcuts",a);let h={};if(o.type==="mark"&&o.config.exitable&&(h.ArrowRight=()=>Jn.handleExit({editor:e,mark:o})),c){const T=Object.fromEntries(Object.entries(c()).map(([w,P])=>[w,()=>P({editor:e})]));h={...h,...T}}const d=CF(h);l.push(d);const f=ne(o,"addInputRules",a);hE(o,e.options.enableInputRules)&&f&&r.push(...f());const m=ne(o,"addPasteRules",a);hE(o,e.options.enablePasteRules)&&m&&s.push(...m());const y=ne(o,"addProseMirrorPlugins",a);if(y){const T=y();l.push(...T)}return l}).flat();return[i2({editor:e,rules:r}),...h2({editor:e,rules:s}),...i]}get attributes(){return Lb(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=$u(this.extensions);return Object.fromEntries(t.filter(r=>!!ne(r,"addNodeView")).map(r=>{const s=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:_t(r.name,this.schema)},o=ne(r,"addNodeView",i);if(!o)return[];const a=(l,c,h,d)=>{const f=nf(l,s);return o()({editor:e,node:l,getPos:h,decorations:d,HTMLAttributes:f,extension:r})};return[r.name,a]}))}}function f2(n){return Object.prototype.toString.call(n).slice(8,-1)}function Kh(n){return f2(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function ju(n,e){const t={...n};return Kh(n)&&Kh(e)&&Object.keys(e).forEach(r=>{Kh(e[r])?r in n?t[r]=ju(n[r],e[r]):Object.assign(t,{[r]:e[r]}):Object.assign(t,{[r]:e[r]})}),t}class Yt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_e(ne(this,"addOptions",{name:this.name}))),this.storage=_e(ne(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Yt(e)}configure(e={}){const t=this.extend();return t.options=ju(this.options,e),t.storage=_e(ne(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Yt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=_e(ne(t,"addOptions",{name:t.name})),t.storage=_e(ne(t,"addStorage",{name:t.name,options:t.options})),t}}function Fb(n,e,t){const{from:r,to:s}=e,{blockSeparator:i=`

`,textSerializers:o={}}=t||{};let a="",l=!0;return n.nodesBetween(r,s,(c,h,d,f)=>{var m;const y=o==null?void 0:o[c.type.name];if(y)return c.isBlock&&!l&&(a+=i,l=!0),d&&(a+=y({node:c,pos:h,parent:d,index:f,range:e})),!1;c.isText?(a+=(m=c==null?void 0:c.text)===null||m===void 0?void 0:m.slice(Math.max(r,h)-h,s-h),l=!1):c.isBlock&&!l&&(a+=i,l=!0)}),a}function Bb(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const p2=Yt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new _n({key:new fs("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:s}=e,{ranges:i}=s,o=Math.min(...i.map(h=>h.$from.pos)),a=Math.max(...i.map(h=>h.$to.pos)),l=Bb(t);return Fb(r,{from:o,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),m2=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),g2=(n=!1)=>({commands:e})=>e.setContent("",n),y2=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:s}=r;return t&&s.forEach(({$from:i,$to:o})=>{n.doc.nodesBetween(i.pos,o.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:h}=e,d=c.resolve(h.map(l)),f=c.resolve(h.map(l+a.nodeSize)),m=d.blockRange(f);if(!m)return;const y=fo(m);if(a.type.isTextblock){const{defaultType:T}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(m.start,T)}(y||y===0)&&e.lift(m,y)})}),!0},_2=n=>e=>n(e),E2=()=>({state:n,dispatch:e})=>UF(n,e),v2=(n,e)=>({editor:t,tr:r})=>{const{state:s}=t,i=s.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const o=r.mapping.map(e);return r.insert(o,i.content),r.setSelection(new ge(r.doc.resolve(o-1))),!0},T2=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const s=n.selection.$anchor;for(let i=s.depth;i>0;i-=1)if(s.node(i).type===r.type){if(e){const a=s.before(i),l=s.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},w2=n=>({tr:e,state:t,dispatch:r})=>{const s=_t(n,t.schema),i=e.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===s){if(r){const l=i.before(o),c=i.after(o);e.delete(l,c).scrollIntoView()}return!0}return!1},b2=n=>({tr:e,dispatch:t})=>{const{from:r,to:s}=n;return t&&e.delete(r,s),!0},S2=()=>({state:n,dispatch:e})=>kF(n,e),I2=()=>({commands:n})=>n.keyboardShortcut("Enter"),A2=()=>({state:n,dispatch:e})=>BF(n,e);function Fc(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(s=>t.strict?e[s]===n[s]:jp(e[s])?e[s].test(n[s]):e[s]===n[s]):!0}function rf(n,e,t={}){return n.find(r=>r.type===e&&Fc(r.attrs,t))}function C2(n,e,t={}){return!!rf(n,e,t)}function Hp(n,e,t={}){if(!n||!e)return;let r=n.parent.childAfter(n.parentOffset);if(n.parentOffset===r.offset&&r.offset!==0&&(r=n.parent.childBefore(n.parentOffset)),!r.node)return;const s=rf([...r.node.marks],e,t);if(!s)return;let i=r.index,o=n.start()+r.offset,a=i+1,l=o+r.node.nodeSize;for(rf([...r.node.marks],e,t);i>0&&s.isInSet(n.parent.child(i-1).marks);)i-=1,o-=n.parent.child(i).nodeSize;for(;a<n.parent.childCount&&C2([...n.parent.child(a).marks],e,t);)l+=n.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function ms(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const k2=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const i=ms(n,r.schema),{doc:o,selection:a}=t,{$from:l,from:c,to:h}=a;if(s){const d=Hp(l,i,e);if(d&&d.from<=c&&d.to>=h){const f=ge.create(o,d.from,d.to);t.setSelection(f)}}return!0},R2=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Ub(n){return n instanceof ge}function Ns(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function $b(n,e=null){if(!e)return null;const t=Ee.atStart(n),r=Ee.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const s=t.from,i=r.to;return e==="all"?ge.create(n,Ns(0,s,i),Ns(n.content.size,s,i)):ge.create(n,Ns(e,s,i),Ns(e,s,i))}function qp(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const P2=(n=null,e={})=>({editor:t,view:r,tr:s,dispatch:i})=>{e={scrollIntoView:!0,...e};const o=()=>{qp()&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!Ub(t.state.selection))return o(),!0;const a=$b(s.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||s.setSelection(a),l&&s.storedMarks&&s.setStoredMarks(s.storedMarks),o()),!0},x2=(n,e)=>t=>n.every((r,s)=>e(r,{...t,index:s})),O2=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),zb=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&zb(r)}return n};function dE(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return zb(t)}function Bc(n,e,t){if(t={slice:!0,parseOptions:{},...t},typeof n=="object"&&n!==null)try{return Array.isArray(n)&&n.length>0?H.fromArray(n.map(r=>e.nodeFromJSON(r))):e.nodeFromJSON(n)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",r),Bc("",e,t)}if(typeof n=="string"){const r=Xi.fromSchema(e);return t.slice?r.parseSlice(dE(n),t.parseOptions).content:r.parse(dE(n),t.parseOptions)}return Bc("",e,t)}function M2(n,e,t){const r=n.steps.length-1;if(r<e)return;const s=n.steps[r];if(!(s instanceof pt||s instanceof gt))return;const i=n.mapping.maps[r];let o=0;i.forEach((a,l,c,h)=>{o===0&&(o=h)}),n.setSelection(Ee.near(n.doc.resolve(o),t))}const N2=n=>n.toString().startsWith("<"),D2=(n,e,t)=>({tr:r,dispatch:s,editor:i})=>{if(s){t={parseOptions:{},updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};const o=Bc(e,i.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions}});if(o.toString()==="<>")return!0;let{from:a,to:l}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},c=!0,h=!0;if((N2(o)?o:[o]).forEach(m=>{m.check(),c=c?m.isText&&m.marks.length===0:!1,h=h?m.isBlock:!1}),a===l&&h){const{parent:m}=r.doc.resolve(a);m.isTextblock&&!m.type.spec.code&&!m.childCount&&(a-=1,l+=1)}let f;c?(Array.isArray(e)?f=e.map(m=>m.text||"").join(""):typeof e=="object"&&e&&e.text?f=e.text:f=e,r.insertText(f,a,l)):(f=o,r.replaceWith(a,l,f)),t.updateSelection&&M2(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:a,text:f}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:a,text:f})}return!0},L2=()=>({state:n,dispatch:e})=>DF(n,e),V2=()=>({state:n,dispatch:e})=>LF(n,e),F2=()=>({state:n,dispatch:e})=>RF(n,e),B2=()=>({state:n,dispatch:e})=>MF(n,e),U2=()=>({tr:n,state:e,dispatch:t})=>{try{const r=Mu(e.doc,e.selection.$from.pos,-1);return r==null?!1:(n.join(r,2),t&&t(n),!0)}catch{return!1}},$2=()=>({state:n,dispatch:e,tr:t})=>{try{const r=Mu(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},z2=()=>({state:n,dispatch:e})=>PF(n,e),j2=()=>({state:n,dispatch:e})=>xF(n,e);function Wp(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function H2(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,s,i,o;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))o=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))s=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))qp()||Wp()?o=!0:s=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),s&&(t=`Ctrl-${t}`),o&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const q2=n=>({editor:e,view:t,tr:r,dispatch:s})=>{const i=H2(n).split(/-(?!$)/),o=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const h=c.map(r.mapping);h&&s&&r.maybeStep(h)}),!0};function Oa(n,e,t={}){const{from:r,to:s,empty:i}=n.selection,o=e?_t(e,n.schema):null,a=[];n.doc.nodesBetween(r,s,(d,f)=>{if(d.isText)return;const m=Math.max(r,f),y=Math.min(s,f+d.nodeSize);a.push({node:d,from:m,to:y})});const l=s-r,c=a.filter(d=>o?o.name===d.node.type.name:!0).filter(d=>Fc(d.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((d,f)=>d+f.to-f.from,0)>=l}const W2=(n,e={})=>({state:t,dispatch:r})=>{const s=_t(n,t.schema);return Oa(t,s,e)?VF(t,r):!1},K2=()=>({state:n,dispatch:e})=>$F(n,e),G2=n=>({state:e,dispatch:t})=>{const r=_t(n,e.schema);return JF(r)(e,t)},J2=()=>({state:n,dispatch:e})=>FF(n,e);function Hu(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function fE(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,s)=>(t.includes(s)||(r[s]=n[s]),r),{})}const Q2=(n,e)=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Hu(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=_t(n,r.schema)),a==="mark"&&(o=ms(n,r.schema)),s&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,h)=>{i&&i===c.type&&t.setNodeMarkup(h,void 0,fE(c.attrs,e)),o&&c.marks.length&&c.marks.forEach(d=>{o===d.type&&t.addMark(h,h+c.nodeSize,o.create(fE(d.attrs,e)))})})}),!0):!1},Y2=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),X2=()=>({tr:n,commands:e})=>e.setTextSelection({from:0,to:n.doc.content.size}),Z2=()=>({state:n,dispatch:e})=>OF(n,e),eB=()=>({state:n,dispatch:e})=>NF(n,e),tB=()=>({state:n,dispatch:e})=>zF(n,e),nB=()=>({state:n,dispatch:e})=>qF(n,e),rB=()=>({state:n,dispatch:e})=>HF(n,e);function jb(n,e,t={}){return Bc(n,e,{slice:!1,parseOptions:t})}const sB=(n,e=!1,t={})=>({tr:r,editor:s,dispatch:i})=>{const{doc:o}=r,a=jb(n,s.schema,t);return i&&r.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!e),!0};function qu(n,e){const t=ms(e,n.schema),{from:r,to:s,empty:i}=n.selection,o=[];i?(n.storedMarks&&o.push(...n.storedMarks),o.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,s,l=>{o.push(...l.marks)});const a=o.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function iB(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function oB(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Kp(n){return e=>oB(e.$from,n)}function aB(n,e){const t=Fn.fromSchema(e).serializeFragment(n),s=document.implementation.createHTMLDocument().createElement("div");return s.appendChild(t),s.innerHTML}function lB(n,e){const t={from:0,to:n.content.size};return Fb(n,t,e)}function cB(n,e){const t=_t(e,n.schema),{from:r,to:s}=n.selection,i=[];n.doc.nodesBetween(r,s,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===t.name);return o?{...o.attrs}:{}}function uB(n,e){const t=Hu(typeof e=="string"?e:e.name,n.schema);return t==="node"?cB(n,e):t==="mark"?qu(n,e):{}}function Hb(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(s=>{const i=t.resolve(n-1),o=Hp(i,s.type);o&&r.push({mark:s,...o})}):t.nodesBetween(n,e,(s,i)=>{!s||(s==null?void 0:s.nodeSize)===void 0||r.push(...s.marks.map(o=>({from:i,to:i+s.nodeSize,mark:o})))}),r}function Ql(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const s=n.find(i=>i.type===e&&i.name===r);return s?s.attribute.keepOnSplit:!1}))}function sf(n,e,t={}){const{empty:r,ranges:s}=n.selection,i=e?ms(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>Fc(d.attrs,t,{strict:!1}));let o=0;const a=[];if(s.forEach(({$from:d,$to:f})=>{const m=d.pos,y=f.pos;n.doc.nodesBetween(m,y,(T,w)=>{if(!T.isText&&!T.marks.length)return;const P=Math.max(m,w),O=Math.min(y,w+T.nodeSize),D=O-P;o+=D,a.push(...T.marks.map($=>({mark:$,from:P,to:O})))})}),o===0)return!1;const l=a.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>Fc(d.mark.attrs,t,{strict:!1})).reduce((d,f)=>d+f.to-f.from,0),c=a.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,f)=>d+f.to-f.from,0);return(l>0?l+c:l)>=o}function hB(n,e,t={}){if(!e)return Oa(n,null,t)||sf(n,null,t);const r=Hu(e,n.schema);return r==="node"?Oa(n,e,t):r==="mark"?sf(n,e,t):!1}function pE(n,e){const{nodeExtensions:t}=$u(e),r=t.find(o=>o.name===n);if(!r)return!1;const s={name:r.name,options:r.options,storage:r.storage},i=_e(ne(r,"group",s));return typeof i!="string"?!1:i.split(" ").includes("list")}function dB(n){var e;const t=(e=n.type.createAndFill())===null||e===void 0?void 0:e.toJSON(),r=n.toJSON();return JSON.stringify(t)===JSON.stringify(r)}function fB(n,e,t){var r;const{selection:s}=e;let i=null;if(Ub(s)&&(i=s.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:o}=s;return o.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(h,d,f)=>{if(c)return!1;if(h.isInline){const m=!f||f.type.allowsMarkType(t),y=!!t.isInSet(h.marks)||!h.marks.some(T=>T.type.excludes(t));c=m&&y}return!c}),c})}const pB=(n,e={})=>({tr:t,state:r,dispatch:s})=>{const{selection:i}=t,{empty:o,ranges:a}=i,l=ms(n,r.schema);if(s)if(o){const c=qu(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const h=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(h,d,(f,m)=>{const y=Math.max(m,h),T=Math.min(m+f.nodeSize,d);f.marks.find(P=>P.type===l)?f.marks.forEach(P=>{l===P.type&&t.addMark(y,T,l.create({...P.attrs,...e}))}):t.addMark(y,T,l.create(e))})});return fB(r,t,l)},mB=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),gB=(n,e={})=>({state:t,dispatch:r,chain:s})=>{const i=_t(n,t.schema);return i.isTextblock?s().command(({commands:o})=>lE(i,e)(t)?!0:o.clearNodes()).command(({state:o})=>lE(i,e)(o,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},yB=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,s=Ns(n,0,r.content.size),i=he.create(r,s);e.setSelection(i)}return!0},_B=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:s,to:i}=typeof n=="number"?{from:n,to:n}:n,o=ge.atStart(r).from,a=ge.atEnd(r).to,l=Ns(s,o,a),c=Ns(i,o,a),h=ge.create(r,l,c);e.setSelection(h)}return!0},EB=n=>({state:e,dispatch:t})=>{const r=_t(n,e.schema);return XF(r)(e,t)};function mE(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(s=>e==null?void 0:e.includes(s.type.name));n.tr.ensureMarks(r)}}const vB=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:s})=>{const{selection:i,doc:o}=e,{$from:a,$to:l}=i,c=s.extensionManager.attributes,h=Ql(c,a.node().type.name,a.node().attrs);if(i instanceof he&&i.node.isBlock)return!a.parentOffset||!Fi(o,a.pos)?!1:(r&&(n&&mE(t,s.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(r){const d=l.parentOffset===l.parent.content.size;i instanceof ge&&e.deleteSelection();const f=a.depth===0?void 0:iB(a.node(-1).contentMatchAt(a.indexAfter(-1)));let m=d&&f?[{type:f,attrs:h}]:void 0,y=Fi(e.doc,e.mapping.map(a.pos),1,m);if(!m&&!y&&Fi(e.doc,e.mapping.map(a.pos),1,f?[{type:f}]:void 0)&&(y=!0,m=f?[{type:f,attrs:h}]:void 0),y&&(e.split(e.mapping.map(a.pos),1,m),f&&!d&&!a.parentOffset&&a.parent.type!==f)){const T=e.mapping.map(a.before()),w=e.doc.resolve(T);a.node(-1).canReplaceWith(w.index(),w.index()+1,f)&&e.setNodeMarkup(e.mapping.map(a.before()),f)}n&&mE(t,s.extensionManager.splittableMarks),e.scrollIntoView()}return!0},TB=n=>({tr:e,state:t,dispatch:r,editor:s})=>{var i;const o=_t(n,t.schema),{$from:a,$to:l}=t.selection,c=t.selection.node;if(c&&c.isBlock||a.depth<2||!a.sameParent(l))return!1;const h=a.node(-1);if(h.type!==o)return!1;const d=s.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(r){let w=H.empty;const P=a.index(-1)?1:a.index(-2)?2:3;for(let A=a.depth-P;A>=a.depth-3;A-=1)w=H.from(a.node(A).copy(w));const O=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,D=Ql(d,a.node().type.name,a.node().attrs),$=((i=o.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(D))||void 0;w=w.append(H.from(o.createAndFill(null,$)||void 0));const q=a.before(a.depth-(P-1));e.replace(q,a.after(-O),new X(w,4-P,0));let F=-1;e.doc.nodesBetween(q,e.doc.content.size,(A,_)=>{if(F>-1)return!1;A.isTextblock&&A.content.size===0&&(F=_+1)}),F>-1&&e.setSelection(ge.near(e.doc.resolve(F))),e.scrollIntoView()}return!0}const f=l.pos===a.end()?h.contentMatchAt(0).defaultType:null,m=Ql(d,h.type.name,h.attrs),y=Ql(d,a.node().type.name,a.node().attrs);e.delete(a.pos,l.pos);const T=f?[{type:o,attrs:m},{type:f,attrs:y}]:[{type:o,attrs:m}];if(!Fi(e.doc,a.pos,2))return!1;if(r){const{selection:w,storedMarks:P}=t,{splittableMarks:O}=s.extensionManager,D=P||w.$to.parentOffset&&w.$from.marks();if(e.split(a.pos,2,T).scrollIntoView(),!D||!r)return!0;const $=D.filter(q=>O.includes(q.type.name));e.ensureMarks($)}return!0},Gh=(n,e)=>{const t=Kp(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&ds(n.doc,t.pos)&&n.join(t.pos),!0},Jh=(n,e)=>{const t=Kp(o=>o.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const s=n.doc.nodeAt(r);return t.node.type===(s==null?void 0:s.type)&&ds(n.doc,r)&&n.join(r),!0},wB=(n,e,t,r={})=>({editor:s,tr:i,state:o,dispatch:a,chain:l,commands:c,can:h})=>{const{extensions:d,splittableMarks:f}=s.extensionManager,m=_t(n,o.schema),y=_t(e,o.schema),{selection:T,storedMarks:w}=o,{$from:P,$to:O}=T,D=P.blockRange(O),$=w||T.$to.parentOffset&&T.$from.marks();if(!D)return!1;const q=Kp(F=>pE(F.type.name,d))(T);if(D.depth>=1&&q&&D.depth-q.depth<=1){if(q.node.type===m)return c.liftListItem(y);if(pE(q.node.type.name,d)&&m.validContent(q.node.content)&&a)return l().command(()=>(i.setNodeMarkup(q.pos,m),!0)).command(()=>Gh(i,m)).command(()=>Jh(i,m)).run()}return!t||!$||!a?l().command(()=>h().wrapInList(m,r)?!0:c.clearNodes()).wrapInList(m,r).command(()=>Gh(i,m)).command(()=>Jh(i,m)).run():l().command(()=>{const F=h().wrapInList(m,r),A=$.filter(_=>f.includes(_.type.name));return i.ensureMarks(A),F?!0:c.clearNodes()}).wrapInList(m,r).command(()=>Gh(i,m)).command(()=>Jh(i,m)).run()},bB=(n,e={},t={})=>({state:r,commands:s})=>{const{extendEmptyMarkRange:i=!1}=t,o=ms(n,r.schema);return sf(r,o,e)?s.unsetMark(o,{extendEmptyMarkRange:i}):s.setMark(o,e)},SB=(n,e,t={})=>({state:r,commands:s})=>{const i=_t(n,r.schema),o=_t(e,r.schema);return Oa(r,i,t)?s.setNode(o):s.setNode(i,t)},IB=(n,e={})=>({state:t,commands:r})=>{const s=_t(n,t.schema);return Oa(t,s,e)?r.lift(s):r.wrapIn(s,e)},AB=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const s=t[r];let i;if(s.spec.isInputRules&&(i=s.getState(n))){if(e){const o=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)o.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else o.delete(i.from,i.to)}return!0}}return!1},CB=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:s}=t;return r||e&&s.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},kB=(n,e={})=>({tr:t,state:r,dispatch:s})=>{var i;const{extendEmptyMarkRange:o=!1}=e,{selection:a}=t,l=ms(n,r.schema),{$from:c,empty:h,ranges:d}=a;if(!s)return!0;if(h&&o){let{from:f,to:m}=a;const y=(i=c.marks().find(w=>w.type===l))===null||i===void 0?void 0:i.attrs,T=Hp(c,l,y);T&&(f=T.from,m=T.to),t.removeMark(f,m,l)}else d.forEach(f=>{t.removeMark(f.$from.pos,f.$to.pos,l)});return t.removeStoredMark(l),!0},RB=(n,e={})=>({tr:t,state:r,dispatch:s})=>{let i=null,o=null;const a=Hu(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=_t(n,r.schema)),a==="mark"&&(o=ms(n,r.schema)),s&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,h=l.$to.pos;r.doc.nodesBetween(c,h,(d,f)=>{i&&i===d.type&&t.setNodeMarkup(f,void 0,{...d.attrs,...e}),o&&d.marks.length&&d.marks.forEach(m=>{if(o===m.type){const y=Math.max(f,c),T=Math.min(f+d.nodeSize,h);t.addMark(y,T,o.create({...m.attrs,...e}))}})})}),!0):!1},PB=(n,e={})=>({state:t,dispatch:r})=>{const s=_t(n,t.schema);return WF(s,e)(t,r)},xB=(n,e={})=>({state:t,dispatch:r})=>{const s=_t(n,t.schema);return KF(s,e)(t,r)};var OB=Object.freeze({__proto__:null,blur:m2,clearContent:g2,clearNodes:y2,command:_2,createParagraphNear:E2,cut:v2,deleteCurrentNode:T2,deleteNode:w2,deleteRange:b2,deleteSelection:S2,enter:I2,exitCode:A2,extendMarkRange:k2,first:R2,focus:P2,forEach:x2,insertContent:O2,insertContentAt:D2,joinUp:L2,joinDown:V2,joinBackward:F2,joinForward:B2,joinItemBackward:U2,joinItemForward:$2,joinTextblockBackward:z2,joinTextblockForward:j2,keyboardShortcut:q2,lift:W2,liftEmptyBlock:K2,liftListItem:G2,newlineInCode:J2,resetAttributes:Q2,scrollIntoView:Y2,selectAll:X2,selectNodeBackward:Z2,selectNodeForward:eB,selectParentNode:tB,selectTextblockEnd:nB,selectTextblockStart:rB,setContent:sB,setMark:pB,setMeta:mB,setNode:gB,setNodeSelection:yB,setTextSelection:_B,sinkListItem:EB,splitBlock:vB,splitListItem:TB,toggleList:wB,toggleMark:bB,toggleNode:SB,toggleWrap:IB,undoInputRule:AB,unsetAllMarks:CB,unsetMark:kB,updateAttributes:RB,wrapIn:PB,wrapInList:xB});const MB=Yt.create({name:"commands",addCommands(){return{...OB}}}),NB=Yt.create({name:"editable",addProseMirrorPlugins(){return[new _n({key:new fs("editable"),props:{editable:()=>this.editor.options.editable}})]}}),DB=Yt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new _n({key:new fs("focusEvents"),props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),LB=Yt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:h,$anchor:d}=l,{pos:f,parent:m}=d,y=d.parent.isTextblock&&f>0?a.doc.resolve(f-1):d,T=y.parent.type.spec.isolating,w=d.pos-d.parentOffset,P=T&&y.parent.childCount===1?w===d.pos:Ee.atStart(c).from===f;return!h||!P||!m.type.isTextblock||m.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},s={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return qp()||Wp()?i:s},addProseMirrorPlugins(){return[new _n({key:new fs("clearDocument"),appendTransaction:(n,e,t)=>{if(!(n.some(y=>y.docChanged)&&!e.doc.eq(t.doc)))return;const{empty:s,from:i,to:o}=e.selection,a=Ee.atStart(e.doc).from,l=Ee.atEnd(e.doc).to;if(s||!(i===a&&o===l)||!(t.doc.textBetween(0,t.doc.content.size," "," ").length===0))return;const d=t.tr,f=Bu({state:t,transaction:d}),{commands:m}=new Uu({editor:this.editor,state:f});if(m.clearNodes(),!!d.steps.length)return d}})]}}),VB=Yt.create({name:"tabindex",addProseMirrorPlugins(){return[new _n({key:new fs("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Rs{constructor(e,t,r=!1,s=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=s}get name(){return this.node.type.name}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You cant set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Rs(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Rs(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Rs(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const s=t.isBlock&&!t.isTextblock,i=this.pos+r+1,o=this.resolvedPos.doc.resolve(i);if(!s&&o.depth<=this.depth)return;const a=new Rs(o,this.editor,s,s?t:null);s&&(a.actualDepth=this.depth+1),e.push(new Rs(o,this.editor,s,s?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,s=this.parent;for(;s&&!r;){if(s.node.type.name===e)if(Object.keys(t).length>0){const i=s.node.attrs,o=Object.keys(t);for(let a=0;a<o.length;a+=1){const l=o[a];if(i[l]!==t[l])break}}else r=s;s=s.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let s=[];return!this.children||this.children.length===0||this.children.forEach(i=>{if(i.node.type.name===e){if(Object.keys(t).length>0){const o=i.node.attrs,a=Object.keys(t);for(let l=0;l<a.length;l+=1){const c=a[l];if(o[c]!==t[c])return}}if(s.push(i),r)return}s=s.concat(i.querySelectorAll(e))}),s}setAttribute(e){const t=this.editor.state.selection;this.editor.chain().setTextSelection(this.from).updateAttributes(this.node.type.name,e).setTextSelection(t.from).run()}}const FB=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function BB(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const s=document.createElement("style");return e&&s.setAttribute("nonce",e),s.setAttribute("data-tiptap-style",""),s.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(s),s}let E4=class extends ZF{constructor(e={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=BB(FB,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=Vb(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],s=this.state.reconfigure({plugins:r});this.view.updateState(s)}unregisterPlugin(e){if(this.isDestroyed)return;const t=typeof e=="string"?`${e}$`:e.key,r=this.state.reconfigure({plugins:this.state.plugins.filter(s=>!s.key.startsWith(t))});this.view.updateState(r)}createExtensionManager(){var e,t;const s=[...this.options.enableCoreExtensions?[NB,p2.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),MB,DB,LB,VB]:[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new Ai(s,this)}createCommandManager(){this.commandManager=new Uu({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const e=jb(this.options.content,this.schema,this.options.parseOptions),t=$b(e,this.options.autofocus);this.view=new _F(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:Ii.create({doc:e,selection:t||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();const s=this.view.dom;s.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const s=e.getMeta("focus"),i=e.getMeta("blur");s&&this.emit("focus",{editor:this,event:s.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return uB(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,s=typeof e=="string"?t:e;return hB(this.state,r,s)}getJSON(){return this.state.doc.toJSON()}getHTML(){return aB(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return lB(this.state.doc,{blockSeparator:t,textSerializers:{...Bb(this.schema),...r}})}get isEmpty(){return dB(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Rs(t,this)}get $doc(){return this.$pos(0)}};function ro(n){return new zu({find:n.find,handler:({state:e,range:t,match:r})=>{const s=_e(n.getAttributes,void 0,r);if(s===!1||s===null)return null;const{tr:i}=e,o=r[r.length-1],a=r[0];if(o){const l=a.search(/\S/),c=t.from+a.indexOf(o),h=c+o.length;if(Hb(t.from,t.to,e.doc).filter(m=>m.mark.type.excluded.find(T=>T===n.type&&T!==m.mark.type)).filter(m=>m.to>c).length)return null;h<t.to&&i.delete(h,t.to),c>t.from&&i.delete(t.from+l,c);const f=t.from+l+o.length;i.addMark(t.from+l,f,n.type.create(s||{})),i.removeStoredMark(n.type)}}})}function UB(n){return new zu({find:n.find,handler:({state:e,range:t,match:r})=>{const s=_e(n.getAttributes,void 0,r)||{},{tr:i}=e,o=t.from;let a=t.to;const l=n.type.create(s);if(r[1]){const c=r[0].lastIndexOf(r[1]);let h=o+c;h>a?h=a:a=h+r[1].length;const d=r[0][r[0].length-1];i.insertText(d,o+r[0].length-1),i.replaceWith(h,a,l)}else r[0]&&i.insert(o-1,n.type.create(s)).delete(i.mapping.map(o),i.mapping.map(a));i.scrollIntoView()}})}function of(n){return new zu({find:n.find,handler:({state:e,range:t,match:r})=>{const s=e.doc.resolve(t.from),i=_e(n.getAttributes,void 0,r)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function Ma(n){return new zu({find:n.find,handler:({state:e,range:t,match:r,chain:s})=>{const i=_e(n.getAttributes,void 0,r)||{},o=e.tr.delete(t.from,t.to),l=o.doc.resolve(t.from).blockRange(),c=l&&xp(l,n.type,i);if(!c)return null;if(o.wrap(l,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:f}=e,{splittableMarks:m}=n.editor.extensionManager,y=f||d.$to.parentOffset&&d.$from.marks();if(y){const T=y.filter(w=>m.includes(w.type.name));o.ensureMarks(T)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";s().updateAttributes(d,i).run()}const h=o.doc.resolve(t.from-1).nodeBefore;h&&h.type===n.type&&ds(o.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,h))&&o.join(t.from-1)}})}class Jn{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_e(ne(this,"addOptions",{name:this.name}))),this.storage=_e(ne(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Jn(e)}configure(e={}){const t=this.extend();return t.options=ju(this.options,e),t.storage=_e(ne(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Jn({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=_e(ne(t,"addOptions",{name:t.name})),t.storage=_e(ne(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,s=e.state.selection.$from;if(s.pos===s.end()){const o=s.marks();if(!!!o.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=o.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",s.pos),e.view.dispatch(r),!0}return!1}}class Dt{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=_e(ne(this,"addOptions",{name:this.name}))),this.storage=_e(ne(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Dt(e)}configure(e={}){const t=this.extend();return t.options=ju(this.options,e),t.storage=_e(ne(t,"addStorage",{name:t.name,options:t.options})),t}extend(e={}){const t=new Dt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=_e(ne(t,"addOptions",{name:t.name})),t.storage=_e(ne(t,"addStorage",{name:t.name,options:t.options})),t}}function so(n){return new a2({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:s})=>{const i=_e(n.getAttributes,void 0,r,s);if(i===!1||i===null)return null;const{tr:o}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const h=l.search(/\S/),d=t.from+l.indexOf(a),f=d+a.length;if(Hb(t.from,t.to,e.doc).filter(y=>y.mark.type.excluded.find(w=>w===n.type&&w!==y.mark.type)).filter(y=>y.to>d).length)return null;f<t.to&&o.delete(f,t.to),d>t.from&&o.delete(t.from+h,d),c=t.from+h+a.length,o.addMark(t.from+h,c,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}const $B=/^\s*>\s$/,zB=Dt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Ma({find:$B,type:this.type})]}}),jB=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,HB=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,qB=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,WB=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,KB=Jn.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[ro({find:jB,type:this.type}),ro({find:qB,type:this.type})]},addPasteRules(){return[so({find:HB,type:this.type}),so({find:WB,type:this.type})]}}),GB=Dt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ht(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),gE=Jn.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=qu(n,this.type);return Object.entries(t).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),yE=/^\s*([-+*])\s$/,JB=Dt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(GB.name,this.editor.getAttributes(gE.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Ma({find:yE,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Ma({find:yE,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(gE.name),editor:this.editor})),[n]}}),QB=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))$/,YB=/(?:^|\s)(`(?!\s+`)((?:[^`]+))`(?!\s+`))/g,XB=Jn.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[ro({find:QB,type:this.type})]},addPasteRules(){return[so({find:YB,type:this.type})]}}),ZB=/^```([a-z]+)?[\s\n]$/,eU=/^~~~([a-z]+)?[\s\n]$/,tU=Dt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(o=>o.startsWith(t)).map(o=>o.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",ht(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:s}=t;if(!s||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,o=r.parent.textContent.endsWith(`

`);return!i||!o?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:s,empty:i}=t;if(!i||s.parent.type!==this.type||!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();return a===void 0||r.nodeAt(a)?!1:n.commands.exitCode()}}},addInputRules(){return[of({find:ZB,type:this.type,getAttributes:n=>({language:n[1]})}),of({find:eU,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new _n({key:new fs("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),s=r?JSON.parse(r):void 0,i=s==null?void 0:s.mode;if(!t||!i)return!1;const{tr:o}=n.state;return n.state.selection.from===n.state.doc.nodeSize-(1+n.state.selection.$to.depth*2)?o.insert(n.state.selection.from-1,this.type.create({language:i})):o.replaceSelectionWith(this.type.create({language:i})),o.setSelection(ge.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(t.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),n.dispatch(o),!0}}})]}}),nU=Dt.create({name:"doc",topNode:!0,content:"block+"});function rU(n={}){return new _n({view(e){return new sU(e,n)}})}class sU{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(s=>{let i=o=>{this[s](o)};return e.dom.addEventListener(s,i),{name:s,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let h=c.getBoundingClientRect(),d=a?h.bottom:h.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:h.left,right:h.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let s=this.editorView.dom.offsetParent;this.element||(this.element=s.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let i,o;if(!s||s==document.body&&getComputedStyle(s).position=="static")i=-pageXOffset,o=-pageYOffset;else{let a=s.getBoundingClientRect();i=a.left-s.scrollLeft,o=a.top-s.scrollTop}this.element.style.left=r.left-i+"px",this.element.style.top=r.top-o+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),s=r&&r.type.spec.disableDropCursor,i=typeof s=="function"?s(this.editorView,t,e):s;if(t&&!i){let o=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=jw(this.editorView.state.doc,o,this.editorView.dragging.slice);a!=null&&(o=a)}this.setCursor(o),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const iU=Yt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[rU(this.options)]}});class Je extends Ee{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Je.valid(r)?new Je(r):Ee.near(r)}content(){return X.empty}eq(e){return e instanceof Je&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Je(e.resolve(t.pos))}getBookmark(){return new Gp(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!oU(e)||!aU(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let s=t.contentMatchAt(e.index()).defaultType;return s&&s.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Je.valid(e))return e;let s=e.pos,i=null;for(let o=e.depth;;o--){let a=e.node(o);if(t>0?e.indexAfter(o)<a.childCount:e.index(o)>0){i=a.child(t>0?e.indexAfter(o):e.index(o)-1);break}else if(o==0)return null;s+=t;let l=e.doc.resolve(s);if(Je.valid(l))return l}for(;;){let o=t>0?i.firstChild:i.lastChild;if(!o){if(i.isAtom&&!i.isText&&!he.isSelectable(i)){e=e.doc.resolve(s+i.nodeSize*t),r=!1;continue e}break}i=o,s+=t;let a=e.doc.resolve(s);if(Je.valid(a))return a}return null}}}Je.prototype.visible=!1;Je.findFrom=Je.findGapCursorFrom;Ee.jsonID("gapcursor",Je);class Gp{constructor(e){this.pos=e}map(e){return new Gp(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Je.valid(t)?new Je(t):Ee.near(t)}}function oU(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t-1);;s=s.lastChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function aU(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let s=r.child(t);;s=s.firstChild){if(s.childCount==0&&!s.inlineContent||s.isAtom||s.type.spec.isolating)return!0;if(s.inlineContent)return!1}}return!0}function lU(){return new _n({props:{decorations:dU,createSelectionBetween(n,e,t){return e.pos==t.pos&&Je.valid(t)?new Je(t):null},handleClick:uU,handleKeyDown:cU,handleDOMEvents:{beforeinput:hU}}})}const cU=Rb({ArrowLeft:Ml("horiz",-1),ArrowRight:Ml("horiz",1),ArrowUp:Ml("vert",-1),ArrowDown:Ml("vert",1)});function Ml(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,s,i){let o=r.selection,a=e>0?o.$to:o.$from,l=o.empty;if(o instanceof ge){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Je.findGapCursorFrom(a,e,l);return c?(s&&s(r.tr.setSelection(new Je(c))),!0):!1}}function uU(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Je.valid(r))return!1;let s=n.posAtCoords({left:t.clientX,top:t.clientY});return s&&s.inside>-1&&he.isSelectable(n.state.doc.nodeAt(s.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Je(r))),!0)}function hU(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Je))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let s=H.empty;for(let o=r.length-1;o>=0;o--)s=H.from(r[o].createAndFill(null,s));let i=n.state.tr.replace(t.pos,t.pos,new X(s,0,0));return i.setSelection(ge.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function dU(n){if(!(n.selection instanceof Je))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",lt.create(n.doc,[fn.widget(n.selection.head,e,{key:"gapcursor"})])}const fU=Yt.create({name:"gapCursor",addProseMirrorPlugins(){return[lU()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=_e(ne(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),pU=Dt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",ht(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:s,storedMarks:i}=t;if(s.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=r.extensionManager,l=i||s.$to.parentOffset&&s.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:h})=>{if(h&&l&&o){const d=l.filter(f=>a.includes(f.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),mU=Dt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,ht(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>of({find:new RegExp(`^(#{1,${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Uc=200,yt=function(){};yt.prototype.append=function(e){return e.length?(e=yt.from(e),!this.length&&e||e.length<Uc&&this.leafAppend(e)||this.length<Uc&&e.leafPrepend(this)||this.appendInner(e)):this};yt.prototype.prepend=function(e){return e.length?yt.from(e).append(this):this};yt.prototype.appendInner=function(e){return new gU(this,e)};yt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?yt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};yt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};yt.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};yt.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var s=[];return this.forEach(function(i,o){return s.push(e(i,o))},t,r),s};yt.from=function(e){return e instanceof yt?e:e&&e.length?new qb(e):yt.empty};var qb=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(s,i){return s==0&&i==this.length?this:new e(this.values.slice(s,i))},e.prototype.getInner=function(s){return this.values[s]},e.prototype.forEachInner=function(s,i,o,a){for(var l=i;l<o;l++)if(s(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(s,i,o,a){for(var l=i-1;l>=o;l--)if(s(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(s){if(this.length+s.length<=Uc)return new e(this.values.concat(s.flatten()))},e.prototype.leafPrepend=function(s){if(this.length+s.length<=Uc)return new e(s.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(yt);yt.empty=new qb([]);var gU=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,s,i,o){var a=this.left.length;if(s<a&&this.left.forEachInner(r,s,Math.min(i,a),o)===!1||i>a&&this.right.forEachInner(r,Math.max(s-a,0),Math.min(this.length,i)-a,o+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,s,i,o){var a=this.left.length;if(s>a&&this.right.forEachInvertedInner(r,s-a,Math.max(i,a)-a,o+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(s,a),i,o)===!1)return!1},e.prototype.sliceInner=function(r,s){if(r==0&&s==this.length)return this;var i=this.left.length;return s<=i?this.left.slice(r,s):r>=i?this.right.slice(r-i,s-i):this.left.slice(r,i).append(this.right.slice(0,s-i))},e.prototype.leafAppend=function(r){var s=this.right.leafAppend(r);if(s)return new e(this.left,s)},e.prototype.leafPrepend=function(r){var s=this.left.leafPrepend(r);if(s)return new e(s,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(yt);const yU=500;class wn{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let s,i;t&&(s=this.remapping(r,this.items.length),i=s.maps.length);let o=e.tr,a,l,c=[],h=[];return this.items.forEach((d,f)=>{if(!d.step){s||(s=this.remapping(r,f+1),i=s.maps.length),i--,h.push(d);return}if(s){h.push(new Mn(d.map));let m=d.step.map(s.slice(i)),y;m&&o.maybeStep(m).doc&&(y=o.mapping.maps[o.mapping.maps.length-1],c.push(new Mn(y,void 0,void 0,c.length+h.length))),i--,y&&s.appendMap(y,i)}else o.maybeStep(d.step);if(d.selection)return a=s?d.selection.map(s.slice(i)):d.selection,l=new wn(this.items.slice(0,r).append(h.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:o,selection:a}}addTransform(e,t,r,s){let i=[],o=this.eventCount,a=this.items,l=!s&&a.length?a.get(a.length-1):null;for(let h=0;h<e.steps.length;h++){let d=e.steps[h].invert(e.docs[h]),f=new Mn(e.mapping.maps[h],d,t),m;(m=l&&l.merge(f))&&(f=m,h?i.pop():a=a.slice(0,a.length-1)),i.push(f),t&&(o++,t=void 0),s||(l=f)}let c=o-r.depth;return c>EU&&(a=_U(a,c),o-=c),new wn(a.append(i),o)}remapping(e,t){let r=new Vi;return this.items.forEach((s,i)=>{let o=s.mirrorOffset!=null&&i-s.mirrorOffset>=e?r.maps.length-s.mirrorOffset:void 0;r.appendMap(s.map,o)},e,t),r}addMaps(e){return this.eventCount==0?this:new wn(this.items.append(e.map(t=>new Mn(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],s=Math.max(0,this.items.length-t),i=e.mapping,o=e.steps.length,a=this.eventCount;this.items.forEach(f=>{f.selection&&a--},s);let l=t;this.items.forEach(f=>{let m=i.getMirror(--l);if(m==null)return;o=Math.min(o,m);let y=i.maps[m];if(f.step){let T=e.steps[m].invert(e.docs[m]),w=f.selection&&f.selection.map(i.slice(l+1,m));w&&a++,r.push(new Mn(y,T,w))}else r.push(new Mn(y))},s);let c=[];for(let f=t;f<o;f++)c.push(new Mn(i.maps[f]));let h=this.items.slice(0,s).append(c).append(r),d=new wn(h,a);return d.emptyItemCount()>yU&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,s=[],i=0;return this.items.forEach((o,a)=>{if(a>=e)s.push(o),o.selection&&i++;else if(o.step){let l=o.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let h=o.selection&&o.selection.map(t.slice(r));h&&i++;let d=new Mn(c.invert(),l,h),f,m=s.length-1;(f=s.length&&s[m].merge(d))?s[m]=f:s.push(d)}}else o.map&&r--},this.items.length,0),new wn(yt.from(s.reverse()),i)}}wn.empty=new wn(yt.empty,0);function _U(n,e){let t;return n.forEach((r,s)=>{if(r.selection&&e--==0)return t=s,!1}),n.slice(t)}class Mn{constructor(e,t,r,s){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=s}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Mn(t.getMap().invert(),t,this.selection)}}}class Or{constructor(e,t,r,s,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=s,this.prevComposition=i}}const EU=20;function vU(n,e,t,r){let s=t.getMeta(Hs),i;if(s)return s.historyState;t.getMeta(bU)&&(n=new Or(n.done,n.undone,null,0,-1));let o=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(o&&o.getMeta(Hs))return o.getMeta(Hs).redo?new Or(n.done.addTransform(t,void 0,r,Yl(e)),n.undone,_E(t.mapping.maps[t.steps.length-1]),n.prevTime,n.prevComposition):new Or(n.done,n.undone.addTransform(t,void 0,r,Yl(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(o&&o.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!o&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!TU(t,n.prevRanges)),c=o?Qh(n.prevRanges,t.mapping):_E(t.mapping.maps[t.steps.length-1]);return new Or(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,Yl(e)),wn.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new Or(n.done.rebased(t,i),n.undone.rebased(t,i),Qh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Or(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),Qh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function TU(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,s)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&s>=e[i]&&(t=!0)}),t}function _E(n){let e=[];return n.forEach((t,r,s,i)=>e.push(s,i)),e}function Qh(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let s=e.map(n[r],1),i=e.map(n[r+1],-1);s<=i&&t.push(s,i)}return t}function wU(n,e,t){let r=Yl(e),s=Hs.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let o=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),s,r),l=new Or(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(o).setMeta(Hs,{redo:t,historyState:l})}let Yh=!1,EE=null;function Yl(n){let e=n.plugins;if(EE!=e){Yh=!1,EE=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Yh=!0;break}}return Yh}const Hs=new fs("history"),bU=new fs("closeHistory");function SU(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new _n({key:Hs,state:{init(){return new Or(wn.empty,wn.empty,null,0,-1)},apply(e,t,r){return vU(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,s=r=="historyUndo"?Kb:r=="historyRedo"?Gb:null;return s?(t.preventDefault(),s(e.state,e.dispatch)):!1}}}})}function Wb(n,e){return(t,r)=>{let s=Hs.getState(t);if(!s||(n?s.undone:s.done).eventCount==0)return!1;if(r){let i=wU(s,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const Kb=Wb(!1,!0),Gb=Wb(!0,!0),IU=Yt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>Kb(n,e),redo:()=>({state:n,dispatch:e})=>Gb(n,e)}},addProseMirrorPlugins(){return[SU(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-":()=>this.editor.commands.undo(),"Shift-Mod-":()=>this.editor.commands.redo()}}}),AU=Dt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",ht(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{$to:t}=e.selection,r=n();return t.parentOffset===0?r.insertContentAt(Math.max(t.pos-2,0),{type:this.name}):r.insertContent({type:this.name}),r.command(({tr:s,dispatch:i})=>{var o;if(i){const{$to:a}=s.selection,l=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?s.setSelection(ge.create(s.doc,a.pos+1)):a.nodeAfter.isBlock?s.setSelection(he.create(s.doc,a.pos)):s.setSelection(ge.create(s.doc,a.pos));else{const c=(o=a.parent.type.contentMatch.defaultType)===null||o===void 0?void 0:o.create();c&&(s.insert(l,c),s.setSelection(ge.create(s.doc,l+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[UB({find:/^(?:---|-|___\s|\*\*\*\s)$/,type:this.type})]}}),CU=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,kU=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,RU=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,PU=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,xU=Jn.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[ro({find:CU,type:this.type}),ro({find:RU,type:this.type})]},addPasteRules(){return[so({find:kU,type:this.type}),so({find:PU,type:this.type})]}}),OU=Dt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ht(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),MU=Dt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",ht(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),vE=Jn.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:n=>n.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["span",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:n,commands:e})=>{const t=qu(n,this.type);return Object.entries(t).some(([,s])=>!!s)?!0:e.unsetMark(this.name)}}}}),TE=/^(\d+)\.\s$/,NU=Dt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",ht(this.options.HTMLAttributes,t),0]:["ol",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(MU.name,this.editor.getAttributes(vE.name)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Ma({find:TE,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Ma({find:TE,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(vE.name)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),DU=Dt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),LU=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,VU=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,FU=Jn.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",ht(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){const n={};return Wp()?n["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():n["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),n},addInputRules(){return[ro({find:LU,type:this.type})]},addPasteRules(){return[so({find:VU,type:this.type})]}}),BU=Dt.create({name:"text",group:"inline"}),T4=Yt.create({name:"starterKit",addExtensions(){var n,e,t,r,s,i,o,a,l,c,h,d,f,m,y,T,w,P;const O=[];return this.options.blockquote!==!1&&O.push(zB.configure((n=this.options)===null||n===void 0?void 0:n.blockquote)),this.options.bold!==!1&&O.push(KB.configure((e=this.options)===null||e===void 0?void 0:e.bold)),this.options.bulletList!==!1&&O.push(JB.configure((t=this.options)===null||t===void 0?void 0:t.bulletList)),this.options.code!==!1&&O.push(XB.configure((r=this.options)===null||r===void 0?void 0:r.code)),this.options.codeBlock!==!1&&O.push(tU.configure((s=this.options)===null||s===void 0?void 0:s.codeBlock)),this.options.document!==!1&&O.push(nU.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&O.push(iU.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&O.push(fU.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&O.push(pU.configure((l=this.options)===null||l===void 0?void 0:l.hardBreak)),this.options.heading!==!1&&O.push(mU.configure((c=this.options)===null||c===void 0?void 0:c.heading)),this.options.history!==!1&&O.push(IU.configure((h=this.options)===null||h===void 0?void 0:h.history)),this.options.horizontalRule!==!1&&O.push(AU.configure((d=this.options)===null||d===void 0?void 0:d.horizontalRule)),this.options.italic!==!1&&O.push(xU.configure((f=this.options)===null||f===void 0?void 0:f.italic)),this.options.listItem!==!1&&O.push(OU.configure((m=this.options)===null||m===void 0?void 0:m.listItem)),this.options.orderedList!==!1&&O.push(NU.configure((y=this.options)===null||y===void 0?void 0:y.orderedList)),this.options.paragraph!==!1&&O.push(DU.configure((T=this.options)===null||T===void 0?void 0:T.paragraph)),this.options.strike!==!1&&O.push(FU.configure((w=this.options)===null||w===void 0?void 0:w.strike)),this.options.text!==!1&&O.push(BU.configure((P=this.options)===null||P===void 0?void 0:P.text)),O}}),w4=Yt.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:n=>n.style.textAlign||this.options.defaultAlignment,renderHTML:n=>n.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${n.textAlign}`}}}}]},addCommands(){return{setTextAlign:n=>({commands:e})=>this.options.alignments.includes(n)?this.options.types.every(t=>e.updateAttributes(t,{textAlign:n})):!1,unsetTextAlign:()=>({commands:n})=>this.options.types.every(e=>n.resetAttributes(e,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),b4=lC("auth",{state:()=>({errorMessage:"",isLoggedIn:!1}),actions:{async login(n,e){const t=yc();try{const s=(await qR(t,n,e)).user;console.log("User logged in:",s),this.isLoggedIn=!0,$c.push("/admin")}catch(r){this.errorMessage=r.message,console.error("Login error:",r.message)}},async logout(){const n=yc();try{await JR(n),this.isLoggedIn=!1,$c.push("/")}catch(e){console.error("Logout error:",e.message)}},clearErrorMessage(){this.errorMessage=""}}}),$c=cx({history:FP("/"),routes:[{path:"/",name:"home",component:HD},{path:"/OmHaven",name:"omhaven",component:()=>On(()=>import("./AboutGarden-D--KqRoi.js"),__vite__mapDeps([0,1,2]))},{path:"/map",name:"map",component:()=>On(()=>import("./MapView-BJ2bbAiJ.js"),__vite__mapDeps([3,1,4]))},{path:"/calender",name:"calender",component:()=>On(()=>import("./CalenderView-gYIenJST.js"),__vite__mapDeps([5,6]))},{path:"/:pathMatch(.*)*",name:"404",component:()=>On(()=>import("./404View-I9Oa_NXT.js"),__vite__mapDeps([7,1,8]))},{path:"/plant/:id",name:"PlantPage",component:()=>On(()=>import("./PlantPage-DBzmp3X9.js"),__vite__mapDeps([9,10])),props:!0},{path:"/event/:id",name:"event-detail",component:()=>On(()=>import("./SingleEventPage-B7xQKkfm.js"),__vite__mapDeps([11,1,12])),props:!0},{path:"/areas/:id",name:"countryView",component:()=>On(()=>import("./CountryView-CvkPUqNH.js"),__vite__mapDeps([13,1,14])),props:!0},{path:"/plants/:origin",name:"plantoverview",component:()=>On(()=>import("./PlantOverview-BKiY7zB_.js"),__vite__mapDeps([15,16])),props:!0},{path:"/admin",name:"admin",component:()=>On(()=>import("./AdminDashboard-7_m3iW_h.js"),__vite__mapDeps([17,1])),meta:{requiresAuth:!0}},{path:"/login",name:"login",component:()=>On(()=>import("./LoginView-DkKH3amv.js"),__vite__mapDeps([18,19]))}]});$c.beforeEach((n,e,t)=>{const r=yc(),s=n.matched.some(o=>o.meta.requiresAuth),i=r.currentUser;s&&!i?t("/login"):t()});const Jp=XA(kD);Jp.use(nC());Jp.use($c);Jp.mount("#app");export{ZU as $,oA as A,sc as B,cA as C,Xc as D,jU as E,Wt as F,Ll as G,Kc as H,Br as I,lA as J,HU as K,mn as L,at as M,uv as N,iI as O,Wc as P,t4 as Q,WU as R,n4 as S,Iv as T,KU as U,qU as V,QU as W,XM as X,u4 as Y,dC as Z,xv as _,je as a,SD as a0,_4 as a1,y4 as a2,l4 as a3,c4 as a4,tI as a5,cv as a6,E4 as a7,Qc as a8,Rf as a9,YU as aa,zU as ab,fA as ac,T4 as ad,w4 as ae,e4 as af,g4 as ag,p4 as ah,d4 as ai,f4 as aj,b4 as ak,yc as al,XU as b,su as c,lC as d,h4 as e,a4 as f,eN as g,Sf as h,tt as i,r4 as j,Ri as k,GU as l,aA as m,tv as n,Kr as o,ev as p,Da as q,La as r,hn as s,$U as t,hx as u,av as v,qo as w,nc as x,JU as y,UU as z};
